(function(t){function e(e){for(var r,o,s=e[0],c=e[1],u=e[2],h=0,f=[];h<s.length;h++)o=s[h],Object.prototype.hasOwnProperty.call(i,o)&&i[o]&&f.push(i[o][0]),i[o]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(t[r]=c[r]);l&&l(e);while(f.length)f.shift()();return a.push.apply(a,u||[]),n()}function n(){for(var t,e=0;e<a.length;e++){for(var n=a[e],r=!0,s=1;s<n.length;s++){var c=n[s];0!==i[c]&&(r=!1)}r&&(a.splice(e--,1),t=o(o.s=n[0]))}return t}var r={},i={app:0},a=[];function o(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=t,o.c=r,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)o.d(n,r,function(e){return t[e]}.bind(null,r));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=e,s=s.slice();for(var u=0;u<s.length;u++)e(s[u]);var l=c;a.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"0014":function(t,e,n){},"0aa2":function(t){t.exports=JSON.parse('{"a":"0.0.0"}')},1227:function(t,e,n){},"2bbc":function(t){t.exports=JSON.parse('{"a":"0.0.0"}')},"2c55":function(t){t.exports=JSON.parse('{"a":"0.0.0"}')},"3d04":function(t){t.exports=JSON.parse('{"a":"0.0.0"}')},"3d1c":function(t){t.exports=JSON.parse('{"a":"0.0.0"}')},"49a4":function(t){t.exports=JSON.parse('{"a":"0.0.0"}')},"56d7":function(t,e,n){"use strict";n.r(e);var r={};n.r(r),n.d(r,"PI",(function(){return pt})),n.d(r,"ROUND",(function(){return vt}));var i={};n.r(i),n.d(i,"Line",(function(){return gt})),n.d(i,"Vector",(function(){return mt})),n.d(i,"Segment",(function(){return Ot})),n.d(i,"Point",(function(){return wt}));var a={};n.r(a),n.d(a,"setTolerance",(function(){return Rt})),n.d(a,"EQ_0",(function(){return Mt})),n.d(a,"EQ",(function(){return Ht})),n.d(a,"GT",(function(){return Bt})),n.d(a,"GE",(function(){return Vt})),n.d(a,"LT",(function(){return zt})),n.d(a,"LE",(function(){return Ut}));var o={};n.r(o),n.d(o,"fromBothPoint",(function(){return kt})),n.d(o,"fromSegment",(function(){return Tt})),n.d(o,"from",(function(){return Et})),n.d(o,"dot",(function(){return St})),n.d(o,"multiply",(function(){return Ct})),n.d(o,"cross",(function(){return Pt})),n.d(o,"length",(function(){return Lt})),n.d(o,"rotate90",(function(){return Dt})),n.d(o,"normalize",(function(){return At})),n.d(o,"invert",(function(){return Nt})),n.d(o,"rotate",(function(){return Ft})),n.d(o,"project",(function(){return Wt})),n.d(o,"equal",(function(){return Yt}));var s={};n.r(s),n.d(s,"fromSegment",(function(){return Jt})),n.d(s,"toStandard",(function(){return ne})),n.d(s,"intersectLine",(function(){return ie}));var c={};n.r(c),n.d(c,"translate",(function(){return jt})),n.d(c,"toLeftOfSegment",(function(){return Gt})),n.d(c,"rotate",(function(){return _t})),n.d(c,"project",(function(){return Xt})),n.d(c,"distanceToPoint",(function(){return Kt})),n.d(c,"distanceToLine",(function(){return qt})),n.d(c,"distanceToSegment",(function(){return ae})),n.d(c,"equal",(function(){return oe}));var u={};n.r(u),n.d(u,"differ",(function(){return se}));var l={};n.r(l),n.d(l,"intersectSegment",(function(){return ue})),n.d(l,"translate",(function(){return le})),n.d(l,"middle",(function(){return he}));var h={};n.r(h),n.d(h,"containsPoint",(function(){return fe})),n.d(h,"area",(function(){return de}));var f={};n.r(f),n.d(f,"Vertex",(function(){return pe})),n.d(f,"HalfEdge",(function(){return ve})),n.d(f,"Face",(function(){return ye}));var d={};n.r(d),n.d(d,"allHalfEdgeOfVertex",(function(){return $e})),n.d(d,"allHalfEdgeOfPath",(function(){return xe}));var p={};n.r(p),n.d(p,"Struct",(function(){return f})),n.d(p,"Iterator",(function(){return d})),n.d(p,"createVertex",(function(){return we})),n.d(p,"getVertexHalfEdgeList",(function(){return ke})),n.d(p,"hasNoHalfEdge",(function(){return Te})),n.d(p,"hasOnlyHalfEdge",(function(){return Ee})),n.d(p,"getAngleOfHalfEdge",(function(){return Se})),n.d(p,"isPathContainsHalfEdge",(function(){return Ce})),n.d(p,"isPathContainsVertex",(function(){return Pe})),n.d(p,"isTwinInSamePath",(function(){return Le})),n.d(p,"getPathOfHalfEdge",(function(){return De})),n.d(p,"isOuterPath",(function(){return Ne})),n.d(p,"isInnerPath",(function(){return Fe})),n.d(p,"splitHalfEdgeByVertex",(function(){return We})),n.d(p,"getPolygonFromFaceOuter",(function(){return Re})),n.d(p,"getFaceOfPoint",(function(){return Be})),n.d(p,"createGlobalFace",(function(){return Ve})),n.d(p,"queryChildFaceList",(function(){return He}));var v={};n.r(v),n.d(v,"EventType",(function(){return ze})),n.d(v,"EventListener",(function(){return Ue})),n.d(v,"PointAxis",(function(){return Ye})),n.d(v,"Point",(function(){return Ge}));var y={};n.r(y),n.d(y,"_",(function(){return Xe})),n.d(y,"Element",(function(){return Qe})),n.d(y,"Plugin",(function(){return Ze})),n.d(y,"Emitter",(function(){return Ke})),n.d(y,"Tool",(function(){return tn})),n.d(y,"ToolProvider",(function(){return en})),n.d(y,"Creator",(function(){return nn}));var g={};n.r(g),n.d(g,"define",(function(){return on}));var b={};n.r(b),n.d(b,"Assert",(function(){return v})),n.d(b,"Proxy",(function(){return y})),n.d(b,"Options",(function(){return g}));var m={};n.r(m),n.d(m,"CENTER",(function(){return Nr})),n.d(m,"CURRENT_POINTER",(function(){return Fr}));var $={};n.r($),n.d($,"define",(function(){return Hr}));var O={};n.r(O),n.d(O,"READY",(function(){return Hn})),n.d(O,"define",(function(){return Br}));var x={};n.r(x),n.d(x,"Element",(function(){return $})),n.d(x,"Tool",(function(){return O})),n.d(x,"define",(function(){return Vr}));var w={};n.r(w),n.d(w,"define",(function(){return zr}));var j={};n.r(j),n.d(j,"Drawing",(function(){return Mr})),n.d(j,"SCALE_MODE",(function(){return m})),n.d(j,"use",(function(){return sr})),n.d(j,"PIXI",(function(){return ln})),n.d(j,"Installer",(function(){return w})),n.d(j,"Plugin",(function(){return x})),n.d(j,"Utils",(function(){return b})),n.d(j,"_",(function(){return Ur}));var k={};n.r(k),n.d(k,"register",(function(){return qr})),n.d(k,"getAllNameList",(function(){return Qr})),n.d(k,"HollowProxy",(function(){return Zr})),n.d(k,"default",(function(){return ni}));var T={};n.r(T),n.d(T,"register",(function(){return ai})),n.d(T,"registerUrl",(function(){return oi})),n.d(T,"StuffProxy",(function(){return li})),n.d(T,"default",(function(){return di}));var E={};n.r(E),n.d(E,"default",(function(){return ts})),n.d(E,"CornerProxy",(function(){return yi})),n.d(E,"RoomProxy",(function(){return Ko})),n.d(E,"WallProxy",(function(){return bi}));var S={};n.r(S),n.d(S,"PICKUP_FROM",(function(){return us})),n.d(S,"PICKUP_TO",(function(){return ls}));var C={};n.r(C),n.d(C,"Indicator",(function(){return cs})),n.d(C,"Tool",(function(){return ms})),n.d(C,"STATE",(function(){return S}));var P={};n.r(P),n.d(P,"vectorFrom",(function(){return ks})),n.d(P,"crossTwoSurface",(function(){return Ts})),n.d(P,"dotTwoSurface",(function(){return Es}));var L={};n.r(L),n.d(L,"WAITING",(function(){return zs})),n.d(L,"ACTIVE",(function(){return Us}));var D={};n.r(D),n.d(D,"Indicator",(function(){return Vs})),n.d(D,"Tool",(function(){return Gs})),n.d(D,"STATE",(function(){return L}));var A={};n.r(A),n.d(A,"WAITING",(function(){return Xs})),n.d(A,"ACTIVE",(function(){return Ks}));var N={};n.r(N),n.d(N,"Indicator",(function(){return _s})),n.d(N,"Tool",(function(){return tc})),n.d(N,"STATE",(function(){return A}));var F={};n.r(F),n.d(F,"DETECTING",(function(){return rc})),n.d(F,"DETECTED",(function(){return ic}));var W={};n.r(W),n.d(W,"Indicator",(function(){return nc})),n.d(W,"Tool",(function(){return sc})),n.d(W,"STATE",(function(){return F}));var I={};n.r(I),n.d(I,"PICKUP_FROM",(function(){return uc})),n.d(I,"PICKUP_TO",(function(){return lc}));var R={};n.r(R),n.d(R,"Indicator",(function(){return cc})),n.d(R,"Tool",(function(){return dc})),n.d(R,"STATE",(function(){return I}));var M={};n.r(M),n.d(M,"BitmapProxy",(function(){return bc})),n.d(M,"default",(function(){return xc}));var H={};n.r(H),n.d(H,"BaseAdaptor",(function(){return Du})),n.d(H,"is",(function(){return Nu}));var B={};n.r(B),n.d(B,"TextLabeler",(function(){return yl})),n.d(B,"LineLabeler",(function(){return hl}));var V={};n.r(V),n.d(V,"STATE",(function(){return B})),n.d(V,"LabelTextProxy",(function(){return rl})),n.d(V,"LabelLineProxy",(function(){return tl})),n.d(V,"default",(function(){return jl}));var z={};n.r(z),n.d(z,"PreventDefaultContextMenu",(function(){return Fl})),n.d(z,"AdjustViewportByPointerButton",(function(){return Wl})),n.d(z,"AdjustZoomByWheel",(function(){return Il})),n.d(z,"SetDefaultFloor",(function(){return Rl})),n.d(z,"rotateCompassByDrag",(function(){return Ml}));var U={};n.r(U),n.d(U,"TRANSFORMER",(function(){return Bl})),n.d(U,"SELECTOR",(function(){return Vl})),n.d(U,"WALL_BUILDER",(function(){return zl})),n.d(U,"SPLITER",(function(){return Ul})),n.d(U,"CHAMBER",(function(){return Yl})),n.d(U,"VIEWPORT",(function(){return Gl})),n.d(U,"LABEL",(function(){return _l}));var Y={};n.r(Y),n.d(Y,"Symbol",(function(){return U})),n.d(Y,"Constructor",(function(){return Ql}));var G={};n.r(G),n.d(G,"Serializer",(function(){return Zl})),n.d(G,"Deserializer",(function(){return th}));var _={};n.r(_),n.d(_,"MovingByWASD",(function(){return rh}));var X={};n.r(X),n.d(X,"all",(function(){return oh}));var K={};n.r(K),n.d(K,"Surface",(function(){return X}));var q={};n.r(q),n.d(q,"Constructor",(function(){return sh}));var J={};n.r(J),n.d(J,"commonTransformerAdaptor",(function(){return vh})),n.d(J,"transformerRegister",(function(){return gh})),n.d(J,"selectorRegister",(function(){return bh}));var Q={};n.r(Q),n.d(Q,"SingleDoor",(function(){return kh})),n.d(Q,"DoubleDoor",(function(){return Th})),n.d(Q,"SlidingDoor",(function(){return Eh})),n.d(Q,"ParentDoor",(function(){return Sh})),n.d(Q,"Bealock",(function(){return Ch}));var Z={};n.r(Z),n.d(Z,"BasicWindow",(function(){return Ph})),n.d(Z,"BoilerWindow",(function(){return Lh})),n.d(Z,"FloorWindow",(function(){return Dh})),n.d(Z,"LWindow",(function(){return Ah})),n.d(Z,"UWindow",(function(){return Nh})),n.d(Z,"LBoilerWindow",(function(){return Fh})),n.d(Z,"UBoilerWindow",(function(){return Wh}));var tt={};n.r(tt),n.d(tt,"windoorMaterialList",(function(){return Ih})),n.d(tt,"windoorRegister",(function(){return Rh})),n.d(tt,"windoorListRegister",(function(){return Mh})),n.d(tt,"windoorRegisterDefault",(function(){return Hh})),n.d(tt,"getAllWindoorNameList",(function(){return Bh})),n.d(tt,"furnitureRegister",(function(){return Vh})),n.d(tt,"furnitureListRegister",(function(){return zh}));var et={};n.r(et),n.d(et,"Common",(function(){return J})),n.d(et,"Resource",(function(){return tt}));var nt={};n.r(nt),n.d(nt,"Utility",(function(){return z})),n.d(nt,"ToolGroup",(function(){return Y})),n.d(nt,"Persistence",(function(){return G})),n.d(nt,"Monitor",(function(){return eh})),n.d(nt,"Viewport",(function(){return _})),n.d(nt,"Dimension",(function(){return K})),n.d(nt,"Floor",(function(){return q})),n.d(nt,"Registry",(function(){return et}));n("e260"),n("e6cf"),n("cca6"),n("a79df"),n("1227");var rt=n("2b0e"),it=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("div",{ref:"drawing",staticClass:"drawing"}),n("panel")],1)},at=[],ot=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"panel"},[n("div",[n("input",{ref:"file_input",staticStyle:{width:"100%"},attrs:{type:"file",accept:"image/*"},on:{change:t.onFileChange}})]),n("div",[t._v(" 原始分辨率: "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.originScale,expression:"originScale"}],attrs:{type:"number"},domProps:{value:t.originScale},on:{input:function(e){e.target.composing||(t.originScale=e.target.value)}}}),n("span",[t._v("px/mm")])]),n("div",[t._v(" 当前分辨率: "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.imgScale,expression:"imgScale"}],attrs:{type:"number"},domProps:{value:t.imgScale},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.changeImgScale.apply(null,arguments)},input:function(e){e.target.composing||(t.imgScale=e.target.value)}}}),n("span",[t._v("px/mm")])]),n("div",[t._v(" 画布比例尺: "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.scale,expression:"scale"}],attrs:{type:"number"},domProps:{value:t.scale},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.changeScale.apply(null,arguments)},input:function(e){e.target.composing||(t.scale=e.target.value)}}}),n("span",[t._v("mm/px")])]),n("canvas",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"canvas"})])},st=[],ct=(n("a9e3"),n("d3b7"),n("159b"),n("ac84")),ut=n("2d58"),lt=n("2fe6"),ht=n("0bd7"),ft=(n("99af"),n("dca8"),n("caad"),n("2532"),n("07ac"),n("3338")),dt=Math,pt=dt.PI,vt=2*pt,yt=[0,0,1,0],gt=function(t,e,n,r){return yt[0]=t,yt[1]=e,yt[2]=n,yt[3]=r,yt},bt=[0,0],mt=function(t,e){return bt[0]=t,bt[1]=e,bt},$t=[0,0,0,0],Ot=function(t,e,n,r){return $t[0]=t,$t[1]=e,$t[2]=n,$t[3]=r,$t},xt=[0,0],wt=function(t,e){return xt[0]=t,xt[1]=e,xt},jt=function(t,e,n,r){return wt(t+n,e+r)},kt=function(t,e,n,r){return mt(n-t,r-e)},Tt=kt,Et=kt,St=function(t,e,n,r){return t*n+e*r},Ct=function(t,e,n){return mt(t*n,e*n)},Pt=function(t,e,n,r){return t*r-e*n},Lt=function(t,e){return ft["d"].sqrt(St(t,e,t,e))},Dt=function(t,e){return mt(-e,t)},At=function(t,e){var n=Lt(t,e);return 0===n&&ft["c"].throwError("Zero Vector CAN NOT be normalized."),mt(t/n,e/n)},Nt=function(t,e){return mt(-t,-e)},Ft=function(t,e,n){var r=ft["d"].cos(n),i=ft["d"].sin(n);return mt(t*r-e*i,t*i+e*r)},Wt=function(t,e,n,r){var i=At(n,r);return Ct.apply(void 0,Object(ht["a"])(i).concat([St.apply(void 0,[t,e].concat(Object(ht["a"])(i)))]))},It=1e-6,Rt=function(t){It=t},Mt=function(t){return t<It&&t>-It},Ht=function(t,e){var n=t-e;return n<It&&n>-It},Bt=function(t,e){return t-e>It},Vt=function(t,e){return t-e>-It},zt=function(t,e){return t-e<-It},Ut=function(t,e){return t-e<It},Yt=function(t,e,n,r){return Ht(t,n)&&Ht(e,r)},Gt=function(t,e,n,r,i,a){return Bt(Pt.apply(o,Object(ht["a"])(kt(n,r,i,a)).concat(Object(ht["a"])(kt(i,a,t,e)))),0)},_t=function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=kt(r,i,t,e);return jt.apply(void 0,Object(ht["a"])(Ft.apply(o,Object(ht["a"])(a).concat([n]))).concat([r,i]))},Xt=function(t,e,n,r,i,a){if(oe(t,e,n,r))return wt(t,e);var s=kt(t,e,n,r);return Mt(Pt.apply(o,Object(ht["a"])(s).concat([i,a])))?wt(n,r):jt.apply(void 0,[t,e].concat(Object(ht["a"])(Wt.apply(o,Object(ht["a"])(s).concat([i,a])))))},Kt=function(t,e,n,r){return Lt.apply(o,Object(ht["a"])(kt(t,e,n,r)))},qt=function(t,e){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return Kt.apply(void 0,[t,e].concat(Object(ht["a"])(Xt.apply(void 0,[t,e].concat(r)))))},Jt=function(t,e,n,r){var a=Tt(t,e,n,r),s=Dt.apply(o,Object(ht["a"])(At.apply(o,Object(ht["a"])(a)))),c=St.apply(o,Object(ht["a"])(s).concat([t,e])),u=zt(c,0)?s:Nt.apply(o,Object(ht["a"])(s));return gt.apply(i,[t,e].concat(Object(ht["a"])(u)))},Qt=[0,0,0],Zt=0,te=1,ee=2,ne=function(t,e,n,r){return Qt[Zt]=n,Qt[te]=r,Qt[ee]=St(n,r,t,e),Qt},re=n("26a3"),ie=function(t,e,n,r,i,a,o,s){var c=ne(t,e,n,r),u=Object(re["a"])(c,3),l=u[0],h=u[1],f=u[2],d=ne(i,a,o,s),p=Object(re["a"])(d,3),v=p[0],y=p[1],g=p[2],b=l*y-h*v,m=f*y-h*g,$=l*g-f*v;return Mt(b)?null:Mt(h)?wt(f/l,$/b):Mt(y)?wt(g/v,$/b):Mt(l)?wt(m/b,f/h):Mt(v)?wt(m/b,g/y):wt(m/b,$/b)},ae=function(t,e,n,r,i,a){return qt.apply(void 0,[t,e].concat(Object(ht["a"])(Jt(n,r,i,a))))},oe=function(t,e,n,r){return Ht(t,n)&&Ht(e,r)},se=function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=(n?1:-1)*(t-e);return r>=0?r:r+vt},ce=function(t,e,n,r,i,a){return(t-i)*(r-a)-(e-a)*(n-i)},ue=function(t,e,n,r,i,a,o,s){var c=ce(t,e,n,r,i,a),u=ce(t,e,n,r,o,s);if(Vt(c*u,0))return null;var l=ce(i,a,o,s,t,e),h=l+c-u;if(Vt(l*h,0))return null;var f=l/(u-c);return wt(t+f*(n-t),e+f*(r-e))},le=function(t,e,n,r,i,a){return Ot(t+i,e+a,n+i,r+a)},he=function(t,e,n,r){return wt((t+n)/2,(e+r)/2)},fe=function(t,e){for(var n=!1,r=t.length,i=0,a=r-1;i<r;a=i++){var o=t[i],s=t[a],c=o.y>e.y!==s.y>e.y&&e.x<(e.y-o.y)/(s.y-o.y)*(s.x-o.x)+o.x;c&&(n=!n)}return n},de=function(){for(var t=arguments.length/2,e=0,n=0;n<t;n++){var r=(n+1)%t;e+=Pt(2*n<0||arguments.length<=2*n?void 0:arguments[2*n],2*n+1<0||arguments.length<=2*n+1?void 0:arguments[2*n+1],2*r<0||arguments.length<=2*r?void 0:arguments[2*r],2*r+1<0||arguments.length<=2*r+1?void 0:arguments[2*r+1])}return e/2},pe=Object(ut["a"])((function t(e,n){Object(ct["a"])(this,t),this.x=e,this.y=n,this.incidentEdge=null})),ve=Object(ut["a"])((function t(){Object(ct["a"])(this,t),this.origin=null,this.twin=null,this.incidentFace=null,this.next=null,this.previous=null})),ye=Object(ut["a"])((function t(){Object(ct["a"])(this,t),this.outerComponent=null,this.innerComponents=[]})),ge=n("d198"),be=9999,me=Object(ge["a"])().mark($e);function $e(t){var e,n,r;return Object(ge["a"])().wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(e=t.incidentEdge,!ft["h"].Not.Null(e)){i.next=8;break}n=e,r=0;case 3:return i.next=5,n;case 5:n=n.twin.next,r++;case 7:if(n!==e&&r<be){i.next=3;break}case 8:case"end":return i.stop()}}),me)}var Oe=Object(ge["a"])().mark(xe);function xe(t){var e,n;return Object(ge["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:e=t,n=0;case 1:return r.next=3,e;case 3:e=e.next,n++;case 5:if(e!==t&&n<be){r.next=1;break}case 6:case"end":return r.stop()}}),Oe)}var we=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return new pe(t,e)},je=n("0402"),ke=function(t){var e,n=[],r=Object(je["a"])($e(t));try{for(r.s();!(e=r.n()).done;){var i=e.value;n.push(i)}}catch(a){r.e(a)}finally{r.f()}return n},Te=function(t){return ft["h"].isNull(t.incidentEdge)},Ee=function(t){return!Te(t)&&t.incidentEdge===t.incidentEdge.twin.next},Se=function(t){var e=t.origin,n=e.x,r=e.y,i=t.twin.origin,a=i.x,o=i.y;return Math.atan2(o-r,a-n)},Ce=function(t,e){var n,r=Object(je["a"])(xe(t));try{for(r.s();!(n=r.n()).done;){var i=n.value;if(i===e)return!0}}catch(a){r.e(a)}finally{r.f()}return!1},Pe=function(t,e){var n,r=Object(je["a"])(xe(t));try{for(r.s();!(n=r.n()).done;){var i=n.value;if(i.origin===e)return!0}}catch(a){r.e(a)}finally{r.f()}return!1},Le=function(t){return Ce(t,t.twin)},De=function(t){var e,n=[],r=Object(je["a"])(xe(t));try{for(r.s();!(e=r.n()).done;){var i=e.value;n.push(i)}}catch(a){r.e(a)}finally{r.f()}return n},Ae=(n("aff5"),function(t){var e,n,r=null,i=-1/0;e=n=Number.MAX_SAFE_INTEGER;var a,o=Object(je["a"])(xe(t));try{for(o.s();!(a=o.n()).done;){var s=a.value,c=s.origin,u=c.x,l=c.y,h=s.next.origin,f=h.x,d=h.y,p=(d-l)/(f-u);(u<e||u===e&&l<n||u===e&&l===n&&p>i)&&(e=u,n=l,i=p,r=s)}}catch(v){o.e(v)}finally{o.f()}return r}),Ne=function(t){var e=Ae(t),n=e.previous.twin;return n!==e&&se(Se(n),Se(e))<Math.PI},Fe=function(t){return!Ne(t)},We=function(t,e){var n=t,r=n.twin,i=new ve,a=new ve;e.incidentEdge=i,i.origin=a.origin=e,i.incidentFace=n.incidentFace,a.incidentFace=r.incidentFace,i.twin=r,r.twin=i,a.twin=n,n.twin=a;var o=n.next,s=r.next;return i.next=o,n.next=i,i.previous=n,o.previous=i,a.next=s,r.next=a,a.previous=r,s.previous=a,i},Ie=(n("d81d"),function(t){return t.origin}),Re=function(t){var e=t.outerComponent;return ft["h"].isNull(e)?[]:De(e).map(Ie)},Me=(n("a434"),function(t,e,n){var r=t.twin.incidentFace;e.includes(r)||(e.push(r),n.push(r))}),He=function(t){var e,n=[t],r=[],i=Object(je["a"])(t.innerComponents);try{for(i.s();!(e=i.n()).done;){var a,o=e.value,s=Object(je["a"])(xe(o));try{for(s.s();!(a=s.n()).done;){var c=a.value;Me(c,n,r)}}catch(v){s.e(v)}finally{s.f()}while(r.length){var u,l=Object(je["a"])(r.splice(0));try{for(l.s();!(u=l.n()).done;){var h,f=u.value,d=Object(je["a"])(xe(f.outerComponent));try{for(d.s();!(h=d.n()).done;){var p=h.value;Me(p,n,r)}}catch(v){d.e(v)}finally{d.f()}}}catch(v){l.e(v)}finally{l.f()}}}}catch(v){i.e(v)}finally{i.f()}return n.shift(),n},Be=function t(e,n){var r=!!ft["h"].isNull(e.outerComponent)||fe(Re(e),n);if(r){var i,a=Object(je["a"])(He(e));try{for(a.s();!(i=a.n()).done;){var o=i.value,s=t(o,n);if(ft["h"].Not.Null(s))return s}}catch(c){a.e(c)}finally{a.f()}return e}return null},Ve=function(){return new ye},ze=function(t){ft["h"].Not.String(t)&&ft["c"].Throw.TypeError("Invalid event `type`, a string expected.")},Ue=function(t){ft["h"].Not.Function(t)&&ft["c"].Throw.TypeError("In valid event `listener`, a function expected.")},Ye=function(t,e){ft["h"].Not.Number(t)&&ft["c"].Throw.TypeError("Invalid `".concat(e,"`, a number excepted."))},Ge=function(t,e){Ye(t),Ye(e)},_e=(n("3ca3"),n("10d1"),n("ddb0"),new WeakMap),Xe=function(t){return _e.get(t)},Ke=function(){function t(e){Object(ct["a"])(this,t),_e.set(this,e)}return Object(ut["a"])(t,[{key:"on",value:function(t,e){return ze(t),Ue(e),Xe(this).$on(t,e),this}},{key:"off",value:function(t,e){return ze(t),Ue(e),Xe(this).$off(t,e),this}}]),t}(),qe=n("a007"),Je=n("e3fc"),Qe=function(t){Object(qe["a"])(n,t);var e=Object(Je["a"])(n);function n(t){return Object(ct["a"])(this,n),e.call(this,t)}return Object(ut["a"])(n,[{key:"$bounds",get:function(){return Xe(this).$getBounds()}},{key:"destroyed",get:function(){return Xe(this).$destroyed}}]),n}(Ke),Ze=function(t){Object(qe["a"])(n,t);var e=Object(Je["a"])(n);function n(){return Object(ct["a"])(this,n),e.apply(this,arguments)}return Object(ut["a"])(n,[{key:"options",get:function(){return Xe(this).$options}},{key:"setOptions",value:function(){}}]),n}(Ke),tn=function(t){Object(qe["a"])(n,t);var e=Object(Je["a"])(n);function n(){return Object(ct["a"])(this,n),e.apply(this,arguments)}return Object(ut["a"])(n,[{key:"$reset",value:function(){Xe(this).$reset()}},{key:"$state",get:function(){return Xe(this).$state}}]),n}(Ke),en=function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=function(t){Object(qe["a"])(n,t);var e=Object(Je["a"])(n);function n(){return Object(ct["a"])(this,n),e.apply(this,arguments)}return Object(ut["a"])(n)}(tn),r=Object(je["a"])(e);try{var i=function(){var e=t.value;n.prototype[e]=function(){return Xe(this)[e](),this}};for(r.s();!(t=r.n()).done;)i()}catch(a){r.e(a)}finally{r.f()}return n},nn=function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return function(){var n=new t(this);return e?Object.freeze(n):n}},rn=n("a34f");function an(){this.forceUpdateAll()}var on=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return rn["a"](t,e,an)},sn=n("c20e"),cn=(n("4ec9"),n("4743")),un=n("dcb4"),ln=(n("b0c0"),n("4e82"),n("3a02")),hn=n("493b"),fn=(n("6062"),n("af93"),g.define()),dn=g.define({capture:!0,autoResizing:!0},{snap:g.define({enable:!0,interval:20}),scale:g.define({max:100,min:1}),style:g.define({backgroundColor:{value:15790320,set:function(t){this.application.renderer.backgroundColor=t}},backgroundOpacity:{value:1,set:function(t){this.application.renderer.backgroundAlpha=t}},fontSize:12}),plugin:fn}),pn=function(t,e){var n=function(n){Object.defineProperty(t,n,{get:function(){return e[n].call(this)}})};for(var r in e)n(r)},vn=function(t,e){var n=function(n){var r=e[n];t[n]=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return r.call.apply(r,[this].concat(e))}};for(var r in e)n(r)},yn=new WeakMap,gn=function(t){return yn.get(t)},bn=function(t){Object(qe["a"])(n,t);var e=Object(Je["a"])(n);function n(t){var r;return Object(ct["a"])(this,n),r=e.call(this),r.context=null,r.drawing=t,r.elementCollectionMap={},r}return Object(ut["a"])(n,[{key:"forceUpdate",value:function(){for(var t in this.elementCollectionMap){var e,n=Object(je["a"])(this.elementCollectionMap[t]);try{for(n.s();!(e=n.n()).done;){var r=e.value;r.setDirty()}}catch(i){n.e(i)}finally{n.f()}}}}]),n}(un["a"].Emitter),mn=bn,$n=(n("a630"),function(t){ft["h"].Not.String(t)&&ft["c"].Throw.TypeError("Invalid `className`, a string excepted.")}),On=function(){function t(e,n){Object(ct["a"])(this,t),this.$id=e,this.$version=n,this.$proxy=this,this.$data=ft["f"].freeze({})}return Object(ut["a"])(t,[{key:"$drawing",get:function(){return gn(this).drawing.proxy}},{key:"$elements",value:Object(ge["a"])().mark((function t(e){var n,r,i,a;return Object(ge["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:$n(e),n=gn(this).elementCollectionMap[e],ft["h"].isUndefined(n)&&ft["c"].throwError("The Element named `".concat(e,"` is NOT existed in this Plugin.")),r=Object(je["a"])(n.values()),t.prev=4,r.s();case 6:if((i=r.n()).done){t.next=12;break}return a=i.value,t.next=10,a.context;case 10:t.next=6;break;case 12:t.next=17;break;case 14:t.prev=14,t.t0=t["catch"](4),r.e(t.t0);case 17:return t.prev=17,r.f(),t.finish(17);case 20:case"end":return t.stop()}}),t,this,[[4,14,17,20]])}))},{key:"$getElementList",value:function(t){return Array.from(this.$elements(t))}},{key:"$hideElement",value:function(t){var e,n=Object(je["a"])(this.$elements(t));try{for(n.s();!(e=n.n()).done;){var r=e.value;r.hide()}}catch(i){n.e(i)}finally{n.f()}}},{key:"$showElement",value:function(t){var e,n=Object(je["a"])(this.$elements(t));try{for(n.s();!(e=n.n()).done;){var r=e.value;r.show()}}catch(i){n.e(i)}finally{n.f()}}},{key:"$hideAll",value:function(){for(var t in gn(this).elementCollectionMap)this.$hideElement(t)}},{key:"$showAll",value:function(){for(var t in gn(this).elementCollectionMap)this.$showElement(t)}},{key:"$forceUpdate",value:function(){gn(this).forceUpdate()}},{key:"$toCanvas",value:function(t,e){return v.Point(t,e),gn(this).drawing.coordinate.toCanvas(t,e)}},{key:"$toGeometry",value:function(t,e){return v.Point(t,e),gn(this).drawing.coordinate.toGeometry(t,e)}},{key:"$on",value:function(t,e){return v.EventType(t),v.EventListener(e),gn(this).on(t,e),this}},{key:"$off",value:function(t,e){return v.EventType(t),v.EventListener(e),gn(this).off(t,e),this}},{key:"$emit",value:function(t){var e;v.EventType(t);for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return(e=gn(this)).emit.apply(e,[t].concat(r)),this}}]),t}(),xn=function(t,e,n,r,i){fn.appendChild(t,n.options);var a=function(t){Object(qe["a"])(n,t);var e=Object(Je["a"])(n);function n(t){var i;for(var a in Object(ct["a"])(this,n),i=e.call(this,t),r)i.elementCollectionMap[a]=new Set;return yn.set(i.context=new o,Object(sn["a"])(i)),i}return Object(ut["a"])(n)}(mn),o=function(a){Object(qe["a"])(s,a);var o=Object(Je["a"])(s);function s(){var r;return Object(ct["a"])(this,s),r=o.call(this,t,e),r.$proxy=n.proxy.call(Object(sn["a"])(r)),r.$data=ft["f"].seal(n.data()),ft["f"].freeze(Object(sn["a"])(r)),r}return Object(ut["a"])(s,[{key:"$options",get:function(){return this.$drawing.options.plugin[t]}},{key:"$createElement",value:function(t){$n(t);var e=r[t].Element;ft["h"].isUndefined(e)&&ft["c"].throwError("The Element named `".concat(t,"` is NOT existed."));for(var n=arguments.length,i=new Array(n>1?n-1:0),a=1;a<n;a++)i[a-1]=arguments[a];var o=Object(hn["a"])(e,[gn(this)].concat(i)).context;return this.$emit("element-created",o.$proxy,t),o}},{key:"$createTool",value:function(t){var e=i[t];ft["h"].isUndefined(e)&&ft["c"].throwError("The Element named `".concat(t,"` is NOT existed."));var n=new e(this),r=n.context;return r.$proxy}}]),s}(On);return vn(o.prototype,n.methods),pn(o.prototype,n.getters),a},wn=n("e5cd"),jn=n("0384"),kn=new Set,Tn=new ln["Container"],En=new WeakMap,Sn=function(t){return En.get(t)},Cn=function(t){Object(qe["a"])(n,t);var e=Object(Je["a"])(n);function n(t){var r;return Object(ct["a"])(this,n),r=e.call(this),r.plugin=t,r.context=null,r.graphics=null,r.isDirty=!1,r._update=ft["e"],r.destroyed=!1,r.collection.add(Object(sn["a"])(r)),r}return Object(ut["a"])(n,[{key:"renderable",get:function(){return!1}},{key:"interactive",get:function(){return!1}},{key:"hoverable",get:function(){return!1}},{key:"focusable",get:function(){return!1}},{key:"selectable",get:function(){return!1}},{key:"draggable",get:function(){return!1}},{key:"drawing",get:function(){return this.plugin.drawing}},{key:"selecting",get:function(){return this.drawing.state.selecting===this}},{key:"hovering",get:function(){return this.drawing.state.hovering===this}},{key:"holding",get:function(){return this.drawing.state.holding===this}},{key:"focusing",get:function(){return this.drawing.state.focusing===this}},{key:"hover",value:function(){ft["h"].isNull(this.drawing.state.holding)&&(this.drawing.setHovering(this),this.setDirty())}},{key:"cancelHover",value:function(){this.drawing.setHovering(),this.setDirty()}},{key:"focus",value:function(){var t=this.drawing.state.focusing;t!==this&&(this.drawing.setFocusing(this),Pn(this,"focus"),this.setDirty())}},{key:"emitBlur",value:function(){Pn(this,"blur"),this.setDirty()}},{key:"hold",value:function(){this.drawing.setHolding(this),this.setDirty()}},{key:"release",value:function(){this.drawing.setHolding(),this.setDirty()}},{key:"group",get:function(){return Tn}},{key:"application",get:function(){return this.drawing.application}},{key:"collection",get:function(){return kn}},{key:"show",value:function(){this.graphics.visible=!0,this.setDirty()}},{key:"hide",value:function(){this.graphics.visible=!1,this.setDirty()}},{key:"setDirty",value:function(){this.destroyed||this.isDirty||(this.drawing.observer.setDirty(),this.isDirty=!0,Pn(this,"dirty"))}},{key:"getBounds",value:function(){return this.graphics.getBounds()}},{key:"update",value:function(){this.isDirty&&(this.isDirty=!1,this.graphics.clear(),this.graphics.visible&&(this._update(this.graphics),Pn(this,"render")))}},{key:"destroy",value:function(){ft["h"].Not.Null(this.graphics)&&(this.hovering&&this.drawing.setHovering(),this.focusing&&this.drawing.setFocusing(),this.holding&&this.drawing.setHolding(),this.graphics.destroy(),this.drawing.observer.cancel(this.observer)),this.collection.delete(this),this.destroyed=!0,Pn(this,"destroy"),un["a"].destroy(this),this.drawing.emit("element-destroy",this.context.$proxy)}}]),n}(un["a"].Emitter),Pn=function(t,e){t.emit(e,t.context.$proxy)},Ln=Cn,Dn=ft["f"].freeze({}),An=function(){function t(){Object(ct["a"])(this,t),this.$proxy=this,this.$state=Dn}return Object(ut["a"])(t,[{key:"$graphics",get:function(){return Sn(this).graphics}},{key:"$data",get:function(){return Sn(this).plugin.context.$data}},{key:"$drawing",get:function(){return Sn(this).drawing.proxy}},{key:"$selecting",get:function(){return Sn(this).selecting}},{key:"$focusing",get:function(){return Sn(this).focusing}},{key:"$hovering",get:function(){return Sn(this).hovering}},{key:"$holding",get:function(){return Sn(this).holding}},{key:"$visible",get:function(){return Sn(this).graphics.visible}},{key:"$isDirty",get:function(){return Sn(this).isDirty}},{key:"$destroyed",get:function(){return Sn(this).destroyed}},{key:"$getBounds",value:function(){return Sn(this).getBounds()}},{key:"$show",value:function(){Sn(this).show()}},{key:"$hide",value:function(){Sn(this).hide()}},{key:"$setDirty",value:function(){Sn(this).setDirty()}},{key:"$destroy",value:function(){Sn(this).destroy()}},{key:"$on",value:function(t,e){return v.EventType(t),v.EventListener(e),Sn(this).on(t,e),this}},{key:"$off",value:function(t,e){return v.EventType(t),v.EventListener(e),Sn(this).off(t,e),this}},{key:"$emit",value:function(t){for(var e,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return(e=Sn(this)).emit.apply(e,[t].concat(r)),this}},{key:"$focus",value:function(){var t=Sn(this);t.focusable&&t.focus()}},{key:"$toCanvas",value:function(t,e){return v.Point(t,e),Sn(this).drawing.coordinate.toCanvas(t,e)}},{key:"$toGeometry",value:function(t,e){return v.Point(t,e),Sn(this).drawing.coordinate.toGeometry(t,e)}}]),t}(),Nn=An,Fn=["pointermove","pointerdown","pointerup","pointerover","pointerout"],Wn=function(t,e){t.emit(e,t.drawing.globalEvent.accessor)},In=function(t,e){var n=ft["h"].Not.Null(e.render),r=function(r){Object(qe["a"])(o,r);var a=Object(Je["a"])(o);function o(r){var s,c;Object(ct["a"])(this,o),c=a.call(this,r);var u=new i;if(n){var l=new ln["Graphics"];c.observer=function(){return c.update()},c.drawing.observer.add(c.observer),c.group.addChild(l),c.graphics=l,c.graphics.name=t,c.graphics.interactive=e.interative,e.interative&&(Fn.forEach((function(t){l.on("".concat(t),(function(t){c.drawing.globalEvent.current=t}))})),l.on("pointermove",(function(){return Wn(Object(sn["a"])(c),"pointermove")})).on("pointerover",(function(){return Wn(Object(sn["a"])(c),"pointerover")})).on("pointerout",(function(){return Wn(Object(sn["a"])(c),"pointerout")})).on("pointerdown",(function(){return Wn(Object(sn["a"])(c),"pointerdown")})).on("pointerup",(function(){return Wn(Object(sn["a"])(c),"pointerup")})),e.hoverable&&l.on("pointerover",(function(){return c.hover()})).on("pointerout",(function(){return c.cancelHover()})),e.draggable&&l.on("pointerdown",(function(){return c.hold()})).on("pointerup",(function(){return c.release()})),e.focusable&&l.on("pointerdown",(function(){return c.focus()}))),c._update=e.render.bind(u)}c.context=u,En.set(u,Object(sn["a"])(c));for(var h=arguments.length,f=new Array(h>1?h-1:0),d=1;d<h;d++)f[d-1]=arguments[d];return(s=e.created).call.apply(s,[u].concat(f)),c.setDirty(),c.drawing.emit("element-create",c.context.$proxy),c}return Object(ut["a"])(o,[{key:"renderable",get:function(){return n}},{key:"interactive",get:function(){return this.renderable&&e.interative}},{key:"hoverable",get:function(){return this.interactive&&e.hoverable}},{key:"focusable",get:function(){return this.interactive&&e.focusable}},{key:"selectable",get:function(){return this.interactive&&e.selectable}},{key:"draggable",get:function(){return this.interactive&&e.draggable}},{key:"group",get:function(){return this.plugin.drawing.groupMap.get(o)}},{key:"collection",get:function(){return this.plugin.elementCollectionMap[t]}}]),o}(Ln),i=function(n){Object(qe["a"])(i,n);var r=Object(Je["a"])(i);function i(){var t;return Object(ct["a"])(this,i),t=r.call(this),t.$proxy=e.proxy.call(Object(sn["a"])(t)),t.$state=ft["f"].seal(e.state.call(Object(sn["a"])(t))),ft["f"].freeze(Object(sn["a"])(t)),t}return Object(ut["a"])(i,[{key:"$name",get:function(){return t}},{key:"$data",get:function(){return this.$plugin.$data}},{key:"$plugin",get:function(){return Sn(this).plugin.context}},{key:"$destroy",value:function(){Object(wn["a"])(Object(jn["a"])(i.prototype),"$destroy",this).call(this),e.destroy.call(this)}}]),i}(Nn);return pn(i.prototype,e.getters),vn(i.prototype,e.methods),r},Rn=(n("a4d3"),n("e01a"),new WeakMap),Mn=function(t){return Rn.get(t)},Hn=Symbol("TOOL_READY"),Bn=function(t){Object(qe["a"])(n,t);var e=Object(Je["a"])(n);function n(){var t;return Object(ct["a"])(this,n),t=e.call(this),t.plugin=null,t.context=null,t.busy=!1,t.state=Hn,t.eventQueue=[],t}return Object(ut["a"])(n,[{key:"reset",value:function(){this.context.$reset(),this.emit("reset"),this.setIdle(Hn)}},{key:"setBusy",value:function(){this.busy=!0}},{key:"setIdle",value:function(t){this.busy=!1,this.state=t;var e=this.eventQueue;while(e.length){var r;(r=Object(wn["a"])(Object(jn["a"])(n.prototype),"emit",this)).call.apply(r,[this].concat(Object(ht["a"])(e.pop())))}}},{key:"emit",value:function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];var i;this.busy?this.eventQueue.push(e):(i=Object(wn["a"])(Object(jn["a"])(n.prototype),"emit",this)).call.apply(i,[this].concat(e));return this}}]),n}(un["a"].Emitter),Vn=Bn,zn=function(){function t(){Object(ct["a"])(this,t)}return Object(ut["a"])(t,[{key:"$state",get:function(){return Mn(this).state}},{key:"$plugin",get:function(){return Mn(this).plugin}},{key:"$on",value:function(t,e){return v.EventType(t),v.EventListener(e),Mn(this).on(t,e),this}},{key:"$off",value:function(t,e){return v.EventType(t),v.EventListener(e),Mn(this).off(t,e),this}},{key:"$emit",value:function(t){for(var e,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return(e=Mn(this)).emit.apply(e,[t].concat(r)),this}}]),t}(),Un=function(t,e){var n=e.data,r=e.actions,i=e.states,a=function(t){Object(qe["a"])(n,t);var e=Object(Je["a"])(n);function n(t){var r;return Object(ct["a"])(this,n),r=e.call(this,t),r.plugin=t,r.context=new o(Object(sn["a"])(r)),t.$drawing.appendTool(Object(sn["a"])(r)),r}return Object(ut["a"])(n)}(Vn),o=function(r){Object(qe["a"])(a,r);var i=Object(Je["a"])(a);function a(t){var r;return Object(ct["a"])(this,a),r=i.call(this),Rn.set(Object(sn["a"])(r),t),r.$proxy=e.proxy.call(Object(sn["a"])(r)),r.$data=ft["f"].seal(n.call(Object(sn["a"])(r),t.plugin)),ft["f"].freeze(Object(sn["a"])(r)),r}return Object(ut["a"])(a,[{key:"$name",get:function(){return t}},{key:"$reset",value:function(){e.reset.call(this),Mn(this).state=Hn}}]),a}(zn),s=function(t){var e,n=r[t],a={},s=Object(je["a"])(n);try{for(s.s();!(e=s.n()).done;){var c=Object(re["a"])(e.value,3),u=c[0],l=c[1],h=c[2];a[u]={handler:l,target:h,source:u}}}catch(f){s.e(f)}finally{s.f()}o.prototype[t]=function(){var e=Mn(this);e.busy&&ft["c"].throwError("It could NOT call an action during another action.");var n=a[this.$state];ft["h"].isUndefined(n)&&ft["c"].throwError(".".concat(t," can NOT be called from state(=").concat(String(this.$state),")."));var r=n.handler,o=n.target,s=n.source;return i[s].leave.call(this),e.setBusy(),r.call(this),i[o].entry.call(this),e.setIdle(o),this}};for(var c in r)s(c);var u=function(t){var n=e.methods[t];o.prototype[t]=function(){for(var t=this.$state,e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];var a=n.call.apply(n,[this].concat(r));return this.$state!==t&&ft["c"].throwError("A normal method could NOT be used to transit state."),a}};for(var l in e.methods)u(l);return a},Yn=function(){return{}},Gn=function(t){var e={data:Yn,created:ft["e"],methods:{},getters:{},proxy:function(){return this},options:g.define()},n=t.data,r=void 0===n?e.data:n,i=t.created,a=void 0===i?e.created:i,o=t.methods,s=void 0===o?e.methods:o,c=t.getters,u=void 0===c?e.getters:c,l=t.proxy,h=void 0===l?e.proxy:l,f=t.options,d=void 0===f?e.options:f;for(var p in ft["h"].Not.Function(r)&&ft["c"].Throw.TypeError("Invalid `.data`, a function as constructor expected."),ft["h"].Not.Function(a)&&ft["c"].Throw.TypeError("Invalid `.created`, a function expected."),ft["h"].Not.Object(s)&&ft["c"].Throw.TypeError("Invalid `.methods`, an object expected."),s)ft["h"].Not.Function(s[p])&&ft["c"].Throw.TypeError("Invalid `.methods.".concat(p,"`, a function expected."));for(var v in ft["h"].Not.Object(u)&&ft["c"].Throw.TypeError("Invalid `.getters`, an object expected."),u)ft["h"].Not.Function(u[v])&&ft["c"].Throw.TypeError("Invalid `.getters.".concat(v,"`, a function expected."));return ft["h"].Not.Function(h)&&ft["c"].Throw.TypeError("Invalid `.proxy`, a function as constructor expected."),e.data=r,e.created=a,e.methods=s,e.getters=u,e.proxy=h,e.options=d,e},_n=function(){return{}},Xn=function(t){var e={groupIndex:0,interative:!1,hoverable:!1,focusable:!1,selectable:!1,draggable:!1,state:_n,render:null,created:ft["e"],destroy:ft["e"],methods:{},getters:{},proxy:function(){return this}},n=t.groupIndex,r=void 0===n?e.groupIndex:n,i=t.interative,a=void 0===i?e.interative:i,o=t.hoverable,s=void 0===o?e.hoverable:o,c=t.focusable,u=void 0===c?e.focusable:c,l=t.selectable,h=void 0===l?e.selectable:l,f=t.draggable,d=void 0===f?e.draggable:f,p=t.state,v=void 0===p?e.state:p,y=t.render,g=void 0===y?e.render:y,b=t.created,m=void 0===b?e.created:b,$=t.destroy,O=void 0===$?e.destroy:$,x=t.methods,w=void 0===x?e.methods:x,j=t.getters,k=void 0===j?e.getters:j,T=t.proxy,E=void 0===T?e.proxy:T;for(var S in ft["h"].Not.Number(r)&&ft["c"].Throw.TypeError("Invalid `.elements[].groupIndex`, a number expected."),ft["h"].Not.Boolean(a)&&ft["c"].Throw.TypeError("Invalid `.elements[].interative`, a boolean expected."),ft["h"].Not.Boolean(s)&&ft["c"].Throw.TypeError("Invalid `.elements[].hoverable`, a boolean expected."),ft["h"].Not.Boolean(u)&&ft["c"].Throw.TypeError("Invalid `.elements[].focusable`, a boolean expected."),ft["h"].Not.Boolean(h)&&ft["c"].Throw.TypeError("Invalid `.elements[].selectable`, a boolean expected."),ft["h"].Not.Boolean(d)&&ft["c"].Throw.TypeError("Invalid `.elements[].draggable`, a boolean expected."),ft["h"].Not.Function(v)&&ft["c"].Throw.TypeError("Invalid `.elements[].state`, a function expected."),ft["h"].Not.Function(g)&&ft["h"].Not.Null(g)&&ft["c"].Throw.TypeError("Invalid `.elements[].render`, a function or null expected."),ft["h"].Not.Function(m)&&ft["c"].Throw.TypeError("Invalid `.elements[].created`, a function expected."),ft["h"].Not.Function(O)&&ft["c"].Throw.TypeError("Invalid `.elements[].destroy`, a function expected."),ft["h"].Not.Object(w)&&ft["c"].Throw.TypeError("Invalid `.elements[].methods`, an object as function map expected"),w)ft["h"].Not.Function(w[S])&&ft["c"].Throw.TypeError("Invalid `.elements[].methods.".concat(S,"`, a function expected."));for(var C in ft["h"].Not.Object(k)&&ft["c"].Throw.TypeError("Invalid `.elements[].getters`, an object as function map expected"),k)ft["h"].Not.Function(k[C])&&ft["c"].Throw.TypeError("Invalid `.elements[].getters.".concat(C,"`, a function expected."));return ft["h"].Not.Function(E)&&ft["c"].Throw.TypeError("Invalid `.proxy`, a function as constructor expected."),e.groupIndex=r,e.interative=a,e.hoverable=s,e.focusable=u,e.selectable=h,e.draggable=d,e.state=v,e.render=g,e.created=m,e.destroy=O,e.methods=w,e.getters=k,e.proxy=E,e},Kn=(n("1bf2"),function(){return{}}),qn=[0,function(){return ft["c"].throwError("Not implemented.")},0],Jn=function(t){ft["h"].isArray(t)&&3===t.length&&ft["h"].isFunction(t[1])||ft["c"].Throw.TypeError("Invalid transition, a [source, function, target] expected.")},Qn=function(t){if(ft["h"].Not.Array(t)&&ft["c"].Throw.TypeError("Invalid action transition, an array expected."),0===t.length)return[qn];if(ft["h"].Not.Array(t[0]))return Jn(t),[t];var e,n=[],r=Object(je["a"])(t);try{for(r.s();!(e=r.n()).done;){var i=e.value;Jn(i),n.push(i)}}catch(a){r.e(a)}finally{r.f()}return n},Zn=function(t){var e={};for(var n in ft["h"].Not.Object(t)&&ft["c"].Throw.TypeError("Invalid tool actions, a plain object expected."),t)e[n]=Qn(t[n]);return e},tr=Object.freeze({entry:ft["e"],leave:ft["e"]}),er=function(t){var e={entry:ft["e"],leave:ft["e"]},n=t.entry,r=void 0===n?e.entry:n,i=t.leave,a=void 0===i?e.leave:i;return ft["h"].Not.Function(r)&&ft["c"].Throw.TypeError("Invalid operation.entry, a function expected."),ft["h"].Not.Function(a)&&ft["c"].Throw.TypeError("Invalid operation.leave, a function expected."),e.entry=r,e.leave=a,e},nr=function(t,e){var n={};for(var r in e){var i=e[r];if(ft["h"].isArray(i[0])){var a,o=Object(je["a"])(i);try{for(o.s();!(a=o.n()).done;){var s=a.value;n[s[0]]=n[s[2]]=tr}}catch(f){o.e(f)}finally{o.f()}}else n[i[0]]=n[i[2]]=tr}var c,u=Object(je["a"])(ft["g"].ownKeys(t));try{for(u.s();!(c=u.n()).done;){var l=c.value,h=t[l];if(ft["h"].isUndefined(h))return;ft["h"].isObject(h)?n[l]=er(h):ft["h"].isFunction(h)?n[l]=er({entry:h}):ft["c"].Throw.TypeError("Invalid state operation, a function or expected.")}}catch(f){u.e(f)}finally{u.f()}return n},rr=function(t){var e={states:{},actions:{},data:Kn,reset:ft["e"],methods:{},proxy:function(){return this}},n=t.states,r=void 0===n?e.states:n,i=t.actions,a=void 0===i?e.actions:i,o=t.data,s=void 0===o?e.data:o,c=t.reset,u=void 0===c?e.reset:c,l=t.methods,h=void 0===l?e.methods:l,f=t.proxy,d=void 0===f?e.proxy:f;for(var p in ft["h"].Not.Function(s)&&ft["c"].Throw.TypeError("Invalid `.tools[].data`, a function expected."),ft["h"].Not.Function(u)&&ft["c"].Throw.TypeError("Invalid `.tools[].reset`, a function expected."),ft["h"].Not.Function(d)&&ft["c"].Throw.TypeError("Invalid `.tools[].proxy`, a function expected."),h)ft["h"].Not.Function(h[p])&&ft["c"].Throw.TypeError("Invalid `.tools[].methods.".concat(p,"`, a function expected."));return e.actions=Zn(a),e.states=nr(r,a),e.data=s,e.reset=u,e.methods=h,e.proxy=d,e},ir=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e={namespace:null,version:null,dependencies:[],plugin:{},elements:{},tools:{}},n=t.id,r=t.version,i=t.namespace,a=void 0===i?e.namespace:i,o=t.dependencies,s=void 0===o?e.dependencies:o,c=t.plugin,u=void 0===c?e.plugin:c,l=t.elements,h=void 0===l?e.elements:l,f=t.tools,d=void 0===f?e.tools:f;if(ft["h"].Not.String(n)&&ft["c"].Throw.TypeError("Invalid `.id`, a string expected."),ft["h"].Not.String(r)&&ft["c"].Throw.TypeError("Invalid `.version`, string expected."),ft["h"].Not.String(a)&&ft["h"].Not.Null(a)&&ft["c"].Throw.TypeError("Invalid `.namespace`, a string or null expected."),ft["h"].Not.Array(s))ft["c"].Throw.TypeError("Invalid `.dependencies`, an array expected.");else{var p,v=Object(je["a"])(s);try{for(v.s();!(p=v.n()).done;){var y=Object(re["a"])(p.value,2),g=y[0],b=y[1];ft["h"].Not.String(g)&&ft["c"].Throw.TypeError("Invalid `.dependencies[".concat(b,"]`, a string expected."))}}catch(O){v.e(O)}finally{v.f()}}for(var m in ft["h"].Not.Object(h)&&ft["c"].Throw.TypeError("Invalid `.elements`, an object as map expected."),e.id=n,e.version=r,e.namespace=a,e.dependencies=s,e.plugin=Gn(u),h)e.elements[m]=Xn(h[m]);for(var $ in d)e.tools[$]=rr(d[$]);return e},ar=new Map,or=[],sr=function(t){var e=ir(t),n=e.id,r=e.namespace,i=e.version,a=e.plugin,o=e.elements,s=e.tools;or.some((function(t){return t.id===n}))&&ft["c"].throwError("A Plugin id=".concat(n," is used."));var c={},u={};for(var l in o)c[l]={index:o[l].groupIndex,Element:In(l,o[l])};for(var h in s)u[h]=Un(h,s[h]);var f=xn(n,i,a,c,u);ar.set(f,a.created),or.push({id:n,namespace:r,Plugin:f,Elements:Object.freeze(c)})},cr=function(t){var e,n=[],r=Object(je["a"])(or);try{for(r.s();!(e=r.n()).done;){var i=e.value,a=i.id,o=i.namespace,s=i.Plugin,c=i.Elements,u=new s(t),l=t.Plugin.Proxy[a]=u.context.$proxy;for(var h in t.Plugin.Context[a]=u.context,ft["h"].isString(o)&&(ft["h"].isUndefined(t.proxy[o])?t.proxy[o]=l:ft["b"].warn('Registering namespace "'.concat(o,'" is duplicated.'))),c){var f=new ln["Container"],d=c[h];f.name="".concat(h,"-group"),t.groupMap.set(d.Element,f),n.push({container:f,index:d.index})}n.sort((function(t,e){return t.index-e.index}));var p,v=Object(je["a"])(n);try{for(v.s();!(p=v.n()).done;){var y=p.value;t.application.stage.addChild(y.container)}}catch(g){v.e(g)}finally{v.f()}ar.get(s).call(u.context)}}catch(g){r.e(g)}finally{r.f()}Object.freeze(t.Plugin.Proxy)},ur={button:0,buttons:0,ctrlKey:!1,shiftKey:!1,altKey:!1,metaKey:!1},lr=function(t){return ft["h"].isNull(t)?null:t.context.$proxy};function hr(t,e){var n=null,r=ft["f"].freeze({get drawing(){return t.proxy},get button(){return ur.button},get buttons(){return ur.buttons},get ctrlKey(){return ur.ctrlKey},get shiftKey(){return ur.shiftKey},get altKey(){return ur.altKey},get metaKey(){return ur.metaKey},get pointerX(){return e.pointer.x},get pointerY(){return e.pointer.y},get virtualX(){return e.virtual.x},get virtualY(){return e.virtual.y},get hovering(){return lr(e.hovering)},get focusing(){return lr(e.focusing)},get selecting(){return lr(e.selecting)},get holding(){return lr(e.holding)},stopPropagation:function(){n.stopPropagation()},preventDefault:function(){n.data.originalEvent.preventDefault()}});return{get current(){return n},set current(t){n=t},accessor:r}}["mousedown","mouseup","pointerdown","pointerup"].forEach((function(t){cn["a"].DOCUMENT.addEventListener(t,(function(t){ur.button=t.button,ur.buttons=t.buttons}),{capture:!0})})),["keydown","keyup"].forEach((function(t){cn["a"].addEventListener(cn["c"].WINDOW,t,(function(t){ur.ctrlKey=t.ctrlKey,ur.shiftKey=t.shiftKey,ur.altKey=t.altKey,ur.metaKey=t.metaKey}))}));var fr=25,dr=100,pr=100,vr=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:dr,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:pr;Object(ct["a"])(this,t),this.scale=fr,this.originX=e,this.originY=n}return Object(ut["a"])(t,[{key:"setScale",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:fr;this.scale=t}},{key:"move",value:function(t,e){this.originX=ft["d"].round(t),this.originY=ft["d"].round(e)}},{key:"toGeometry",value:function(t,e){var n=this.scale,r=this.originX,i=this.originY;return[(t-r)*n,(i-e)*n]}},{key:"toCanvas",value:function(t,e){var n=this.scale,r=this.originX,i=this.originY;return[r+t/n,i-e/n]}}]),t}(),yr=function(){return{x:0,y:0}},gr=function(){return{capturedAt:null,pointer:yr(),virtual:yr(),hovering:null,focusing:null,selecting:null,holding:null}},br=["pointermove","pointerdown","pointerup"];function mr(t,e,n){var r=new ln["Application"]({antialias:!0,backgroundColor:n.style.backgroundColor,backgroundAlpha:n.style.backgroundOpacity}),i=r.stage,a=r.ticker;return i.interactive=!0,i.hitArea=new ln["Rectangle"],a.add((function(){return t.observer.update()})).add((function(){return t.watchSnap()})).add((function(){return t.watchSize()})),br.forEach((function(e){i.on("".concat(e),(function(e){t.globalEvent.current=e}))})),i.on("pointerdown",(function(n){$r(t,"pointerdown");var r=n.target,i=e.focusing;ft["h"].Not.Null(i)&&r!==i.graphics&&t.setFocusing()})).on("pointerup",(function(){$r(t,"pointerup"),t.setHolding()})).on("pointermove",(function(r){if(n.capture){var i=r.data.global,a=i.x,o=i.y,s=e.pointer;s.x===a&&s.y===o||t.setPointer(a,o)}})),r}var $r=function(t,e){t.emit(e,t.globalEvent.accessor)},Or=(n("4de4"),function(){function t(){Object(ct["a"])(this,t),this.store=new Set}return Object(ut["a"])(t,[{key:"register",value:function(t){this.store.add(t)}},{key:"remove",value:function(t){this.store.has(t)&&this.store.delete(t)}},{key:"from",value:function(t,e){var n=!1,r=[t,e],i=Array.from(this.store).filter(wr).sort(xr),a=function(t,e){v.Point(t,e),r[0]=t,r[1]=e,n=!0};while(!n&&i.length>0)i.pop().handle(t,e,a);return r}}]),t}()),xr=function(t,e){return t.priority-e.priority},wr=function(t){return t.active},jr=function(){function t(){Object(ct["a"])(this,t),this.registry=new Set}return Object(ut["a"])(t,[{key:"append",value:function(t){this.registry.add(t)}},{key:"reset",value:function(){var t,e=Object(je["a"])(this.registry);try{for(e.s();!(t=e.n()).done;){var n=t.value;n.reset()}}catch(r){e.e(r)}finally{e.f()}}}]),t}(),kr=200,Tr=function(){function t(e){Object(ct["a"])(this,t),this.drawing=e,this.dirty=!1,this.set=new Set,this.tickerTimer=null,this.setDirty()}return Object(ut["a"])(t,[{key:"add",value:function(t){this.set.add(t)}},{key:"cancel",value:function(t){this.set.delete(t)}},{key:"setDirty",value:function(){cn["d"].Clear.Timeout(this.tickerTimer),this.drawing.application.ticker.start(),this.dirty=!0}},{key:"update",value:function(){var t=this;if(this.dirty){this.tickerTimer=cn["d"].Timeout((function(){t.drawing.application.ticker.stop()}),kr);var e,n=Object(je["a"])(this.set);try{for(n.s();!(e=n.n()).done;){var r=e.value;r()}}catch(i){n.e(i)}finally{n.f()}this.dirty=!1}}}]),t}(),Er=new WeakMap,Sr=function(t){return Er.get(t)},Cr=["keydown","keyup"];function Pr(t){cn["a"].addEventListener(cn["c"].WINDOW,t,this.keyboardEventListener)}function Lr(t){cn["a"].removeEventListener(cn["c"].WINDOW,t,this.keyboardEventListener)}for(var Dr,Ar=function(t){Object(qe["a"])(n,t);var e=Object(Je["a"])(n);function n(t){var r;Object(ct["a"])(this,n),r=e.call(this,t),Er.set(t,Object(sn["a"])(r));var i=r.state=gr(),a=r.options=new dn(Object(sn["a"])(r));return r.destroyed=!1,r.proxy=t,r.containerElement=null,r.keyboardEventListener=function(t){return $r(Object(sn["a"])(r),t.type)},r.application=mr(Object(sn["a"])(r),i,a),r.observer=new Tr(Object(sn["a"])(r)),r.globalEvent=hr(Object(sn["a"])(r),i),r.coordinate=new vr,r.snapManager=new Or,r.toolManager=new jr,r.groupMap=new Map,r.Plugin={Proxy:{},Context:{}},cr(Object(sn["a"])(r)),Cr.forEach(Pr,Object(sn["a"])(r)),r}return Object(ut["a"])(n,[{key:"canvasElement",get:function(){return this.application.view}},{key:"watchSize",value:function(){if(this.options.autoResizing){var t=this.application.view,e=t.parentElement,n=e.offsetHeight,r=e.offsetWidth;t.height===n&&t.width===r||this.resize()}}},{key:"watchSnap",value:function(){if(this.options.snap.enable){var t=this.state,e=t.capturedAt,n=t.virtual,r=t.pointer;if(!ft["h"].isNull(e)){var i=Date.now();if(i-e>this.options.snap.interval){var a=this.snapManager.from(r.x,r.y),o=Object(re["a"])(a,2);n.x=o[0],n.y=o[1],$r(this,"pointermove"),$r(this,"snap"),this.state.capturedAt=null}}}}},{key:"mount",value:function(t){cn["a"].appendChild(t,this.canvasElement),this.containerElement=t,$r(this,"mount"),this.resize()}},{key:"destroy",value:function(){Cr.forEach(Lr,this),this.keyboardEventListener=null,cn["a"].removeFromParent(this.canvasElement),un["a"].destroy(this),this.destroyed=!0}},{key:"resize",value:function(){var t=this.application,e=t.stage,n=t.view,r=this.containerElement,i=r.offsetWidth,a=r.offsetHeight;e.hitArea.width=n.width=i,e.hitArea.height=n.height=a,this.application.renderer.resize(i,a),this.forceUpdateAll(),$r(this,"resize")}},{key:"setPointer",value:function(t,e){this.state.pointer.x=this.state.virtual.x=t,this.state.pointer.y=this.state.virtual.y=e,this.state.capturedAt=Date.now(),this.observer.setDirty(),$r(this,"pointermove")}},{key:"setHovering",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.state.hovering=t}},{key:"setFocusing",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=this.state.focusing;this.state.focusing=t,ft["h"].Not.Null(e)&&(e.emitBlur(),this.emit("element-blur",e.context.$proxy)),ft["h"].Not.Null(t)&&this.emit("element-focus",t.context.$proxy)}},{key:"setHolding",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.state.holding=t}},{key:"forceUpdateAll",value:function(){for(var t in this.observer.setDirty(),this.Plugin.Context)this.Plugin.Context[t].$forceUpdate()}}]),n}(un["a"].Emitter),Nr=0,Fr=1,Wr=function(t){return ft["h"].isNull(t)?null:t.context.$proxy},Ir=function(t){return[t.x,t.y]},Rr=(Dr={},Object(lt["a"])(Dr,Nr,(function(t,e){t.setScale(e)})),Object(lt["a"])(Dr,Fr,(function(t,e){t.setScaleByReference.apply(t,[e].concat(Object(ht["a"])(t.pointer)))})),Dr),Mr=function(){function t(){Object(ct["a"])(this,t),new Ar(this),ft["f"].freeze(this)}return Object(ut["a"])(t,[{key:"options",get:function(){return Sr(this).options}},{key:"canvasElement",get:function(){return Sr(this).canvasElement}},{key:"hovering",get:function(){return Wr(Sr(this).state.hovering)}},{key:"selecting",get:function(){return Wr(Sr(this).state.selecting)}},{key:"focusing",get:function(){return Wr(Sr(this).state.focusing)}},{key:"holding",get:function(){return Wr(Sr(this).state.holding)}},{key:"plugins",get:function(){return Sr(this).Plugin.Proxy}},{key:"pointer",get:function(){return Ir(Sr(this).state.pointer)}},{key:"virtual",get:function(){return Ir(Sr(this).state.virtual)}},{key:"origin",get:function(){var t=Sr(this).coordinate,e=t.originX,n=t.originY;return[e,n]}},{key:"scale",get:function(){return Sr(this).coordinate.scale}},{key:"width",get:function(){return Sr(this).application.view.width}},{key:"height",get:function(){return Sr(this).application.view.height}},{key:"mount",value:function(t){ft["c"].instanceOf(t,HTMLElement)||ft["c"].Throw.TypeError("Invalid `element`, a HTMLElement expected."),Sr(this).mount(t)}},{key:"resize",value:function(){Sr(this).resize()}},{key:"destroy",value:function(){Sr(this).destroy()}},{key:"setOrigin",value:function(t,e){v.Point(t,e);var n=Sr(this);n.coordinate.move(t,e),n.forceUpdateAll()}},{key:"setScale",value:function(t){ft["h"].Not.Number(t)&&ft["c"].Throw.TypeError("Invalid scale, a number expected.");var e=Sr(this),n=this.options.scale,r=n.min,i=n.max,a=ft["d"].max(r,ft["d"].min(i,t));e.coordinate.setScale(a),e.forceUpdateAll()}},{key:"setScaleByReference",value:function(t,e,n){var r,i;v.Point(e,n);var a=Sr(this),s=this.origin,u=a.coordinate.toGeometry(e,n);this.setScale(t);var l=(r=a.coordinate).toCanvas.apply(r,Object(ht["a"])(u)),h=o.fromBothPoint.apply(o,Object(ht["a"])(l).concat([e,n]));(i=a.coordinate).move.apply(i,Object(ht["a"])(c.translate.apply(c,Object(ht["a"])(s).concat(Object(ht["a"])(h))))),a.forceUpdateAll()}},{key:"setScaleInMode",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Nr;ft["f"].values(m).includes(e)?Rr[e](this,t):ft["c"].Throw.TypeError("Invalid `mode`, a value of SCALE_MODE expected.")}},{key:"on",value:function(t,e){return Sr(this).on(t,e),this}},{key:"off",value:function(t,e){return Sr(this).off(t,e),this}},{key:"registerSnap",value:function(t){Sr(this).snapManager.register(t)}},{key:"appendTool",value:function(t){Sr(this).toolManager.append(t)}},{key:"resetAllTool",value:function(){Sr(this).toolManager.reset()}}]),t}(),Hr=function(t){return Xn(t)},Br=function(t,e,n){return rr(ft["f"].assign(n,{states:t,actions:e}))},Vr=function(t){return Gn(t)},zr=function(t){return ir(t)},Ur=y._,Yr=n("49a4"),Gr=function(t){return t.$proxy},_r=function(t){Object(qe["a"])(n,t);var e=Object(Je["a"])(n);function n(){return Object(ct["a"])(this,n),e.apply(this,arguments)}return Object(ut["a"])(n,[{key:"hollows",value:Object(ge["a"])().mark((function t(){var e,n,r;return Object(ge["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=Object(je["a"])(Ur(this).hollows()),t.prev=1,e.s();case 3:if((n=e.n()).done){t.next=9;break}return r=n.value,t.next=7,r.$proxy;case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](1),e.e(t.t0);case 14:return t.prev=14,e.f(),t.finish(14);case 17:case"end":return t.stop()}}),t,this,[[1,11,14,17]])}))},{key:"createHollow",value:function(t,e,n){return Ur(this).createHollow(t,e,n)}},{key:"createMovingHollow",value:function(t,e){return Ur(this).createMovingHollow(t,e)}},{key:"getAllHollowList",value:function(){return Ur(this).$getElementList("Hollow").map(Gr)}}]),n}(b.Proxy.Plugin),Xr=x.define({proxy:b.Proxy.Creator(_r),created:function(){var t=this;this.$on("element-created",(function(e,n){t.$emit("".concat(n.toLowerCase(),"-created"),e)}))},methods:{createHollow:function(t,e,n){return this.$createElement("Hollow",t,e,n)},createMovingHollow:function(t,e){var n=this.$createElement("Hollow",t);return e&&n.setWidth(e),this.$drawing.hammer.adjuster.moveElement(n),n},hollows:Object(ge["a"])().mark((function t(){var e,n,r;return Object(ge["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=Object(je["a"])(this.$elements("Hollow")),t.prev=1,e.s();case 3:if((n=e.n()).done){t.next=9;break}return r=n.value,t.next=7,r;case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](1),e.e(t.t0);case 14:return t.prev=14,e.f(),t.finish(14);case 17:case"end":return t.stop()}}),t,this,[[1,11,14,17]])}))}}),Kr=(n("b64b"),{}),qr=function(t,e){ft["h"].Not.String(t)&&ft["c"].Throw.TypeError("Invalid `name`, a string expected."),ft["h"].Not.Function(e.render)&&ft["c"].Throw.TypeError("Invalid `material`, a function expected."),t in Kr&&ft["b"].warn('Duplicated material name="'.concat(t,'". The original is replaced.')),Kr[t]=e},Jr=function(t){return Kr[t]},Qr=function(){return Object.keys(Kr)},Zr=function(t){Object(qe["a"])(n,t);var e=Object(Je["a"])(n);function n(){return Object(ct["a"])(this,n),e.apply(this,arguments)}return Object(ut["a"])(n,[{key:"surface",get:function(){return Ur(this).surface}},{key:"virtualSurface",get:function(){return Ur(this).virtualSurface}},{key:"width",get:function(){return Ur(this).width}},{key:"defaultWidth",get:function(){return Ur(this).defaultWidth}},{key:"offset",get:function(){return Ur(this).offset}},{key:"materialName",get:function(){return Ur(this).materialName}},{key:"fliped",get:function(){return Ur(this).fliped}},{key:"visible",get:function(){return Ur(this).$visible}},{key:"flip",value:function(){Ur(this).flip()}},{key:"toggleSurface",value:function(){Ur(this).toggleSurface()}},{key:"setSurface",value:function(t){Ur(this).setSurface(t)}},{key:"setMaterial",value:function(t){Ur(this).setMaterial(t)}},{key:"setOffset",value:function(t){Ur(this).setOffset(t)}},{key:"setWidth",value:function(t){Ur(this).setWidth(t)}},{key:"show",value:function(){Ur(this).$show()}},{key:"hide",value:function(){Ur(this).$hide()}},{key:"remove",value:function(){Ur(this).remove()}}]),n}(b.Proxy.Element),ti=function(){function t(e,n,r){Object(ct["a"])(this,t),this.name="virtual",this.corner={x:e,y:n},this.back={corner:{x:e+10,y:n}},this.wall={thickness:r}}return Object(ut["a"])(t,[{key:"setCorner",value:function(t,e){this.corner.x=t,this.corner.y=e}},{key:"setBackCorner",value:function(t,e){this.back.corner.x=t,this.back.corner.y=e}},{key:"setThinkness",value:function(t){this.wall.thickness=t}}]),t}(),ei=x.Element.define({groupIndex:1100,interative:!0,hoverable:!0,focusable:!0,draggable:!0,state:function(){return{surface:null,virtualSurface:null,offset:0,materialName:"",fliped:!1,width:0,defaultWidth:0,rendering:!1,changeListener:ft["e"],destroyListener:ft["e"]}},getters:{surface:function(){return this.$state.surface},virtualSurface:function(){return this.$state.virtualSurface},width:function(){return this.$state.width},defaultWidth:function(){return this.$state.defaultWidth},offset:function(){return this.$state.offset},materialName:function(){return this.$state.materialName},fliped:function(){return this.$state.fliped}},created:function(t,e){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.$state.virtualSurface=new ti(1e4,10001,200),this.$state.changeListener=function(){n.updateVirtualSurface(),n.$setDirty()},this.$state.destroyListener=function(){n.setSurface(n.$state.virtualSurface)},this.$state.defaultWidth=Jr(t).width,this.setMaterial(t),this.setSurface(e||this.$state.virtualSurface),this.setOffset(r),this.setWidth(this.$state.defaultWidth)},destroy:function(){var t=this.$state.surface;!1===t.destroyed&&(t.wall.off("destroy",this.$state.destroyListener),t.wall.off("change",this.$state.changeListener))},render:function(t){var e=this.$state,n=e.surface,r=e.virtualSurface,i=e.width,a=e.fliped,s=e.offset,u=e.materialName,l=e.rendering,h=n.corner?n:r,f=this.$drawing.scale,d=h.corner,p=h.back.corner,v={width:i/f,height:h.wall.thickness/f,fliped:a,scale:f,hover:this.$hovering,focus:this.$focusing,hold:this.$holding};Jr(u).render(t,v),n&&"virtual"===n.name&&t.beginFill(16711680).drawCircle(v.width/2,v.height/2,5);var y=this.$toCanvas(d.x,d.y),g=this.$toCanvas(p.x,p.y),b=o.normalize.apply(o,Object(ht["a"])(o.fromBothPoint.apply(o,Object(ht["a"])(y).concat(Object(ht["a"])(g))))),m=Object(re["a"])(b,2),$=m[0],O=m[1],x=c.translate.apply(c,Object(ht["a"])(y).concat(Object(ht["a"])(o.multiply($,O,s/f)))),w=Object(re["a"])(x,2);t.x=w[0],t.y=w[1],t.rotation=ft["d"].atan2(O,$),l&&(this.$emit("change",this.$proxy),this.setRendering(!1))},methods:{flip:function(){this.$state.fliped=!this.$state.fliped,this.$setDirty(),this.setRendering(!0)},toggleSurface:function(){var t=this.$state.surface.corner,e=this.$state.surface.back.corner,n=o.length.apply(o,Object(ht["a"])(o.fromBothPoint(t.x,t.y,e.x,e.y)));this.setOffset(n-this.$state.offset),this.setSurface(this.$state.surface.back)},setSurface:function(t){if(this.$state.surface!==t){var e=this.$state.surface;this.$state.surface=t,e&&!1===e.destroyed&&(e.wall.off("destroy",this.$state.destroyListener),e.wall.off("change",this.$state.changeListener)),t&&t.on&&(t.wall.on("destroy",this.$state.destroyListener),t.wall.on("change",this.$state.changeListener),this.updateVirtualSurface()),this.$setDirty()}},setMaterial:function(t){this.$state.materialName=t,this.$setDirty(),this.setRendering(!0)},setOffset:function(t){this.$state.offset=t,this.$setDirty()},setWidth:function(t){this.$state.width=t,this.$setDirty(),this.setRendering(!0)},remove:function(){this.$destroy()},updateVirtualSurface:function(){var t=this.$state,e=t.surface,n=t.virtualSurface;n.setCorner(e.corner.x,e.corner.y),n.setBackCorner(e.back.corner.x,e.back.corner.y),n.setThinkness(e.wall.thickness)},setRendering:function(t){this.$state.rendering=t}},proxy:function(){return new Zr(this)}},Xr),ni=w.define({id:"com.3dnest.spoke.windoor",namespace:"windoor",version:Yr["a"],plugin:Xr,elements:{Hollow:ei}}),ri=n("7580"),ii={},ai=function(t,e){ft["h"].Not.String(t)&&ft["c"].Throw.TypeError("Invalid `name`, a string expected."),ft["h"].Not.Function(e.render)&&ft["c"].Throw.TypeError("Invalid `material`, a function expected."),t in ii&&ft["b"].warn('Duplicated material name="'.concat(t,'". The original is replaced.')),ii[t]=e},oi=function(){var t=Object(ri["a"])(Object(ge["a"])().mark((function t(e,n){var r,i;return Object(ge["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,ln.Texture.fromURL(n);case 2:r=t.sent,i={texture:r,render:function(t,e){var n=e.width,i=e.height,a=n>0?n:r.width,o=i>0?i:r.height;t.beginTextureFill({texture:r,matrix:new ln.Matrix(a/r.width,0,0,o/r.height,0,0)}).drawRect(0,0,a,o)}},ai(e,i);case 5:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),si=function(t){return t in ii||ft["b"].warn('material name="'.concat(t,'" is not exist.')),ii[t]},ci=function(t){Object(qe["a"])(n,t);var e=Object(Je["a"])(n);function n(){return Object(ct["a"])(this,n),e.apply(this,arguments)}return Object(ut["a"])(n,[{key:"createStuff",value:function(t,e,n,r,i){return Ur(this).createStuff(t,e,n,r,i)}},{key:"createMovingStuff",value:function(t,e,n,r){return Ur(this).createMovingStuff(t,e,n,r)}},{key:"getAllStuffList",value:function(){return Array.from(this.stuffs())}},{key:"stuffs",value:Object(ge["a"])().mark((function t(){var e,n,r;return Object(ge["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=Object(je["a"])(Ur(this).stuffs()),t.prev=1,e.s();case 3:if((n=e.n()).done){t.next=9;break}return r=n.value,t.next=7,r.$proxy;case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](1),e.e(t.t0);case 14:return t.prev=14,e.f(),t.finish(14);case 17:case"end":return t.stop()}}),t,this,[[1,11,14,17]])}))}]),n}(b.Proxy.Plugin),ui=x.define({proxy:b.Proxy.Creator(ci),created:function(){var t=this;this.$on("element-created",(function(e,n){t.$emit("".concat(n.toLowerCase(),"-created"),e)}))},methods:{createStuff:function(t,e,n,r,i){var a=si(t).texture,o=this.$drawing.scale;return this.$createElement("Stuff",t,e,n,r||a.width*o,i||a.height*o).$proxy},createMovingStuff:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=this.createStuff(t,1e4,1e4,e,n);return i.setRotation(r),this.$drawing.common.transformer.moveElement(i),i},stuffs:Object(ge["a"])().mark((function t(){var e,n,r;return Object(ge["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=Object(je["a"])(this.$elements("Stuff")),t.prev=1,e.s();case 3:if((n=e.n()).done){t.next=9;break}return r=n.value,t.next=7,r;case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](1),e.e(t.t0);case 14:return t.prev=14,e.f(),t.finish(14);case 17:case"end":return t.stop()}}),t,this,[[1,11,14,17]])}))}}),li=(n("cb29"),function(t){Object(qe["a"])(n,t);var e=Object(Je["a"])(n);function n(){return Object(ct["a"])(this,n),e.apply(this,arguments)}return Object(ut["a"])(n,[{key:"fill",get:function(){return Ur(this).fill}},{key:"width",get:function(){return Ur(this).width}},{key:"height",get:function(){return Ur(this).height}},{key:"rotation",get:function(){return Ur(this).rotation}},{key:"x",get:function(){return Ur(this).x}},{key:"y",get:function(){return Ur(this).y}},{key:"room",get:function(){return Ur(this).room}},{key:"visible",get:function(){return Ur(this).$visible}},{key:"setFill",value:function(t){Ur(this).setFill(t)}},{key:"setRoom",value:function(t){Ur(this).setRoom(t)}},{key:"setWidth",value:function(t){Ur(this).setWidth(t)}},{key:"setHeight",value:function(t){Ur(this).setHeight(t)}},{key:"setOffset",value:function(t,e){Ur(this).setOffet(t,e)}},{key:"setRotation",value:function(t){Ur(this).setRotation(t)}},{key:"setPosition",value:function(t,e){Ur(this).setPosition(t,e)}},{key:"show",value:function(){Ur(this).$show()}},{key:"hide",value:function(){Ur(this).$hide()}},{key:"remove",value:function(){Ur(this).remove()}}]),n}(b.Proxy.Element)),hi=x.Element.define({proxy:b.Proxy.Creator(li),groupIndex:1200,interative:!0,focusable:!0,draggable:!0,state:function(){return{fill:"",width:0,height:0,room:null,offsetX:0,offsetY:0,x:0,y:0,rotation:0,rendering:!1,listener:ft["e"]}},getters:{fill:function(){return this.$state.fill},width:function(){return this.$state.width},height:function(){return this.$state.height},rotation:function(){return this.$state.rotation},x:function(){return this.$state.x},y:function(){return this.$state.y},room:function(){return this.$state.room}},created:function(t,e,n,r,i){this.setWidth(r),this.setHeight(i),this.setFill(t),this.setPosition(e,n)},destroy:function(){var t=this.$state.room;t&&t.off&&t.off("dirty",this.$state.listener)},render:function(t){var e=this.$state,n=e.width,r=e.height,i=e.rotation,a=e.fill,o=e.rendering,s=e.x,c=e.y,u=this.$drawing.scale,l={width:n/u,height:r/u};t.drawRect(0,0,l.width,l.height),t.pivot.x=l.width/2,t.pivot.y=l.height/2;var h=si(a);h&&h.render(t,l);var f=this.$toCanvas(Number(s),Number(c)),d=Object(re["a"])(f,2);t.x=d[0],t.y=d[1],t.rotation=i,o&&(this.$emit("change",this.$proxy),this.setRendering(!1))},methods:{setFill:function(t){this.$state.fill=t,this.$setDirty()},setRoom:function(t){var e=this;t!==this.$state.room&&(t?(this.$state.room=t,t.on("dirty",this.$state.listener=function(){return e.$setDirty()}),this.$setDirty()):this.$state.room=null)},setWidth:function(t){this.$state.width=t,this.$setDirty(),this.setRendering(!0)},setHeight:function(t){this.$state.height=t,this.$setDirty(),this.setRendering(!0)},setRotation:function(t){this.$state.rotation=t,this.$setDirty(),this.setRendering(!0)},setPosition:function(t,e){var n=this.$state.room,r=n?this.$toGeometry(n.$bounds.left,n.$bounds.bottom):[0,0],i=Object(re["a"])(r,2),a=i[0],o=i[1];this.$state.x=t,this.$state.y=e,this.$state.offsetX=t-a,this.$state.offsetY=e-o,this.$setDirty(),this.setRendering(!0)},setOffset:function(t,e){var n=this.$state.room,r=n?this.$toGeometry(n.$bounds.left,n.$bounds.bottom):[0,0],i=Object(re["a"])(r,2),a=i[0],o=i[1];this.$state.offsetX=t,this.$state.offsetY=e;var s=[a+t,o+e];this.$state.x=s[0],this.$state.y=s[1],this.$setDirty()},setRendering:function(t){this.$state.rendering=t},remove:function(){this.$destroy()}}},ui),fi=n("e07e"),di=w.define({id:"com.3dnest.spoke.furniture",namespace:"furniture",version:fi["a"],plugin:ui,elements:{Stuff:hi}}),pi=n("3d04"),vi=n("5d77"),yi=(n("9911"),n("ac1f"),n("1276"),function(t){Object(qe["a"])(n,t);var e=Object(Je["a"])(n);function n(){return Object(ct["a"])(this,n),e.apply(this,arguments)}return Object(ut["a"])(n,[{key:"x",get:function(){return Ur(this).x}},{key:"y",get:function(){return Ur(this).y}},{key:"size",get:function(){return Ur(this).size}},{key:"point",get:function(){var t=Ur(this),e=t.x,n=t.y;return[e,n]}},{key:"move",value:function(t,e){return b.Assert.Point(t,e),Ur(this).move(t,e),this}},{key:"remove",value:function(){return Ur(this).remove(),this}},{key:"getAdjacentCornerList",value:function(){return Ur(this).getAdjacentCornerList().map(gi)}},{key:"surfaces",value:Object(ge["a"])().mark((function t(){var e,n,r;return Object(ge["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=Object(je["a"])(Ur(this).surfaces()),t.prev=1,e.s();case 3:if((n=e.n()).done){t.next=9;break}return r=n.value,t.next=7,r.$proxy;case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](1),e.e(t.t0);case 14:return t.prev=14,e.f(),t.finish(14);case 17:case"end":return t.stop()}}),t,this,[[1,11,14,17]])}))},{key:"walls",value:Object(ge["a"])().mark((function t(){var e,n,r;return Object(ge["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=Object(je["a"])(Ur(this).surfaces()),t.prev=1,e.s();case 3:if((n=e.n()).done){t.next=9;break}return r=n.value,t.next=7,r.wall.$proxy;case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](1),e.e(t.t0);case 14:return t.prev=14,e.f(),t.finish(14);case 17:case"end":return t.stop()}}),t,this,[[1,11,14,17]])}))},{key:"getWallByToCorner",value:function(t){ft["c"].instanceOf(t,n)||ft["c"].Throw.TypeError("Invalid corner, a CornerProxy expected.");var e=Ur(this).getWallByToCorner(Ur(t));return ft["h"].isNull(e)?null:e.$proxy}}]),n}(b.Proxy.Element)),gi=function(t){return t.$proxy},bi=function(t){Object(qe["a"])(n,t);var e=Object(Je["a"])(n);function n(){return Object(ct["a"])(this,n),e.apply(this,arguments)}return Object(ut["a"])(n,[{key:"thisCorner",get:function(){return Ur(this).thisSurface.corner.$proxy}},{key:"thatCorner",get:function(){return Ur(this).thatSurface.corner.$proxy}},{key:"thisSurface",get:function(){return Ur(this).thisSurface.$proxy}},{key:"thatSurface",get:function(){return Ur(this).thatSurface.$proxy}},{key:"thickness",get:function(){return Ur(this).$state.thickness},set:function(t){(ft["h"].Not.Number(t)||t<0)&&ft["c"].Throw.TypeError("Invalid `thickness`, a number >=0 expected."),Ur(this).setThickness(t)}},{key:"segment",get:function(){return Ur(this).segment}},{key:"color",get:function(){return Ur(this).$state.color},set:function(t){Ur(this).setColor(t)}},{key:"remove",value:function(){Ur(this).remove()}},{key:"removeSimple",value:function(){Ur(this).removeSimple()}},{key:"drawPolygon",value:function(t){ft["c"].instanceOf(t,ln.Graphics)||ft["c"].Throw.TypeError("Invalid `graphics`, a `PIXI.Graphics` expected."),Ur(this).drawPolygon(t)}},{key:"containsPoint",value:function(){}}]),n}(b.Proxy.Element),mi=function(t){Object(qe["a"])(n,t);var e=Object(Je["a"])(n);function n(){return Object(ct["a"])(this,n),e.apply(this,arguments)}return Object(ut["a"])(n,[{key:"getOptions",value:function(){return Ur(this).$data.optionsGetter}},{key:"createCorner",value:function(t,e){return b.Assert.Point(t,e),Ur(this).createCorner(t,e).$proxy}},{key:"removeCorner",value:function(t){return ft["c"].instanceOf(t,yi)||ft["c"].Throw.TypeError("Invalid `corner`, a CornerProxy expected."),Ur(this).removeCorner(Ur(t))}},{key:"createWall",value:function(t,e){return Oi(t,e),ft["h"].Not.Null(t.getWallByToCorner(e))&&ft["c"].throwError("Duplicated wall"),t===e&&ft["c"].throwError("`fromCorner` and `toCorner` MUST NOT be same."),Ur(this).createWall(Ur(t),Ur(e)).$proxy}},{key:"removeWall",value:function(t){return ft["c"].instanceOf(t,bi)||ft["c"].Throw.TypeError("Invalid `wall`, a WallProxy expected."),Ur(this).removeWall(Ur(t))}},{key:"removeWallSimple",value:function(t){return ft["c"].instanceOf(t,bi)||ft["c"].Throw.TypeError("Invalid `wall`, a WallProxy expected."),Ur(this).removeWallSimple(Ur(t))}},{key:"split",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:ft["e"];return b.Assert.Point(e,n),ft["c"].instanceOf(t,bi)||ft["c"].Throw.TypeError("Invalid `wall`, a WallProxy expected."),Ur(this).split(Ur(t),e,n,(function(t,e,n){r(t.$proxy,e.$proxy,n.$proxy)})).$proxy}},{key:"merge",value:function(t){return ft["c"].instanceOf(t,yi)||ft["c"].Throw.TypeError("Invalid `corner`, a CornerProxy expected."),2!==t.size&&ft["c"].throwError("The Wall number of this Corner is NOT 2."),Ur(this).merge(Ur(t)).$proxy}},{key:"combine",value:function(t){ft["c"].instanceOf(t,bi)||ft["c"].Throw.TypeError("Invalid `wall`, a WallProxy expected.");var e=Ur(t);return Ur(this).combine(e).$proxy}},{key:"removeRoom",value:function(){}},{key:"getAllCornerList",value:function(){return Array.from(this.corners())}},{key:"getAllWallList",value:function(){return Array.from(this.walls())}},{key:"getAllRoomList",value:function(){return Array.from(this.rooms())}},{key:"getRoomByPoint",value:function(t,e){b.Assert.Point(t,e);var n=Ur(this).getRoomOfPoint(t,e);return n?n.$proxy:null}},{key:"queryCorner",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;b.Assert.Point(t,e),(ft["h"].Not.Number(n)||n<=0)&&ft["c"].Throw.TypeError("Invalid `range`, a number >0 expected.");var r=Ur(this).queryCorner(t,e,n);return ft["h"].isNull(r)?null:r.$proxy}},{key:"mergeAll",value:function(){}},{key:"clearEmplyCorner",value:function(){}},{key:"corners",value:Object(ge["a"])().mark((function t(){var e,n,r;return Object(ge["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=Object(je["a"])(Ur(this).$elements("Corner")),t.prev=1,e.s();case 3:if((n=e.n()).done){t.next=9;break}return r=n.value,t.next=7,r.$proxy;case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](1),e.e(t.t0);case 14:return t.prev=14,e.f(),t.finish(14);case 17:case"end":return t.stop()}}),t,this,[[1,11,14,17]])}))},{key:"walls",value:Object(ge["a"])().mark((function t(){var e,n,r;return Object(ge["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=Object(je["a"])(Ur(this).$elements("Wall")),t.prev=1,e.s();case 3:if((n=e.n()).done){t.next=9;break}return r=n.value,t.next=7,r.$proxy;case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](1),e.e(t.t0);case 14:return t.prev=14,e.f(),t.finish(14);case 17:case"end":return t.stop()}}),t,this,[[1,11,14,17]])}))},{key:"rooms",value:Object(ge["a"])().mark((function t(){var e,n,r;return Object(ge["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=Object(je["a"])(Ur(this).$elements("Room")),t.prev=1,e.s();case 3:if((n=e.n()).done){t.next=9;break}return r=n.value,t.next=7,r.$proxy;case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](1),e.e(t.t0);case 14:return t.prev=14,e.f(),t.finish(14);case 17:case"end":return t.stop()}}),t,this,[[1,11,14,17]])}))},{key:"surfaces",value:Object(ge["a"])().mark((function t(){var e,n,r;return Object(ge["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=Object(je["a"])(Ur(this).$elements("Surface")),t.prev=1,e.s();case 3:if((n=e.n()).done){t.next=9;break}return r=n.value,t.next=7,r.$proxy;case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](1),e.e(t.t0);case 14:return t.prev=14,e.f(),t.finish(14);case 17:case"end":return t.stop()}}),t,this,[[1,11,14,17]])}))}]),n}(b.Proxy.Plugin),$i=["from","to"],Oi=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var r in $i)ft["c"].instanceOf(e[r],yi)||ft["c"].Throw.TypeError("Invalid `".concat($i[r],"`, a CornerProxy excepted."))},xi=b.Options.define,wi=xi({show:!0},{snap:xi({},{corner:xi({active:!0,priority:0,maxDistance:15})}),corner:xi({show:!0,render:null},{style:xi({color:16777215,opacity:.75,radius:5},{hover:xi({color:0,opacity:.75,radius:5})})}),wall:xi({show:!0},{style:xi({opacity:1,color:10066329,hoverColor:13421772}),midline:xi({show:!0,color:16711680,width:1})}),room:xi({show:!0,defaultTexture:null}),surface:xi({opacity:1,borderColor:0,borderWidth:2})}),ji=(n("2781"),n("c8d3"),n("1d93"),n("8fdf"),n("8f79"),n("cbd2"),n("6065"),function(t,e){var n,i=null,a=r.ROUND,o=Object(je["a"])(p.Iterator.allHalfEdgeOfVertex(t));try{for(o.s();!(n=o.n()).done;){var s=n.value,c=u.differ(e,p.getAngleOfHalfEdge(s),!1);c<a&&(a=c,i=s)}}catch(l){o.e(l)}finally{o.f()}return i}),ki=function(t,e,n){if(ft["h"].Not.Null(t.incidentEdge)){var r=t.x,i=t.y,a=n.x,o=n.y,s=Math.atan2(o-i,a-r),c=ji(t,s),u=c.twin;e.previous=u,e.twin.next=u.next,u.next.previous=e.twin,u.next=e}e.origin=t,t.incidentEdge=e},Ti=function(t,e){var n,r=Object(je["a"])(p.Iterator.allHalfEdgeOfPath(t));try{for(r.s();!(n=r.n()).done;){var i=n.value;i.incidentFace=e}}catch(a){r.e(a)}finally{r.f()}},Ei=function(t,e){t.twin=e,e.twin=t,t.next=e,e.next=t,t.previous=e,e.previous=t},Si=function(t,e,n){var r=ft["h"].isNull(t.incidentEdge)&&ft["h"].isNull(e.incidentEdge),i=new p.Struct.HalfEdge,a=new p.Struct.HalfEdge;Ei(i,a),ki(t,i,e),ki(e,a,t);var o=r?p.getFaceOfPoint(n,t):i.previous.incidentFace||i.next.incidentFace,s=o.outerComponent,c=o.innerComponents;if(p.isTwinInSamePath(i)){i.incidentFace=a.incidentFace=o;var u=c.splice(0);p.isPathContainsHalfEdge(i,s)?o.outerComponent=i:c.push(i);var l,h=Object(je["a"])(u);try{for(h.s();!(l=h.n()).done;){var f=l.value;p.isPathContainsHalfEdge(i,f)||c.push(f)}}catch(k){h.e(k)}finally{h.f()}}else{var d=new p.Struct.Face,v=p.isOuterPath(a),y=p.isOuterPath(i),g=v?i:a,b=g.twin;Ti(b,d),g.incidentFace=o,d.outerComponent=b;var m=o.innerComponents.splice(0);y===v?o.outerComponent=g:o.innerComponents.push(g);var $,O=Object(je["a"])(m);try{for(O.s();!($=O.n()).done;){var x=$.value,w=x.origin;if(!p.isPathContainsVertex(g,w)&&!p.isPathContainsHalfEdge(b,x)){var j=p.getFaceOfPoint(d,w)?d:o;x.incidentFace!==j&&Ti(x,j),j.innerComponents.push(x)}}}catch(k){O.e(k)}finally{O.f()}}return i},Ci=function(t){t.origin=null,t.twin=null,t.previous=null,t.next=null,t.incidentFace=null},Pi=function(t){return t.outerComponent=null,t.innerComponents.length=0,t},Li=function(t){var e=t.twin,n=t.previous,r=t.origin,i=null;return e===n?r.incidentEdge=null:(n.next=r.incidentEdge=e.next,i=e.next.previous=n),i},Di=function(t){var e=t.incidentFace,n=t.twin,r=p.isTwinInSamePath(t),i=p.isOuterPath(t),a=Li(t),o=Li(n);if(r){var s,c=e.innerComponents,u=c.splice(0),l=[a,o].filter(ft["h"].Not.Null).filter((function(t){var n=p.isOuterPath(t);return n?e.outerComponent=t:c.push(t),!n})),h=Object(je["a"])(u);try{var f=function(){var e=s.value;e!==t&&e!==n&&l.every((function(t){return!p.isPathContainsHalfEdge(t,e)}))&&c.push(e)};for(h.s();!(s=h.n()).done;)f()}catch(w){h.e(w)}finally{h.f()}}else{var d,v,y=a.incidentFace,g=o.incidentFace;if(i?(d=g,v=y):(d=y,v=g),p.isOuterPath(a))d.outerComponent=a;else{var b=d.innerComponents,m=d.innerComponents.splice(0).concat(v.innerComponents);b.push(a);var $,O=Object(je["a"])(m);try{for(O.s();!($=O.n()).done;){var x=$.value;x===t||x===n||p.isPathContainsHalfEdge(a,x)||b.push(x)}}catch(w){O.e(w)}finally{O.f()}}Ti(a,d),Pi(v)}Ci(t),Ci(n)},Ai=function(t){return p.getVertexHalfEdgeList(t).forEach(Di),t.incidentEdge=null,t},Ni=function(t){t.incidentEdge=null,t.x=0,t.y=0},Fi=function(t){var e=t.incidentEdge.twin,n=e.next.twin,r=e.next.next,i=n.next.next;return Ci(e.twin),Ci(n.twin),Ni(t),e.twin=n,n.twin=e,e.next=r,n.next=i,r.previous=e,i.previous=n,e},Wi=function(t){var e=t.incidentFace;if(e.outerComponent===t)e.outerComponent=t.next;else{var n=e.innerComponents,r=n.indexOf(t);-1!==r&&(n[r]=t.next)}},Ii=function(t){var e=t.twin,n=t.origin,r=e.origin,i=p.hasOnlyHalfEdge(n),a=p.hasOnlyHalfEdge(r);Wi(t),Wi(e);var o=n;if(i)if(a)Di(t);else{var s=[n.x,n.y];r.x=s[0],r.y=s[1],Ai(n),o=r}else if(a)Ai(r);else{var c,u=Object(je["a"])(p.Iterator.allHalfEdgeOfVertex(r));try{for(u.s();!(c=u.n()).done;){var l=c.value;l.origin=n}}catch(f){u.e(f)}finally{u.f()}n.incidentEdge=t.next,t.previous.next=t.next,t.next.previous=t.previous;var h=t.twin;h.previous.next=h.next,h.next.previous=h.previous,Ci(t),Ci(h),Ni(r)}return o},Ri=(n("000d"),"c"),Mi="d",Hi="D",Bi="Rg",Vi="_D",zi="_Rg",Ui=new WeakMap,Yi=function(t){return Ui.get(t)},Gi=function(t,e,n,r,i){function a(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;Object(ct["a"])(this,a),Ui.set(t,this),this[Ri]=e}return Object(ut["a"])(a,[{key:t,get:function(){return ft["h"].isNull(this[Ri])}},{key:e,value:function(){this[Ri]=null,this[Vi]()}},{key:n,value:function(){this[zi]()}},{key:r,value:function(){}},{key:i,value:function(){}}]),a}(Mi,Hi,Bi,Vi,zi),_i=function(){function t(){Object(ct["a"])(this,t)}return Object(ut["a"])(t,[{key:"mesh",get:function(){var t=Yi(this);return t[Mi]?null:t[Ri].$}},{key:"destroyed",get:function(){return Yi(this)[Mi]}}]),t}(),Xi="v",Ki="s",qi="Hs",Ji="F",Qi="H",Zi="E",ta="M",ea="e",na="v",ra="f",ia="g",aa="mv",oa="mf",sa="mh",ca="CV",ua="M",la="L",ha="S",fa="G",da="C",pa="LV",va="RV",ya="RE",ga="HV",ba="HE",ma="HF",$a="TV",Oa="TH",xa="TF",wa="PF",ja="AE",ka="AV",Ta="AF",Ea="FV",Sa="FE",Ca="FF",Pa="l",La="VC",Da="VD",Aa="EC",Na="ED",Fa="FC",Wa="FD",Ia="HC",Ra="HD",Ma="t",Ha="he",Ba="v",Va="e",za="f",Ua="n",Ya="p",Ga="b",_a="P",Xa=new WeakMap,Ka=function(t){return Xa.get(t)},qa=function(t){return t[Va]},Ja=function(t,e,n,r,i,a,o,s,c){Object(qe["a"])(l,t);var u=Object(Je["a"])(l);function l(t,e,n,r){var i;return Object(ct["a"])(this,l),i=u.call(this,t,e),Xa.set(t,Object(sn["a"])(i)),i.$=t,i[Xi]=p.createVertex(n,r),i[Bi](),i}return Object(ut["a"])(l,[{key:e,get:function(){var t,e=0,n=Object(je["a"])(p.Iterator.allHalfEdgeOfVertex(this[Xi]));try{for(n.s();!(t=n.n()).done;){t.value;e++}}catch(r){n.e(r)}finally{n.f()}return e}},{key:n,value:Object(ge["a"])().mark((function t(){var e,n,r;return Object(ge["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=Object(je["a"])(p.Iterator.allHalfEdgeOfVertex(this[Xi])),t.prev=1,e.s();case 3:if((n=e.n()).done){t.next=9;break}return r=n.value,t.next=7,this[Ri][Oa](r);case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](1),e.e(t.t0);case 14:return t.prev=14,e.f(),t.finish(14);case 17:case"end":return t.stop()}}),t,this,[[1,11,14,17]])}))},{key:r,value:function(){var t=this[Ri];t[na].add(this),t[aa].set(this[Xi],this)}},{key:i,value:function(){this[Xi]=null}},{key:a,value:function(){return p.getVertexHalfEdgeList(this[Xi]).map(this[Ri][Oa])}},{key:o,value:function(){return this[Qi]().map(qa)}},{key:s,value:function(){var t,e=new Set,n=Object(je["a"])(p.Iterator.allHalfEdgeOfVertex(this[Xi]));try{for(n.s();!(t=n.n()).done;){var r=t.value;e.add(r.incidentFace)}}catch(i){n.e(i)}finally{n.f()}return Array.from(e).map(this[Ri][xa])}},{key:c,value:function(t,e){this[Xi].x=t,this[Xi].y=e}}]),l}(Gi,Ki,qi,zi,Vi,Qi,Zi,Ji,ta),Qa=(n("c7b3"),function(t){return t.$}),Za=function(t){Object(qe["a"])(n,t);var e=Object(Je["a"])(n);function n(t,r,i){var a;return Object(ct["a"])(this,n),a=e.call(this),new Ja(Object(sn["a"])(a),t,r,i),Object.seal(Object(sn["a"])(a)),a}return Object(ut["a"])(n,[{key:"x",get:function(){return Ka(this)[Xi].x}},{key:"y",get:function(){return Ka(this)[Xi].y}},{key:"size",get:function(){return Ka(this)[Ki]}},{key:"halfEdges",value:Object(ge["a"])().mark((function t(){var e,n,r;return Object(ge["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=Object(je["a"])(Ka(this)[qi]()),t.prev=1,e.s();case 3:if((n=e.n()).done){t.next=9;break}return r=n.value,t.next=7,r.$;case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](1),e.e(t.t0);case 14:return t.prev=14,e.f(),t.finish(14);case 17:case"end":return t.stop()}}),t,this,[[1,11,14,17]])}))},{key:"move",value:function(t,e){return ft["h"].Not.Number(t)&&ft["c"].Throw.TypeError("Vertex.x MUST be a number."),ft["h"].Not.Number(e)&&ft["c"].Throw.TypeError("Vertex.y MUST be a number."),Ka(this)[ta](t,e),this}},{key:"getFaceList",value:function(){return Ka(this)[Ji]().map(Qa)}},{key:"getHalfEdgeList",value:function(){return Ka(this)[Qi]().map(Qa)}},{key:"getEdgeList",value:function(){return Ka(this)[Zi]().map(Qa)}}]),n}(_i),to="if",eo="af",no="iv",ro="av",io="ih",ao="ah",oo=new WeakMap,so=function(t){return oo.get(t)},co=function(t,e,n,r,i,a,o,s){Object(qe["a"])(u,t);var c=Object(Je["a"])(u);function u(t,e,n){var r;return Object(ct["a"])(this,u),r=c.call(this,t,e),oo.set(t,Object(sn["a"])(r)),r.$=t,r[io]=n,n[Va]=n[Ga][Va]=Object(sn["a"])(r),r[Bi](),r}return Object(ut["a"])(u,[{key:e,value:function(){this[Ri][ea].add(this)}},{key:n,value:function(){this[io]=null}},{key:r,get:function(){return this[io][za]}},{key:i,get:function(){return this[ao][za]}},{key:a,get:function(){return this[io][Ba]}},{key:o,get:function(){return this[ao][Ba]}},{key:s,get:function(){return this[io][Ga]}}]),u}(Gi,zi,Vi,to,eo,no,ro,ao),uo=(n("a939"),function(t){Object(qe["a"])(n,t);var e=Object(Je["a"])(n);function n(t,r){var i;return Object(ct["a"])(this,n),i=e.call(this),new co(Object(sn["a"])(i),t,r),Object.freeze(Object(sn["a"])(i)),i}return Object(ut["a"])(n,[{key:"thisFace",get:function(){return so(this)[to].$}},{key:"thatFace",get:function(){return so(this)[eo].$}},{key:"thisVertex",get:function(){return so(this)[no].$}},{key:"thatVertex",get:function(){return so(this)[ro].$}},{key:"thisHalfEdge",get:function(){return so(this)[io].$}},{key:"thatHalfEdge",get:function(){return so(this)[ao].$}}]),n}(_i)),lo="f",ho="o",fo="i",po="H",vo="C",yo="O",go="P",bo=new WeakMap,mo=function(t){return bo.get(t)},$o=function(t,e,n,r,i,a,o,s,c){Object(qe["a"])(l,t);var u=Object(Je["a"])(l);function l(t,e,n){var r;return Object(ct["a"])(this,l),r=u.call(this,t,e),bo.set(t,Object(sn["a"])(r)),r.$=t,r[lo]=n,r}return Object(ut["a"])(l,[{key:e,get:function(){return this[Ri][Oa](this[lo].outerComponent)}},{key:n,get:function(){return this[lo].innerComponents.map(this[Ri][Oa])}},{key:r,value:function(){var t=this[Ri];t[ra].add(this),t[oa].set(this[lo],this)}},{key:i,value:function(){this[lo]=null}},{key:a,value:function(){return p.getPathOfHalfEdge(this[lo].outerComponent)}},{key:o,value:function(){return this[po]().map(this[Ri][Oa])}},{key:s,value:function(){return p.queryChildFaceList(this[lo]).map(this[Ri][xa])}},{key:c,value:function(t,e){var n=p.getPolygonFromFaceOuter(this[lo]);return h.containsPoint(n,{x:t,y:e})}}]),l}(Gi,ho,fo,zi,Vi,po,yo,vo,go),Oo=function(t){Object(qe["a"])(n,t);var e=Object(Je["a"])(n);function n(t,r){var i;return Object(ct["a"])(this,n),i=e.call(this),new $o(Object(sn["a"])(i),t,r),Object.freeze(Object(sn["a"])(i)),i}return Object(ut["a"])(n,[{key:"outerHalfEdge",get:function(){return mo(this)[ho].$}},{key:"innerHalfEdgeList",get:function(){return mo(this)[fo].map(Qa)}},{key:"getChildFaceList",value:function(){return mo(this)[vo]().map(Qa)}},{key:"getOuterHalfEdgeList",value:function(){return mo(this)[yo]().map(Qa)}},{key:"containsPoint",value:function(t,e){return mo(this)[go](t,e)}}]),n}(_i),xo=function(t){return new Oo(t,p.createGlobalFace())},wo=new WeakMap,jo=function(t){return wo.get(t)},ko=function(t,e,n,r,i,a,o,s,c,u){Object(qe["a"])(h,t);var l=Object(Je["a"])(h);function h(t,e,n){var r;return Object(ct["a"])(this,h),r=l.call(this,t,e),wo.set(t,Object(sn["a"])(r)),r.$=t,r[Ha]=n,r[Va]=null,r[zi](),r}return Object(ut["a"])(h,[{key:e,value:function(){this[Ri][sa].set(this[Ha],this)}},{key:n,value:function(){this[Ha]=null,this[Va]=null}},{key:r,get:function(){return this[Ha].twin}},{key:i,get:function(){return this[Ri][$a](this[Ha].origin)}},{key:a,get:function(){return this[Ri][xa](this[Ha].incidentFace)}},{key:o,get:function(){return this[Ri][Oa](this[Ha].next)}},{key:s,get:function(){return this[Ri][Oa](this[Ha].previous)}},{key:c,get:function(){return this[Ri][Oa](this[Ma])}},{key:u,value:Object(ge["a"])().mark((function t(){var e,n,r,i;return Object(ge["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=this[Ri][Oa],n=Object(je["a"])(p.Iterator.allHalfEdgeOfPath(this[Ha])),t.prev=2,n.s();case 4:if((r=n.n()).done){t.next=10;break}return i=r.value,t.next=8,e(i);case 8:t.next=4;break;case 10:t.next=15;break;case 12:t.prev=12,t.t0=t["catch"](2),n.e(t.t0);case 15:return t.prev=15,n.f(),t.finish(15);case 18:case"end":return t.stop()}}),t,this,[[2,12,15,18]])}))}]),h}(Gi,zi,Vi,Ma,Ba,za,Ua,Ya,Ga,_a),To=function(t){Object(qe["a"])(n,t);var e=Object(Je["a"])(n);function n(t,r){var i;return Object(ct["a"])(this,n),i=e.call(this),new ko(Object(sn["a"])(i),t,r),Object.freeze(Object(sn["a"])(i)),i}return Object(ut["a"])(n,[{key:"vertex",get:function(){return jo(this)[Ba].$}},{key:"edge",get:function(){return jo(this)[Va].$}},{key:"face",get:function(){return jo(this)[za].$}},{key:"next",get:function(){return jo(this)[Ua].$}},{key:"previous",get:function(){return jo(this)[Ya].$}},{key:"back",get:function(){return jo(this)[Ga].$}},{key:"path",value:Object(ge["a"])().mark((function t(){var e,n,r;return Object(ge["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=Object(je["a"])(jo(this)[_a]()),t.prev=1,e.s();case 3:if((n=e.n()).done){t.next=9;break}return r=n.value,t.next=7,r.$;case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](1),e.e(t.t0);case 14:return t.prev=14,e.f(),t.finish(14);case 17:case"end":return t.stop()}}),t,this,[[1,11,14,17]])}))}]),n}(_i),Eo=new WeakMap,So=function(t){return Eo.get(t)},Co=function(t,e,n,r,i,a,o,s,c,u,l,h,f,d,v,y,g,b,m){function $(t){var e;Object(ct["a"])(this,$),Eo.set(t,this),this.$=t,this[ea]=new Set,this[na]=new Set;var n=this[aa]=new Map,r=this[ia]=mo(xo(this));this[ra]=new Set;var i=this[oa]=new Map,a=this[sa]=new Map;this[Oa]=function(t){return a.get(t)};var o=r[lo];this[xa]=function(t){return o===t?r:i.get(t)},this[$a]=function(t){return n.get(t)},this[Pa]=(e={},Object(lt["a"])(e,La,ft["e"]),Object(lt["a"])(e,Da,ft["e"]),Object(lt["a"])(e,Aa,ft["e"]),Object(lt["a"])(e,Na,ft["e"]),Object(lt["a"])(e,Fa,ft["e"]),Object(lt["a"])(e,Wa,ft["e"]),Object(lt["a"])(e,Ia,ft["e"]),Object(lt["a"])(e,Ra,ft["e"]),e)}return Object(ut["a"])($,[{key:t,value:function(t,e){var n=new Za(this,t,e);return this[Pa][La](n),n}},{key:e,value:function(t,e,n){t[ta](e,n)}},{key:n,value:function(t,e){var n=this[ia][lo],r=t[Xi],i=e[Xi],a=Si(r,i,n),o=a.twin,s=a.incidentFace,c=o.incidentFace;if(s!==c){var u=this[xa](s)?c:s,l=new Oo(this,u);mo(l)[Bi](),this[Pa][Fa](l)}var h=new To(this,a),f=new To(this,o),d=new uo(this,jo(h));return this[Pa][Ia](h),this[Pa][Ia](f),this[Pa][Aa](d),d}},{key:r,value:function(t,e){var n=p.splitHalfEdgeByVertex(t[io][Ha],e[Xi]),r=t[io][Ma],i=new To(this,n),a=new To(this,r),o=new uo(this,jo(i));return t[ao][Va]=t,this[Pa][Ia](i),this[Pa][Ia](a),this[Pa][Aa](o),o}},{key:i,value:function(t){var e=t[Xi],n=p.getVertexHalfEdgeList(e);2!==n.length&&ft["c"].throwError("The MeshHalfEdge number of this MeshVertex is NOT 2.");var r=this[Oa](e.incidentEdge.twin.next)[Va],i=this[Oa](e.incidentEdge)[Va],a=this[Oa](Fi(e));a[Ga][Va]=i,i[io]=a,r[io]=n[0];var o,s=Object(je["a"])(n);try{for(s.s();!(o=s.n()).done;){var c=o.value;this[Oa](c)[Va]=r}}catch(u){s.e(u)}finally{s.f()}return this[Sa](),this[aa].delete(t[Xi]),this[na].delete(t),this[Pa][Da](t.$),i}},{key:a,value:function(t){var e=t[io],n=e[Ha],r=Ii(n);return this[Ea](),this[Sa](),this[Ca](),this[$a](r)}},{key:o,value:function(t){Ai(t[Xi]),this[Sa](),this[Ca]()}},{key:s,value:function(t){this[pa](t),t[Hi](),this[aa].delete(t[Xi]),this[na].delete(t),this[Pa][Da](t.$)}},{key:c,value:function(t){Di(t[io][Ha]),this[Sa](),this[Ca]()}},{key:u,value:function(t){return this[na].has(t)}},{key:l,value:function(t){return this[ea].has(t)}},{key:h,value:function(t){return this[ra].has(t)}},{key:f,value:function(){return Array.from(this[ea])}},{key:d,value:function(){return Array.from(this[ra])}},{key:v,value:function(){return Array.from(this[na])}},{key:y,value:function(t,e){var n=this[ia],r=n[lo],i=p.getFaceOfPoint(r,{x:t,y:e});return i===r?n:this[xa](i)}},{key:g,value:function(){var t,e=this[aa],n=this[na],r=[],i=Object(je["a"])(e);try{for(i.s();!(t=i.n()).done;){var a=Object(re["a"])(t.value,2),o=a[0],s=a[1];ft["h"].isNull(o.incidentEdge)&&(n.delete(s),s[Hi](),r.push(o),this[Pa][Da](s.$))}}catch(h){i.e(h)}finally{i.f()}for(var c=0,u=r;c<u.length;c++){var l=u[c];e.delete(l)}}},{key:b,value:function(){var t,e=this[sa],n=this[ea],r=[],i=new Set,a=Object(je["a"])(e);try{for(a.s();!(t=a.n()).done;){var o=Object(re["a"])(t.value,2),s=o[0],c=o[1];if(ft["h"].isNull(s.twin)){var u=c[Va];n.delete(u),u[Hi](),c[Hi](),r.push(s),i.add(u),this[Pa][Ra](c.$)}}}catch(y){a.e(y)}finally{a.f()}for(var l=0,h=r;l<h.length;l++){var f=h[l];e.delete(f)}var d,p=Object(je["a"])(i);try{for(p.s();!(d=p.n()).done;){var v=d.value;this[Pa][Na](v.$)}}catch(y){p.e(y)}finally{p.f()}}},{key:m,value:function(){var t,e=this[oa],n=this[ra],r=[],i=Object(je["a"])(e);try{for(i.s();!(t=i.n()).done;){var a=Object(re["a"])(t.value,2),o=a[0],s=a[1];ft["h"].isNull(o.outerComponent)&&(n.delete(s),s[Hi](),r.push(o),this[Pa][Wa](s.$))}}catch(h){i.e(h)}finally{i.f()}for(var c=0,u=r;c<u.length;c++){var l=u[c];e.delete(l)}}}]),$}(ca,ua,la,ha,fa,da,pa,va,ya,ga,ba,ma,ja,Ta,ka,wa,Ea,Sa,Ca),Po=function(){function t(){Object(ct["a"])(this,t),new Co(this),ft["f"].seal(this)}return Object(ut["a"])(t,[{key:"globalFace",get:function(){return So(this)[ia].$}},{key:"createVertex",value:function(t,e){return ft["h"].Not.Number(t)&&ft["c"].throwError("The `x` MUST be a number."),ft["h"].Not.Number(e)&&ft["c"].throwError("The `y` MUST be a number."),So(this)[ca](t,e)}},{key:"moveVertex",value:function(t,e,n){ft["c"].instanceOf(t,Za)||ft["c"].Throw.TypeError("The `vertex` MUST be a MeshVertex."),ft["h"].Not.Number(e)&&ft["c"].Throw.TypeError("Vertex.x MUST be a number."),ft["h"].Not.Number(n)&&ft["c"].Throw.TypeError("Vertex.y MUST be a number.");var r=So(this),i=Ka(t);return r[ga](i)||ft["c"].throwError("The `vertex` does NOT belong to this mesh."),r[ua](i,e,n)}},{key:"link",value:function(t,e){ft["c"].instanceOf(t,Za)||ft["c"].Throw.TypeError("The `thisVertex` MUST be a MeshVertex."),ft["c"].instanceOf(e,Za)||ft["c"].Throw.TypeError("The `thatVertex` MUST be a MeshVertex."),t===e&&ft["c"].throwError("The `thisVertex` MUST be NOT `thatVertex`.");var n=So(this),r=Ka(t),i=Ka(e);return n[ga](r)||ft["c"].throwError("The `thisVertex` does NOT belong to this mesh."),n[ga](i)||ft["c"].throwError("The `thatVertex` does NOT belong to this mesh."),n[la](r,i)}},{key:"split",value:function(t,e){ft["c"].instanceOf(t,uo)||ft["c"].Throw.TypeError("The `edge` MUST be a MeshEdge."),ft["c"].instanceOf(e,Za)||ft["c"].Throw.TypeError("The `vertex` MUST be a MeshVertex.");var n=So(this),r=so(t),i=Ka(e);return n[ba](r)||ft["c"].throwError("The `edge` does NOT belong to this mesh."),n[ga](i)||ft["c"].throwError("The `vertex` does NOT belong to this mesh."),n[ha](r,i)}},{key:"merge",value:function(t){ft["c"].instanceOf(t,Za)||ft["c"].Throw.TypeError("The `vertex` MUST be a MeshVertex.");var e=So(this)[fa](Ka(t));return ft["h"].isNull(e)?null:e.$}},{key:"combine",value:function(t){ft["c"].instanceOf(t,uo)||ft["c"].Throw.TypeError("The `edge` MUST be a MeshEdge.");var e=So(this)[da](so(t));return ft["h"].isUndefined(e)?null:e.$}},{key:"clearVertex",value:function(t){ft["c"].instanceOf(t,Za)||ft["c"].Throw.TypeError("The `vertex` MUST be a MeshVertex.");var e=So(this),n=Ka(t);e[ga](n)||ft["c"].throwError("The `vertex` does NOT belong to this mesh."),e[pa](n)}},{key:"removeVertex",value:function(t){ft["c"].instanceOf(t,Za)||ft["c"].Throw.TypeError("The `vertex` MUST be a MeshVertex.");var e=So(this),n=Ka(t);e[ga](n)||ft["c"].throwError("The `vertex` does NOT belong to this mesh."),e[va](n)}},{key:"removeEdge",value:function(t){ft["c"].instanceOf(t,uo)||ft["c"].Throw.TypeError("The `edge` MUST be a MeshEdge.");var e=So(this),n=so(t);e[ba](n)||ft["c"].throwError("The `edge` does NOT belong to this mesh."),e[ya](n)}},{key:"getAllVertexList",value:function(){return So(this)[ka]().map(Qa)}},{key:"getAllEdgeList",value:function(){return So(this)[ja]().map(Qa)}},{key:"getAllFaceList",value:function(){return So(this)[Ta]().map(Qa)}},{key:"hasVertex",value:function(t){return ft["c"].instanceOf(t,Za)||ft["c"].Throw.TypeError("The `vertex` MUST be a MeshVertex."),So(this)[ga](Ka(t))}},{key:"hasEdge",value:function(t){return ft["c"].instanceOf(t,uo)||ft["c"].Throw.TypeError("The `edge` MUST be a MeshEdge."),So(this)[ba](so(t))}},{key:"hasFace",value:function(t){return ft["c"].instanceOf(t,Oo)||ft["c"].Throw.TypeError("The `face` MUST be a MeshFace."),So(this)[ma](mo(t))}},{key:"getFaceOfPoint",value:function(t,e){return ft["h"].Not.Number(t)&&ft["c"].Throw.TypeError("The `x` MUST be a number."),ft["h"].Not.Number(e)&&ft["c"].Throw.TypeError("The `y` MUST be a number."),So(this)[wa](t,e).$}},{key:"flush",value:function(){var t=So(this);t[Ea](),t[Sa](),t[Ca]()}},{key:"flushVertex",value:function(){So(this)[Ea]()}}]),t}(),Lo=function(){var t=Object(re["a"])(Ao[Do],2),e=t[0],n=t[1];ft["f"].defineProperty(Po.prototype,e,{get:function(){return So(this)[Pa][n]},set:function(t){ft["h"].Not.Function(t)&&ft["c"].Throw.TypeError("listener MUST be a function."),So(this)[Pa][n]=t}})},Do=0,Ao=[["onVertexCreate",La],["onVertexDestroy",Da],["onEdgeCreate",Aa],["onEdgeDestroy",Na],["onFaceCreate",Fa],["onFaceDestroy",Wa],["onHalfEdgeCreate",Ia],["onHalfEdgeDestroy",Ra]];Do<Ao.length;Do++)Lo();function No(){return{mesh:new Po,vertexToCorner:new Map,edgeToWall:new Map,faceToRoom:new Map,halfEdgeToSurface:new Map}}var Fo=x.define({options:wi,data:No,proxy:b.Proxy.Creator(mi),created:function(){var t=this,e=this.$data,n=e.mesh,r=e.vertexToCorner,i=e.edgeToWall,a=e.halfEdgeToSurface,o=e.faceToRoom;n.onFaceCreate=function(e){return t.$createElement("Room",e)},n.onEdgeCreate=function(e){return t.$createElement("Wall",e)},n.onVertexCreate=function(e){return t.$createElement("Corner",e)},n.onHalfEdgeCreate=function(e){return t.$createElement("Surface",e)},n.onFaceDestroy=function(t){o.get(t).$destroy(),o.delete(t)},n.onVertexDestroy=function(t){r.get(t).$destroy(),r.delete(t)},n.onEdgeDestroy=function(t){i.get(t).$destroy(),i.delete(t)},n.onHalfEdgeDestroy=function(t){a.get(t).$destroy(),a.delete(t)},this.$on("element-created",(function(e,n){t.$emit("".concat(n.toLowerCase(),"-created"),e)}));var s=this.$options.snap;this.$drawing.registerSnap({name:"structure-corner",get priority(){return s.corner.priority},get active(){return s.corner.active},handle:function(e,n,i){var a,o=Object(je["a"])(r);try{for(o.s();!(a=o.n()).done;){var u=Object(re["a"])(a.value,1),l=u[0],h=t.$toCanvas(l.x,l.y),f=c.distanceToPoint.apply(c,[e,n].concat(Object(ht["a"])(h)));if(f<s.corner.maxDistance)return i.apply(void 0,Object(ht["a"])(h))}}catch(d){o.e(d)}finally{o.f()}}})},methods:{assertNoCornerAt:function(t,e){this.queryCorner(t,e)&&ft["c"].throwError("It could NOT create a new `Corner` in same place")},createCorner:function(t,e){this.assertNoCornerAt(t,e);var n=this.$data,r=n.mesh,i=n.vertexToCorner;return i.get(r.createVertex(t,e))},removeCorner:function(t){return t.remove()},createWall:function(t,e){var n=this.$data,r=n.mesh,i=n.edgeToWall;return i.get(r.link(t.vertex,e.vertex))},removeWall:function(t){return t.remove()},removeWallSimple:function(t){return t.removeSimple()},split:function(t,e,n,r){this.assertNoCornerAt(e,n);var i=t.thisSurface.corner,a=t.thatSurface.corner,o=this.createCorner(e,n),s=this.$data.mesh.split(t.$state.edge,o.vertex),c=this.$data.edgeToWall.get(s);return c.setThickness(t.$state.thickness),i.updateSurfaces(),a.updateSurfaces(),o.updateSurfaces(),r(c,t,o),o},merge:function(t){var e=this.$data,n=e.mesh,r=e.edgeToWall,i=n.merge(t.$state.vertex),a=r.get(i);return a.thisSurface.corner.updateSurfaces(),a.thatSurface.corner.updateSurfaces(),a},combine:function(t){var e=this.$data,n=e.mesh,r=e.vertexToCorner,i=n.combine(t.$state.edge),a=r.get(i);return a.updateAllSiblingSurface(),a},queryCorner:function(t,e){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=Object(je["a"])(this.$data.vertexToCorner);try{for(i.s();!(n=i.n()).done;){var a=Object(re["a"])(n.value,2),s=a[0],c=a[1],u=o.fromBothPoint(s.x,s.y,t,e);if(o.length.apply(o,Object(ht["a"])(u))<r)return c}}catch(l){i.e(l)}finally{i.f()}return null},queryWallByFromTo:function(t,e){return t.getWallByToCorner(e)},getRoomOfPoint:function(t,e){var n=this.$data,r=n.mesh,i=n.faceToRoom;return i.get(r.getFaceOfPoint(t,e))}}}),Wo=function(t){return t.back.vertex},Io=function(t){return t.updateSurfaces()};function Ro(t){return this.get(t)}var Mo,Ho,Bo,Vo,zo,Uo=x.Element.define({proxy:b.Proxy.Creator(yi),groupIndex:1e3,interative:!0,focusable:!0,hoverable:!0,render:function(t){var e=this.$plugin.$options.corner.style,n=e.color,r=e.opacity,i=e.radius,a=e.hover,o=this.$state.vertex,s=o.x,c=o.y,u=this.$toCanvas(s,c),l=Object(re["a"])(u,2),h=l[0],f=l[1];this.$hovering?t.beginFill(a.color,a.opacity):t.beginFill(n,r),t.drawCircle(0,0,i).endFill(),t.x=h,t.y=f,this.$state.rendering&&(this.$emit("change",this.$proxy),this.setRendering(!1))},created:function(t){this.$data.vertexToCorner.set(this.$state.vertex=t,this)},state:function(){return{vertex:null,point:[0,0],rendering:!1}},getters:{x:function(){return this.vertex.x},y:function(){return this.vertex.y},point:function(){var t=this.vertex,e=t.x,n=t.y,r=this.$state.point;return r[0]=e,r[1]=n,r},vertex:function(){return this.$state.vertex},size:function(){return this.$state.vertex.size},destroyed:function(){return this.$state.vertex.destroyed}},methods:{move:function(t,e){var n=this.$plugin.queryCorner(t,e);ft["h"].Not.Null(n)&&n!==this&&ft["c"].throwError("It could NOT move the Corner to the same <".concat(t,", ").concat(e,"> place.")),this.$state.vertex.move(t,e),this.updateAllSiblingSurface(),this.$setDirty(),this.setRendering(!0)},remove:function(){var t=this.$state.vertex,e=this.$data,n=e.mesh,r=e.vertexToCorner,i=t.getHalfEdgeList().map(Wo).map(Ro,r);n.removeVertex(t);var a,o=Object(je["a"])(i);try{for(o.s();!(a=o.n()).done;){var s=a.value;s.updateSurfaces()}}catch(c){o.e(c)}finally{o.f()}return this},surfaces:Object(ge["a"])().mark((function t(){var e,n,r;return Object(ge["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=Object(je["a"])(this.$state.vertex.halfEdges()),t.prev=1,e.s();case 3:if((n=e.n()).done){t.next=9;break}return r=n.value,t.next=7,this.$data.halfEdgeToSurface.get(r);case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](1),e.e(t.t0);case 14:return t.prev=14,e.f(),t.finish(14);case 17:case"end":return t.stop()}}),t,this,[[1,11,14,17]])})),getWallByToCorner:function(t){var e,n=Object(je["a"])(this.surfaces());try{for(n.s();!(e=n.n()).done;){var r=e.value;if(r.back.corner===t)return r.wall}}catch(i){n.e(i)}finally{n.f()}return null},getAdjacentCornerList:function(){return this.$state.vertex.getHalfEdgeList().map(Wo).map(Ro,this.$data.vertexToCorner)},updateAllSiblingSurface:function(){this.getAdjacentCornerList().concat([this]).forEach(Io)},updateSurfaces:function(){var t,e=Object(je["a"])(this.surfaces());try{for(e.s();!(t=e.n()).done;){var n=t.value;n.update()}}catch(r){e.e(r)}finally{e.f()}},setRendering:function(t){this.$state.rendering=t}}},Fo),Yo=x.Element.define({proxy:b.Proxy.Creator(bi),groupIndex:900,interative:!0,focusable:!0,hoverable:!0,render:function(t){var e,n,r=this.$plugin.$options.wall,i=r.midline,a=r.style,o=a.hoverColor,s=this.$state.edge,c=s.thisVertex,u=s.thatVertex,l=[c.x,c.y],h=[u.x,u.y],f=this.$state.color||a.color;(t.beginFill(this.$hovering?o:f),this.drawPolygon(t),t.endFill(),i.show)&&(e=(n=t.lineStyle(i.width,i.color)).moveTo.apply(n,Object(ht["a"])(this.$toCanvas.apply(this,l)))).lineTo.apply(e,Object(ht["a"])(this.$toCanvas.apply(this,h)));this.$state.rendering&&(this.$emit("change",this.$proxy),this.setRendering(!1))},created:function(t){var e=this,n=t.thisVertex,r=t.thatVertex,i=this.$data,a=i.edgeToWall,o=i.vertexToCorner;a.set(this.$state.edge=t,this),o.get(n).updateSurfaces(),o.get(r).updateSurfaces(),this.$on("dirty",(function(){if(!t.destroyed){var n=e.thisSurface,r=e.thatSurface,i=n.room,a=r.room;ft["h"].Not.Null(i)&&i.$setDirty(),ft["h"].Not.Null(a)&&a.$setDirty(),n.emitChange(),r.emitChange()}}))},state:function(){return{type:0,thickness:200,edge:null,rendering:!1,color:null}},getters:{thisSurface:function(){return this.$data.halfEdgeToSurface.get(this.$state.edge.thisHalfEdge)},thatSurface:function(){return this.$data.halfEdgeToSurface.get(this.$state.edge.thatHalfEdge)},segment:function(){var t=this.$state.edge,e=t.thisVertex,n=t.thatVertex;return i.Segment(e.x,e.y,n.x,n.y)}},methods:{drawPolygon:function(t){var e=this.$state.edge,n=e.thisVertex,r=e.thatVertex,i=[n.x,n.y],a=[r.x,r.y],o=this.thisSurface,s=this.thatSurface;t.drawPolygon.apply(t,Object(ht["a"])(this.$toCanvas.apply(this,i)).concat(Object(ht["a"])(this.$toCanvas.apply(this,Object(ht["a"])(o.origin))),Object(ht["a"])(this.$toCanvas.apply(this,Object(ht["a"])(o.target))),Object(ht["a"])(this.$toCanvas.apply(this,a)),Object(ht["a"])(this.$toCanvas.apply(this,Object(ht["a"])(s.origin))),Object(ht["a"])(this.$toCanvas.apply(this,Object(ht["a"])(s.target)))))},setThickness:function(t){this.$state.thickness=t,this.thisSurface.corner.updateSurfaces(),this.thatSurface.corner.updateSurfaces(),this.$setDirty(),this.setRendering(!0)},remove:function(){var t=this.thisSurface.corner,e=this.thatSurface.corner;this.removeSimple();for(var n=0,r=[t,e];n<r.length;n++){var i=r[n];0===i.size?i.remove():i.updateSurfaces()}return this.$proxy},removeSimple:function(){return this.$data.mesh.removeEdge(this.$state.edge),this.$proxy},setColor:function(t){this.$state.color=t,this.$setDirty()},setRendering:function(t){this.$state.rendering=t}}},Fo),Go=(n("fb6a"),function(t){Object(qe["a"])(n,t);var e=Object(Je["a"])(n);function n(){return Object(ct["a"])(this,n),e.apply(this,arguments)}return Object(ut["a"])(n,[{key:"back",get:function(){return Ur(this).back.$proxy}},{key:"previous",get:function(){return Ur(this).previous.$proxy}},{key:"next",get:function(){return Ur(this).next.$proxy}},{key:"corner",get:function(){return Ur(this).corner.$proxy}},{key:"wall",get:function(){return Ur(this).wall.$proxy}},{key:"room",get:function(){var t=Ur(this).room;return t?t.$proxy:null}},{key:"origin",get:function(){return Ur(this).origin}},{key:"target",get:function(){return Ur(this).target}},{key:"originSafe",get:function(){return this.origin.slice(0)}},{key:"targetSafe",get:function(){return this.target.slice(0)}},{key:"path",value:Object(ge["a"])().mark((function t(){var e,n,r;return Object(ge["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=Object(je["a"])(Ur(this).path()),t.prev=1,e.s();case 3:if((n=e.n()).done){t.next=9;break}return r=n.value,t.next=7,r.$proxy;case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](1),e.e(t.t0);case 14:return t.prev=14,e.f(),t.finish(14);case 17:case"end":return t.stop()}}),t,this,[[1,11,14,17]])}))}]),n}(b.Proxy.Element)),_o=function(t,e,n){n[0]=t,n[1]=e},Xo=x.Element.define({proxy:b.Proxy.Creator(Go),groupIndex:920,state:function(){return{halfEdge:null,origin:[0,0],target:[0,0],normal:Object(ht["a"])(i.Vector(0,0)),translation:Object(ht["a"])(i.Vector(0,0)),line:Object(ht["a"])(i.Line(0,0,0,0))}},render:function(t){var e,n,r,i=this.$state,a=i.origin,o=i.target;(e=(n=(r=t.lineStyle(1.5,2236962)).moveTo.apply(r,Object(ht["a"])(this.$toCanvas.apply(this,Object(ht["a"])(a))))).lineTo.apply(n,Object(ht["a"])(this.$toCanvas.apply(this,Object(ht["a"])(o))))).lineTo.apply(e,Object(ht["a"])(this.$toCanvas.apply(this,Object(ht["a"])(this.next.origin))))},created:function(t){this.$data.halfEdgeToSurface.set(this.$state.halfEdge=t,this)},getters:{next:function(){return this.$data.halfEdgeToSurface.get(this.$state.halfEdge.next)},previous:function(){return this.$data.halfEdgeToSurface.get(this.$state.halfEdge.previous)},back:function(){return this.$data.halfEdgeToSurface.get(this.$state.halfEdge.back)},corner:function(){return this.$data.vertexToCorner.get(this.$state.halfEdge.vertex)},wall:function(){return this.$data.edgeToWall.get(this.$state.halfEdge.edge)},room:function(){var t=this.$state.halfEdge.face,e=this.$data.faceToRoom.get(t);return ft["h"].isUndefined(e)?null:e},origin:function(){return this.$state.origin},target:function(){return this.$state.target}},methods:{setOrigin:function(t,e){return _o(t,e,this.$state.origin),this.$setDirty(),this},setTarget:function(t,e){return _o(t,e,this.$state.target),this.$setDirty(),this},path:Object(ge["a"])().mark((function t(){var e,n,r;return Object(ge["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=Object(je["a"])(this.$state.halfEdge.path()),t.prev=1,e.s();case 3:if((n=e.n()).done){t.next=9;break}return r=n.value,t.next=7,this.$data.halfEdgeToSurface.get(r);case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](1),e.e(t.t0);case 14:return t.prev=14,e.f(),t.finish(14);case 17:case"end":return t.stop()}}),t,this,[[1,11,14,17]])})),getLine:function(){var t=this.$state,e=t.normal,n=t.line,r=t.translation,a=this.wall.$state.thickness/2,s=this.corner.point,u=this.next.corner.point;return ft["f"].assign(e,o.rotate90.apply(o,Object(ht["a"])(o.normalize.apply(o,Object(ht["a"])(o.fromBothPoint.apply(o,Object(ht["a"])(s).concat(Object(ht["a"])(u)))))))),ft["f"].assign(r,o.multiply.apply(o,Object(ht["a"])(e).concat([a]))),ft["f"].assign(n,i.Line.apply(i,Object(ht["a"])(c.translate.apply(c,Object(ht["a"])(s).concat(Object(ht["a"])(r)))).concat(Object(ht["a"])(e))))},update:function(){this.updateSelf(),this.back.updateSelf(),this.wall.$setDirty()},updateSelf:function(){var t=this.$state,e=t.origin,n=t.target,r=t.translation,i=this.getLine(),a=s.intersectLine.apply(s,Object(ht["a"])(i).concat(Object(ht["a"])(this.previous.getLine())));ft["f"].assign(e,ft["h"].isNull(a)?c.translate.apply(c,Object(ht["a"])(this.corner.point).concat(Object(ht["a"])(r))):a);var o=s.intersectLine.apply(s,Object(ht["a"])(i).concat(Object(ht["a"])(this.next.getLine())));ft["f"].assign(n,ft["h"].isNull(o)?c.translate.apply(c,Object(ht["a"])(this.next.corner.point).concat(Object(ht["a"])(r))):o),this.$setDirty()},emitChange:function(){this.$emit("change")}}},Fo),Ko=function(t){Object(qe["a"])(n,t);var e=Object(Je["a"])(n);function n(){return Object(ct["a"])(this,n),e.apply(this,arguments)}return Object(ut["a"])(n,[{key:"area",get:function(){return Ur(this).area}},{key:"bounds",get:function(){return Ur(this).$getBounds()}},{key:"floorUrl",get:function(){return Ur(this).floorUrl}},{key:"setFloor",value:function(t){return Ur(this).setFloor(t)}},{key:"getOuterSurfaceList",value:function(){return Ur(this).getOuterSurfaceList()}}]),n}(b.Proxy.Element),qo=ln,Jo=x.Element.define({proxy:b.Proxy.Creator(Ko),groupIndex:800,interative:!0,focusable:!0,hoverable:!0,render:function(t){if(this.$plugin.$options.room.show){var e,n,r=this.$state.textureOptions,i=this.$drawing,a=i.origin,o=i.scale,s=[],c=Object(je["a"])(this.outerSurface.path());try{for(c.s();!(e=c.n()).done;){var u=e.value;s.push.apply(s,Object(ht["a"])(this.$toCanvas.apply(this,Object(ht["a"])(u.origin))).concat(Object(ht["a"])(this.$toCanvas.apply(this,Object(ht["a"])(u.target)))))}}catch(m){c.e(m)}finally{c.f()}if(ft["h"].Not.Null(r.texture))(n=r.matrix).set.apply(n,[5/o,0,0,5/o].concat(Object(ht["a"])(a))),t.beginTextureFill(r);else t.beginFill(16777215,.01);t.drawPolygon(s).beginHole();var l,h=Object(je["a"])(this.innerSurfaceList);try{for(h.s();!(l=h.n()).done;){var f,d=l.value,p=[],v=Object(je["a"])(d.path());try{for(v.s();!(f=v.n()).done;){var y=f.value,g=y.origin,b=y.target;p.push.apply(p,Object(ht["a"])(this.$toCanvas.apply(this,Object(ht["a"])(g))).concat(Object(ht["a"])(this.$toCanvas.apply(this,Object(ht["a"])(b)))))}}catch(m){v.e(m)}finally{v.f()}t.drawPolygon.apply(t,p)}}catch(m){h.e(m)}finally{h.f()}}},state:function(){return{face:null,textureOptions:{url:"",texture:null,matrix:new qo.Matrix}}},created:function(t){this.$data.faceToRoom.set(this.$state.face=t,this)},getters:{outerSurface:function(){return this.toSurface(this.$state.face.outerHalfEdge)},innerSurfaceList:function(){return this.$state.face.innerHalfEdgeList.map(this.toSurface,this)},area:function(){var t,e=this.areaOfSurface(this.outerSurface),n=Object(je["a"])(this.innerSurfaceList);try{for(n.s();!(t=n.n()).done;){var r=t.value;e-=this.areaOfSurface(r)}}catch(i){n.e(i)}finally{n.f()}return e},floorUrl:function(){return this.$state.textureOptions.url}},methods:{areaOfSurface:function(t){var e,n=[],r=Object(je["a"])(t.path());try{for(r.s();!(e=r.n()).done;){var i=e.value,a=i.origin,o=i.target;n.push.apply(n,Object(ht["a"])(a).concat(Object(ht["a"])(o)))}}catch(s){r.e(s)}finally{r.f()}return ft["d"].abs(h.area.apply(h,n))},toSurface:function(t){return this.$data.halfEdgeToSurface.get(t)},setFloor:function(){var t=arguments,e=this;return Object(ri["a"])(Object(ge["a"])().mark((function n(){var r;return Object(ge["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(r=t.length>0&&void 0!==t[0]?t[0]:null,e.$state.textureOptions.url=r,!r){n.next=8;break}return n.next=5,qo.Texture.fromURL(r);case 5:n.t0=n.sent,n.next=9;break;case 8:n.t0=r;case 9:e.$state.textureOptions.texture=n.t0,e.$setDirty();case 11:case"end":return n.stop()}}),n)})))()},getOuterSurfaceList:function(){var t=this.$data.halfEdgeToSurface,e=this.$state.face;return e.getOuterHalfEdgeList().map((function(e){return t.get(e).$proxy}))}}},Fo),Qo="com.3dnest.spoke.structure",Zo="structure",ts=w.define({id:Qo,namespace:Zo,version:vi["a"],plugin:Fo,elements:{Corner:Uo,Wall:Yo,Surface:Xo,Room:Jo}}),es=function(t){Object(qe["a"])(n,t);var e=Object(Je["a"])(n);function n(){return Object(ct["a"])(this,n),e.apply(this,arguments)}return Object(ut["a"])(n,[{key:"Builder",get:function(){return Ur(this).$data.builder}},{key:"Mover",get:function(){return Ur(this).$data.mover}},{key:"Spliter",get:function(){return Ur(this).$data.spliter}},{key:"Extender",get:function(){return Ur(this).$data.extender}},{key:"Chamber",get:function(){return Ur(this).$data.chamber}}]),n}(b.Proxy.Plugin),ns=b.Options.define,rs=ns({},{spliter:ns({},{interaction:ns({distance:50})})}),is=x.define({options:rs,proxy:b.Proxy.Creator(es),data:function(){return{builder:null,mover:null,spliter:null,extender:null,chamber:null}},created:function(){ft["f"].assign(this.$data,{builder:this.$createTool("Builder"),mover:this.$createTool("Mover"),spliter:this.$createTool("Spliter"),extender:this.$createTool("Extender"),chamber:this.$createTool("Chamber")})}}),as=5,os=65280,ss={left:0,center:.5,right:1},cs=x.Element.define({groupIndex:1200,interative:!0,state:function(){return{from:[0,0],to:[0,0],thickness:200,alignment:"center"}},render:function(t){var e=this.$drawing.scale,n=this.$state,r=n.from,i=n.to,a=n.thickness,o=n.alignment,s=this.$toCanvas.apply(this,Object(ht["a"])(r)),c=Object(re["a"])(s,2),u=c[0],l=c[1],h=this.$toCanvas.apply(this,Object(ht["a"])(i)),f=Object(re["a"])(h,2),d=f[0],p=f[1];t.lineStyle(a/e,10066329,1,ss[o]).moveTo(u,l).lineTo(d,p).beginFill(os).lineStyle(0).drawCircle(d,p,as).drawCircle(u,l,as)},created:function(){this.$hide()},methods:{setFrom:function(t,e){var n=this.$state,r=n.from,i=n.to;r[0]=i[0]=t,r[1]=i[1]=e,this.$setDirty()},setTo:function(t,e){this.$state.to[0]=t,this.$state.to[1]=e,this.$setDirty()},setThickness:function(t){this.$state.thickness=t,this.$setDirty()},setAlignment:function(t){this.$state.alignment=t,this.$setDirty()}}},is),us=Symbol("PickupFrom"),ls=Symbol("PickupTo"),hs=10,fs=function(t,e){return t.distance-e.distance},ds=function(t){return t.corner},ps=function(t,e,n){return n.indexOf(t)===e},vs=function(t,e,n,r,i,o){return a.GT(t,n)===a.LT(t,i)&&a.GT(e,r)===a.LT(e,o)},ys=function(){function t(e){Object(ct["a"])(this,t),this.structure=e}return Object(ut["a"])(t,[{key:"inCollinearContinuousWall",value:function(t,e){var n,r={from:{point:t,distance:1/0,wall:null},to:{point:e,distance:1/0,wall:null}},i=Object(je["a"])(this.structure.walls());try{for(i.s();!(n=i.n()).done;){var a=n.value,o=a.segment,s=a.thickness,u=s/2;for(var l in r){var h=r[l],f=c.distanceToSegment.apply(c,Object(ht["a"])(h.point).concat(Object(ht["a"])(o)));f<u&&f<h.distance&&vs.apply(void 0,Object(ht["a"])(h.point).concat(Object(ht["a"])(o)))&&(h.distance=f,h.wall=a)}}}catch(d){i.e(d)}finally{i.f()}return!ft["h"].isNull(r.from.wall)&&!ft["h"].isNull(r.to.wall)&&r.from.wall===r.to.wall}},{key:"ensureCorner",value:function(t,e){var n=this.structure.queryCorner(t,e,hs);return n||this.structure.createCorner(t,e)}},{key:"ensureFromAndTo",value:function(t,e){var n,r,i={from:(n=this.structure).queryCorner.apply(n,Object(ht["a"])(t).concat([hs])),to:(r=this.structure).queryCorner.apply(r,Object(ht["a"])(e).concat([hs]))};if(ft["h"].Not.Null(i.from)&&ft["h"].Not.Null(i.to))return i;var a=Object(ht["a"])(s.fromSegment.apply(s,Object(ht["a"])(t).concat(Object(ht["a"])(e)))),o={from:{point:t,distance:1/0,wall:null},to:{point:e,distance:1/0,wall:null}};for(var u in o){var l,h,f=o[u],d=f.point;if(!ft["h"].Not.Null(i[u])){var p,v=Object(je["a"])(this.structure.walls());try{for(v.s();!(p=v.n()).done;){var y=p.value,g=y.segment,b=s.fromSegment.apply(s,Object(ht["a"])(y.segment)),m=y.thickness/2,$=s.intersectLine.apply(s,Object(ht["a"])(b).concat(Object(ht["a"])(a))),O=ft["h"].Not.Null($),x=O?c.distanceToPoint.apply(c,Object(ht["a"])(d).concat(Object(ht["a"])($))):c.distanceToLine.apply(c,Object(ht["a"])(d).concat(Object(ht["a"])(b))),w=O?$:c.project.apply(c,Object(ht["a"])(d).concat(Object(ht["a"])(b)));vs.apply(void 0,Object(ht["a"])(w).concat(Object(ht["a"])(g)))&&x<m&&(ft["f"].assign(d,w),f.distance=x,f.wall=y)}}catch(j){v.e(j)}finally{v.f()}i[u]=ft["h"].isNull(o[u].wall)?(l=this.structure).createCorner.apply(l,Object(ht["a"])(d)):(h=this.structure).split.apply(h,[o[u].wall].concat(Object(ht["a"])(d)))}}return i}},{key:"linkWall",value:function(t,e,n){var r=t.getWallByToCorner(e);if(ft["h"].isNull(r)){var i=this.structure.createWall(t,e);return i.thickness=n,i}return r.thickness=n,r}},{key:"buildWallByCorner",value:function(t,e,n){var r=this,i=[].concat(ft["a"].from(t.walls())).concat(ft["a"].from(e.walls())),a=t.point,o=e.point,u=[].concat(Object(ht["a"])(a),Object(ht["a"])(o)),h=s.fromSegment.apply(s,Object(ht["a"])(u)),f=function(t){var e=t.point,n=c.distanceToLine.apply(c,Object(ht["a"])(e).concat(Object(ht["a"])(h)));return n>1||!vs.apply(void 0,Object(ht["a"])(e).concat(Object(ht["a"])(u)))?null:{distance:c.distanceToPoint.apply(c,Object(ht["a"])(e).concat(Object(ht["a"])(a))),corner:t}},d=function(t){var e,n,i=l.intersectSegment.apply(l,Object(ht["a"])(t.segment).concat(Object(ht["a"])(a),Object(ht["a"])(o)));return ft["h"].isNull(i)?null:{distance:c.distanceToPoint.apply(c,Object(ht["a"])(i).concat(Object(ht["a"])(a))),corner:(e=r.structure).queryCorner.apply(e,Object(ht["a"])(i))||(n=r.structure).split.apply(n,[t].concat(Object(ht["a"])(i)))}},p=ft["a"].from(this.structure.corners()).filter((function(n){return n!==t&&n!==e})).map(f);ft["a"].from(this.structure.walls()).filter((function(t){return!i.includes(t)})).map(d).concat(p).filter(ft["h"].Not.Null).sort(fs).map(ds).concat([e]).filter(ps).reduce((function(t,e){return r.linkWall(t,e,n),e}),t)}}]),t}(),gs=function(t){Object(qe["a"])(n,t);var e=Object(Je["a"])(n);function n(){return Object(ct["a"])(this,n),e.apply(this,arguments)}return Object(ut["a"])(n,[{key:"from",get:function(){var t=Ur(this);return t.getCorner.apply(t,Object(ht["a"])(t.$data.from))}},{key:"to",get:function(){var t=Ur(this);return t.getCorner.apply(t,Object(ht["a"])(t.$data.to))}},{key:"setThickness",value:function(t){Ur(this).setThickness(t)}},{key:"setAlignment",value:function(t){Ur(this).setAlignment(t)}}]),n}(b.Proxy.ToolProvider(["build","pick","drop"])),bs=x.Tool.READY,ms=x.Tool.define((Mo={},Object(lt["a"])(Mo,bs,{entry:function(){this.$data.indicator.$hide()},leave:function(){this.$data.indicator.$show()}}),Object(lt["a"])(Mo,us,(function(){this.setFromByTo()})),Mo),{build:[ls,function(){var t=this.$data,e=t.from,n=t.to,r=t.thickness,i=t.layer,a=i.ensureFromAndTo(e,n);a.from!==a.to&&(ft["f"].assign(e,a.from.point),ft["f"].assign(n,a.to.point),i.buildWallByCorner(a.from,a.to,r),this.setFromByTo(),this.$emit("end"),this.$emit("build"))},bs],pick:[[bs,ft["e"],us],[us,ft["e"],ls]],drop:[[ls,ft["e"],us],[us,ft["e"],bs],[bs,ft["e"],bs]]},{proxy:b.Proxy.Creator(gs),data:function(t){var e,n=this,r=t.$createElement("Builder"),i=[0,0],a=[0,0],o=(e={},Object(lt["a"])(e,us,(function(t){ft["f"].assign(i,t),r.setFrom.apply(r,Object(ht["a"])(t))})),Object(lt["a"])(e,ls,(function(t){ft["f"].assign(a,t),r.setTo.apply(r,Object(ht["a"])(t))})),e);return t.$drawing.on("pointermove",(function(e){if(n.$state!==bs){var r=e.virtualX,i=e.virtualY;o[n.$state](t.$toGeometry(r,i))}})),{indicator:r,thickness:200,alignment:"center",from:i,to:a,layer:new ys(t.$drawing.structure)}},reset:function(){this.$data.indicator.$hide(),this.$emit("end")},methods:{setFromByTo:function(){var t=this.$data,e=t.from,n=t.to,r=t.indicator;ft["f"].assign(e,n),r.setFrom.apply(r,Object(ht["a"])(e))},setThickness:function(t){this.$data.thickness=t,this.$data.indicator.setThickness(t)},setAlignment:function(t){this.$data.alignment=t,this.$data.indicator.setAlignment(t)},getCorner:function(t,e){return this.$plugin.$drawing.structure.queryCorner(t,e)}}}),$s=0,Os=1,xs=function(t){return t.corner},ws=function(t){return t.back.corner},js=(Ho={},Object(lt["a"])(Ho,$s,ft["f"].freeze({name:$s,isBare:function(t){return t.previous===t.back},origin:xs,sibling:function(t){return t.previous},source:ws,target:xs})),Object(lt["a"])(Ho,Os,ft["f"].freeze({name:Os,isBare:function(t){return t.next===t.back},origin:ws,sibling:function(t){return t.next},source:xs,target:ws})),Ho),ks=(n("00b4"),function(t){return o.fromBothPoint.apply(o,Object(ht["a"])(t.corner.point).concat(Object(ht["a"])(t.next.corner.point)))}),Ts=function(t,e){return o.cross.apply(o,Object(ht["a"])(ks(t)).concat(Object(ht["a"])(ks(e))))},Es=function(t,e){return o.dot.apply(o,Object(ht["a"])(ks(t)).concat(Object(ht["a"])(ks(e))))},Ss={test:function(){return!0}},Cs=(Bo={},Object(lt["a"])(Bo,$s,a.LT),Object(lt["a"])(Bo,Os,a.GT),Bo),Ps=function(t){return s.fromSegment.apply(s,Object(ht["a"])(t.corner.point).concat(Object(ht["a"])(t.next.corner.point)))},Ls=function(t){var e=t.current;return Ps(e)},Ds=[{name:"=180",test:function(t){var e=t.current,n=t.surface;return a.EQ_0(Ts(e,n))},Rail:function(t){var e=t.current,n=t.accessor,r=t.destination;return[].concat(Object(ht["a"])(n.source(e).point),Object(ht["a"])(o.fromSegment.apply(o,Object(ht["a"])(r))))},tail:"source"},{name:">180",test:function(t){var e=t.current,n=t.surface,r=t.accessor;return Cs[r.name](Ts(e,n),0)},Rail:Ls,tail:"source"},{name:"<180",test:function(t){var e=t.current,n=t.destination,r=e.corner,i=e.next.corner;return c.toLeftOfSegment.apply(c,Object(ht["a"])(r.point).concat(Object(ht["a"])(n)))!==c.toLeftOfSegment.apply(c,Object(ht["a"])(i.point).concat(Object(ht["a"])(n)))},Rail:Ls,tail:"target"},{name:"bare",test:function(t){var e=t.current,n=t.accessor;return n.isBare(e)},Rail:Ls,tail:"target"},Ss],As=function(t){var e,n=Object(je["a"])(Ds);try{for(n.s();!(e=n.n()).done;){var r=e.value;if(r.test(t))return r}}catch(i){n.e(i)}finally{n.f()}},Ns=function(t,e){var n=o.normalize.apply(o,Object(ht["a"])(ks(t))),r=o.rotate90.apply(o,Object(ht["a"])(n)),i=o.multiply.apply(o,Object(ht["a"])(r).concat([e]));return i},Fs=function(t,e){return l.translate.apply(l,Object(ht["a"])(t.corner.point).concat(Object(ht["a"])(t.next.corner.point),Object(ht["a"])(e)))},Ws=function(t,e,n){t.reset(),t.surface=e;var r=t.translation=Ns(e,n),i=t.destination=Fs(e,r),a=t.context;for(var o in t.sides){var c=js[o],u=t.sides[o];if(a.accessor=c,u.isBare=c.isBare(e),u.origin=c.origin(e),u.isBare)u.rail=[].concat(Object(ht["a"])(c.target(e).point),Object(ht["a"])(ks(e)));else{var l=e,h=Ss,f=!0;do{l=a.current=c.sibling(l),u.path.push(l),f=f&&c.source(l).size<3,f&&t.addWeak(l),a.weak=f,h=As(a)}while(h===Ss);u.rail=h.Rail(a),u.tail=c[h.tail](l).point,"source"===h.tail&&t.deleteWeak(l)}u.point=s.intersectLine.apply(s,Object(ht["a"])(u.rail).concat(Object(ht["a"])(s.fromSegment.apply(s,Object(ht["a"])(i)))))}},Is=function(t){if(t.destroyed)return!1;if(2!==t.size)return!1;var e=ft["a"].from(t.surfaces());return a.EQ_0(Ts.apply(P,Object(ht["a"])(e)))},Rs=function(t,e){var n=t.surface.wall,r=n.thickness;n.remove();var i,a=Object(je["a"])(t.weaks);try{for(a.s();!(i=a.n()).done;){var o=i.value;o.wall.remove()}}catch(y){a.e(y)}finally{a.f()}var s=[],c=t.sides,u=c[$s],l=c[Os],h=e.ensureFromAndTo(u.point,l.point),f=h.from,d=h.to;if(e.buildWallByCorner(f,d,r),ft["h"].Not.Null(u.tail)){var p=e.ensureFromAndTo(u.point,u.tail);e.buildWallByCorner(p.from,p.to,200),s.push(p.to)}if(ft["h"].Not.Null(l.tail)){var v=e.ensureFromAndTo(l.point,l.tail);e.buildWallByCorner(v.from,v.to,200),s.push(v.to)}s.push(u.origin,l.origin),s.forEach((function(t){Is(t)&&e.structure.merge(t)}))},Ms=function(){function t(){Object(ct["a"])(this,t),this.path=[],this.origin=null,this.isBare=!1,this.hasTail=!1,this.data={point:[0,0],rail:[0,0,0,0],tail:[0,0]}}return Object(ut["a"])(t,[{key:"reset",value:function(){ft["a"].empty(this.path),this.origin=null,this.isBare=!1,this.hasTail=!1}},{key:"point",get:function(){return this.data.point},set:function(t){ft["f"].assign(this.data.point,t)}},{key:"rail",get:function(){return this.data.rail},set:function(t){ft["f"].assign(this.data.rail,t)}},{key:"tail",get:function(){return this.hasTail?this.data.tail:null},set:function(t){ft["f"].assign(this.data.tail,t),this.hasTail=!0}}]),t}(),Hs=function(t){return{get surface(){return t.surface},get destination(){return t.destination},accessor:null,current:null,weak:null}},Bs=function(){function t(){var e;Object(ct["a"])(this,t);var n={surface:null,destination:[0,0,0,0],translation:[0,0]};this.context=Hs(n),this.data=n,this.weaks=new Set,this.sides=(e={},Object(lt["a"])(e,$s,new Ms),Object(lt["a"])(e,Os,new Ms),e)}return Object(ut["a"])(t,[{key:"surface",get:function(){return this.data.surface},set:function(t){this.data.surface=t}},{key:"destination",get:function(){return this.data.destination},set:function(t){ft["f"].assign(this.data.destination,t)}},{key:"translation",get:function(){return this.data.translation},set:function(t){ft["f"].assign(this.data.translation,t)}},{key:"addWeak",value:function(t){this.weaks.add(t)}},{key:"deleteWeak",value:function(t){this.weaks.delete(t)}},{key:"isWeak",value:function(t){return this.weaks.has(t)}},{key:"reset",value:function(){for(var t in this.weaks.clear(),this.data.surface=null,this.sides)this.sides[t].reset();var e=this.context;e.side=null,e.weak=null,e.current=null}}]),t}(),Vs=x.Element.define({groupIndex:1220,interative:!0,state:function(){var t=this;return{wall:null,pointer:[0,0],plan:null,updatePointer:function(e){t.setPointer([e.pointerX,e.pointerY])},finish:function(){t.unbind(),t.$emit("finish")},cancel:function(e){2===e.button&&(t.unbind(),t.$emit("cancel"))}}},render:function(t){var e,n,r,i,a,o=this.$state,s=o.wall,u=o.pointer,l=o.plan,h=this.$toGeometry.apply(this,Object(ht["a"])(u)),f=s.thisSurface,d=s.thatSurface,p=c.toLeftOfSegment.apply(c,Object(ht["a"])(h).concat(Object(ht["a"])(f.corner.point),Object(ht["a"])(d.corner.point)))?f:d,v=c.distanceToSegment.apply(c,Object(ht["a"])(h).concat(Object(ht["a"])(p.corner.point),Object(ht["a"])(p.back.corner.point)));for(var y in Ws(l,p,v),(e=(n=t.lineStyle(10,255)).moveTo.apply(n,Object(ht["a"])(this.$toCanvas.apply(this,Object(ht["a"])(p.origin))))).lineTo.apply(e,Object(ht["a"])(this.$toCanvas.apply(this,Object(ht["a"])(p.target)))),l.sides){var g,b,m=l.sides[y],$=m.path,O=m.point,x=Object(je["a"])($);try{for(x.s();!(b=x.n()).done;){var w,j,k=b.value;(w=(j=t.lineStyle(10,l.isWeak(k)?16711680:65280)).moveTo.apply(j,Object(ht["a"])(this.$toCanvas.apply(this,Object(ht["a"])(k.origin))))).lineTo.apply(w,Object(ht["a"])(this.$toCanvas.apply(this,Object(ht["a"])(k.target))))}}catch(L){x.e(L)}finally{x.f()}(g=t.lineStyle(5,65280)).drawCircle.apply(g,Object(ht["a"])(this.$toCanvas.apply(this,Object(ht["a"])(O))).concat([5]))}var T=Object(re["a"])(l.destination,4),E=T[0],S=T[1],C=T[2],P=T[3];(r=(i=t.lineStyle(3)).moveTo.apply(i,Object(ht["a"])(this.$toCanvas(E,S)))).lineTo.apply(r,Object(ht["a"])(this.$toCanvas(C,P))),(a=t.beginFill(0)).drawCircle.apply(a,Object(ht["a"])(this.$state.pointer).concat([5]))},created:function(){this.$hide(),this.$state.plan=new Bs},methods:{bind:function(){var t=this.$state,e=t.updatePointer,n=t.finish,r=t.cancel;this.$drawing.on("pointermove",e),cn["a"].addEventListener(cn["c"].WINDOW,"mouseup",n),cn["a"].addEventListener(cn["c"].WINDOW,"mousedown",r),this.$show()},unbind:function(){var t=this.$state,e=t.updatePointer,n=t.finish,r=t.cancel;this.$drawing.off("pointermove",e),cn["a"].removeEventListener(cn["c"].WINDOW,"mouseup",n),cn["a"].removeEventListener(cn["c"].WINDOW,"mousedown",r),this.$hide()},setPointer:function(t){ft["f"].assign(this.$state.pointer,t),this.$setDirty()},setWall:function(t){this.$state.wall=t,this.$setDirty()},reset:function(){this.$state.wall=null,this.$hide()}}}),zs=Symbol("ExtenderWaiting"),Us=Symbol("ExtenderActive"),Ys=x.Tool.READY,Gs=x.Tool.define((Vo={},Object(lt["a"])(Vo,Us,(function(){this.$data.indicator.bind()})),Object(lt["a"])(Vo,zs,(function(){this.$data.indicator.unbind(),this.$data.wall=null})),Vo),{open:[[zs,ft["e"],zs],[Ys,ft["e"],zs]],close:[[Ys,ft["e"],Ys],[zs,ft["e"],Ys]],capture:[zs,function(){var t=this.$data,e=t.indicator,n=t.wall;e.setWall(n)},Us],release:[Us,ft["e"],zs],extend:[Us,function(){var t=this.$data,e=t.indicator,n=t.layer,r=e.$state.plan;Rs(r,n)},zs]},{data:function(t){var e=this,n=t.$createElement("Extender");return n.$on("cancel",(function(){return e.release()})).$on("finish",(function(){return e.extend()})),t.$drawing.structure.on("wall-created",(function(t){t.on("pointerdown",(function(r){e.$state===zs&&(r.stopPropagation(),n.setPointer([r.pointerX,r.pointerY]),e.setWall(t),e.capture())}))})),{indicator:n,wall:null,layer:new ys(t.$drawing.structure)}},methods:{setWall:function(t){this.$data.wall=t,this.$data.indicator.setWall(t)}}}),_s=x.Element.define({groupIndex:1150,interative:!0,state:function(){var t=this;return{origin:[0,0],current:[0,0],adjacentList:[],updateCurrent:function(e){t.setCurrent([e.virtualX,e.virtualY])},finish:function(){t.unbind(),t.$emit("finish")},cancel:function(e){2===e.button&&(t.unbind(),t.$emit("cancel"))}}},getters:{active:function(){return this.$visible}},created:function(){this.$hide()},render:function(t){var e,n=this.$state,r=n.adjacentList,i=n.current,a=this.$drawing.structure.options.corner.style.radius;(e=t.beginFill(0)).drawCircle.apply(e,Object(ht["a"])(i).concat([a])).lineStyle(2,0);var o,s=Object(je["a"])(r);try{for(s.s();!(o=s.n()).done;){var c,u,l,h=o.value,f=this.$toCanvas.apply(this,Object(ht["a"])(h));(c=(u=(l=t.beginFill(16777215)).drawCircle.apply(l,Object(ht["a"])(f).concat([a]))).moveTo.apply(u,Object(ht["a"])(f))).lineTo.apply(c,Object(ht["a"])(i))}}catch(d){s.e(d)}finally{s.f()}},methods:{bind:function(){var t=this.$state,e=t.updateCurrent,n=t.cancel,r=t.finish;this.$drawing.on("pointermove",e),cn["a"].addEventListener(cn["c"].WINDOW,"mouseup",r),cn["a"].addEventListener(cn["c"].WINDOW,"mousedown",n),this.$show()},unbind:function(){var t=this.$state,e=t.updateCurrent,n=t.cancel,r=t.finish;this.$drawing.off("pointermove",e),cn["a"].removeEventListener(cn["c"].WINDOW,"mouseup",r),cn["a"].removeEventListener(cn["c"].WINDOW,"mousedown",n),this.$hide()},setCurrent:function(t){ft["f"].assign(this.$state.current,t),this.$setDirty()},setOrigin:function(t){ft["f"].assign(this.$state.origin,t),this.setCurrent(this.$toCanvas.apply(this,Object(ht["a"])(t)))},setSiblingList:function(t){this.$state.adjacentList=t,this.$setDirty()}}},is),Xs=Symbol("MoverWaiting"),Ks=Symbol("MoverActive"),qs=x.Tool.READY,Js=["open","close"],Qs=function(t){return ft["c"].instanceOf(t,yi)},Zs=function(t){Object(qe["a"])(n,t);var e=Object(Je["a"])(n);function n(){return Object(ct["a"])(this,n),e.apply(this,arguments)}return Object(ut["a"])(n,[{key:"setCorner",value:function(t){Qs(t)&&ft["c"].Throw.TypeError("Invalid corner, a Strucure.CornerProxy expected."),Ur(this).setCorner(t)}}]),n}(b.Proxy.ToolProvider(Js)),tc=x.Tool.define((zo={},Object(lt["a"])(zo,Ks,(function(){this.$data.indicator.bind()})),Object(lt["a"])(zo,Xs,(function(){this.$data.indicator.unbind(),this.$data.corner=null})),zo),{open:[[qs,ft["e"],Xs],[Xs,ft["e"],Xs]],close:[[Xs,ft["e"],qs],[qs,ft["e"],qs]],capture:[Xs,function(){this.setCorner(this.$data.corner)},Ks],release:[Ks,ft["e"],Xs],move:[Ks,function(){var t,e=this.$data,n=e.indicator,r=e.corner,i=e.layer,a=(t=this.$plugin).$toGeometry.apply(t,Object(ht["a"])(n.$state.current)),o=i.ensureFromAndTo(r.point,a);if(o.from!==o.to){var s=ft["a"].from(r.surfaces()).map((function(t){return[t.back.corner,t.wall.thickness]}));r.remove();var c,u=Object(je["a"])(s);try{for(u.s();!(c=u.n()).done;){var l=Object(re["a"])(c.value,2),h=l[0],f=l[1];h!==o.to&&i.buildWallByCorner(o.to,h,f)}}catch(d){u.e(d)}finally{u.f()}}},Xs]},{proxy:b.Proxy.Creator(Zs),data:function(t){var e=this,n=t.$createElement("Mover");return n.$on("cancel",(function(){return e.release()})).$on("finish",(function(){return e.move()})),t.$drawing.structure.on("corner-created",(function(t){t.on("pointerdown",(function(n){e.$state===Xs&&(n.stopPropagation(),e.setCorner(t),e.capture())}))})),{corner:null,indicator:n,layer:new ys(t.$drawing.structure)}},reset:function(){this.$data.indicator.$hide(),this.$data.corner=null},methods:{setCorner:function(t){var e=this.$data.indicator,n=t.getAdjacentCornerList().map(ec);this.$data.corner=t,e.setOrigin(ec(t)),e.setSiblingList(n)}}}),ec=function(t){return[t.x,t.y]},nc=x.Element.define({groupIndex:1210,state:function(){return{breakpoint:[0,0],segment:[0,0,0,0]}},render:function(t){var e,n,r,i=this.$state,a=i.segment,s=i.breakpoint,u=Object(re["a"])(a,4),l=u[0],h=u[1],f=u[2],d=u[3],p=o.rotate90.apply(o,Object(ht["a"])(o.normalize.apply(o,Object(ht["a"])(o.fromSegment.apply(o,Object(ht["a"])(a)))))),v=o.multiply.apply(o,Object(ht["a"])(p).concat([30]));(e=(n=(r=t.lineStyle(1,0)).moveTo.apply(r,Object(ht["a"])(c.translate.apply(c,Object(ht["a"])(s).concat(Object(ht["a"])(v)))))).lineTo.apply(n,Object(ht["a"])(c.translate.apply(c,Object(ht["a"])(s).concat(Object(ht["a"])(o.invert.apply(o,Object(ht["a"])(v))))))).moveTo(l,h).lineTo(f,d).beginFill(65280)).drawCircle.apply(e,Object(ht["a"])(s).concat([5]))},created:function(){this.$hide()},methods:{setBreakpoint:function(t){ft["f"].assign(this.$state.breakpoint,t),this.$setDirty()},setSegment:function(t){ft["f"].assign(this.$state.segment,t),this.$setDirty()}}},is),rc=Symbol("SpliterDetecting"),ic=Symbol("SpliterDetected"),ac=x.Tool.READY,oc=function(t){Object(qe["a"])(n,t);var e=Object(Je["a"])(n);function n(){return Object(ct["a"])(this,n),e.apply(this,arguments)}return Object(ut["a"])(n)}(b.Proxy.ToolProvider(["open","close"])),sc=x.Tool.define(Object(lt["a"])({},ic,{entry:function(){this.$data.indicator.$show()},leave:function(){this.$data.indicator.$hide()}}),{open:[ac,ft["e"],rc],found:[[rc,ft["e"],ic],[ic,ft["e"],ic]],lost:[[ic,ft["e"],rc],[rc,ft["e"],rc]],close:[[ac,ft["e"],ac],[rc,ft["e"],ac],[ic,ft["e"],ac]]},{proxy:b.Proxy.Creator(oc),data:function(t){var e=this,n=t.$createElement("Spliter"),r={indicator:n,target:null,breakpoint:[0,0]},i=t.$drawing,a=i.structure;return i.on("pointermove",(function(t){e.$state!==ac&&(e.findWall(t.pointerX,t.pointerY)?e.found():e.lost())})).on("pointerup",(function(t){0===t.button&&e.$state===ic&&a.split.apply(a,[r.target].concat(Object(ht["a"])(r.breakpoint)))})),r},methods:{findWall:function(t,e){var n,r=this.$data,a=r.indicator,o=r.breakpoint,u=this.$plugin,l=u.$drawing.structure,h=u.$options.spliter.interaction.distance,f=Object(je["a"])(l.getAllWallList());try{for(f.s();!(n=f.n()).done;){var d=n.value,p=i.Segment.apply(i,Object(ht["a"])(u.$toCanvas.apply(u,Object(ht["a"])(d.thisSurface.corner.point))).concat(Object(ht["a"])(u.$toCanvas.apply(u,Object(ht["a"])(d.thatSurface.corner.point))))),v=c.distanceToSegment.apply(c,[t,e].concat(Object(ht["a"])(p)));if(v<h){var y=c.project.apply(c,[t,e].concat(Object(ht["a"])(s.fromSegment.apply(s,Object(ht["a"])(p)))));if(vs.apply(void 0,Object(ht["a"])(y).concat(Object(ht["a"])(p)))){var g=u.$toGeometry.apply(u,Object(ht["a"])(y));return ft["f"].assign(o,g),a.setBreakpoint(y),a.setSegment(p),this.$data.target=d,!0}}}}catch(b){f.e(b)}finally{f.f()}return!1}},reset:function(){this.close()}}),cc=x.Element.define({groupIndex:1160,interative:!0,state:function(){return{from:[0,0],to:[0,0]}},created:function(){this.$hide()},render:function(t){var e=this.$state,n=e.from,r=e.to,i=this.$toCanvas.apply(this,Object(ht["a"])(n)),a=Object(re["a"])(i,2),o=a[0],s=a[1],c=this.$toCanvas.apply(this,Object(ht["a"])(r)),u=Object(re["a"])(c,2),l=u[0],h=u[1];t.lineStyle(2,0).moveTo(o,s).lineTo(o,h).lineTo(l,h).lineTo(l,s).closePath().beginFill(16711680).drawCircle(l,h,5).beginFill(65280).drawCircle(o,s,5)},methods:{setFrom:function(t,e){var n=this.$state,r=n.from,i=n.to;r[0]=i[0]=t,r[1]=i[1]=e,this.$setDirty()},setTo:function(t,e){this.$state.to[0]=t,this.$state.to[1]=e,this.$setDirty()}}},is),uc=Symbol("PickupFrom"),lc=Symbol("PickupTo"),hc=x.Tool.READY,fc=function(t){Object(qe["a"])(n,t);var e=Object(Je["a"])(n);function n(){return Object(ct["a"])(this,n),e.apply(this,arguments)}return Object(ut["a"])(n,[{key:"setThickness",value:function(t){Ur(this).setThickness(t)}},{key:"setAlignment",value:function(){}}]),n}(b.Proxy.ToolProvider(["build","pick","drop"])),dc=x.Tool.define(Object(lt["a"])({},hc,{entry:function(){this.$data.indicator.$hide()},leave:function(){this.$data.indicator.$show()}}),{pick:[[hc,ft["e"],uc],[uc,ft["e"],lc]],drop:[[lc,ft["e"],uc],[uc,ft["e"],hc],[hc,ft["e"],hc]],build:[[lc,function(){var t=this.$data,e=t.indicator,n=t.thickness,r=Object(re["a"])(t.from,2),i=r[0],o=r[1],s=Object(re["a"])(t.to,2),c=s[0],u=s[1],l=t.layer;e.setFrom.apply(e,Object(ht["a"])(e.$state.to)),a.EQ(i,c)||a.EQ(o,u)||[[i,o],[c,o],[c,u],[i,u]].forEach((function(t,e,r){var i=r[(e+1)%4],a=l.ensureFromAndTo(t,i);l.buildWallByCorner(a.from,a.to,n)}))},hc]]},{proxy:b.Proxy.Creator(fc),data:function(t){var e,n=this,r=t.$createElement("Chamber"),i=[0,0],a=[0,0],o=(e={},Object(lt["a"])(e,uc,(function(t,e){i[0]=t,i[1]=e,r.setFrom(t,e)})),Object(lt["a"])(e,lc,(function(t,e){a[0]=t,a[1]=e,r.setTo(t,e)})),e);return t.$drawing.on("pointermove",(function(e){if(n.$state!==hc){var r=e.virtualX,i=e.virtualY;o[n.$state].apply(o,Object(ht["a"])(t.$toGeometry(r,i)))}})),{indicator:r,thickness:200,from:i,to:a,layer:new ys(t.$drawing.structure)}},methods:{setThickness:function(t){this.$data.thickness=t}}}),pc=w.define({id:"com.3dnest.spoke.bricklayer",namespace:"bricklayer",version:pi["a"],plugin:is,elements:{Builder:C.Indicator,Spliter:W.Indicator,Mover:N.Indicator,Extender:D.Indicator,Chamber:R.Indicator},tools:{Builder:C.Tool,Mover:N.Tool,Spliter:W.Tool,Extender:D.Tool,Chamber:R.Tool}}),vc=function(t){return t.$proxy},yc=function(t){Object(qe["a"])(n,t);var e=Object(Je["a"])(n);function n(){return Object(ct["a"])(this,n),e.apply(this,arguments)}return Object(ut["a"])(n,[{key:"createBitmap",value:function(t,e,n){return Ur(this).createBitmap(t,e,n)}},{key:"getAllBitmapList",value:function(){return Ur(this).$getElementList("Bitmap").map(vc)}},{key:"bitmaps",value:Object(ge["a"])().mark((function t(){var e,n,r;return Object(ge["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=Object(je["a"])(Ur(this).bitmaps()),t.prev=1,e.s();case 3:if((n=e.n()).done){t.next=9;break}return r=n.value,t.next=7,r.$proxy;case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](1),e.e(t.t0);case 14:return t.prev=14,e.f(),t.finish(14);case 17:case"end":return t.stop()}}),t,this,[[1,11,14,17]])}))}]),n}(b.Proxy.Plugin),gc=x.define({proxy:b.Proxy.Creator(yc),created:function(){var t=this;this.$on("element-created",(function(e,n){t.$emit("".concat(n.toLowerCase(),"-created"),e)}))},methods:{createBitmap:function(t,e,n){var r=this;return Object(ri["a"])(Object(ge["a"])().mark((function i(){var a,o;return Object(ge["a"])().wrap((function(i){while(1)switch(i.prev=i.next){case 0:return i.next=2,ln.Texture.fromURL(t);case 2:return a=i.sent,o=r.$drawing.scale,i.abrupt("return",r.$createElement("Bitmap",a,e||a.width*o,n||a.height*o).$proxy);case 5:case"end":return i.stop()}}),i)})))()},bitmaps:Object(ge["a"])().mark((function t(){var e,n,r;return Object(ge["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=Object(je["a"])(this.$elements("Bitmap")),t.prev=1,e.s();case 3:if((n=e.n()).done){t.next=9;break}return r=n.value,t.next=7,r;case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](1),e.e(t.t0);case 14:return t.prev=14,e.f(),t.finish(14);case 17:case"end":return t.stop()}}),t,this,[[1,11,14,17]])}))}}),bc=function(t){Object(qe["a"])(n,t);var e=Object(Je["a"])(n);function n(){return Object(ct["a"])(this,n),e.apply(this,arguments)}return Object(ut["a"])(n,[{key:"url",get:function(){return Ur(this).url}},{key:"width",get:function(){return Ur(this).width}},{key:"height",get:function(){return Ur(this).height}},{key:"rotation",get:function(){return Ur(this).rotation}},{key:"x",get:function(){return Ur(this).x}},{key:"y",get:function(){return Ur(this).y}},{key:"alpha",get:function(){return Ur(this).alpha}},{key:"setWidth",value:function(t){Ur(this).setWidth(t)}},{key:"setHeight",value:function(t){Ur(this).setHeight(t)}},{key:"setRotation",value:function(t){Ur(this).setRotation(t)}},{key:"setPosition",value:function(t,e){Ur(this).setPosition(t,e)}},{key:"setAlpha",value:function(t){Ur(this).setAlpha(t)}},{key:"remove",value:function(){Ur(this).remove()}}]),n}(b.Proxy.Element),mc=ln,$c=x.Element.define({proxy:b.Proxy.Creator(bc),groupIndex:-100,interative:!0,focusable:!0,draggable:!0,state:function(){return{texture:null,width:0,height:0,x:0,y:0,rotation:0,alpha:1,rendering:!1}},getters:{url:function(){return this.$state.texture.baseTexture.cacheId},width:function(){return this.$state.width},height:function(){return this.$state.height},rotation:function(){return this.$state.rotation},x:function(){return this.$state.x},y:function(){return this.$state.y},alpha:function(){return this.$state.alpha}},created:function(t,e,n){this.setTexture(t),this.setWidth(e),this.setHeight(n)},destroy:function(){},render:function(t){var e=this.$state,n=e.texture,r=e.width,i=e.height,a=e.x,o=e.y,s=e.rotation,c=e.alpha,u=e.rendering,l=this.$drawing.scale,h=r/l,f=i/l,d=h>0?h:n.width,p=f>0?f:n.height;t.pivot.x=h/2,t.pivot.y=f/2,t.beginTextureFill({texture:n,alpha:c,matrix:new mc.Matrix(d/n.width,0,0,p/n.height,0,0)}).drawRect(0,0,d,p);var v=this.$toCanvas(a,o),y=Object(re["a"])(v,2);t.x=y[0],t.y=y[1],t.rotation=s,u&&(this.$emit("change",this.$proxy),this.setRendering(!1))},methods:{setTexture:function(t){this.$state.texture=t,this.$setDirty()},setWidth:function(t){this.$state.width=t,this.$setDirty(),this.setRendering(!0)},setHeight:function(t){this.$state.height=t,this.$setDirty(),this.setRendering(!0)},setRotation:function(t){this.$state.rotation=t,this.$setDirty(),this.setRendering(!0)},setPosition:function(t,e){this.$state.x=t,this.$state.y=e,this.$setDirty(),this.setRendering(!0)},setAlpha:function(t){this.$state.alpha=t,this.$setDirty()},setRendering:function(t){this.$state.rendering=t},remove:function(){this.$destroy()}}},gc),Oc=n("3d1c"),xc=w.define({id:"com.3dnest.spoke.negative",namespace:"negative",version:Oc["a"],plugin:gc,elements:{Bitmap:$c}}),wc=n("2c55"),jc=x.define({proxy:function(){var t=this;return{setPosition:function(e,n){t.setPosition(e,n)},setRotation:function(e){t.setRotation(e)},get rotation(){return t.$data.compass.rotation},get element(){return t.$data.compass.$proxy}}},data:function(){return{compass:null}},created:function(){this.$data.compass=this.$createElement("Element")},methods:{setPosition:function(t,e){this.$data.compass.setPosition(t,e)},setRotation:function(t){this.$data.compass.setRotation(t)}}}),kc=function(t){Object(qe["a"])(n,t);var e=Object(Je["a"])(n);function n(){return Object(ct["a"])(this,n),e.apply(this,arguments)}return Object(ut["a"])(n,[{key:"x",get:function(){return Ur(this).x}},{key:"y",get:function(){return Ur(this).y}},{key:"rotation",get:function(){return Ur(this).rotation}},{key:"resetPosition",value:function(){Ur(this).resetPosition()}},{key:"setPosition",value:function(t,e){Ur(this).setPosition(t,e)}},{key:"setRotation",value:function(t){Ur(this).setRotation(t)}},{key:"setCompassColor",value:function(t){Ur(this).setCompassColor(t)}},{key:"setNorthPointColor",value:function(t){Ur(this).setNorthPointColor(t)}},{key:"setSouthPointColor",value:function(t){Ur(this).setSouthPointColor(t)}}]),n}(b.Proxy.Element),Tc=x.Element.define({proxy:b.Proxy.Creator(kc),groupIndex:3e3,interative:!0,state:function(){return{x:50,y:50,rotation:0,compassColor:16777215,northPointColor:14423100,southPointColor:4098301,rendering:!1}},getters:{x:function(){return this.$state.x},y:function(){return this.$state.y},rotation:function(){return this.$state.rotation}},created:function(){var t=new ln.Text,e=new ln.Text;t.text="N",t.style.fontSize=12,t.transform.position.x=-4,t.transform.position.y=-34,e.text="S",e.style.fontSize=12,e.transform.position.x=-4,e.transform.position.y=19,this.$graphics.addChild(t),this.$graphics.addChild(e),window.p=this},render:function(t){var e,n,r,i,a,o,s,c,u,l,h=this.$state,f=h.x,d=h.y,p=h.rotation,v=h.compassColor,y=h.northPointColor,g=h.southPointColor,b=h.rendering,m=[0,0],$=[0,-20],O=[-6,0],x=[6,0],w=[0,20],j=(e=(n=(r=(i=(a=(o=(s=(c=(u=(l=t.beginFill(v)).moveTo.apply(l,m).lineStyle(0).drawCircle(0,0,35).beginFill(y)).moveTo.apply(u,m)).lineTo.apply(c,O)).lineTo.apply(s,$)).lineTo.apply(o,x)).lineTo.apply(a,m).beginFill(g)).lineTo.apply(i,O)).lineTo.apply(r,w)).lineTo.apply(n,x)).lineTo.apply(e,m).endFill().lineStyle(1,9082010).moveTo(0,-35).lineTo(0,-32).moveTo(0,35).lineTo(0,32).moveTo(-35,0).lineTo(-28,0).moveTo(35,0).lineTo(28,0);j.x=f,j.y=d,j.rotation=p,b&&(this.$emit("change",this.$proxy),this.setRendering(!1))},methods:{resetPosition:function(){this.$state.x=50,this.$state.y=50,this.$setDirty()},setPosition:function(t,e){this.$state.x=t,this.$state.y=e,this.$setDirty()},setRotation:function(t){this.$state.rotation=t,this.$setDirty(),this.setRendering(!0)},setCompassColor:function(t){this.$state.compassColor=t,this.$setDirty()},setNorthPointColor:function(t){this.$state.northPointColor=t,this.$setDirty()},setSouthPointColor:function(t){this.$state.southPointColor=t,this.$setDirty()},setRendering:function(t){this.$state.rendering=t}}}),Ec=w.define({id:"com.3dnest.spoke.compass",namespace:"compass",version:wc["a"],plugin:jc,elements:{Element:Tc}}),Sc=n("2bbc"),Cc=function(t){Object(qe["a"])(n,t);var e=Object(Je["a"])(n);function n(){return Object(ct["a"])(this,n),e.apply(this,arguments)}return Object(ut["a"])(n,[{key:"transformer",get:function(){return Ur(this).transformer}},{key:"selector",get:function(){return Ur(this).selector}},{key:"addTransformerAdapter",value:function(t,e){return Ur(this).addTransformerAdapter(t,e)}},{key:"addSelectorAdapter",value:function(t,e){return Ur(this).addSelectorAdapter(t,e)}},{key:"transformerAction",value:function(t){return Ur(this).transformerAction(t)}},{key:"selectorAction",value:function(t,e){return Ur(this).selectorAction(t,e)}},{key:"getSelectedList",value:function(){return Ur(this).getSelectedList()}},{key:"remove",value:function(){return Ur(this).remove()}}]),n}(b.Proxy.Plugin),Pc=x.define({proxy:b.Proxy.Creator(Cc),data:function(){return{transformer:null,selector:null,transformerAdapter:new Map,selectorAdapter:new Map}},created:function(){this.$data.transformer=this.$createTool("Transformer"),this.$data.selector=this.$createTool("Selector")},getters:{transformer:function(){return this.$data.transformer},selector:function(){return this.$data.selector}},methods:{addTransformerAdapter:function(t,e){this.$data.transformerAdapter.set(t,e)},addSelectorAdapter:function(t,e){this.$data.selectorAdapter.set(t,e)},transformerAction:function(t){var e=t?this.$data.transformerAdapter.get(t.constructor):null;e?this.$data.transformer.pick():this.$data.transformer.drop()},selectorAction:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.$data.selector,r=t?this.$data.selectorAdapter.get(t.constructor):null;r?(n.setElement(t),e?n.pick_multiple():n.pick_single()):n.drop()},getSelectedList:function(){return this.$data.selector.getElements()},remove:function(){var t=this,e=this.$data.selector.getElements();e.forEach((function(e){t.$data.selectorAdapter.get(e.constructor).remove(e)}))}}}),Lc=function(t,e,n,r,i,a){return c.project.apply(c,[i,a].concat(Object(ht["a"])(s.fromSegment(t,e,n,r))))},Dc=function(t,e,n,r,i,a){var s=Lc(t,e,n,r,i,a);return o.length.apply(o,Object(ht["a"])(o.fromBothPoint.apply(o,[t,e].concat(Object(ht["a"])(s)))))},Ac=function(t,e,n,r,i){var a=o.normalize.apply(o,Object(ht["a"])(o.fromBothPoint(t,e,n,r))),s=Object(re["a"])(a,2),u=s[0],l=s[1],h=c.translate.apply(c,[t,e].concat(Object(ht["a"])(o.multiply(u,l,i)))),f=Object(re["a"])(h,2),d=f[0],p=f[1];return[d,p]},Nc=x.Element.define({groupIndex:1300,interative:!0,state:function(){return{xStatus:0,yStatus:0,active:!1,x:0,y:0,width:0,height:0,rotation:0}},created:function(t,e){var n=this;this.$state.xStatus=t,this.$state.yStatus=e,this.$on("pointerdown",(function(t){t.stopPropagation(),n.beginAdjust()}))},render:function(t){if(this.$state.active){var e=this.$state,n=e.xStatus,r=e.yStatus,i=e.x,a=e.y,o=e.width,s=e.height,c=e.rotation,u=this.$drawing.scale;t.lineStyle(1,4096759).beginFill(16777215).drawRect(-5,-5,10,10),t.pivot.x=-n*o/2/u,t.pivot.y=r*s/2/u;var l=this.$toCanvas(i,a),h=Object(re["a"])(l,2);t.x=h[0],t.y=h[1],t.rotation=c}},methods:{show:function(){this.$state.active=!0,this.$setDirty()},hide:function(){this.$state.active=!1,this.$setDirty()},setPosition:function(t,e){this.$state.x=t,this.$state.y=e,this.$setDirty()},setWidth:function(t){this.$state.width=t,this.$setDirty()},setHeight:function(t){this.$state.height=t,this.$setDirty()},setRotation:function(t){this.$state.rotation=t,this.$setDirty()},updateState:function(t,e,n,r,i){this.setPosition(t,e),this.setWidth(n),this.setHeight(r),this.setRotation(i)},beginAdjust:function(){var t=this,e=this.$data.transformer.getElement(),n=this.$data.transformerAdapter.get(e.constructor),r=function(r){var i=t.$state,a=i.xStatus,o=i.yStatus,s=i.x,u=i.y,l=i.width,h=i.height,f=i.rotation,d=t.$toGeometry(r.pointerX,r.pointerY),p=s+a*l/2,v=u+o*h/2,y=c.rotate(p,v,-f,s,u),g=Object(re["a"])(y,2),b=g[0],m=g[1],$=Dc(s,u,b,m,b,m),O=Dc.apply(void 0,[s,u,b,m].concat(Object(ht["a"])(d))),x=c.rotate.apply(c,Object(ht["a"])(Ac(s,u,b,m,O)).concat([f,s,u])),w=Object(re["a"])(x,2),j=w[0],k=w[1],T=a*(j-p),E=o*(k-v),S=l+T,C=h+E,P=Ac(s,u,b,m,(O-$)/2),L=Object(re["a"])(P,2),D=L[0],A=L[1];t.setWidth(S),t.setHeight(C),n.setWidth(e,S),n.setHeight(e,C),n.setPosition(e,D,A),t.$emit("update",{x:D,y:A,width:S,height:C,rotation:f})},i=function e(){t.$drawing.off("pointermove",r),window.removeEventListener("mouseup",e)};this.$drawing.on("pointermove",r),window.addEventListener("mouseup",i)}}},Pc),Fc=30,Wc=x.Element.define({groupIndex:1300,interative:!0,state:function(){return{active:!1,x:0,y:0,width:0,height:0,rotation:0}},created:function(){var t=this;this.$on("pointerdown",(function(e){e.stopPropagation(),t.beginAdjust()}))},render:function(t){if(this.$state.active){var e=this.$state,n=e.x,r=e.y,i=e.height,a=e.rotation,o=this.$drawing.scale;t.lineStyle(1,4096759).beginFill(16777215).drawCircle(0,0,5).moveTo(0,5).lineTo(0,Fc-5),t.pivot.x=0,t.pivot.y=i/o/2+Fc;var s=this.$toCanvas(n,r),c=Object(re["a"])(s,2);t.x=c[0],t.y=c[1],t.rotation=a}},methods:{show:function(){this.$state.active=!0,this.$setDirty()},hide:function(){this.$state.active=!1,this.$setDirty()},setPosition:function(t,e){this.$state.x=t,this.$state.y=e,this.$setDirty()},setWidth:function(t){this.$state.width=t,this.$setDirty()},setHeight:function(t){this.$state.height=t,this.$setDirty()},setRotation:function(t){this.$state.rotation=t,this.$setDirty()},updateState:function(t,e,n,r,i){this.setPosition(t,e),this.setWidth(n),this.setHeight(r),this.setRotation(i)},beginAdjust:function(){var t=this,e=this.$data.transformer.getElement(),n=this.$data.transformerAdapter.get(e.constructor),r=function(r){var i=t.$state,a=i.x,s=i.y,c=i.width,u=i.height,l=t.$toGeometry(r.pointerX,r.pointerY),h=Math.atan2.apply(Math,Object(ht["a"])(o.fromBothPoint.apply(o,[a,s].concat(Object(ht["a"])(l)))));t.setRotation(h),n.setRotation(e,h),t.$emit("update",{x:a,y:s,width:c,height:u,rotation:h})},i=function e(){t.$drawing.off("pointermove",r),window.removeEventListener("mouseup",e)};this.$drawing.on("pointermove",r),window.addEventListener("mouseup",i)}}},Pc),Ic=x.Element.define({groupIndex:1200,interative:!0,state:function(){return{active:!1,x:0,y:0,width:0,height:0,rotation:0,isCreating:!1}},created:function(){var t=this;this.$on("pointerdown",(function(e){e.stopPropagation(),t.elementAdjust(e)}))},render:function(t){if(this.$state.active){var e=this.$state,n=e.x,r=e.y,i=e.width,a=e.height,o=e.rotation,s=this.$drawing.scale,c=i/s,u=a/s;t.lineStyle(1,16711680).beginFill(4096759,.01).drawRect(-c/2,-u/2,c,u).endFill(),t.pivot.x=0,t.pivot.y=0;var l=this.$toCanvas(n,r),h=Object(re["a"])(l,2);t.x=h[0],t.y=h[1],t.rotation=o}},methods:{show:function(){this.$state.active=!0,this.$setDirty()},hide:function(){this.$state.active=!1,this.$setDirty()},setPosition:function(t,e){this.$state.x=t,this.$state.y=e,this.$setDirty()},setWidth:function(t){this.$state.width=t,this.$setDirty()},setHeight:function(t){this.$state.height=t,this.$setDirty()},setRotation:function(t){this.$state.rotation=t,this.$setDirty()},setCreating:function(t){this.$state.isCreating=t,this.$setDirty()},updateState:function(t,e,n,r,i){this.setPosition(t,e),this.setWidth(n),this.setHeight(r),this.setRotation(i)},elementAdjust:function(t){var e=this,n=this.$drawing,r=this.$data.transformer.getElement(),i=this.$data.transformerAdapter.get(r.constructor),a=this.$state,o=a.width,s=a.height,c=a.rotation,u=a.isCreating,l=i.getPosition(r),h=Object(re["a"])(l,2),f=h[0],d=h[1],p=t?this.$toGeometry(t.pointerX,t.pointerY):[f,d],v=p[0]-f,y=p[1]-d,g=i.adjustVerify,b=function(t){var n=e.$toGeometry(t.pointerX,t.pointerY),a=n[0]-v,u=n[1]-y,l=e.$drawing.structure.getRoomByPoint(a,u);if(e.setPosition(a,u),g){var h=g(r,e);if(ft["h"].isArray(h))return i.setPosition.apply(i,[r].concat(Object(ht["a"])(h))),void e.$emit("update",{x:h[0],y:h[1],width:o,height:s,rotation:c});if(!h)return}i.setRoom&&i.setRoom(r,l),i.setPosition(r,a,u),e.$emit("update",{x:a,y:u,width:o,height:s,rotation:c})},m=function(){n.off("pointermove",b),window.removeEventListener("mouseup",$),window.removeEventListener("keydown",O),u&&(e.setCreating(!1),e.hide())},$=function(){var t=e.$data.element;t&&e.setPosition.apply(e,Object(ht["a"])(i.getPosition(t))),m()},O=function(t){"Escape"===t.code&&u&&(r.remove(),m())};n.on("pointermove",b),window.addEventListener("mouseup",$),window.addEventListener("keydown",O)}}},Pc),Rc=x.Element.define({groupIndex:1250,state:function(){return{active:!1,x:0,y:0,width:0,height:0,rotation:0}},render:function(t){if(this.$state.active){var e=this.$state,n=e.x,r=e.y,i=e.width,a=e.height,o=e.rotation,s=this.$drawing.scale,c=i/s,u=a/s;t.lineStyle(1,4096759).beginFill(16777215).drawCircle(0,0,5).endFill().beginFill(4096759,.2).drawRect(-c/2,-u/2,c,u).endFill(),t.pivot.x=0,t.pivot.y=0;var l=this.$toCanvas(n,r),h=Object(re["a"])(l,2);t.x=h[0],t.y=h[1],t.rotation=o}},methods:{show:function(){this.$state.active=!0,this.$setDirty()},hide:function(){this.$state.active=!1,this.$setDirty()},updateState:function(t,e,n,r,i){this.$state.x=t,this.$state.y=e,this.$state.width=n,this.$state.height=r,this.$state.rotation=i,this.$setDirty()}}},Pc),Mc=x.Element.define({groupIndex:1300,state:function(){return{active:!1,x:0,y:0,width:0,height:0}},render:function(t){if(this.$state.active){var e=this.$state,n=e.x,r=e.y,i=e.width,a=e.height,o=this.$drawing.scale,s=i/o,c=a/o;t.lineStyle(1,4096759).beginFill(4096759,.2).drawRect(-s/2,-c/2,s,c).endFill(),t.pivot.x=0,t.pivot.y=0;var u=this.$toCanvas(n,r),l=Object(re["a"])(u,2);t.x=l[0],t.y=l[1]}},methods:{show:function(){this.$state.active=!0,this.$setDirty()},hide:function(){this.$state.active=!1,this.$setDirty()},updateState:function(t){var e=this.$drawing.scale,n=t.width*e,r=t.height*e,i=this.$toGeometry(t.x,t.y);this.$state.x=i[0]+n/2,this.$state.y=i[1]-r/2,this.$state.width=n,this.$state.height=r,this.$setDirty()},remove:function(){this.$destroy()}}},Pc),Hc=x.Tool.READY,Bc=Symbol("Pick"),Vc=Symbol("Show"),zc=function(t){Object(qe["a"])(n,t);var e=Object(Je["a"])(n);function n(){return Object(ct["a"])(this,n),e.apply(this,arguments)}return Object(ut["a"])(n,[{key:"getElement",value:function(){return Ur(this).getElement()}},{key:"moveElement",value:function(t){return Ur(this).moveElement(t)}}]),n}(b.Proxy.ToolProvider(["open","pick","drop","close"])),Uc=[[-1,1],[0,1],[1,1],[-1,0],[1,0],[-1,-1],[0,-1],[1,-1]],Yc=x.Tool.define(Object(lt["a"])({},Vc,(function(){this.updateState()})),{open:[[Hc,ft["e"],Bc]],pick:[[Bc,function(){var t=this;this.$data.element=this.$plugin.$drawing.focusing;var e,n=Object(je["a"])(this.$data.handlers);try{for(n.s();!(e=n.n()).done;){var r=e.value;r.show()}}catch(i){n.e(i)}finally{n.f()}this.$data.rotater.show(),this.$data.previewer.show(),this.$data.outline.show(),this.$data.element.on("change",this.$data.listener=function(){t.updateState()})},Vc],[Vc,function(){this.$data.element.off("change",this.$data.listener),this.$data.element=this.$plugin.$drawing.focusing,this.$data.element.on("change",this.$data.listener)},Vc],[Hc,ft["e"],Hc]],drop:[[Vc,function(){var t,e=Object(je["a"])(this.$data.handlers);try{for(e.s();!(t=e.n()).done;){var n=t.value;n.hide()}}catch(r){e.e(r)}finally{e.f()}this.$data.rotater.hide(),this.$data.previewer.hide(),this.$data.outline.hide(),this.$data.element.off("change",this.$data.listener),this.$data.element=null},Bc],[Bc,ft["e"],Bc],[Hc,ft["e"],Hc]],close:[[Vc,function(){var t,e=Object(je["a"])(this.$data.handlers);try{for(e.s();!(t=e.n()).done;){var n=t.value;n.hide()}}catch(r){e.e(r)}finally{e.f()}this.$data.rotater.hide(),this.$data.previewer.hide(),this.$data.outline.hide(),this.$data.element.off("change",this.$data.listener),this.$data.element=null},Hc],[Bc,ft["e"],Hc],[Hc,ft["e"],Hc]]},{proxy:b.Proxy.Creator(zc),data:function(t){var e=t.$createElement("Rotater"),n=t.$createElement("Previewer"),r=t.$createElement("Outline"),i=Uc.map((function(a){var o=t.$createElement.apply(t,["Handler"].concat(Object(ht["a"])(a)));return o.$on("update",(function(t){var a,o=t.x,s=t.y,c=t.width,u=t.height,l=t.rotation,h=Object(je["a"])(i);try{for(h.s();!(a=h.n()).done;){var f=a.value;f.updateState(o,s,c,u,l)}}catch(d){h.e(d)}finally{h.f()}e.updateState(o,s,c,u,l),n.updateState(o,s,c,u,l),r.updateState(o,s,c,u,l)})),o}));return e.$on("update",(function(t){var e,a=t.x,o=t.y,s=t.width,c=t.height,u=t.rotation,l=Object(je["a"])(i);try{for(l.s();!(e=l.n()).done;){var h=e.value;h.updateState(a,o,s,c,u)}}catch(f){l.e(f)}finally{l.f()}n.updateState(a,o,s,c,u),r.updateState(a,o,s,c,u)})),n.$on("update",(function(t){var n,a=t.x,o=t.y,s=t.width,c=t.height,u=t.rotation,l=Object(je["a"])(i);try{for(l.s();!(n=l.n()).done;){var h=n.value;h.updateState(a,o,s,c,u)}}catch(f){l.e(f)}finally{l.f()}e.updateState(a,o,s,c,u),r.updateState(a,o,s,c,u)})),{element:null,handlers:i,rotater:e,previewer:n,outline:r,listener:ft["e"]}},methods:{updateState:function(){var t,e=this.$data.element,n=this.$plugin.$data.transformerAdapter.get(e.constructor),r=n.getPosition(e),i=Object(re["a"])(r,2),a=i[0],o=i[1],s=n.getWidth(e),c=n.getHeight(e),u=n.getRotation(e),l=Object(je["a"])(this.$data.handlers);try{for(l.s();!(t=l.n()).done;){var h=t.value;h.updateState(a,o,s,c,u)}}catch(f){l.e(f)}finally{l.f()}this.$data.rotater.updateState(a,o,s,c,u),this.$data.previewer.updateState(a,o,s,c,u),this.$data.outline.updateState(a,o,s,c,u)},getElement:function(){return this.$data.element},moveElement:function(t){this.$data.element=t,this.updateState(),this.$data.previewer.setCreating(!0),this.$data.previewer.show(),this.$data.previewer.elementAdjust()}},reset:function(){this.close()}}),Gc=x.Tool.READY,_c=Symbol("Pick"),Xc=Symbol("Show"),Kc=function(t){Object(qe["a"])(n,t);var e=Object(Je["a"])(n);function n(){return Object(ct["a"])(this,n),e.apply(this,arguments)}return Object(ut["a"])(n,[{key:"setElement",value:function(t){return Ur(this).setElement(t)}},{key:"getElements",value:function(){return Ur(this).getElements()}}]),n}(b.Proxy.ToolProvider(["open","pick_single","pick_multiple","drop","close"])),qc=x.Tool.define({},{open:[[Gc,ft["e"],_c]],pick_single:[[_c,function(){this.addSingleBounds()},Xc],[Xc,function(){this.addSingleBounds()},Xc],[Gc,ft["e"],Gc]],pick_multiple:[[_c,function(){this.addMultipleBounds()},Xc],[Xc,function(){this.addMultipleBounds()},Xc],[Gc,ft["e"],Gc]],drop:[[Xc,function(){this.clearBounds()},_c],[_c,ft["e"],_c],[Gc,ft["e"],Gc]],close:[[Xc,function(){this.clearBounds()},Gc],[_c,ft["e"],Gc],[Gc,ft["e"],Gc]]},{proxy:b.Proxy.Creator(Kc),data:function(){return{element:null,boundsList:[],elementList:[],listenerList:[]}},methods:{addSingleBounds:function(){var t=this,e=this.$data.element||this.$plugin.$drawing.focusing,n=this.$plugin.$createElement("Bounds");this.clearBounds(),n.show(),this.updateState(n,e);var r=function(){t.updateState(n,e)};e.on("change",r),this.$data.boundsList.push(n),this.$data.elementList.push(e),this.$data.listenerList.push(r),this.$plugin.$emit("selector-add",this.$data.elementList)},addMultipleBounds:function(t){var e=this,n=this.$data,r=n.boundsList,i=n.elementList,a=n.listenerList,o=i.indexOf(t);if(o>-1){var s=r.splice(o,1),c=Object(re["a"])(s,1),u=c[0];return i[o].off("change",a[o]),i.splice(o,1),void u.remove()}var l=this.$plugin.$createElement("Bounds");this.updateState(l,t),l.show();var h=function(){e.updateState(l,t)};t.on("change",h),r.push(l),i.push(t),a.push(h),this.$plugin.$emit("selector-add",this.$data.elementList)},clearBounds:function(){var t,e=this,n=Object(je["a"])(this.$data.boundsList);try{for(n.s();!(t=n.n()).done;){var r=t.value;r.remove()}}catch(i){n.e(i)}finally{n.f()}this.$data.elementList.forEach((function(t,n){t.off("change",e.$data.listenerList[n])})),this.$data.boundsList=[],this.$data.elementList=[],this.$data.listenerList=[],this.$plugin.$emit("selector-clear")},updateState:function(t,e){var n=this.$plugin.$data.selectorAdapter.get(e.constructor),r=n.getBounds(e);t.updateState(r)},setElement:function(t){this.$data.element=t},getElements:function(){return this.$data.elementList}},reset:function(){this.close()}}),Jc=w.define({id:"com.3dnest.spoke.common",namespace:"common",version:Sc["a"],plugin:Pc,elements:{Handler:Nc,Rotater:Wc,Previewer:Ic,Outline:Rc,Bounds:Mc},tools:{Transformer:Yc,Selector:qc}}),Qc=n("0aa2"),Zc=b.Options.define,tu=Zc({enabled:!0},{rectangular:Zc({enabled:!0,referenceUnit:15},{style:Zc({color:13421823,lineWidth:1}),snap:Zc({enabled:!0})})}),eu=function(t){Object(qe["a"])(n,t);var e=Object(Je["a"])(n);function n(){return Object(ct["a"])(this,n),e.apply(this,arguments)}return Object(ut["a"])(n)}(b.Proxy.Plugin),nu=x.define({options:tu,proxy:b.Proxy.Creator(eu),data:function(){return{layerList:[]}},created:function(){var t=this.$createElement("RectangularGrid");this.$data.layerList.push(t)}}),ru=(n("6b93"),n("7db0"),[5,2,1]),iu=function(t,e,n){return t.moveTo(0,e).lineTo(n,e)},au=function(t,e,n){return t.moveTo(e,0).lineTo(e,n)},ou=function(t){Object(qe["a"])(n,t);var e=Object(Je["a"])(n);function n(){return Object(ct["a"])(this,n),e.apply(this,arguments)}return Object(ut["a"])(n)}(b.Proxy.Element),su=x.Element.define({proxy:b.Proxy.Creator(ou),groupIndex:0,render:function(t){var e=this.$plugin.$options,n=e.rectangular.style,r=this.$drawing,i=r.width,a=r.height,o=r.scale,s=r.origin,c=Object(re["a"])(s,2),u=c[0],l=c[1],h=this.getUnitInMM(),f=function(t){return h*t/o};t.lineStyle(n.lineWidth,n.color,1,0);var d=0,p=0;for(d=1;(p=f(d))<u;d++)au(t,ft["d"].round(u-p),a);for(d=1;(p=f(d))<i-u;d++)au(t,ft["d"].round(u+p),a);for(d=1;(p=f(d))<l;d++)iu(t,ft["d"].round(l-p),i);for(d=1;(p=f(d))<a-l;d++)iu(t,ft["d"].round(l+p),i);t.lineStyle(1,16711680,1,0).moveTo(0,l).lineTo(i,l).moveTo(u,0).lineTo(u,a)},created:function(){var t=this,e=this.$plugin.$options;this.$drawing.registerSnap({name:"grid-point",priority:-1/0,get active(){return e.enabled&&e.rectangular.enabled&&e.rectangular.snap.enabled},handle:function(e,n,r){var i=t.getUnitInMM(),a=t.$toGeometry(e,n),o=a.map(cu,i),s=t.$toCanvas.apply(t,Object(ht["a"])(o));r.apply(void 0,Object(ht["a"])(s))}})},methods:{getUnitInMM:function(){var t=this.$plugin.$options.rectangular.referenceUnit,e=t*this.$drawing.scale,n=ft["d"].pow(10,ft["d"].floor(ft["d"].log10(e)));return ru.find(uu,ft["d"].round(e/n))*n}}},nu);function cu(t){return ft["d"].round(t/this)*this}function uu(t){return this>=t}var lu,hu=4,fu=x.Element.define({groupIndex:1e4,created:function(){var t=this;this.$drawing.on("snap",(function(){return t.$setDirty()}))},render:function(t){t.lineStyle(1,13421772).moveTo(-hu,-hu).lineTo(hu,hu).moveTo(hu,-hu).lineTo(-hu,hu);var e=Object(re["a"])(this.$drawing.virtual,2);t.x=e[0],t.y=e[1]}},nu),du=w.define({id:"com.3dnest.spoke.grid",namespace:"grid",version:Qc["a"],plugin:nu,elements:{RectangularGrid:su,Crosshair:fu}}),pu=n("c5c2"),vu=function(t){Object(qe["a"])(n,t);var e=Object(Je["a"])(n);function n(){return Object(ct["a"])(this,n),e.apply(this,arguments)}return Object(ut["a"])(n,[{key:"adjuster",get:function(){return Ur(this).adjuster}}]),n}(b.Proxy.Plugin),yu=x.define({proxy:b.Proxy.Creator(vu),data:function(){return{adjuster:null}},created:function(){this.$data.adjuster=this.$createTool("Adjuster")},getters:{adjuster:function(){return this.$data.adjuster}}}),gu=50,bu=function(t,e){var n=t.corner,r=t.back.corner,i=o.normalize.apply(o,Object(ht["a"])(o.fromBothPoint(n.x,n.y,r.x,r.y))),a=Object(re["a"])(i,2),s=a[0],u=a[1],l=c.translate.apply(c,[n.x,n.y].concat(Object(ht["a"])(o.multiply(s,u,e)))),h=Object(re["a"])(l,2),f=h[0],d=h[1];return[f,d]},mu=function(t,e,n){var r=t.corner,i=t.back.corner;return c.project.apply(c,[e,n].concat(Object(ht["a"])(s.fromSegment(r.x,r.y,i.x,i.y))))},$u=function(t,e,n){var r=t.corner,i=mu(t,e,n);return o.length.apply(o,Object(ht["a"])(o.fromBothPoint.apply(o,[r.x,r.y].concat(Object(ht["a"])(i)))))},Ou=function(t,e,n,r,i){var a=null,s=null,u=0;if(t.forEach((function(t){var r=mu(t.thisSurface,e,n),i=Object(re["a"])(r,2),a=i[0],c=i[1],l=Math.min(t.thisSurface.corner.x,t.thatSurface.corner.x),h=Math.max(t.thisSurface.corner.x,t.thatSurface.corner.x),f=Math.min(t.thisSurface.corner.y,t.thatSurface.corner.y),d=Math.max(t.thisSurface.corner.y,t.thatSurface.corner.y);if(!(a<l||a>h||c<f||c>d)){var p=o.length.apply(o,Object(ht["a"])(o.fromBothPoint(e,n,a,c)));(!s||p<u)&&(s=t,u=p)}})),!s||u/r>gu)i.corner.x=e,i.corner.y=n,i.back.corner.x=e+10,i.back.corner.y=n,a=i;else{var l=s.thisSurface,h=s.thatSurface;a=c.toLeftOfSegment(e,n,h.corner.x,h.corner.y,l.corner.x,l.corner.y)?h:l}return a},xu=x.Element.define({groupIndex:1200,interative:!0,hoverable:!0,state:function(){return{active:!1,surface:null,offset:0,width:0}},created:function(){var t=this;this.$on("pointerdown",(function(e){e.stopPropagation(),t.beginAdjust()}))},destroy:function(){},render:function(t){if(this.$state.active){var e=this.$state,n=e.surface,r=e.offset,i=e.width,a=this.$toCanvas.apply(this,Object(ht["a"])(bu(n,r-i/2))),o=Object(re["a"])(a,2),s=o[0],c=o[1];t.lineStyle(this.$hovering||this.$holding?2:1,this.$hovering||this.$holding?16777215:4096759).beginFill(4096759,.5).drawCircle(s,c,5)}},methods:{show:function(){this.$state.active=!0,this.$setDirty()},hide:function(){this.$state.active=!1,this.$setDirty()},setSurface:function(t){this.$state.surface=t,this.$setDirty()},setOffset:function(t){this.$state.offset=t,this.$setDirty()},setWidth:function(t){this.$state.width=t,this.$setDirty()},updateState:function(t,e,n){this.setSurface(t),this.setOffset(e),this.setWidth(n)},beginAdjust:function(){var t=this,e=this.$data.adjuster.getElement(),n=this.$state,r=n.surface,i=n.offset,a=n.width,o=function(n){var o=t.$toGeometry(n.pointerX,n.pointerY),s=$u.apply(void 0,[r].concat(Object(ht["a"])(o))),c=i-a/2-s,u=i-c/2,l=a+c;t.setOffset(u),t.setWidth(l),e.setOffset(u),e.setWidth(l),t.$emit("update",{surface:r,offset:u,width:l})},s=function e(){t.$drawing.off("pointermove",o),window.removeEventListener("mouseup",e)};this.$drawing.on("pointermove",o),window.addEventListener("mouseup",s)}}},yu),wu=x.Element.define({groupIndex:1200,interative:!0,hoverable:!0,state:function(){return{active:!1,surface:null,offset:0,width:0}},created:function(){var t=this;this.$on("pointerdown",(function(e){e.stopPropagation(),t.beginAdjust()}))},destroy:function(){},render:function(t){if(this.$state.active){var e=this.$state,n=e.surface,r=e.offset,i=e.width,a=this.$toCanvas.apply(this,Object(ht["a"])(bu(n,r+i/2))),o=Object(re["a"])(a,2),s=o[0],c=o[1];t.lineStyle(this.$hovering||this.$holding?2:1,this.$hovering||this.$holding?16777215:4096759).beginFill(4096759,.5).drawRect(s-5,c-5,10,10)}},methods:{show:function(){this.$state.active=!0,this.$setDirty()},hide:function(){this.$state.active=!1,this.$setDirty()},setSurface:function(t){this.$state.surface=t,this.$setDirty()},setOffset:function(t){this.$state.offset=t,this.$setDirty()},setWidth:function(t){this.$state.width=t,this.$setDirty()},updateState:function(t,e,n){this.setSurface(t),this.setOffset(e),this.setWidth(n)},beginAdjust:function(){var t=this,e=this.$data.adjuster.getElement(),n=this.$state,r=n.surface,i=n.offset,a=n.width,o=function(n){var o=t.$toGeometry(n.pointerX,n.pointerY),s=$u.apply(void 0,[r].concat(Object(ht["a"])(o))),c=s-i-a/2,u=i+c/2,l=a+c;t.setOffset(u),t.setWidth(l),e.setOffset(u),e.setWidth(l),t.$emit("update",{surface:r,offset:u,width:l})},s=function e(){t.$drawing.off("pointermove",o),window.removeEventListener("mouseup",e)};this.$drawing.on("pointermove",o),window.addEventListener("mouseup",s)}}},yu),ju=x.Element.define({groupIndex:1200,interative:!0,state:function(){return{surface:null,offset:0,width:0,listener:null,isCreating:!1}},methods:{show:function(){var t=this,e=this.$data.adjuster.getElement();e.on("pointerdown",this.$state.listener=function(n){t.$state.isCreating||t.hollowAdjust(e,n)}),this.$setDirty()},hide:function(){var t=this.$data.adjuster.getElement();t&&t.off("pointerdown",this.$state.listener),this.$setDirty()},setSurface:function(t){this.$state.surface=t,this.$setDirty()},setOffset:function(t){this.$state.offset=t,this.$setDirty()},setWidth:function(t){this.$state.width=t,this.$setDirty()},setCreating:function(t){this.$state.isCreating=t,this.$setDirty()},updateState:function(t,e,n){this.setSurface(t),this.setOffset(e),this.setWidth(n)},adjustAction:function(t,e,n,r){this.setSurface(e),this.setOffset(n),t.setSurface(e),t.setOffset(n),this.$emit("update",{surface:e,offset:n,width:r})},hollowAdjust:function(t,e){var n=this,r=this.$state,i=r.surface,a=r.offset,o=r.width,s=r.isCreating,c=this.$drawing,u=e?$u.apply(void 0,[i].concat(Object(ht["a"])(this.$toGeometry(e.pointerX,e.pointerY))))-a:0,l=c.structure.getAllWallList(),h=function(e){var r=n.$toGeometry(e.pointerX,e.pointerY),i=Ou.apply(void 0,[l].concat(Object(ht["a"])(r),[n.$drawing.scale,t.virtualSurface]));if("virtual"!==i.name){var a=$u.apply(void 0,[i].concat(Object(ht["a"])(r)))-u,s=$u.apply(void 0,[i].concat(Object(ht["a"])(i.originSafe))),c=$u.apply(void 0,[i].concat(Object(ht["a"])(i.targetSafe))),h=$u.apply(void 0,[i].concat(Object(ht["a"])(i.back.originSafe))),f=$u.apply(void 0,[i].concat(Object(ht["a"])(i.back.targetSafe))),d=Math.max(s,f)+o/2,p=Math.min(c,h)-o/2,v=a<d?d:a>p?p:a;n.adjustAction(t,i,v,o)}else n.adjustAction(t,i,0,o)},f=function(){c.off("pointermove",h),window.removeEventListener("mouseup",d),window.removeEventListener("keydown",p),s&&n.setCreating(!1)},d=function(){f()},p=function(e){"Escape"===e.code&&s&&(t.remove(),f())};c.on("pointermove",h),window.addEventListener("mouseup",d),window.addEventListener("keydown",p)}}},yu),ku=x.Tool.READY,Tu=Symbol("Pick"),Eu=Symbol("Show"),Su=function(t){Object(qe["a"])(n,t);var e=Object(Je["a"])(n);function n(){return Object(ct["a"])(this,n),e.apply(this,arguments)}return Object(ut["a"])(n,[{key:"getElement",value:function(){return Ur(this).getElement()}},{key:"moveElement",value:function(t){return Ur(this).moveElement(t)}}]),n}(b.Proxy.ToolProvider(["open","pick","drop","close"])),Cu=x.Tool.define(Object(lt["a"])({},Eu,(function(){this.updateState()})),{open:[[ku,ft["e"],Tu]],pick:[[Tu,function(){var t=this;this.$data.element=this.$plugin.$drawing.focusing,this.$data.element.on("change",this.$data.listener=function(){t.updateState()}),this.$data.headHandler.show(),this.$data.rearHandler.show(),this.$data.mover.show()},Eu],[Eu,function(){var t=this;this.$data.element!==this.$plugin.$drawing.focusing&&(this.$data.element.off("change",this.$data.listener),this.$data.mover.hide(),this.$data.element=this.$plugin.$drawing.focusing,this.$data.element.on("change",this.$data.listener=function(){t.updateState()}),this.$data.mover.show())},Eu],[ku,ft["e"],ku]],drop:[[Eu,function(){this.$data.headHandler.hide(),this.$data.rearHandler.hide(),this.$data.mover.hide(),this.$data.element.off("change",this.$data.listener),this.$data.element=null},Tu],[Tu,ft["e"],Tu],[ku,ft["e"],ku]],close:[[Eu,function(){this.$data.headHandler.hide(),this.$data.rearHandler.hide(),this.$data.mover.hide()},ku],[Tu,ft["e"],ku],[ku,ft["e"],ku]]},{proxy:b.Proxy.Creator(Su),data:function(t){var e=t.$createElement("HeadHandler"),n=t.$createElement("RearHandler"),r=t.$createElement("Mover");return e.$on("update",(function(t){var e=t.surface,i=t.offset,a=t.width;n.updateState(e,i,a),r.updateState(e,i,a)})),n.$on("update",(function(t){var n=t.surface,i=t.offset,a=t.width;e.updateState(n,i,a),r.updateState(n,i,a)})),r.$on("update",(function(t){var r=t.surface,i=t.offset,a=t.width;n.updateState(r,i,a),e.updateState(r,i,a)})),{element:null,headHandler:e,rearHandler:n,mover:r,listener:ft["e"]}},methods:{updateState:function(){var t=this.$data.element,e=t.surface,n=t.offset,r=t.width;this.$data.headHandler.updateState(e,n,r),this.$data.rearHandler.updateState(e,n,r),this.$data.mover.updateState(e,n,r)},getElement:function(){return this.$data.element},moveElement:function(t){this.$data.element=t,this.drop(),this.$data.mover.setCreating(!0),this.$data.mover.hollowAdjust(t)}},reset:function(){this.close()}}),Pu=w.define({id:"com.3dnest.spoke.hammer",namespace:"hammer",version:pu["a"],plugin:yu,elements:{HeadHandler:xu,RearHandler:wu,Mover:ju},tools:{Adjuster:Cu}}),Lu=n("7612"),Du=function(t){Object(qe["a"])(n,t);var e=Object(Je["a"])(n);function n(){return Object(ct["a"])(this,n),e.apply(this,arguments)}return Object(ut["a"])(n,[{key:"from",get:function(){return ft["c"].throwError("The `.from` getter MUST be implemented.")}},{key:"to",get:function(){return ft["c"].throwError("The `.to` getter MUST be implemented.")}}]),n}(un["a"].Emitter),Au=function(t){return ft["c"].instanceOf(t,Du)},Nu=Au,Fu=function(t){Object(qe["a"])(n,t);var e=Object(Je["a"])(n);function n(){return Object(ct["a"])(this,n),e.apply(this,arguments)}return Object(ut["a"])(n,[{key:"createDimension",value:function(t){return Nu(t)||ft["c"].Throw.TypeError("Invalid adaptor, a adaptor expected."),Ur(this).createDimension(t).$proxy}},{key:"setFontsizer",value:function(t){Ur(this).setFontsizer(t)}},{key:"setTextOffsetYModifier",value:function(t){Ur(this).setTextOffsetYModifier(t)}},{key:"removeAll",value:function(){Ur(this).removeAll()}},{key:"dimensions",value:Object(ge["a"])().mark((function t(){var e,n,r;return Object(ge["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=Object(je["a"])(Ur(this).dimensions()),t.prev=1,e.s();case 3:if((n=e.n()).done){t.next=9;break}return r=n.value,t.next=7,r.$proxy;case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](1),e.e(t.t0);case 14:return t.prev=14,e.f(),t.finish(14);case 17:case"end":return t.stop()}}),t,this,[[1,11,14,17]])}))}]),n}(b.Proxy.Plugin),Wu=function(t){return 360/t},Iu=function(t){return-t},Ru=x.define({proxy:b.Proxy.Creator(Fu),data:function(){return{fontsizer:Wu,textOffsetYModifier:Iu}},created:function(){var t=this;this.$on("element-created",(function(e,n){t.$emit("".concat(n.toLowerCase(),"-created"),e)}))},methods:{createDimension:function(t){return this.$createElement("Dimension",t)},setFontsizer:function(t){this.$data.fontsizer=t,this.$forceUpdate()},setTextOffsetYModifier:function(t){this.$data.textOffsetYModifier=t,this.$forceUpdate()},removeAll:function(){this.$getElementList("Dimension").forEach((function(t){return t.$proxy.remove()}))},dimensions:Object(ge["a"])().mark((function t(){var e,n,r;return Object(ge["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=Object(je["a"])(this.$elements("Dimension")),t.prev=1,e.s();case 3:if((n=e.n()).done){t.next=9;break}return r=n.value,t.next=7,r;case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](1),e.e(t.t0);case 14:return t.prev=14,e.f(),t.finish(14);case 17:case"end":return t.stop()}}),t,this,[[1,11,14,17]])}))}}),Mu=function(t){Object(qe["a"])(n,t);var e=Object(Je["a"])(n);function n(){return Object(ct["a"])(this,n),e.apply(this,arguments)}return Object(ut["a"])(n,[{key:"offset",get:function(){return Ur(this).$state.offset},set:function(t){ft["h"].Not.Number(t)&&ft["c"].Throw.TypeError("Invalid value, a number expected."),Ur(this).setOffset(t)}},{key:"hide",value:function(){Ur(this).$hide()}},{key:"show",value:function(){Ur(this).$show()}},{key:"remove",value:function(){Ur(this).$destroy()}}]),n}(b.Proxy.Element),Hu=200,Bu=200,Vu=0,zu=100,Uu=30,Yu=ft["d"].PI,Gu=Yu/2,_u=400,Xu=function(t){return t>Gu&&t<=Yu||t>-Yu&&t<=-Gu},Ku=x.Element.define({proxy:b.Proxy.Creator(Mu),groupIndex:1e3,interative:!0,focusable:!0,state:function(){return{element:null,offset:Hu,valueText:null}},render:function(t){var e=this.$state,n=e.element,r=e.offset,a=e.valueText,s=n.from,u=n.to,h=o.length.apply(o,Object(ht["a"])(o.from.apply(o,Object(ht["a"])(s).concat(Object(ht["a"])(u)))));if(h<_u)a.visible=!1;else{var f=this.$drawing.scale,d=this.$data,p=d.fontsizer,v=d.textOffsetYModifier,y=Bu/f,g=Vu/f,b=zu/f,m=Uu/f,$=p(f);a.visible=!0,a.style.fontSize=$,a.text=ft["d"].round(h),a.y=v($),a.pivot.set(a.width/2,a.height/2);var O=i.Segment.apply(i,Object(ht["a"])(this.$toCanvas.apply(this,Object(ht["a"])(s))).concat(Object(ht["a"])(this.$toCanvas.apply(this,Object(ht["a"])(u))))),x=o.fromSegment.apply(o,Object(ht["a"])(O)),w=Object(re["a"])(x,2),j=w[0],k=w[1],T=o.length(j,k)/2;t.lineStyle(1,0),r<0?t.moveTo(-T,b).lineTo(-T,-y).moveTo(T,b).lineTo(T,-y):t.moveTo(-T,y).lineTo(-T,-b).moveTo(T,y).lineTo(T,-b),t.moveTo(-T-g,0).lineTo(T+g,0).lineStyle(3).moveTo(-T-m,m).lineTo(-T+m,-m).moveTo(T-m,m).lineTo(T+m,-m);var E=l.middle.apply(l,Object(ht["a"])(O)),S=o.invert.apply(o,Object(ht["a"])(o.rotate90.apply(o,Object(ht["a"])(o.normalize(j,k))))),C=o.multiply.apply(o,Object(ht["a"])(S).concat([r/f])),P=c.translate.apply(c,Object(ht["a"])(E).concat(Object(ht["a"])(C))),L=Object(re["a"])(P,2);t.x=L[0],t.y=L[1],Xu(t.rotation=ft["d"].atan2(k,j))&&(a.rotation=ft["d"].PI)}},created:function(t){var e=this,n=this.$state.valueText=new ln.Text;ft["f"].assign(n.style,{stroke:16777215,strokeThickness:2}),t.on("change",(function(){return e.$setDirty()})),t.on("destroy",(function(){return e.$destroy()})),this.$state.element=t,this.$graphics.addChild(n)},methods:{setOffset:function(t){this.$state.offset=t,this.$setDirty()}}},Ru),qu=w.define({id:"com.3dnest.spoke.measure",namespace:"measure",version:Lu["a"],plugin:Ru,elements:{Dimension:Ku}}),Ju=n("c394"),Qu=function(t){Object(qe["a"])(n,t);var e=Object(Je["a"])(n);function n(){return Object(ct["a"])(this,n),e.apply(this,arguments)}return Object(ut["a"])(n,[{key:"LineLabeler",get:function(){return Ur(this).$data.lineLabeler}},{key:"TextLabeler",get:function(){return Ur(this).$data.textLabeler}},{key:"LabelTransformer",get:function(){return Ur(this).$data.labelTransformer}},{key:"open",value:function(){return Ur(this).open()}},{key:"openTextLabeler",value:function(){return Ur(this).openTextLabeler()}},{key:"openLineLabeler",value:function(){return Ur(this).openLineLabeler()}},{key:"close",value:function(){return Ur(this).close()}},{key:"createLabelText",value:function(t,e,n){return Ur(this).createLabelText(t,e,n).$proxy}},{key:"createLabelLine",value:function(t,e,n){return Ur(this).createLabelLine(t,e,n).$proxy}},{key:"getAllLabelTextList",value:function(){return Array.from(this.textLabels())}},{key:"getAllLabelLineList",value:function(){return Array.from(this.lineLabels())}},{key:"textLabels",value:Object(ge["a"])().mark((function t(){var e,n,r;return Object(ge["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=Object(je["a"])(Ur(this).textLabels()),t.prev=1,e.s();case 3:if((n=e.n()).done){t.next=9;break}return r=n.value,t.next=7,r.$proxy;case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](1),e.e(t.t0);case 14:return t.prev=14,e.f(),t.finish(14);case 17:case"end":return t.stop()}}),t,this,[[1,11,14,17]])}))},{key:"lineLabels",value:Object(ge["a"])().mark((function t(){var e,n,r;return Object(ge["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=Object(je["a"])(Ur(this).lineLabels()),t.prev=1,e.s();case 3:if((n=e.n()).done){t.next=9;break}return r=n.value,t.next=7,r.$proxy;case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](1),e.e(t.t0);case 14:return t.prev=14,e.f(),t.finish(14);case 17:case"end":return t.stop()}}),t,this,[[1,11,14,17]])}))}]),n}(b.Proxy.Plugin),Zu=x.define({proxy:b.Proxy.Creator(Qu),data:function(){return{lineLabeler:null,textLabeler:null,labelTransformer:null}},created:function(){var t=this;this.$data.lineLabeler=this.$createTool("LineLabeler"),this.$data.textLabeler=this.$createTool("TextLabeler"),this.$data.labelTransformer=this.$createTool("LabelTransformer"),this.$on("element-created",(function(e,n){t.$emit("".concat(n.toLowerCase(),"-created"),e)}))},methods:{open:function(){this.openTextLabeler()},openTextLabeler:function(){this.$data.lineLabeler.close(),this.$data.textLabeler.open()},openLineLabeler:function(){this.$data.textLabeler.close(),this.$data.lineLabeler.open()},close:function(){this.$data.textLabeler.close(),this.$data.lineLabeler.close()},createLabelText:function(t,e,n){var r=this.$createElement("LabelText");return r.setPosition(t,e),r.setText(n),r},createLabelLine:function(t,e,n){var r=this.$createElement("LabelLine");return r.setOrigin(t),r.setTarget(e),r.setText(n),r},lineLabels:Object(ge["a"])().mark((function t(){var e,n,r;return Object(ge["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=Object(je["a"])(this.$elements("LabelLine")),t.prev=1,e.s();case 3:if((n=e.n()).done){t.next=9;break}return r=n.value,t.next=7,r;case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](1),e.e(t.t0);case 14:return t.prev=14,e.f(),t.finish(14);case 17:case"end":return t.stop()}}),t,this,[[1,11,14,17]])})),textLabels:Object(ge["a"])().mark((function t(){var e,n,r;return Object(ge["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=Object(je["a"])(this.$elements("LabelText")),t.prev=1,e.s();case 3:if((n=e.n()).done){t.next=9;break}return r=n.value,t.next=7,r;case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](1),e.e(t.t0);case 14:return t.prev=14,e.f(),t.finish(14);case 17:case"end":return t.stop()}}),t,this,[[1,11,14,17]])}))}}),tl=function(t){Object(qe["a"])(n,t);var e=Object(Je["a"])(n);function n(){return Object(ct["a"])(this,n),e.apply(this,arguments)}return Object(ut["a"])(n,[{key:"origin",get:function(){return Ur(this).origin}},{key:"target",get:function(){return Ur(this).target}},{key:"text",get:function(){return Ur(this).text}},{key:"visible",get:function(){return Ur(this).$visible}},{key:"setOrigin",value:function(t){return Ur(this).setOrigin(t)}},{key:"setTarget",value:function(t){return Ur(this).setTarget(t)}},{key:"setText",value:function(t){return Ur(this).setText(t)}},{key:"setFontsize",value:function(t){return Ur(this).fontSize(t)}},{key:"show",value:function(){Ur(this).$show()}},{key:"hide",value:function(){Ur(this).$hide()}},{key:"remove",value:function(){Ur(this).remove()}}]),n}(b.Proxy.Element),el=1500,nl=x.Element.define({proxy:b.Proxy.Creator(tl),groupIndex:1400,interative:!0,focusable:!0,state:function(){return{pixiText:null,origin:null,target:null,text:"",fontSize:200,rendering:!1}},getters:{origin:function(){return this.$state.origin},target:function(){return this.$state.target},text:function(){return this.$state.text}},render:function(t){var e,n,r=this.$state,i=r.origin,a=r.target,s=r.pixiText,c=r.text,u=r.fontSize,l=r.rendering,h=this.$drawing.scale;if(i&&a){var f=this.$toCanvas.apply(this,Object(ht["a"])(i)),d=this.$toCanvas.apply(this,Object(ht["a"])(a)),p=o.fromBothPoint.apply(o,Object(ht["a"])(i).concat(Object(ht["a"])(a))),v=ft["d"].atan2(p[1],p[0]);s.text=c||"No Text",s.style.fontSize=u/h,s.transform.pivot.y=s.height,s.transform.position.x=d[0],s.transform.position.y=d[1];var y=s.width>el/h?s.width:el/h;(e=(n=t.lineStyle(1,0)).moveTo.apply(n,Object(ht["a"])(f))).lineTo.apply(e,Object(ht["a"])(d)),v<ft["d"].PI/2&&v>-ft["d"].PI/2?(s.transform.pivot.x=0,t.lineTo(d[0]+y,d[1])):(s.transform.pivot.x=s.width,t.lineTo(d[0]-y,d[1])),l&&(this.$emit("change",this.$proxy),this.setRendering(!1))}},created:function(){var t=this.$state.pixiText=new ln.Text;Object.assign(t.style,{stroke:16777215,strokeThickness:2}),this.$graphics.addChild(t)},methods:{setOrigin:function(t){this.$state.origin=t,this.$setDirty(),this.setRendering(!0)},setTarget:function(t){this.$state.target=t,this.$setDirty(),this.setRendering(!0)},setText:function(t){this.$state.text=t,this.$setDirty(),this.setRendering(!0)},setFontSize:function(t){this.$state.fontSize=t,this.$setDirty(),this.setRendering(!0)},setRendering:function(t){this.$state.rendering=t},remove:function(){this.$destroy()}}},Zu),rl=function(t){Object(qe["a"])(n,t);var e=Object(Je["a"])(n);function n(){return Object(ct["a"])(this,n),e.apply(this,arguments)}return Object(ut["a"])(n,[{key:"text",get:function(){return Ur(this).text}},{key:"x",get:function(){return Ur(this).x}},{key:"y",get:function(){return Ur(this).y}},{key:"room",get:function(){return Ur(this).room}},{key:"visible",get:function(){return Ur(this).$visible}},{key:"setPosition",value:function(t,e){return Ur(this).setPosition(t,e)}},{key:"setText",value:function(t){return Ur(this).setText(t)}},{key:"setFontSize",value:function(t){return Ur(this).setFontSize(t)}},{key:"setRoom",value:function(t){return Ur(this).setRoom(t)}},{key:"show",value:function(){Ur(this).$show()}},{key:"hide",value:function(){Ur(this).$hide()}},{key:"remove",value:function(){Ur(this).remove()}}]),n}(b.Proxy.Element),il=x.Element.define({proxy:b.Proxy.Creator(rl),groupIndex:1500,interative:!0,focusable:!0,state:function(){return{pixiText:null,text:"",fontSize:200,x:0,y:0,room:null,rendering:!1}},getters:{text:function(){return this.$state.text},x:function(){return this.$state.x},y:function(){return this.$state.y},room:function(){return this.$state.room}},render:function(t){var e=this.$state,n=e.pixiText,r=e.text,i=e.fontSize,a=e.x,o=e.y,s=e.rendering,c=this.$drawing.scale;n.text=r||"No Text",n.style.fontSize=i/c,t.pivot.x=t.width/2,t.pivot.y=t.height/2;var u=this.$toCanvas(a,o),l=Object(re["a"])(u,2);t.x=l[0],t.y=l[1],s&&(this.$emit("change",this.$proxy),this.setRendering(!1))},created:function(){var t=this.$state.pixiText=new ln.Text;Object.assign(t.style,{stroke:16777215,strokeThickness:2,align:"center"}),this.$graphics.addChild(t)},methods:{setPosition:function(t,e){this.$state.x=t,this.$state.y=e,this.$setDirty(),this.setRendering(!0)},setText:function(t){this.$state.text=t,this.$setDirty(),this.setRendering(!0)},setFontSize:function(t){this.$state.fontSize=t,this.$setDirty(),this.setRendering(!0)},setRoom:function(t){this.$state.room=t,this.$setDirty()},setRendering:function(t){this.$state.rendering=t},remove:function(){this.$destroy()}}},Zu),al=x.Element.define({groupIndex:1600,interative:!0,hoverable:!0,state:function(){return{active:!1,x:0,y:0}},render:function(t){if(this.$state.active){var e=this.$state,n=e.x,r=e.y;this.$hovering?t.beginFill(16711680):t.beginFill(65280),t.drawCircle(0,0,3).endFill();var i=this.$toCanvas(n,r),a=Object(re["a"])(i,2);t.x=a[0],t.y=a[1]}},created:function(){var t=this;this.$on("pointerdown",(function(e){e.stopPropagation(),t.beginAdjust()}))},methods:{show:function(){this.$state.active=!0,this.$setDirty()},hide:function(){this.$state.active=!1,this.$setDirty()},setPosition:function(t,e){this.$state.x=t,this.$state.y=e,this.$setDirty()},beginAdjust:function(){var t=this,e=this.$data.labelTransformer.getElement(),n=function(n){var r=t.$toGeometry(n.pointerX,n.pointerY);t.setPosition.apply(t,Object(ht["a"])(r)),e.setOrigin(Object(ht["a"])(r)),t.$emit("update")},r=function e(){t.$drawing.off("pointermove",n),window.removeEventListener("mouseup",e)};this.$drawing.on("pointermove",n),window.addEventListener("mouseup",r)}}},Zu),ol=x.Element.define({groupIndex:1600,interative:!0,hoverable:!0,state:function(){return{active:!1,x:0,y:0}},render:function(t){if(this.$state.active){var e=this.$state,n=e.x,r=e.y;this.$hovering?t.beginFill(16711680):t.beginFill(65280),t.drawCircle(0,0,3).endFill();var i=this.$toCanvas(n,r),a=Object(re["a"])(i,2);t.x=a[0],t.y=a[1]}},created:function(){var t=this;this.$on("pointerdown",(function(e){e.stopPropagation(),t.beginAdjust()}))},methods:{show:function(){this.$state.active=!0,this.$setDirty()},hide:function(){this.$state.active=!1,this.$setDirty()},setPosition:function(t,e){this.$state.x=t,this.$state.y=e,this.$setDirty()},beginAdjust:function(){var t=this,e=this.$data.labelTransformer.getElement(),n=function(n){var r=t.$toGeometry(n.pointerX,n.pointerY);t.setPosition.apply(t,Object(ht["a"])(r)),e.setTarget(Object(ht["a"])(r)),t.$emit("update")},r=function e(){t.$drawing.off("pointermove",n),window.removeEventListener("mouseup",e)};this.$drawing.on("pointermove",n),window.addEventListener("mouseup",r)}}},Zu),sl=x.Element.define({groupIndex:1550,interative:!0,state:function(){return{active:!1,x:0,y:0,width:0,height:0}},render:function(t){if(this.$state.active){var e=this.$state,n=e.x,r=e.y,i=e.width,a=e.height,o=this.$drawing.scale,s=i/o,c=a/o;t.lineStyle(1,4096759).beginFill(4096759,.2).drawRect(-s/2,-c/2,s,c).endFill(),t.pivot.x=0,t.pivot.y=0;var u=this.$toCanvas(n,r),l=Object(re["a"])(u,2);t.x=l[0],t.y=l[1]}},created:function(){var t=this;this.$on("pointerdown",(function(e){e.stopPropagation(),t.beginAdjust(e)}))},methods:{show:function(){this.$state.active=!0,this.$setDirty()},hide:function(){this.$state.active=!1,this.$setDirty()},setWidth:function(t){this.$state.width=t,this.$setDirty()},setHeight:function(t){this.$state.height=t,this.$setDirty()},setPosition:function(t,e){this.$state.x=t,this.$state.y=e,this.$setDirty()},updateState:function(t,e,n,r){this.setPosition(t,e),this.setWidth(n),this.setHeight(r)},beginAdjust:function(t){var e=this,n=this.$drawing,r=this.$data.labelTransformer.getElement(),i=this.$state,a=i.x,o=i.y,s=this.$toGeometry(t.pointerX,t.pointerY),c={x:s[0]-a,y:s[1]-o};ft["c"].instanceOf(r,tl)&&(c.originX=s[0]-r.origin[0],c.originY=s[1]-r.origin[1],c.targetX=s[0]-r.target[0],c.targetY=s[1]-r.target[1]);var u=function(t){var n=e.$toGeometry(t.pointerX,t.pointerY),i=n[0]-c.x,a=n[1]-c.y;if(ft["c"].instanceOf(r,rl))if(r.room){var o=e.$state,s=o.width,u=o.height,l=[{x:i-s/2,y:a+u/2},{x:i+s/2,y:a+u/2},{x:i-s/2,y:a-u/2},{x:i+s/2,y:a-u/2}],f=r.room.getOuterSurfaceList().map((function(t){return{x:t.origin[0],y:t.origin[1]}})),d=l.find((function(t){return!h.containsPoint(f,t)}));d||r.setPosition(i,a)}else r.setPosition(i,a);else r.setOrigin([n[0]-c.originX,n[1]-c.originY]),r.setTarget([n[0]-c.targetX,n[1]-c.targetY]);e.setPosition(i,a),e.$emit("update")},l=function t(){n.off("pointermove",u),window.removeEventListener("mouseup",t)};n.on("pointermove",u),window.addEventListener("mouseup",l)}}},Zu),cl=x.Tool.READY,ul=Symbol("PickOrigin"),ll=Symbol("PickTarget"),hl={PICK_ORIGIN:ul,PICK_TARGET:ll},fl=function(t){Object(qe["a"])(n,t);var e=Object(Je["a"])(n);function n(){return Object(ct["a"])(this,n),e.apply(this,arguments)}return Object(ut["a"])(n)}(b.Proxy.ToolProvider(["open","pick","close"])),dl=x.Tool.define({},{open:[[cl,ft["e"],ul]],pick:[[ul,function(){var t=this.$plugin,e=this.$data.labelLine=this.$plugin.$createElement("LabelLine");e.setOrigin(t.$toGeometry.apply(t,Object(ht["a"])(t.$drawing.pointer))),t.$drawing.on("pointermove",this.$data.listener=function(n){var r=n.pointerX,i=n.pointerY;e.setTarget(t.$toGeometry(r,i))})},ll],[ll,function(){var t=this.$plugin;t.$drawing.off("pointermove",this.$data.listener),this.$emit("pick-target",this.$data.labelLine.$proxy)},cl]],close:[[ul,ft["e"],cl],[ll,function(){this.$data.labelLine.remove()},cl],[cl,ft["e"],cl]]},{proxy:b.Proxy.Creator(fl),data:function(){return{labelLine:null,listener:ft["e"]}},methods:{},reset:function(){this.close()}}),pl=x.Tool.READY,vl=Symbol("Pick"),yl={PICK:vl},gl=function(t){Object(qe["a"])(n,t);var e=Object(Je["a"])(n);function n(){return Object(ct["a"])(this,n),e.apply(this,arguments)}return Object(ut["a"])(n)}(b.Proxy.ToolProvider(["open","pick","close"])),bl=x.Tool.define({},{open:[[pl,ft["e"],vl]],pick:[[vl,function(){var t,e=this.$plugin.$drawing,n=this.$plugin.$createElement("LabelText");n.setPosition.apply(n,Object(ht["a"])((t=this.$plugin).$toGeometry.apply(t,Object(ht["a"])(e.pointer)))),this.$emit("pick",n.$proxy)},pl]],close:[[vl,ft["e"],pl],[pl,ft["e"],pl]]},{proxy:b.Proxy.Creator(gl),data:function(){return{}},methods:{},reset:function(){this.close()}}),ml=x.Tool.READY,$l=Symbol("Pick"),Ol=Symbol("Show"),xl=function(t){Object(qe["a"])(n,t);var e=Object(Je["a"])(n);function n(){return Object(ct["a"])(this,n),e.apply(this,arguments)}return Object(ut["a"])(n,[{key:"getElement",value:function(){return Ur(this).getElement()}}]),n}(b.Proxy.ToolProvider(["open","pick","drop","close"])),wl=x.Tool.define(Object(lt["a"])({},Ol,(function(){this.updateState()})),{open:[[ml,ft["e"],$l],[$l,ft["e"],$l]],pick:[[$l,function(){this.showTool()},Ol],[Ol,function(){this.$data.label!==this.$plugin.$drawing.focusing&&this.showTool()},Ol],[ml,ft["e"],ml]],drop:[[Ol,function(){this.hideTool()},$l],[$l,ft["e"],$l],[ml,ft["e"],ml]],close:[[Ol,function(){this.hideTool()},ml],[$l,ft["e"],ml],[ml,ft["e"],ml]]},{proxy:b.Proxy.Creator(xl),data:function(t){var e=this,n=t.$createElement("OriginHandler"),r=t.$createElement("TargetHandler"),i=t.$createElement("LabelMover");return n.$on("update",(function(){e.updateState()})),r.$on("update",(function(){e.updateState()})),i.$on("update",(function(){e.updateState()})),{label:null,originHandler:n,targetHandler:r,labelMover:i}},methods:{showTool:function(){this.$data.label=this.$plugin.$drawing.focusing,this.$data.originHandler.show(),this.$data.targetHandler.show(),this.$data.labelMover.show()},hideTool:function(){this.$data.originHandler.hide(),this.$data.targetHandler.hide(),this.$data.labelMover.hide(),this.$data.label=null},updateState:function(){var t,e,n,r=this.$data.label,i=this.$plugin.$drawing.scale,a=r.$bounds,o=a.width,s=a.height,c=a.top,u=a.left,l=this.$plugin.$toGeometry(u+o/2,c+s/2);((t=this.$data.labelMover).updateState.apply(t,Object(ht["a"])(l).concat([o*i,s*i])),ft["c"].instanceOf(r,tl))?((e=this.$data.originHandler).setPosition.apply(e,Object(ht["a"])(r.origin)),(n=this.$data.targetHandler).setPosition.apply(n,Object(ht["a"])(r.target))):(this.$data.originHandler.hide(),this.$data.targetHandler.hide())},getElement:function(){return this.$data.label}},reset:function(){this.close()}}),jl=w.define({id:"com.3dnest.spoke.label",namespace:"label",version:Ju["a"],plugin:Zu,elements:{LabelLine:nl,LabelText:il,OriginHandler:al,TargetHandler:ol,LabelMover:sl},tools:{LineLabeler:dl,TextLabeler:bl,LabelTransformer:wl}}),kl=n("7c09"),Tl=function(t){Object(qe["a"])(n,t);var e=Object(Je["a"])(n);function n(){return Object(ct["a"])(this,n),e.apply(this,arguments)}return Object(ut["a"])(n,[{key:"ViewAdjuster",get:function(){return Ur(this).$data.viewAdjuster}},{key:"backToCenter",value:function(t){return Ur(this).backToCenter(t)}}]),n}(b.Proxy.Plugin),El=x.define({proxy:b.Proxy.Creator(Tl),data:function(){return{viewAdjuster:null}},created:function(){this.$data.viewAdjuster=this.$createTool("ViewAdjuster")},methods:{backToCenter:function(t){var e,n=t.$bounds,r=n.top,i=n.right,a=n.bottom,o=n.left,s=this.$toGeometry(o,r),c=this.$toGeometry(i,a);(e=this.$data.viewAdjuster).backToCenter.apply(e,Object(ht["a"])(s).concat(Object(ht["a"])(c)))}}}),Sl=x.Element.define({groupIndex:2e3,interative:!0,state:function(){return{origin:null,target:null}},getters:{origin:function(){return this.$state.origin},target:function(){return this.$state.target}},render:function(t){var e=this.$state,n=e.origin,r=e.target;if(n&&r){var i=this.$toCanvas.apply(this,Object(ht["a"])(n)),a=Object(re["a"])(i,2),o=a[0],s=a[1],c=this.$toCanvas.apply(this,Object(ht["a"])(r)),u=Object(re["a"])(c,2),l=u[0],h=u[1];t.lineStyle(1,4096759).beginFill(4096759,.2).drawRect(o,s,l-o,h-s).endFill()}},created:function(){},methods:{setOrigin:function(t,e){this.$state.origin=t&&e?[t,e]:null,this.$setDirty()},setTarget:function(t,e){this.$state.target=t&&e?[t,e]:null,this.$setDirty()},remove:function(){this.$destroy()}}},El),Cl=5,Pl=x.Tool.READY,Ll=Symbol("Pick"),Dl=function(t){Object(qe["a"])(n,t);var e=Object(Je["a"])(n);function n(){return Object(ct["a"])(this,n),e.apply(this,arguments)}return Object(ut["a"])(n,[{key:"backToCenter",value:function(t,e,n,r){Ur(this).backToCenter(t,e,n,r)}}]),n}(b.Proxy.ToolProvider(["open","pick","close"])),Al=x.Tool.define(Object(lt["a"])({},Pl,(function(){var t=this.$plugin;t.$drawing.off("pointerdown",this.$data.pointerdownListener),t.$drawing.off("pointermove",this.$data.pointermoveListener),t.$drawing.off("pointerup",this.$data.pointerupListener)})),{open:[[Pl,function(){var t=this.$plugin;t.$drawing.on("pointerdown",this.$data.pointerdownListener),t.$drawing.on("pointermove",this.$data.pointermoveListener),t.$drawing.on("pointerup",this.$data.pointerupListener)},Ll]],close:[[Ll,ft["e"],Pl],[Pl,ft["e"],Pl]]},{proxy:b.Proxy.Creator(Dl),data:function(t){var e=this,n=t.$drawing.scale,r=t.$createElement("Field"),i=function(e){if(0===e.button&&!r.origin){var n=e.pointerX,i=e.pointerY;r.setOrigin.apply(r,Object(ht["a"])(t.$toGeometry(n,i)))}},a=function(e){var n=e.pointerX,i=e.pointerY;r.setTarget.apply(r,Object(ht["a"])(t.$toGeometry(n,i)))},o=function(t){if(0===t.button){var i=r.origin,a=r.target,o=ft["d"].abs(i[0]-a[0])/n,s=ft["d"].abs(i[1]-a[1])/n;o>Cl&&s>Cl&&e.backToCenter.apply(e,Object(ht["a"])(i).concat(Object(ht["a"])(a))),r.setOrigin(null)}};return{field:r,pointerdownListener:i,pointermoveListener:a,pointerupListener:o}},methods:{backToCenter:function(t,e,n,r){var i=[(t+n)/2,(e+r)/2];this.areaZoomToView(t,e,n,r),this.pointBackToCenter.apply(this,i)},pointBackToCenter:function(t,e){var n=this.$plugin.$drawing,r=n.width,i=n.height,a=n.origin,o=this.$plugin.$toCanvas(t,e),s=r/2-o[0],c=i/2-o[1];this.$plugin.$drawing.setOrigin(a[0]+s,a[1]+c)},areaZoomToView:function(t,e,n,r){var i=this.$plugin.$drawing,a=i.width,o=i.height,s=i.scale,c=ft["d"].abs(t-n)/s,u=ft["d"].abs(e-r)/s,l=s*c/a,h=s*u/o;this.$plugin.$drawing.setScale(ft["d"].ceil(ft["d"].max(l,h)))}},reset:function(){this.close()}}),Nl=w.define({id:"com.3dnest.spoke.viewport",namespace:"viewport",version:kl["a"],plugin:El,elements:{Field:Sl},tools:{ViewAdjuster:Al}}),Fl=function(t){t.canvasElement.addEventListener("contextmenu",cn["b"].preventDefault)},Wl=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;t.on("pointerdown",(function(n){if(n.button===e){var r=Object(re["a"])(t.origin,2),i=r[0],a=r[1],o=n.pointerX,s=n.pointerY,c=function(e){var n=e.pointerX,r=e.pointerY;t.setOrigin(i+n-o,a+r-s)},u=function e(){t.off("pointermove",c),cn["a"].removeEventListener(cn["c"].WINDOW,"mouseup",e)};t.on("pointermove",c),cn["a"].addEventListener(cn["c"].WINDOW,"mouseup",u)}}))},Il=function(t){cn["a"].addEventListener(t.canvasElement,"wheel",(function(e){e.deltaY>0?t.setScaleInMode(t.scale+1,1):t.setScaleInMode(t.scale-1,1)}))},Rl=function(t,e){t.structure.on("room-created",(function(t){t.setFloor(e)}))},Ml=function(t){t.compass.element.on("pointerdown",(function(e){Hl(t,e)}))},Hl=function(t,e){var n=t.compass.element,r=n.x,i=n.y,a=n.rotation,s=e.pointerX,c=e.pointerY,u=ft["d"].atan2.apply(ft["d"],Object(ht["a"])(o.from(r,i,s,c))),l=function(t){var e=ft["d"].atan2.apply(ft["d"],Object(ht["a"])(o.from(r,i,t.pointerX,t.pointerY))),s=(a-e+u)%(2*ft["d"].PI);n.setRotation(s)},h=function e(){t.off("pointermove",l),window.removeEventListener("mouseup",e)};t.on("pointermove",l),window.addEventListener("mouseup",h)},Bl=Symbol(),Vl=Symbol(),zl=Symbol(),Ul=Symbol(),Yl=Symbol(),Gl=Symbol(),_l=Symbol(),Xl=(lu={},Object(lt["a"])(lu,Bl,{open:function(t){t.hammer.adjuster.open(),t.common.transformer.open(),t.bricklayer.Mover.open(),t.bricklayer.Extender.open(),t.label.LabelTransformer.open()},close:function(t){t.hammer.adjuster.close(),t.common.transformer.close(),t.bricklayer.Mover.close(),t.bricklayer.Extender.close(),t.label.LabelTransformer.close()}}),Object(lt["a"])(lu,Vl,{open:function(t){t.common.selector.open()},close:function(t){t.common.selector.close()}}),Object(lt["a"])(lu,zl,{open:function(t){t.bricklayer.Builder.pick()},close:function(t){t.bricklayer.Builder.drop().drop()}}),Object(lt["a"])(lu,Ul,{open:function(t){t.bricklayer.Spliter.open()},close:function(t){t.bricklayer.Spliter.close()}}),Object(lt["a"])(lu,Yl,{open:function(t){t.bricklayer.Chamber.pick()},close:function(t){t.bricklayer.Chamber.drop().drop()}}),Object(lt["a"])(lu,Gl,{open:function(t){t.viewport.ViewAdjuster.open()},close:function(t){t.viewport.ViewAdjuster.close()}}),Object(lt["a"])(lu,_l,{open:function(t){t.label.open()},close:function(t){t.label.close()}}),lu),Kl=function(){function t(e){Object(ct["a"])(this,t),ft["c"].instanceOf(e,Mr)||ft["c"].Throw.TypeError("The `drawing` MUST be a DrawingProxy."),this.drawing=e,this.current=null,this.activeDefault()}return Object(ut["a"])(t,[{key:"active",value:function(t){this.current!==t&&(this.current&&Xl[this.current].close(this.drawing),Xl[t].open(this.drawing),this.current=t)}},{key:"activeDefault",value:function(){this.active(Vl)}},{key:"deactiveAllTool",value:function(){this.current&&(Xl[this.current].close(this.drawing),this.current=null)}}]),t}(),ql=new WeakMap,Jl=function(t){return ql.get(t)},Ql=function(t){Object(qe["a"])(n,t);var e=Object(Je["a"])(n);function n(t){var r;return Object(ct["a"])(this,n),r=e.call(this),ql.set(Object(sn["a"])(r),new Kl(t)),r}return Object(ut["a"])(n,[{key:"activated",get:function(){return Jl(this).current}},{key:"symbol",get:function(){return U}},{key:"openDefault",value:function(){Jl(this).activeDefault(),this.emit("open","selector")}},{key:"closeAllTool",value:function(){Jl(this).deactiveAllTool(),this.emit("open",null)}},{key:"openTransformer",value:function(){Jl(this).active(Bl),this.emit("open","transformer")}},{key:"openSelector",value:function(){Jl(this).active(Vl),this.emit("open","selector")}},{key:"openWallBuilder",value:function(){Jl(this).active(zl),this.emit("open","builder")}},{key:"openChamber",value:function(){Jl(this).active(Yl),this.emit("open","chamber")}},{key:"openSpliter",value:function(){Jl(this).active(Ul),this.emit("open","spliter")}},{key:"openViewport",value:function(){Jl(this).active(Gl),this.emit("open","viewport")}},{key:"openLabeler",value:function(){Jl(this).active(_l),this.emit("open","labeler")}}]),n}(un["a"].Emitter),Zl=function(t){Object(qe["a"])(n,t);var e=Object(Je["a"])(n);function n(t){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(ct["a"])(this,n),r=e.call(this),r.drawing=t,r.options=i,r}return Object(ut["a"])(n,[{key:"execute",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=this.drawing.structure.getAllCornerList(),r=this.drawing.structure.getAllWallList(),i=this.drawing.structure.getAllRoomList(),a=this.drawing.windoor.getAllHollowList(),o=this.drawing.furniture.getAllStuffList(),s=this.drawing.negative.getAllBitmapList(),c=this.drawing.label.getAllLabelTextList(),u=this.drawing.label.getAllLabelLineList();this.options.corners&&this.options.corners(e,n);var l=n.map((function(n){var r=[n.x,n.y];return t.options.corner&&t.options.corner(e,n),r}));this.options.walls&&this.options.walls(e,r);var h=r.map((function(r){var i=[];return i.push(n.indexOf(r.thisSurface.corner)),i.push(n.indexOf(r.thatSurface.corner)),i.push(r.thickness),t.options.wall&&t.options.wall(e,r),i}));this.options.rooms&&this.options.rooms(e,i);var f=i.map((function(r){var i=r.getOuterSurfaceList().map((function(t){return n.indexOf(t.corner)})),a=c.find((function(t){return t.room===r})),o=a.text,s={cornerList:i,label:{text:o.slice(0,o.indexOf("\n")),position:[a.x,a.y]},floor:{url:r.floorUrl}};return t.options.room&&t.options.room(e,r),s}));this.options.hollows&&this.options.hollows(e,a);var d=a.map((function(r){var i=r.materialName,a=r.width,o=r.fliped,s=r.offset,c=r.surface,u="virtual"===c.name,l={materialName:i,width:a,fliped:o,offset:s,isVirtual:u,surface:u?[c.corner.x,c.corner.y]:[n.indexOf(c.corner),n.indexOf(c.back.corner)]};return t.options.hollow&&t.options.hollow(e,r),l}));this.options.stuffs&&this.options.stuffs(e,o);var p=o.map((function(n){var r=n.fill,i=n.x,a=n.y,o=n.width,s=n.height,c={fill:r,x:i,y:a,width:o,height:s};return t.options.stuff&&t.options.stuff(e,n),c}));this.options.bitmaps&&this.options.bitmaps(e,s);var v=s.map((function(n){var r=n.url,i=n.width,a=n.height,o=n.x,s=n.y,c=n.rotation,u={url:r,width:i,height:a,x:o,y:s,rotation:c};return t.options.bitmap&&t.options.bitmap(e,n),u}));this.options.labelTexts&&this.options.labelTexts(e,c);var y=c.filter((function(t){return!t.room})).map((function(n){var r=n.x,i=n.y,a=n.text,o={x:r,y:i,text:a};return t.options.labelText&&t.options.labelText(e,n),o}));this.options.labelLines&&this.options.labelLines(e,u);var g=u.map((function(n){var r=n.origin,i=n.target,a=n.text,o={origin:r,target:i,text:a};return t.options.labelLine&&t.oprions.labelLine(e,n),o}));return{cornerList:l,wallList:h,roomList:f,hollowList:d,stuffList:p,bitmapList:v,labelTextList:y,labelLineList:g}}}]),n}(un["a"].Emitter),th=function(t){Object(qe["a"])(n,t);var e=Object(Je["a"])(n);function n(t){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(ct["a"])(this,n),r=e.call(this),r.drawing=t,r.options=i,r}return Object(ut["a"])(n,[{key:"execute",value:function(t,e){var n=this,r=t.cornerList,i=t.wallList,a=t.roomList,o=t.hollowList,s=t.stuffList,c=t.bitmapList,u=t.labelTextList,l=t.labelLineList;this.options.corners&&this.options.corners(e,r);var h=r.map((function(t,r){var i=n.drawing.structure.createCorner(t[0],t[1]);return n.options.corner&&n.options.corner(e,i,r),i}));i&&i.length&&(this.options.walls&&this.options.walls(e,i),i.forEach((function(t,r){var i=n.drawing.structure.createWall(h[t[0]],h[t[1]]);i.thickness=t[2],n.options.wall&&n.options.wall(e,i,r)}))),a&&a.length&&setTimeout((function(){n.options.rooms&&n.options.rooms(e,a);var t=n.drawing.structure.getAllRoomList(),r=n.drawing.label.getAllLabelTextList();a.forEach((function(i,a){var o=i.cornerList.map((function(t){return h[t]})),s=t.find((function(t){var e=t.getOuterSurfaceList().map((function(t){return t.corner}));return e.length===o.length&&e.filter((function(t){return o.includes(t)})).length===e.length}));s.setFloor(i.floor.url);var c=r.find((function(t){return t.room===s}));c.setText("".concat(i.label.text).concat(c.text.slice(c.text.indexOf("\n")))),c.setPosition.apply(c,Object(ht["a"])(i.label.position)),n.options.room&&n.options.room(e,s,a)}))})),o&&o.length&&(this.options.hollows&&this.options.hollows(e,o),o.forEach((function(t,r){var i=null;if(t.isVirtual){var a=Object(re["a"])(t.surface,2),o=a[0],s=a[1];i=n.drawing.windoor.createHollow(t.materialName),i.virtualSurface.setCorner(o,s),i.virtualSurface.setBackCorner(o+10,s)}else{var c=h[t.surface[0]],u=h[t.surface[1]],l=c.getWallByToCorner(u);i=n.drawing.windoor.createHollow(t.materialName,l.thisSurface.corner===c?l.thisSurface:l.thatSurface,t.offset)}i.setWidth(t.width),i.fliped!==t.fliped&&i.flip(),n.options.hollow&&n.options.hollow(e,i,r)}))),s&&s.length&&(this.options.stuffs&&this.options.stuffs(e,s),s.forEach((function(t,r){var i=t.fill,a=t.x,o=t.y,s=t.width,c=t.height,u=n.drawing.furniture.createStuff(i,a,o,s,c);n.options.stuff&&n.options.stuff(e,u,r)}))),c&&c.length&&(this.options.bitmaps&&this.options.bitmaps(e,c),c.forEach((function(t,r){var i=t.url,a=t.width,o=t.height,s=t.x,c=t.y,u=t.rotation;n.drawing.negative.createBitmap(i,a,o).then((function(t){t.setPosition(s,c),t.setRotation(u),n.options.bitmap&&n.options.bitmap(e,t,r)}))}))),u&&u.length&&(this.options.labelTexts&&this.options.labelTexts(e,u),u.forEach((function(t,r){var i=t.x,a=t.y,o=t.text,s=n.drawing.label.createLabelText(i,a,o);n.options.labelText&&n.options.labelText(e,s,r)}))),l&&l.length&&(this.options.labelLines&&this.options.labelLines(e,l),l.forEach((function(t,r){var i=t.origin,a=t.target,o=t.text,s=n.drawing.label.createLabelLine(i,a,o);n.options.labelLine&&n.oprions.labelLine(e,s,r)})))}}]),n}(un["a"].Emitter),eh=n("bf64"),nh={w:[0,-1],a:[-1,0],s:[0,1],d:[1,0]},rh=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;window.addEventListener("keydown",(function(n){var r=Object(re["a"])(t.origin,2),i=r[0],a=r[1],o=nh[n.key];o&&t.setOrigin(i+e*o[0],a+e*o[1])}))},ih=function(t){Object(qe["a"])(n,t);var e=Object(Je["a"])(n);function n(t){var r;return Object(ct["a"])(this,n),r=e.call(this),r.surface=t,t.on("dirty",(function(){return r.emit("change")})),t.on("destroy",(function(){return r.emit("destroy")})),r}return Object(ut["a"])(n,[{key:"from",get:function(){return this.surface.origin}},{key:"to",get:function(){return this.surface.target}}]),n}(H.BaseAdaptor);function ah(t){var e=t.structure,n=t.measure;n.setFontsizer((function(t){return 200/t})),n.setTextOffsetYModifier((function(t){return-2*t/3})),e.on("surface-created",(function(t){n.createDimension(new ih(t))}))}var oh=ah,sh=function(){function t(e,n,r){Object(ct["a"])(this,t),ft["c"].instanceOf(e,Mr)||ft["c"].Throw.TypeError("The `drawing` MUST be a DrawingProxy."),ft["c"].instanceOf(n,Zl)||ft["c"].Throw.TypeError("The `serializer` MUST be a instance of Serializer."),ft["c"].instanceOf(r,th)||ft["c"].Throw.TypeError("The `deserializer` MUST be a instance of Deserializer."),this.drawing=e,this.serializer=n,this.deserializer=r}return Object(ut["a"])(t,[{key:"changeFloor",value:function(t,e,n){var r=this.serializer.execute(n);return ch(this.drawing),this.deserializer.execute(t,e),r}}]),t}(),ch=function(t){var e=t.windoor.getAllHollowList(),n=t.furniture.getAllStuffList(),r=t.structure.getAllCornerList(),i=t.negative.getAllBitmapList(),a=t.label.getAllLabelTextList(),o=t.label.getAllLabelLineList();e.forEach((function(t){return t.remove()})),n.forEach((function(t){return t.remove()})),r.forEach((function(t){return t.remove()})),i.forEach((function(t){return t.remove()})),a.filter((function(t){return!t.room})).forEach((function(t){return t.remove()})),o.forEach((function(t){return t.remove()}))},uh=function(t,e,n,r,i){var a=[[t-n/2,e+r/2],[t+n/2,e+r/2],[t+n/2,e-r/2],[t-n/2,e-r/2]];return a.map((function(n){return c.rotate.apply(c,Object(ht["a"])(n).concat([i,t,e])).slice(0)}))},lh=function(t,e,n,r,i){var a=uh(t,e,n,r,i);return[[a[0],a[1]],[a[1],a[2]],[a[2],a[3]],[a[3],a[0]]]},hh=function(t,e,n,r,i,a){return c.project.apply(c,[t,e].concat(Object(ht["a"])(s.fromSegment(n,r,i,a))))},fh=function(t,e,n){var r=null,i=-1;return t.forEach((function(t){var a=c.distanceToSegment.apply(c,[e,n].concat(Object(ht["a"])(t.origin),Object(ht["a"])(t.target)));(!r||a<i)&&(r=t,i=a)})),r},dh=function(t,e,n,r,i){var a=t.map((function(t){return c.distanceToSegment.apply(c,Object(ht["a"])(t).concat([e,n,r,i]))}));return Math.max.apply(Math,Object(ht["a"])(a))},ph=[{proxy:T.StuffProxy,bounds:"$bounds",remove:"remove"},{proxy:k.HollowProxy,bounds:"$bounds",remove:"remove"},{proxy:V.LabelTextProxy,bounds:"$bounds",remove:"remove"},{proxy:V.LabelLineProxy,bounds:"$bounds",remove:"remove"},{proxy:E.CornerProxy,bounds:"$bounds",remove:"remove"},{proxy:E.WallProxy,bounds:"$bounds",remove:"remove"},{proxy:E.RoomProxy,bounds:"$bounds"},{proxy:M.BitmapProxy,bounds:"$bounds",remove:"remove"}],vh={getPosition:function(t){return[t.x,t.y]},setPosition:function(t,e,n){t.setPosition(e,n)},getWidth:function(t){return t.width},setWidth:function(t,e){t.setWidth(e)},getHeight:function(t){return t.height},setHeight:function(t,e){t.setHeight(e)},getRotation:function(t){return t.rotation},setRotation:function(t,e){t.setRotation(e)}},yh=function(t){return function(e,n){var r=n.$state,i=r.x,a=r.y,s=e.x,u=e.y,h=t.structure.getAllWallList(),f=h.map((function(t){return t.thisSurface})),d=h.map((function(t){return t.thatSurface})),p=f.concat(d),v=uh(i,a,e.width,e.height,e.rotation),y=lh(i,a,e.width,e.height,e.rotation),g=p.filter((function(t){return y.find((function(e){return l.intersectSegment.apply(l,Object(ht["a"])(e[0]).concat(Object(ht["a"])(e[1]),Object(ht["a"])(t.origin),Object(ht["a"])(t.target)))}))}));if(g.length){if(g.length>2)return!1;if(2===g.length&&g[0].back!==g[1])return!1;var b=fh(g,s,u),m=c.toLeftOfSegment.apply(c,[s,u].concat(Object(ht["a"])(b.origin),Object(ht["a"])(b.target))),$=c.toLeftOfSegment.apply(c,[i,a].concat(Object(ht["a"])(b.origin),Object(ht["a"])(b.target))),O=v.filter((function(t){return c.toLeftOfSegment.apply(c,Object(ht["a"])(t).concat(Object(ht["a"])(b.origin),Object(ht["a"])(b.target)))!==m})),x=dh.apply(void 0,[O].concat(Object(ht["a"])(b.origin),Object(ht["a"])(b.target))),w=hh.apply(void 0,[i,a].concat(Object(ht["a"])(b.origin),Object(ht["a"])(b.target))),j=m===$?o.fromBothPoint.apply(o,Object(ht["a"])(w).concat([i,a])):o.fromBothPoint.apply(o,[i,a].concat(Object(ht["a"])(w))),k=Object(re["a"])(j,2),T=k[0],E=k[1],S=o.normalize(0===o.length(T,E)?T+1:T,E),C=Object(re["a"])(S,2),P=C[0],L=C[1],D=c.translate.apply(c,[i,a].concat(Object(ht["a"])(o.multiply(P,L,x+1)))),A=Object(re["a"])(D,2),N=A[0],F=A[1],W=lh(N,F,e.width,e.height,e.rotation),I=W.find((function(t){var e=f.find((function(e){return l.intersectSegment.apply(l,Object(ht["a"])(t[0]).concat(Object(ht["a"])(t[1]),Object(ht["a"])(e.origin),Object(ht["a"])(e.target)))})),n=d.find((function(e){return l.intersectSegment.apply(l,Object(ht["a"])(t[0]).concat(Object(ht["a"])(t[1]),Object(ht["a"])(e.origin),Object(ht["a"])(e.target)))}));return e||n}));return I?null:[N,F]}return!0}},gh=function(t){t.common.addTransformerAdapter(T.StuffProxy,Object.assign({adjustVerify:yh(t),setRoom:function(t,e){t.setRoom(e)}},vh)),t.common.addTransformerAdapter(M.BitmapProxy,vh)},bh=function(t){var e,n=Object(je["a"])(ph);try{var r=function(){var n=e.value;t.common.addSelectorAdapter(n.proxy,{getBounds:function(t){return t[n.bounds]},remove:function(e){n.remove&&(n.proxy===V.LabelTextProxy&&e.room||(t.common.selector.drop(),e[n.remove]()))}})};for(n.s();!(e=n.n()).done;)r()}catch(i){n.e(i)}finally{n.f()}},mh=Math.PI,$h=60,Oh=15,xh=10,wh={stateless:{line:0,arcLine:14145753,fill:16777215,windowFill:13421772},hover:{line:8053503,arcLine:15464441,fill:16777215,windowFill:13421772},select:{line:4096759,arcLine:15068665,fill:16777215,windowFill:13421772}},jh=function(t){var e=t.hover,n=t.focus,r=t.select;return r||n?wh.select:e?wh.hover:wh.stateless},kh={width:800,render:function(t,e){var n=e.width,r=e.height,i=e.fliped,a=e.scale,o=i?1:0,s=Oh/a,c=$h/a,u=jh(e);return t.lineStyle(s,u.arcLine).beginFill(u.fill,.1).arc(n*o,r/2,n,-mh/2*o-mh/2,-mh*o/2).lineTo(n*o,r/2).lineTo(0,r/2-n+o*n).endFill().beginFill(u.fill).lineStyle(s,u.fill).drawRect(0,0,n,r).lineStyle(s,u.line).moveTo(0,0).lineTo(0,r).moveTo(n,0).lineTo(n,r).lineStyle(s,u.line).drawRect((n-c)*o,r/2,c,-n),t.pivot.x=n/2,t.pivot.y=r/2,t}},Th={width:1500,render:function(t,e){var n=e.width,r=e.height,i=e.scale,a=Oh/i,o=$h/i,s=jh(e);return t.lineStyle(a,s.arcLine).beginFill(s.fill,.1).arc(0,r/2,n/2,-mh/2,0).lineTo(0,r/2).lineTo(0,(r-n)/2).endFill().beginFill(s.fill,.1).lineStyle(a,s.arcLine).arc(n,r/2,n/2,mh,-mh/2).lineTo(n,r/2).lineTo(n/2,r/2).endFill().beginFill(s.fill).lineStyle(a,s.fill).drawRect(0,0,n,r).lineStyle(a,s.line).moveTo(0,0).lineTo(0,r).moveTo(n,0).lineTo(n,r).drawRect(0,r/2,o,-n/2).drawRect(n,r/2,-o,-n/2),t.pivot.x=n/2,t.pivot.y=r/2,t}},Eh={width:1500,render:function(t,e){var n=e.width,r=e.height,i=e.scale,a=e.fliped,o=a?-1:1,s=Oh/i,c=xh/i,u=jh(e);return t.lineStyle(s,u.line).beginFill(u.fill).drawRect(0,0,n,r).drawRect(0+s+c,r/2,2*n/3,r/4*o).drawRect(n-s-c,r/2,-2*n/3,-r/4*o),t.pivot.x=n/2,t.pivot.y=r/2,t}},Sh={width:1450,render:function(t,e){var n=e.width,r=e.height,i=e.fliped,a=e.scale,o=i?1:0,s=Oh/a,c=jh(e);return t.lineStyle(s,c.line).beginFill(c.fill).drawRect(0,0,n,r).moveTo(0,r/3).lineTo(n,r/3).moveTo(0,2*r/3).lineTo(n,2*r/3).moveTo(n/4+o*n/2,r/3).lineTo(n/4+o*n/2,2*r/3).endFill(),t.pivot.x=n/2,t.pivot.y=r/2,t}},Ch={width:2e3,render:function(t,e){var n=e.width,r=e.height,i=e.scale,a=Oh/i,o=jh(e);return t.lineStyle(a,o.fill).beginFill(o.fill).drawRect(0,0,n,r).endFill().lineStyle(a,o.line).drawRect(0,0,n,r/3).drawRect(0,2*r/3,n,r/3),t.pivot.x=n/2,t.pivot.y=r/2,t}},Ph={width:800,render:function(t,e){var n=e.width,r=e.height,i=e.scale,a=Oh/i,o=jh(e);return t.lineStyle(a,o.line).beginFill(o.fill).drawRect(0,0,n,r).moveTo(0,r/2).lineTo(n,r/2).endFill(),t.pivot.x=n/2,t.pivot.y=r/2,t}},Lh={width:1500,render:function(t,e){var n=e.width,r=e.scale,i=e.sillThickness,a=void 0===i?500/r:i,o=e.height,s=Oh/r,c=o,u=jh(e);return t.lineStyle(s,u.line).beginFill(u.windowFill).drawRect(0,-a,n,a).endFill().beginFill(u.fill).moveTo(0,-o).lineTo(0,-a).lineTo(n,-a).lineTo(n,-o).lineTo(n+c,-o).lineTo(n+c,-(a+c)).lineTo(-c,-(a+c)).lineTo(-c,-o).lineTo(0,-o).endFill().moveTo(-c/2,-o).lineTo(-c/2,-(a+c/2)).lineTo(n+c/2,-(a+c/2)).lineTo(n+c/2,-o),t.pivot.x=n/2,t.pivot.y=-o/2,t}},Dh={width:1500,render:function(t,e){var n=e.width,r=e.height,i=e.scale,a=Oh/i,o=jh(e);return t.lineStyle(a,o.line).beginFill(o.fill).drawRect(0,0,n,r).endFill().moveTo(0,r/2).lineTo(n,r/2).moveTo(0,r/3).lineTo(n,r/3).moveTo(0,2*r/3).lineTo(n,2*r/3).moveTo(n/2,r/3).lineTo(n/2,2*r/3),t.pivot.x=n/2,t.pivot.y=r/2,t}},Ah={render:function(t,e){var n=e.leftWidth,r=e.rightWidth,i=e.leftWallThickness,a=e.rightWallThickness,o=e.scale,s=Oh/o,c=jh(e);return t.lineStyle(s,c.line).beginFill(c.fill).moveTo(0,0).lineTo(r,0).lineTo(r,a).lineTo(i,a).lineTo(i,n).lineTo(0,n).lineTo(0,0).endFill().moveTo(i/2,n).lineTo(i/2,a/2).lineTo(r,a/2),t.pivot.x=r/2,t.pivot.y=a/2,t}},Nh={render:function(t,e){var n=e.leftWidth,r=e.centerWidtn,i=e.rightWidth,a=e.leftWallThickness,o=e.centerWallThickness,s=e.rightWallThickness,c=e.scale,u=Oh/c,l=jh(e);return t.lineStyle(u,l.line).beginFill(l.fill).moveTo(0,0).lineTo(r,0).lineTo(r,i).lineTo(r-s,i).lineTo(r-s,o).lineTo(a,o).lineTo(a,n).lineTo(0,n).lineTo(0,0).endFill().moveTo(a/2,n).lineTo(a/2,o/2).lineTo(r-s/2,o/2).lineTo(r-s/2,i),t.pivot.x=r/2,t.pivot.y=o/2,t}},Fh={render:function(t,e){var n=e.leftWidth,r=e.rightWidth,i=e.leftWindowThickness,a=e.rightWindowThickness,o=e.leftWallThickness,s=e.rightWallThickness,c=e.scale,u=Oh/c,l=jh(e);return t.lineStyle(u,l.line).beginFill(l.windowFill).moveTo(o,s).lineTo(r,s).lineTo(r,s-a).lineTo(o-i,s-a).lineTo(o-i,n).lineTo(o,n).lineTo(o,s).endFill().beginFill(l.fill).moveTo(o-i,s-a).lineTo(r,s-a).lineTo(r,0).lineTo(r+s,0).lineTo(r+s,-a).lineTo(-i,-a).lineTo(-i,n+o).lineTo(0,n+o).lineTo(0,n).lineTo(o-i,n).lineTo(o-i,s-a).endFill().moveTo(0,n+o/2).lineTo(o/2-i,n+o/2).lineTo(o/2-i,s/2-a).lineTo(r+s/2,s/2-a).lineTo(r+s/2,0),t.pivot.x=r/2,t.pivot.y=s/2,t}},Wh={render:function(t,e){var n=e.leftWidth,r=e.centerWidtn,i=e.rightWidth,a=e.leftWindowThinkness,o=e.centerWindowThinkness,s=e.rightWindowThinkness,c=e.leftWallThickness,u=e.centerWallThickness,l=e.rightWallThickness,h=e.scale,f=Oh/h,d=jh(e);return t.lineStyle(f,d.line).beginFill(d.windowFill).moveTo(c,u).lineTo(r-l,u).lineTo(r-l,i).lineTo(r-l+s,i).lineTo(r-l+s,u-o).lineTo(c-a,u-o).lineTo(c-a,n).lineTo(c,n).lineTo(c,u).endFill().beginFill(d.fill).moveTo(c-a,u-o).lineTo(r+s-l,u-o).lineTo(r+s-l,i).lineTo(r,i).lineTo(r,i+l).lineTo(r+s,i+l).lineTo(r+s,-o).lineTo(-a,-o).lineTo(-a,n+c).lineTo(0,n+c).lineTo(0,n).lineTo(c-a,n).lineTo(c-a,u-o).endFill().moveTo(0,n+c/2).lineTo(c/2-a,n+c/2).lineTo(c/2-a,u/2-o).lineTo(r+s-l/2,u/2-o).lineTo(r+s-l/2,i+l/2).lineTo(r,i+l/2),t.pivot.x=r/2,t.pivot.y=u/2,t}},Ih=[{id:"singleDoor",material:Q.SingleDoor},{id:"doubleDoor",material:Q.DoubleDoor},{id:"slidingDoor",material:Q.SlidingDoor},{id:"parentDoor",material:Q.ParentDoor},{id:"bealock",material:Q.Bealock},{id:"basicWindow",material:Z.BasicWindow},{id:"boilerWindow",material:Z.BoilerWindow},{id:"floorWindow",material:Z.FloorWindow}],Rh=function(t,e){return k.register(t,e)},Mh=function(t){var e,n=Object(je["a"])(t);try{for(n.s();!(e=n.n()).done;){var r=e.value;k.register(r.id,r.material)}}catch(i){n.e(i)}finally{n.f()}return t.map((function(t){return t.id}))},Hh=function(){Mh(Ih)},Bh=function(){return k.getAllNameList()},Vh=function(t,e){return T.registerUrl(t,e)},zh=function(t){var e=t.map((function(t){return T.registerUrl(t.id,t.url)}));return Promise.all(e)};[ts,ni,di,pc,Jc,Pu,du,xc,Ec,qu,jl,Nl].forEach((function(t){return sr(t)}));var Uh=100,Yh={data:function(){return{scale:0,scaleClone:0,originScale:.1,imgScale:.1,img:{src:"",width:0,height:0}}},mounted:function(){this.init()},methods:{init:function(){var t=this;this._interval=setInterval((function(){t.flush()}),Uh)},flush:function(){var t=this.$spoke.getEditor("primary"),e=t.drawing;e.scale!==this.scaleClone&&(this.scale=e.scale),this.scaleClone=e.scale},changeScale:function(){var t=this.$spoke.getEditor("primary"),e=t.drawing;e.setScale(Number(this.scale))},onFileChange:function(t){var e=this,n=t.target.files[0];if(n){var r=this.$spoke.getEditor("primary"),i=r.drawing,a=new FileReader,o=this.$refs.canvas,s=o.getContext("2d");this.imgScale=this.originScale,this.clearBitmap(),a.onload=function(t){var n=new Image;n.src=e.img.src=t.target.result,n.onload=function(){var t=n.width,r=n.height;o.width=t,o.height=r,s.drawImage(n,0,0,t,r),e.img.width=t,e.img.height=r,i.negative.createBitmap(o,t/e.imgScale,r/e.imgScale).then((function(t){t.on("destroy",(function(){j.PIXI.Texture.removeFromCache(t.url)}))}))}},a.readAsDataURL(n)}},changeImgScale:function(){var t=this,e=this.$spoke.getEditor("primary"),n=e.drawing,r=this.$refs.canvas,i=r.getContext("2d"),a=new Image;a.src=this.img.src,a.width=this.img.width/(this.originScale/this.imgScale),a.height=this.img.height/(this.originScale/this.imgScale),this.clearBitmap(),i.clearRect(0,0,r.width,r.height),a.onload=function(){var e=a.width,o=a.height;r.width=e,r.height=o,i.drawImage(a,0,0,e,o),n.negative.createBitmap(r,e/t.imgScale,o/t.imgScale).then((function(t){t.on("destroy",(function(){j.PIXI.Texture.removeFromCache(t.url)}))}))}},clearBitmap:function(){var t=this.$spoke.getEditor("primary"),e=t.drawing,n=e.negative.getAllBitmapList();n.forEach((function(t){t.remove()}))}}},Gh=Yh,_h=(n("f7ca"),n("0c7c")),Xh=Object(_h["a"])(Gh,ot,st,!1,null,null,null),Kh=Xh.exports,qh={components:{Panel:Kh},mounted:function(){this.$spoke.getEditor("primary").drawing.mount(this.$refs.drawing),this.init()},methods:{init:function(){var t=this.$spoke.getEditor("primary"),e=t.drawing,n=e.width,r=e.height;e.grid.options.rectangular.style.lineWidth=.5,e.setOrigin(n/2,r/2),e.setScale(25)}}},Jh=qh,Qh=(n("5c0b"),Object(_h["a"])(Jh,it,at,!1,null,null,null)),Zh=Qh.exports,tf=(n("d9e2"),nt.Utility),ef=nt.Viewport,nf=Object(ut["a"])((function t(e){Object(ct["a"])(this,t),this.drawing=e})),rf=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=new j.Drawing,n=new nf(e,t);return t.element&&e.mount(t.element),tf.AdjustViewportByPointerButton(e),tf.PreventDefaultContextMenu(e),tf.AdjustZoomByWheel(e),ef.MovingByWASD(e,10),n},af={},of=Object.freeze({getEditor:function(t){var e=af[t];if(!e)throw new Error("id ".concat(t," is not existed"));return e},createEditor:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=af[t];if(n)throw new Error("Duplicated id '".concat(t,"'"));var r=rf(e);return af[t]=r,r}}),sf={install:function(t){t.prototype.$spoke=of}},cf=(of.getEditor,of.createEditor);rt["a"].use(sf),window.d=cf("primary"),new rt["a"]({render:function(t){return t(Zh)},mounted:function(){}}).$mount("#app")},"5c0b":function(t,e,n){"use strict";n("0014")},"5d77":function(t){t.exports=JSON.parse('{"a":"0.0.0"}')},7612:function(t){t.exports=JSON.parse('{"a":"0.0.0"}')},"7c09":function(t){t.exports=JSON.parse('{"a":"0.0.0"}')},a82e:function(t,e,n){},bf64:function(t,e){},c394:function(t){t.exports=JSON.parse('{"a":"0.0.0"}')},c5c2:function(t){t.exports=JSON.parse('{"a":"0.0.0"}')},e07e:function(t){t.exports=JSON.parse('{"a":"0.0.0"}')},f7ca:function(t,e,n){"use strict";n("a82e")}});