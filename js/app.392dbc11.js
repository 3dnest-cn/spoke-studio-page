(function(t){function e(e){for(var i,a,s=e[0],c=e[1],u=e[2],h=0,f=[];h<s.length;h++)a=s[h],Object.prototype.hasOwnProperty.call(r,a)&&r[a]&&f.push(r[a][0]),r[a]=0;for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(t[i]=c[i]);l&&l(e);while(f.length)f.shift()();return o.push.apply(o,u||[]),n()}function n(){for(var t,e=0;e<o.length;e++){for(var n=o[e],i=!0,s=1;s<n.length;s++){var c=n[s];0!==r[c]&&(i=!1)}i&&(o.splice(e--,1),t=a(a.s=n[0]))}return t}var i={},r={app:0},o=[];function a(e){if(i[e])return i[e].exports;var n=i[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=t,a.c=i,a.d=function(t,e,n){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)a.d(n,i,function(e){return t[e]}.bind(null,i));return n},a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=e,s=s.slice();for(var u=0;u<s.length;u++)e(s[u]);var l=c;o.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"0aa2":function(t){t.exports=JSON.parse('{"a":"0.0.0"}')},1227:function(t,e,n){},"2bbc":function(t){t.exports=JSON.parse('{"a":"0.0.0"}')},"2c55":function(t){t.exports=JSON.parse('{"a":"0.0.0"}')},"3d04":function(t){t.exports=JSON.parse('{"a":"0.0.0"}')},"3d1c":function(t){t.exports=JSON.parse('{"a":"0.0.0"}')},"49a4":function(t){t.exports=JSON.parse('{"a":"0.0.0"}')},"56d7":function(t,e,n){"use strict";n.r(e);var i={};n.r(i),n.d(i,"PI",(function(){return gt})),n.d(i,"ROUND",(function(){return yt}));var r={};n.r(r),n.d(r,"Line",(function(){return xt})),n.d(r,"Vector",(function(){return wt})),n.d(r,"Segment",(function(){return Ot})),n.d(r,"Point",(function(){return Tt}));var o={};n.r(o),n.d(o,"setTolerance",(function(){return Ht})),n.d(o,"EQ_0",(function(){return Bt})),n.d(o,"EQ",(function(){return zt})),n.d(o,"GT",(function(){return Vt})),n.d(o,"GE",(function(){return Ut})),n.d(o,"LT",(function(){return Yt})),n.d(o,"LE",(function(){return Gt}));var a={};n.r(a),n.d(a,"fromBothPoint",(function(){return St})),n.d(a,"fromSegment",(function(){return Lt})),n.d(a,"from",(function(){return Ct})),n.d(a,"dot",(function(){return Pt})),n.d(a,"multiply",(function(){return Ft})),n.d(a,"cross",(function(){return At})),n.d(a,"length",(function(){return _t})),n.d(a,"rotate90",(function(){return Rt})),n.d(a,"normalize",(function(){return Dt})),n.d(a,"invert",(function(){return Nt})),n.d(a,"rotate",(function(){return Wt})),n.d(a,"project",(function(){return Mt})),n.d(a,"equal",(function(){return Xt}));var s={};n.r(s),n.d(s,"fromSegment",(function(){return te})),n.d(s,"toStandard",(function(){return oe})),n.d(s,"intersectLine",(function(){return se}));var c={};n.r(c),n.d(c,"translate",(function(){return Et})),n.d(c,"toLeftOfSegment",(function(){return Kt})),n.d(c,"rotate",(function(){return Jt})),n.d(c,"project",(function(){return qt})),n.d(c,"distanceToPoint",(function(){return Qt})),n.d(c,"distanceToLine",(function(){return Zt})),n.d(c,"distanceToSegment",(function(){return ce})),n.d(c,"equal",(function(){return ue}));var u={};n.r(u),n.d(u,"differ",(function(){return le}));var l={};n.r(l),n.d(l,"intersectSegment",(function(){return fe})),n.d(l,"translate",(function(){return de})),n.d(l,"middle",(function(){return pe}));var h={};n.r(h),n.d(h,"containsPoint",(function(){return ve})),n.d(h,"area",(function(){return me}));var f={};n.r(f),n.d(f,"Vertex",(function(){return ge})),n.d(f,"HalfEdge",(function(){return ye})),n.d(f,"Face",(function(){return be}));var d={};n.r(d),n.d(d,"allHalfEdgeOfVertex",(function(){return we})),n.d(d,"allHalfEdgeOfPath",(function(){return Oe}));var p={};n.r(p),n.d(p,"Struct",(function(){return f})),n.d(p,"Iterator",(function(){return d})),n.d(p,"createVertex",(function(){return je})),n.d(p,"getVertexHalfEdgeList",(function(){return Ee})),n.d(p,"hasNoHalfEdge",(function(){return Se})),n.d(p,"hasOnlyHalfEdge",(function(){return Le})),n.d(p,"getAngleOfHalfEdge",(function(){return Ce})),n.d(p,"isPathContainsHalfEdge",(function(){return Pe})),n.d(p,"isPathContainsVertex",(function(){return Fe})),n.d(p,"isTwinInSamePath",(function(){return Ae})),n.d(p,"getPathOfHalfEdge",(function(){return _e})),n.d(p,"isOuterPath",(function(){return De})),n.d(p,"isInnerPath",(function(){return Ne})),n.d(p,"splitHalfEdgeByVertex",(function(){return We})),n.d(p,"getPolygonFromFaceOuter",(function(){return Ie})),n.d(p,"getFaceOfPoint",(function(){return ze})),n.d(p,"createGlobalFace",(function(){return Ve})),n.d(p,"queryChildFaceList",(function(){return Be}));var v={};n.r(v),n.d(v,"EventType",(function(){return Ue})),n.d(v,"EventListener",(function(){return Ye})),n.d(v,"PointAxis",(function(){return Ge})),n.d(v,"Point",(function(){return Xe}));var m={};n.r(m),n.d(m,"_",(function(){return Je})),n.d(m,"Element",(function(){return tn})),n.d(m,"Plugin",(function(){return en})),n.d(m,"Emitter",(function(){return qe})),n.d(m,"Tool",(function(){return nn})),n.d(m,"ToolProvider",(function(){return rn})),n.d(m,"Creator",(function(){return on}));var g={};n.r(g),n.d(g,"define",(function(){return cn}));var y={};n.r(y),n.d(y,"Assert",(function(){return v})),n.d(y,"Proxy",(function(){return m})),n.d(y,"Options",(function(){return g}));var b={};n.r(b),n.d(b,"CENTER",(function(){return Di})),n.d(b,"CURRENT_POINTER",(function(){return Ni}));var x={};n.r(x),n.d(x,"define",(function(){return Bi}));var $={};n.r($),n.d($,"READY",(function(){return Bn})),n.d($,"define",(function(){return zi}));var w={};n.r(w),n.d(w,"Element",(function(){return x})),n.d(w,"Tool",(function(){return $})),n.d(w,"define",(function(){return Vi}));var k={};n.r(k),n.d(k,"define",(function(){return Ui}));var O={};n.r(O),n.d(O,"Drawing",(function(){return Hi})),n.d(O,"SCALE_MODE",(function(){return b})),n.d(O,"use",(function(){return ui})),n.d(O,"PIXI",(function(){return fn})),n.d(O,"Installer",(function(){return k})),n.d(O,"Plugin",(function(){return w})),n.d(O,"Utils",(function(){return y})),n.d(O,"_",(function(){return Yi}));var j={};n.r(j),n.d(j,"register",(function(){return Qi})),n.d(j,"getAllNameList",(function(){return tr})),n.d(j,"HollowProxy",(function(){return er})),n.d(j,"default",(function(){return rr}));var T={};n.r(T),n.d(T,"register",(function(){return sr})),n.d(T,"registerUrl",(function(){return cr})),n.d(T,"StuffProxy",(function(){return fr})),n.d(T,"default",(function(){return vr}));var E={};n.r(E),n.d(E,"register",(function(){return Qa})),n.d(E,"registerFloor",(function(){return Za})),n.d(E,"default",(function(){return os})),n.d(E,"CornerProxy",(function(){return yr})),n.d(E,"RoomProxy",(function(){return es})),n.d(E,"WallProxy",(function(){return xr}));var S={};n.r(S),n.d(S,"PICKUP_FROM",(function(){return ps})),n.d(S,"PICKUP_TO",(function(){return vs}));var L={};n.r(L),n.d(L,"Indicator",(function(){return ds})),n.d(L,"Tool",(function(){return Os})),n.d(L,"STATE",(function(){return S}));var C={};n.r(C),n.d(C,"vectorFrom",(function(){return Cs})),n.d(C,"crossTwoSurface",(function(){return Ps})),n.d(C,"dotTwoSurface",(function(){return Fs}));var P={};n.r(P),n.d(P,"WAITING",(function(){return Xs})),n.d(P,"ACTIVE",(function(){return Ks}));var F={};n.r(F),n.d(F,"Indicator",(function(){return Gs})),n.d(F,"Tool",(function(){return qs})),n.d(F,"STATE",(function(){return P}));var A={};n.r(A),n.d(A,"WAITING",(function(){return Zs})),n.d(A,"ACTIVE",(function(){return tc}));var _={};n.r(_),n.d(_,"Indicator",(function(){return Qs})),n.d(_,"Tool",(function(){return oc})),n.d(_,"STATE",(function(){return A}));var R={};n.r(R),n.d(R,"DETECTING",(function(){return cc})),n.d(R,"DETECTED",(function(){return uc}));var D={};n.r(D),n.d(D,"Indicator",(function(){return sc})),n.d(D,"Tool",(function(){return fc})),n.d(D,"STATE",(function(){return R}));var N={};n.r(N),n.d(N,"PICKUP_FROM",(function(){return pc})),n.d(N,"PICKUP_TO",(function(){return vc}));var W={};n.r(W),n.d(W,"Indicator",(function(){return dc})),n.d(W,"Tool",(function(){return yc})),n.d(W,"STATE",(function(){return N}));var M={};n.r(M),n.d(M,"Builder",(function(){return S})),n.d(M,"Extender",(function(){return P})),n.d(M,"Mover",(function(){return A})),n.d(M,"Spliter",(function(){return R})),n.d(M,"Chamber",(function(){return N}));var I={};n.r(I),n.d(I,"STATE",(function(){return M})),n.d(I,"default",(function(){return bc}));var H={};n.r(H),n.d(H,"BitmapProxy",(function(){return kc})),n.d(H,"default",(function(){return Ec}));var B={};n.r(B),n.d(B,"BaseAdaptor",(function(){return Nu})),n.d(B,"is",(function(){return Mu}));var z={};n.r(z),n.d(z,"default",(function(){return el})),n.d(z,"Adaptor",(function(){return B})),n.d(z,"DimensionProxy",(function(){return Vu}));var V={};n.r(V),n.d(V,"TextLabeler",(function(){return $l})),n.d(V,"LineLabeler",(function(){return ml}));var U={};n.r(U),n.d(U,"STATE",(function(){return V})),n.d(U,"LabelTextProxy",(function(){return cl})),n.d(U,"LabelLineProxy",(function(){return ol})),n.d(U,"default",(function(){return Ll}));var Y={};n.r(Y),n.d(Y,"PreventDefaultContextMenu",(function(){return Kl})),n.d(Y,"AdjustViewportByPointerButton",(function(){return Jl})),n.d(Y,"AdjustZoomByWheel",(function(){return ql})),n.d(Y,"SetDefaultFloor",(function(){return Ql})),n.d(Y,"rotateCompassByDrag",(function(){return Zl}));var G={};n.r(G),n.d(G,"TRANSFORMER",(function(){return eh})),n.d(G,"SELECTOR",(function(){return nh})),n.d(G,"WALL_BUILDER",(function(){return ih})),n.d(G,"SPLITER",(function(){return rh})),n.d(G,"CHAMBER",(function(){return oh})),n.d(G,"VIEWPORT",(function(){return ah})),n.d(G,"LABEL",(function(){return sh}));var X={};n.r(X),n.d(X,"Symbol",(function(){return G})),n.d(X,"Constructor",(function(){return fh}));var K={};n.r(K),n.d(K,"Serializer",(function(){return dh})),n.d(K,"Deserializer",(function(){return ph}));var J={};n.r(J),n.d(J,"MovingByWASD",(function(){return gh}));var q={};n.r(q),n.d(q,"all",(function(){return xh}));var Q={};n.r(Q),n.d(Q,"Surface",(function(){return q}));var Z={};n.r(Z),n.d(Z,"Constructor",(function(){return $h}));var tt={};n.r(tt),n.d(tt,"Windoor",(function(){return j})),n.d(tt,"Furniture",(function(){return T})),n.d(tt,"Negative",(function(){return H})),n.d(tt,"Bricklayer",(function(){return I})),n.d(tt,"Label",(function(){return U})),n.d(tt,"Structure",(function(){return E})),n.d(tt,"Measure",(function(){return z}));var et={};n.r(et),n.d(et,"commonTransformerAdaptor",(function(){return Lh})),n.d(et,"transformerRegister",(function(){return Ph})),n.d(et,"selectorRegister",(function(){return Fh}));var nt={};n.r(nt),n.d(nt,"SingleDoor",(function(){return Mh})),n.d(nt,"DoubleDoor",(function(){return Ih})),n.d(nt,"SlidingDoor",(function(){return Hh})),n.d(nt,"ParentDoor",(function(){return Bh})),n.d(nt,"Bealock",(function(){return zh}));var it={};n.r(it),n.d(it,"BasicWindow",(function(){return Vh})),n.d(it,"BoilerWindow",(function(){return Uh})),n.d(it,"FloorWindow",(function(){return Yh})),n.d(it,"LWindow",(function(){return Gh})),n.d(it,"UWindow",(function(){return Xh})),n.d(it,"LBoilerWindow",(function(){return Kh})),n.d(it,"UBoilerWindow",(function(){return Jh}));var rt={};n.r(rt),n.d(rt,"windoorMaterialList",(function(){return qh})),n.d(rt,"windoorRegister",(function(){return Qh})),n.d(rt,"windoorListRegister",(function(){return Zh})),n.d(rt,"windoorRegisterDefault",(function(){return tf})),n.d(rt,"getAllWindoorNameList",(function(){return ef})),n.d(rt,"furnitureRegister",(function(){return nf})),n.d(rt,"furnitureListRegister",(function(){return rf})),n.d(rt,"floorRegister",(function(){return of})),n.d(rt,"floorListRegister",(function(){return af}));var ot={};n.r(ot),n.d(ot,"Common",(function(){return et})),n.d(ot,"Resource",(function(){return rt}));var at={};n.r(at),n.d(at,"Utility",(function(){return Y})),n.d(at,"ToolGroup",(function(){return X})),n.d(at,"Persistence",(function(){return K})),n.d(at,"Monitor",(function(){return vh})),n.d(at,"Viewport",(function(){return J})),n.d(at,"Dimension",(function(){return Q})),n.d(at,"Floor",(function(){return Z})),n.d(at,"Registry",(function(){return ot}));var st={};n.r(st),n.d(st,"furnitureList",(function(){return py})),n.d(st,"bitmap",(function(){return vy})),n.d(st,"wallTypeData",(function(){return my})),n.d(st,"wallTypeColor",(function(){return gy})),n.d(st,"floorList",(function(){return yy}));n("e260"),n("e6cf"),n("cca6"),n("a79df"),n("1227"),n("15de");var ct=n("2b0e"),ut=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"d-flex flex-column h-100",attrs:{id:"app"}},[n("div",{staticClass:"d-flex",attrs:{id:"app-menu-container"}},[n("div",{staticStyle:{background:"#333",width:"45px"},attrs:{id:"app-icon"}}),n("app-menu",{staticClass:"flex-grow-1",staticStyle:{background:"#444"},attrs:{id:"app-menu"}})],1),n("div",{staticClass:"flex-grow-1 d-flex flex-column",attrs:{id:"app-workbench-container"}},[n("div",{staticClass:"d-flex flex-grow-1"},[n("app-tool-group-bar",{staticClass:"border-right"}),n("sv-container",{staticClass:"flex-grow-1"},[n("sv-view",{attrs:{id:"app-drawing-area"}},[n("sv-container",{staticClass:"flex-grow-1",attrs:{direction:"column"}},[n("sv-view",{attrs:{id:"app-drawing-slot"}},[n("div",{ref:"drawing",staticClass:"w-100 h-100",staticStyle:{"line-height":"0"}}),n("app-tool-group-setting")],1),n("sv-view",{staticClass:"border-top",attrs:{id:"app-console",max:"500",min:"100"},model:{value:t.layout.consoleHeight,callback:function(e){t.$set(t.layout,"consoleHeight",e)},expression:"layout.consoleHeight"}},[t._v(" console ")])],1)],1),n("sv-view",{attrs:{id:"app-feature-area",max:"500",min:"200"}},[n("app-feature-panel")],1)],1)],1)]),n("app-status-bar"),n("app-error")],1)},lt=[],ht=(n("4ec9"),n("d3b7"),n("3ca3"),n("ddb0"),n("159b"),n("ac84")),ft=n("2d58"),dt=n("2fe6"),pt=n("0bd7"),vt=(n("99af"),n("dca8"),n("caad"),n("2532"),n("07ac"),n("3338")),mt=Math,gt=mt.PI,yt=2*gt,bt=[0,0,1,0],xt=function(t,e,n,i){return bt[0]=t,bt[1]=e,bt[2]=n,bt[3]=i,bt},$t=[0,0],wt=function(t,e){return $t[0]=t,$t[1]=e,$t},kt=[0,0,0,0],Ot=function(t,e,n,i){return kt[0]=t,kt[1]=e,kt[2]=n,kt[3]=i,kt},jt=[0,0],Tt=function(t,e){return jt[0]=t,jt[1]=e,jt},Et=function(t,e,n,i){return Tt(t+n,e+i)},St=function(t,e,n,i){return wt(n-t,i-e)},Lt=St,Ct=St,Pt=function(t,e,n,i){return t*n+e*i},Ft=function(t,e,n){return wt(t*n,e*n)},At=function(t,e,n,i){return t*i-e*n},_t=function(t,e){return vt["d"].sqrt(Pt(t,e,t,e))},Rt=function(t,e){return wt(-e,t)},Dt=function(t,e){var n=_t(t,e);return 0===n&&vt["c"].throwError("Zero Vector CAN NOT be normalized."),wt(t/n,e/n)},Nt=function(t,e){return wt(-t,-e)},Wt=function(t,e,n){var i=vt["d"].cos(n),r=vt["d"].sin(n);return wt(t*i-e*r,t*r+e*i)},Mt=function(t,e,n,i){var r=Dt(n,i);return Ft.apply(void 0,Object(pt["a"])(r).concat([Pt.apply(void 0,[t,e].concat(Object(pt["a"])(r)))]))},It=1e-6,Ht=function(t){It=t},Bt=function(t){return t<It&&t>-It},zt=function(t,e){var n=t-e;return n<It&&n>-It},Vt=function(t,e){return t-e>It},Ut=function(t,e){return t-e>-It},Yt=function(t,e){return t-e<-It},Gt=function(t,e){return t-e<It},Xt=function(t,e,n,i){return zt(t,n)&&zt(e,i)},Kt=function(t,e,n,i,r,o){return Vt(At.apply(a,Object(pt["a"])(St(n,i,r,o)).concat(Object(pt["a"])(St(r,o,t,e)))),0)},Jt=function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=St(i,r,t,e);return Et.apply(void 0,Object(pt["a"])(Wt.apply(a,Object(pt["a"])(o).concat([n]))).concat([i,r]))},qt=function(t,e,n,i,r,o){if(ue(t,e,n,i))return Tt(t,e);var s=St(t,e,n,i);return Bt(At.apply(a,Object(pt["a"])(s).concat([r,o])))?Tt(n,i):Et.apply(void 0,[t,e].concat(Object(pt["a"])(Mt.apply(a,Object(pt["a"])(s).concat([r,o])))))},Qt=function(t,e,n,i){return _t.apply(a,Object(pt["a"])(St(t,e,n,i)))},Zt=function(t,e){for(var n=arguments.length,i=new Array(n>2?n-2:0),r=2;r<n;r++)i[r-2]=arguments[r];return Qt.apply(void 0,[t,e].concat(Object(pt["a"])(qt.apply(void 0,[t,e].concat(i)))))},te=function(t,e,n,i){var o=Lt(t,e,n,i),s=Rt.apply(a,Object(pt["a"])(Dt.apply(a,Object(pt["a"])(o)))),c=Pt.apply(a,Object(pt["a"])(s).concat([t,e])),u=Yt(c,0)?s:Nt.apply(a,Object(pt["a"])(s));return xt.apply(r,[t,e].concat(Object(pt["a"])(u)))},ee=[0,0,0],ne=0,ie=1,re=2,oe=function(t,e,n,i){return ee[ne]=n,ee[ie]=i,ee[re]=Pt(n,i,t,e),ee},ae=n("26a3"),se=function(t,e,n,i,r,o,a,s){var c=oe(t,e,n,i),u=Object(ae["a"])(c,3),l=u[0],h=u[1],f=u[2],d=oe(r,o,a,s),p=Object(ae["a"])(d,3),v=p[0],m=p[1],g=p[2],y=l*m-h*v,b=f*m-h*g,x=l*g-f*v;return Bt(y)?null:Bt(h)?Tt(f/l,x/y):Bt(m)?Tt(g/v,x/y):Bt(l)?Tt(b/y,f/h):Bt(v)?Tt(b/y,g/m):Tt(b/y,x/y)},ce=function(t,e,n,i,r,o){return Zt.apply(void 0,[t,e].concat(Object(pt["a"])(te(n,i,r,o))))},ue=function(t,e,n,i){return zt(t,n)&&zt(e,i)},le=function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=(n?1:-1)*(t-e);return i>=0?i:i+yt},he=function(t,e,n,i,r,o){return(t-r)*(i-o)-(e-o)*(n-r)},fe=function(t,e,n,i,r,o,a,s){var c=he(t,e,n,i,r,o),u=he(t,e,n,i,a,s);if(Ut(c*u,0))return null;var l=he(r,o,a,s,t,e),h=l+c-u;if(Ut(l*h,0))return null;var f=l/(u-c);return Tt(t+f*(n-t),e+f*(i-e))},de=function(t,e,n,i,r,o){return Ot(t+r,e+o,n+r,i+o)},pe=function(t,e,n,i){return Tt((t+n)/2,(e+i)/2)},ve=function(t,e){for(var n=!1,i=t.length,r=0,o=i-1;r<i;o=r++){var a=t[r],s=t[o],c=a.y>e.y!==s.y>e.y&&e.x<(e.y-a.y)/(s.y-a.y)*(s.x-a.x)+a.x;c&&(n=!n)}return n},me=function(){for(var t=arguments.length/2,e=0,n=0;n<t;n++){var i=(n+1)%t;e+=At(2*n<0||arguments.length<=2*n?void 0:arguments[2*n],2*n+1<0||arguments.length<=2*n+1?void 0:arguments[2*n+1],2*i<0||arguments.length<=2*i?void 0:arguments[2*i],2*i+1<0||arguments.length<=2*i+1?void 0:arguments[2*i+1])}return e/2},ge=Object(ft["a"])((function t(e,n){Object(ht["a"])(this,t),this.x=e,this.y=n,this.incidentEdge=null})),ye=Object(ft["a"])((function t(){Object(ht["a"])(this,t),this.origin=null,this.twin=null,this.incidentFace=null,this.next=null,this.previous=null})),be=Object(ft["a"])((function t(){Object(ht["a"])(this,t),this.outerComponent=null,this.innerComponents=[]})),xe=(n("96cf"),9999),$e=regeneratorRuntime.mark(we);function we(t){var e,n,i;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(e=t.incidentEdge,!vt["h"].Not.Null(e)){r.next=8;break}n=e,i=0;case 3:return r.next=5,n;case 5:n=n.twin.next,i++;case 7:if(n!==e&&i<xe){r.next=3;break}case 8:case"end":return r.stop()}}),$e)}var ke=regeneratorRuntime.mark(Oe);function Oe(t){var e,n;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:e=t,n=0;case 1:return i.next=3,e;case 3:e=e.next,n++;case 5:if(e!==t&&n<xe){i.next=1;break}case 6:case"end":return i.stop()}}),ke)}var je=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return new ge(t,e)},Te=n("0402"),Ee=function(t){var e,n=[],i=Object(Te["a"])(we(t));try{for(i.s();!(e=i.n()).done;){var r=e.value;n.push(r)}}catch(o){i.e(o)}finally{i.f()}return n},Se=function(t){return vt["h"].isNull(t.incidentEdge)},Le=function(t){return!Se(t)&&t.incidentEdge===t.incidentEdge.twin.next},Ce=function(t){var e=t.origin,n=e.x,i=e.y,r=t.twin.origin,o=r.x,a=r.y;return Math.atan2(a-i,o-n)},Pe=function(t,e){var n,i=Object(Te["a"])(Oe(t));try{for(i.s();!(n=i.n()).done;){var r=n.value;if(r===e)return!0}}catch(o){i.e(o)}finally{i.f()}return!1},Fe=function(t,e){var n,i=Object(Te["a"])(Oe(t));try{for(i.s();!(n=i.n()).done;){var r=n.value;if(r.origin===e)return!0}}catch(o){i.e(o)}finally{i.f()}return!1},Ae=function(t){return Pe(t,t.twin)},_e=function(t){var e,n=[],i=Object(Te["a"])(Oe(t));try{for(i.s();!(e=i.n()).done;){var r=e.value;n.push(r)}}catch(o){i.e(o)}finally{i.f()}return n},Re=(n("aff5"),n("a9e3"),function(t){var e,n,i=null,r=-1/0;e=n=Number.MAX_SAFE_INTEGER;var o,a=Object(Te["a"])(Oe(t));try{for(a.s();!(o=a.n()).done;){var s=o.value,c=s.origin,u=c.x,l=c.y,h=s.next.origin,f=h.x,d=h.y,p=(d-l)/(f-u);(u<e||u===e&&l<n||u===e&&l===n&&p>r)&&(e=u,n=l,r=p,i=s)}}catch(v){a.e(v)}finally{a.f()}return i}),De=function(t){var e=Re(t),n=e.previous.twin;return n!==e&&le(Ce(n),Ce(e))<Math.PI},Ne=function(t){return!De(t)},We=function(t,e){var n=t,i=n.twin,r=new ye,o=new ye;e.incidentEdge=r,r.origin=o.origin=e,r.incidentFace=n.incidentFace,o.incidentFace=i.incidentFace,r.twin=i,i.twin=r,o.twin=n,n.twin=o;var a=n.next,s=i.next;return r.next=a,n.next=r,r.previous=n,a.previous=r,o.next=s,i.next=o,o.previous=i,s.previous=o,r},Me=(n("d81d"),function(t){return t.origin}),Ie=function(t){var e=t.outerComponent;return vt["h"].isNull(e)?[]:_e(e).map(Me)},He=(n("a434"),function(t,e,n){var i=t.twin.incidentFace;e.includes(i)||(e.push(i),n.push(i))}),Be=function(t){var e,n=[t],i=[],r=Object(Te["a"])(t.innerComponents);try{for(r.s();!(e=r.n()).done;){var o,a=e.value,s=Object(Te["a"])(Oe(a));try{for(s.s();!(o=s.n()).done;){var c=o.value;He(c,n,i)}}catch(v){s.e(v)}finally{s.f()}while(i.length){var u,l=Object(Te["a"])(i.splice(0));try{for(l.s();!(u=l.n()).done;){var h,f=u.value,d=Object(Te["a"])(Oe(f.outerComponent));try{for(d.s();!(h=d.n()).done;){var p=h.value;He(p,n,i)}}catch(v){d.e(v)}finally{d.f()}}}catch(v){l.e(v)}finally{l.f()}}}}catch(v){r.e(v)}finally{r.f()}return n.shift(),n},ze=function t(e,n){var i=!!vt["h"].isNull(e.outerComponent)||ve(Ie(e),n);if(i){var r,o=Object(Te["a"])(Be(e));try{for(o.s();!(r=o.n()).done;){var a=r.value,s=t(a,n);if(vt["h"].Not.Null(s))return s}}catch(c){o.e(c)}finally{o.f()}return e}return null},Ve=function(){return new be},Ue=function(t){vt["h"].Not.String(t)&&vt["c"].Throw.TypeError("Invalid event `type`, a string expected.")},Ye=function(t){vt["h"].Not.Function(t)&&vt["c"].Throw.TypeError("In valid event `listener`, a function expected.")},Ge=function(t,e){vt["h"].Not.Number(t)&&vt["c"].Throw.TypeError("Invalid `".concat(e,"`, a number excepted."))},Xe=function(t,e){Ge(t),Ge(e)},Ke=(n("10d1"),new WeakMap),Je=function(t){return Ke.get(t)},qe=function(){function t(e){Object(ht["a"])(this,t),Ke.set(this,e)}return Object(ft["a"])(t,[{key:"on",value:function(t,e){return Ue(t),Ye(e),Je(this).$on(t,e),this}},{key:"off",value:function(t,e){return Ue(t),Ye(e),Je(this).$off(t,e),this}}]),t}(),Qe=n("a007"),Ze=n("e3fc"),tn=function(t){Object(Qe["a"])(n,t);var e=Object(Ze["a"])(n);function n(t){return Object(ht["a"])(this,n),e.call(this,t)}return Object(ft["a"])(n,[{key:"$bounds",get:function(){return Je(this).$getBounds()}},{key:"destroyed",get:function(){return Je(this).$destroyed}}]),n}(qe),en=function(t){Object(Qe["a"])(n,t);var e=Object(Ze["a"])(n);function n(){return Object(ht["a"])(this,n),e.apply(this,arguments)}return Object(ft["a"])(n,[{key:"options",get:function(){return Je(this).$options}},{key:"setOptions",value:function(){}}]),n}(qe),nn=function(t){Object(Qe["a"])(n,t);var e=Object(Ze["a"])(n);function n(){return Object(ht["a"])(this,n),e.apply(this,arguments)}return Object(ft["a"])(n,[{key:"$reset",value:function(){Je(this).$reset()}},{key:"$state",get:function(){return Je(this).$state}}]),n}(qe),rn=function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=function(t){Object(Qe["a"])(n,t);var e=Object(Ze["a"])(n);function n(){return Object(ht["a"])(this,n),e.apply(this,arguments)}return Object(ft["a"])(n)}(nn),i=Object(Te["a"])(e);try{var r=function(){var e=t.value;n.prototype[e]=function(){return Je(this)[e](),this}};for(i.s();!(t=i.n()).done;)r()}catch(o){i.e(o)}finally{i.f()}return n},on=function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return function(){var n=new t(this);return e?Object.freeze(n):n}},an=n("a34f");function sn(){this.forceUpdateAll()}var cn=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return an["a"](t,e,sn)},un=n("c20e"),ln=n("4743"),hn=n("dcb4"),fn=(n("b0c0"),n("4e82"),n("3a02")),dn=n("493b"),pn=(n("6062"),n("af93"),g.define()),vn=g.define({capture:!0,autoResizing:!0},{snap:g.define({enable:!0,interval:20}),scale:g.define({max:100,min:1}),style:g.define({backgroundColor:{value:15790320,set:function(t){this.application.renderer.backgroundColor=t}},backgroundOpacity:{value:1,set:function(t){this.application.renderer.backgroundAlpha=t}},fontSize:12}),plugin:pn}),mn=function(t,e){var n=function(n){Object.defineProperty(t,n,{get:function(){return e[n].call(this)}})};for(var i in e)n(i)},gn=function(t,e){var n=function(n){var i=e[n];t[n]=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return i.call.apply(i,[this].concat(e))}};for(var i in e)n(i)},yn=new WeakMap,bn=function(t){return yn.get(t)},xn=function(t){Object(Qe["a"])(n,t);var e=Object(Ze["a"])(n);function n(t){var i;return Object(ht["a"])(this,n),i=e.call(this),i.context=null,i.drawing=t,i.elementCollectionMap={},i}return Object(ft["a"])(n,[{key:"forceUpdate",value:function(){for(var t in this.elementCollectionMap){var e,n=Object(Te["a"])(this.elementCollectionMap[t]);try{for(n.s();!(e=n.n()).done;){var i=e.value;i.setDirty()}}catch(r){n.e(r)}finally{n.f()}}}}]),n}(hn["a"].Emitter),$n=xn,wn=(n("a630"),function(t){vt["h"].Not.String(t)&&vt["c"].Throw.TypeError("Invalid `className`, a string excepted.")}),kn=function(){function t(e,n){Object(ht["a"])(this,t),this.$id=e,this.$version=n,this.$proxy=this,this.$data=vt["f"].freeze({})}return Object(ft["a"])(t,[{key:"$drawing",get:function(){return bn(this).drawing.proxy}},{key:"$elements",value:regeneratorRuntime.mark((function t(e){var n,i,r,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:wn(e),n=bn(this).elementCollectionMap[e],vt["h"].isUndefined(n)&&vt["c"].throwError("The Element named `".concat(e,"` is NOT existed in this Plugin.")),i=Object(Te["a"])(n.values()),t.prev=4,i.s();case 6:if((r=i.n()).done){t.next=12;break}return o=r.value,t.next=10,o.context;case 10:t.next=6;break;case 12:t.next=17;break;case 14:t.prev=14,t.t0=t["catch"](4),i.e(t.t0);case 17:return t.prev=17,i.f(),t.finish(17);case 20:case"end":return t.stop()}}),t,this,[[4,14,17,20]])}))},{key:"$getElementList",value:function(t){return Array.from(this.$elements(t))}},{key:"$hideElement",value:function(t){var e,n=Object(Te["a"])(this.$elements(t));try{for(n.s();!(e=n.n()).done;){var i=e.value;i.hide()}}catch(r){n.e(r)}finally{n.f()}}},{key:"$showElement",value:function(t){var e,n=Object(Te["a"])(this.$elements(t));try{for(n.s();!(e=n.n()).done;){var i=e.value;i.show()}}catch(r){n.e(r)}finally{n.f()}}},{key:"$hideAll",value:function(){for(var t in bn(this).elementCollectionMap)this.$hideElement(t)}},{key:"$showAll",value:function(){for(var t in bn(this).elementCollectionMap)this.$showElement(t)}},{key:"$forceUpdate",value:function(){bn(this).forceUpdate()}},{key:"$toCanvas",value:function(t,e){return v.Point(t,e),bn(this).drawing.coordinate.toCanvas(t,e)}},{key:"$toGeometry",value:function(t,e){return v.Point(t,e),bn(this).drawing.coordinate.toGeometry(t,e)}},{key:"$on",value:function(t,e){return v.EventType(t),v.EventListener(e),bn(this).on(t,e),this}},{key:"$off",value:function(t,e){return v.EventType(t),v.EventListener(e),bn(this).off(t,e),this}},{key:"$emit",value:function(t){var e;v.EventType(t);for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return(e=bn(this)).emit.apply(e,[t].concat(i)),this}}]),t}(),On=function(t,e,n,i,r){pn.appendChild(t,n.options);var o=function(t){Object(Qe["a"])(n,t);var e=Object(Ze["a"])(n);function n(t){var r;for(var o in Object(ht["a"])(this,n),r=e.call(this,t),i)r.elementCollectionMap[o]=new Set;return yn.set(r.context=new a,Object(un["a"])(r)),r}return Object(ft["a"])(n)}($n),a=function(o){Object(Qe["a"])(s,o);var a=Object(Ze["a"])(s);function s(){var i;return Object(ht["a"])(this,s),i=a.call(this,t,e),i.$proxy=n.proxy.call(Object(un["a"])(i)),i.$data=vt["f"].seal(n.data()),vt["f"].freeze(Object(un["a"])(i)),i}return Object(ft["a"])(s,[{key:"$options",get:function(){return this.$drawing.options.plugin[t]}},{key:"$createElement",value:function(t){wn(t);var e=i[t].Element;vt["h"].isUndefined(e)&&vt["c"].throwError("The Element named `".concat(t,"` is NOT existed."));for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];var a=Object(dn["a"])(e,[bn(this)].concat(r)).context;return this.$emit("element-created",a.$proxy,t),a}},{key:"$createTool",value:function(t){var e=r[t];vt["h"].isUndefined(e)&&vt["c"].throwError("The Element named `".concat(t,"` is NOT existed."));var n=new e(this),i=n.context;return i.$proxy}}]),s}(kn);return gn(a.prototype,n.methods),mn(a.prototype,n.getters),o},jn=n("e5cd"),Tn=n("0384"),En=new Set,Sn=new fn["Container"],Ln=new WeakMap,Cn=function(t){return Ln.get(t)},Pn=function(t){Object(Qe["a"])(n,t);var e=Object(Ze["a"])(n);function n(t){var i;return Object(ht["a"])(this,n),i=e.call(this),i.plugin=t,i.context=null,i.graphics=null,i.isDirty=!1,i._update=vt["e"],i.destroyed=!1,i.collection.add(Object(un["a"])(i)),i}return Object(ft["a"])(n,[{key:"renderable",get:function(){return!1}},{key:"interactive",get:function(){return!1}},{key:"hoverable",get:function(){return!1}},{key:"focusable",get:function(){return!1}},{key:"selectable",get:function(){return!1}},{key:"draggable",get:function(){return!1}},{key:"drawing",get:function(){return this.plugin.drawing}},{key:"selecting",get:function(){return this.drawing.state.selecting===this}},{key:"hovering",get:function(){return this.drawing.state.hovering===this}},{key:"holding",get:function(){return this.drawing.state.holding===this}},{key:"focusing",get:function(){return this.drawing.state.focusing===this}},{key:"hover",value:function(){vt["h"].isNull(this.drawing.state.holding)&&(this.drawing.setHovering(this),this.setDirty())}},{key:"cancelHover",value:function(){this.drawing.setHovering(),this.setDirty()}},{key:"focus",value:function(){var t=this.drawing.state.focusing;t!==this&&(this.drawing.setFocusing(this),Fn(this,"focus"),this.setDirty())}},{key:"emitBlur",value:function(){Fn(this,"blur"),this.setDirty()}},{key:"hold",value:function(){this.drawing.setHolding(this),this.setDirty()}},{key:"release",value:function(){this.drawing.setHolding(),this.setDirty()}},{key:"group",get:function(){return Sn}},{key:"application",get:function(){return this.drawing.application}},{key:"collection",get:function(){return En}},{key:"show",value:function(){this.graphics.visible=!0,this.setDirty()}},{key:"hide",value:function(){this.graphics.visible=!1,this.setDirty()}},{key:"setDirty",value:function(){this.destroyed||this.isDirty||(this.drawing.observer.setDirty(),this.isDirty=!0,Fn(this,"dirty"))}},{key:"getBounds",value:function(){return this.graphics.getBounds()}},{key:"update",value:function(){this.isDirty&&(this.isDirty=!1,this.graphics.clear(),this.graphics.visible&&(this._update(this.graphics),Fn(this,"render")))}},{key:"destroy",value:function(){vt["h"].Not.Null(this.graphics)&&(this.hovering&&this.drawing.setHovering(),this.focusing&&this.drawing.setFocusing(),this.holding&&this.drawing.setHolding(),this.graphics.destroy(),this.drawing.observer.cancel(this.observer)),this.collection.delete(this),this.destroyed=!0,Fn(this,"destroy"),hn["a"].destroy(this),this.drawing.emit("element-destroy",this.context.$proxy)}}]),n}(hn["a"].Emitter),Fn=function(t,e){t.emit(e,t.context.$proxy)},An=Pn,_n=vt["f"].freeze({}),Rn=function(){function t(){Object(ht["a"])(this,t),this.$proxy=this,this.$state=_n}return Object(ft["a"])(t,[{key:"$graphics",get:function(){return Cn(this).graphics}},{key:"$data",get:function(){return Cn(this).plugin.context.$data}},{key:"$drawing",get:function(){return Cn(this).drawing.proxy}},{key:"$selecting",get:function(){return Cn(this).selecting}},{key:"$focusing",get:function(){return Cn(this).focusing}},{key:"$hovering",get:function(){return Cn(this).hovering}},{key:"$holding",get:function(){return Cn(this).holding}},{key:"$visible",get:function(){return Cn(this).graphics.visible}},{key:"$isDirty",get:function(){return Cn(this).isDirty}},{key:"$destroyed",get:function(){return Cn(this).destroyed}},{key:"$getBounds",value:function(){return Cn(this).getBounds()}},{key:"$show",value:function(){Cn(this).show()}},{key:"$hide",value:function(){Cn(this).hide()}},{key:"$setDirty",value:function(){Cn(this).setDirty()}},{key:"$destroy",value:function(){Cn(this).destroy()}},{key:"$on",value:function(t,e){return v.EventType(t),v.EventListener(e),Cn(this).on(t,e),this}},{key:"$off",value:function(t,e){return v.EventType(t),v.EventListener(e),Cn(this).off(t,e),this}},{key:"$emit",value:function(t){for(var e,n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return(e=Cn(this)).emit.apply(e,[t].concat(i)),this}},{key:"$focus",value:function(){var t=Cn(this);t.focusable&&t.focus()}},{key:"$toCanvas",value:function(t,e){return v.Point(t,e),Cn(this).drawing.coordinate.toCanvas(t,e)}},{key:"$toGeometry",value:function(t,e){return v.Point(t,e),Cn(this).drawing.coordinate.toGeometry(t,e)}}]),t}(),Dn=Rn,Nn=["pointermove","pointerdown","pointerup","pointerover","pointerout"],Wn=function(t,e){t.emit(e,t.drawing.globalEvent.accessor)},Mn=function(t,e){var n=vt["h"].Not.Null(e.render),i=function(i){Object(Qe["a"])(a,i);var o=Object(Ze["a"])(a);function a(i){var s,c;Object(ht["a"])(this,a),c=o.call(this,i);var u=new r;if(n){var l=new fn["Graphics"];c.observer=function(){return c.update()},c.drawing.observer.add(c.observer),c.group.addChild(l),c.graphics=l,c.graphics.name=t,c.graphics.interactive=e.interative,e.interative&&(Nn.forEach((function(t){l.on("".concat(t),(function(t){c.drawing.globalEvent.current=t}))})),l.on("pointermove",(function(){return Wn(Object(un["a"])(c),"pointermove")})).on("pointerover",(function(){return Wn(Object(un["a"])(c),"pointerover")})).on("pointerout",(function(){return Wn(Object(un["a"])(c),"pointerout")})).on("pointerdown",(function(){return Wn(Object(un["a"])(c),"pointerdown")})).on("pointerup",(function(){return Wn(Object(un["a"])(c),"pointerup")})),e.hoverable&&l.on("pointerover",(function(){return c.hover()})).on("pointerout",(function(){return c.cancelHover()})),e.draggable&&l.on("pointerdown",(function(){return c.hold()})).on("pointerup",(function(){return c.release()})),e.focusable&&l.on("pointerdown",(function(){return c.focus()}))),c._update=e.render.bind(u)}c.context=u,Ln.set(u,Object(un["a"])(c));for(var h=arguments.length,f=new Array(h>1?h-1:0),d=1;d<h;d++)f[d-1]=arguments[d];return(s=e.created).call.apply(s,[u].concat(f)),c.setDirty(),c.drawing.emit("element-create",c.context.$proxy),c}return Object(ft["a"])(a,[{key:"renderable",get:function(){return n}},{key:"interactive",get:function(){return this.renderable&&e.interative}},{key:"hoverable",get:function(){return this.interactive&&e.hoverable}},{key:"focusable",get:function(){return this.interactive&&e.focusable}},{key:"selectable",get:function(){return this.interactive&&e.selectable}},{key:"draggable",get:function(){return this.interactive&&e.draggable}},{key:"group",get:function(){return this.plugin.drawing.groupMap.get(a)}},{key:"collection",get:function(){return this.plugin.elementCollectionMap[t]}}]),a}(An),r=function(n){Object(Qe["a"])(r,n);var i=Object(Ze["a"])(r);function r(){var t;return Object(ht["a"])(this,r),t=i.call(this),t.$proxy=e.proxy.call(Object(un["a"])(t)),t.$state=vt["f"].seal(e.state.call(Object(un["a"])(t))),vt["f"].freeze(Object(un["a"])(t)),t}return Object(ft["a"])(r,[{key:"$name",get:function(){return t}},{key:"$data",get:function(){return this.$plugin.$data}},{key:"$plugin",get:function(){return Cn(this).plugin.context}},{key:"$destroy",value:function(){Object(jn["a"])(Object(Tn["a"])(r.prototype),"$destroy",this).call(this),e.destroy.call(this)}}]),r}(Dn);return mn(r.prototype,e.getters),gn(r.prototype,e.methods),i},In=(n("a4d3"),n("e01a"),new WeakMap),Hn=function(t){return In.get(t)},Bn=Symbol("TOOL_READY"),zn=function(t){Object(Qe["a"])(n,t);var e=Object(Ze["a"])(n);function n(){var t;return Object(ht["a"])(this,n),t=e.call(this),t.plugin=null,t.context=null,t.busy=!1,t.state=Bn,t.eventQueue=[],t}return Object(ft["a"])(n,[{key:"reset",value:function(){this.context.$reset(),this.emit("reset"),this.setIdle(Bn)}},{key:"setBusy",value:function(){this.busy=!0}},{key:"setIdle",value:function(t){this.busy=!1,this.state=t;var e=this.eventQueue;while(e.length){var i;(i=Object(jn["a"])(Object(Tn["a"])(n.prototype),"emit",this)).call.apply(i,[this].concat(Object(pt["a"])(e.pop())))}}},{key:"emit",value:function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];var r;this.busy?this.eventQueue.push(e):(r=Object(jn["a"])(Object(Tn["a"])(n.prototype),"emit",this)).call.apply(r,[this].concat(e));return this}}]),n}(hn["a"].Emitter),Vn=zn,Un=function(){function t(){Object(ht["a"])(this,t)}return Object(ft["a"])(t,[{key:"$state",get:function(){return Hn(this).state}},{key:"$plugin",get:function(){return Hn(this).plugin}},{key:"$on",value:function(t,e){return v.EventType(t),v.EventListener(e),Hn(this).on(t,e),this}},{key:"$off",value:function(t,e){return v.EventType(t),v.EventListener(e),Hn(this).off(t,e),this}},{key:"$emit",value:function(t){for(var e,n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return(e=Hn(this)).emit.apply(e,[t].concat(i)),this}}]),t}(),Yn=function(t,e){var n=e.data,i=e.actions,r=e.states,o=function(t){Object(Qe["a"])(n,t);var e=Object(Ze["a"])(n);function n(t){var i;return Object(ht["a"])(this,n),i=e.call(this,t),i.plugin=t,i.context=new a(Object(un["a"])(i)),t.$drawing.appendTool(Object(un["a"])(i)),i}return Object(ft["a"])(n)}(Vn),a=function(i){Object(Qe["a"])(o,i);var r=Object(Ze["a"])(o);function o(t){var i;return Object(ht["a"])(this,o),i=r.call(this),In.set(Object(un["a"])(i),t),i.$proxy=e.proxy.call(Object(un["a"])(i)),i.$data=vt["f"].seal(n.call(Object(un["a"])(i),t.plugin)),vt["f"].freeze(Object(un["a"])(i)),i}return Object(ft["a"])(o,[{key:"$name",get:function(){return t}},{key:"$reset",value:function(){e.reset.call(this),Hn(this).state=Bn}}]),o}(Un),s=function(t){var e,n=i[t],o={},s=Object(Te["a"])(n);try{for(s.s();!(e=s.n()).done;){var c=Object(ae["a"])(e.value,3),u=c[0],l=c[1],h=c[2];o[u]={handler:l,target:h,source:u}}}catch(f){s.e(f)}finally{s.f()}a.prototype[t]=function(){var e=Hn(this);e.busy&&vt["c"].throwError("It could NOT call an action during another action.");var n=o[this.$state];vt["h"].isUndefined(n)&&vt["c"].throwError(".".concat(t," can NOT be called from state(=").concat(String(this.$state),")."));var i=n.handler,a=n.target,s=n.source;return r[s].leave.call(this),e.setBusy(),i.call(this),r[a].entry.call(this),e.setIdle(a),this}};for(var c in i)s(c);var u=function(t){var n=e.methods[t];a.prototype[t]=function(){for(var t=this.$state,e=arguments.length,i=new Array(e),r=0;r<e;r++)i[r]=arguments[r];var o=n.call.apply(n,[this].concat(i));return this.$state!==t&&vt["c"].throwError("A normal method could NOT be used to transit state."),o}};for(var l in e.methods)u(l);return o},Gn=function(){return{}},Xn=function(t){var e={data:Gn,created:vt["e"],methods:{},getters:{},proxy:function(){return this},options:g.define()},n=t.data,i=void 0===n?e.data:n,r=t.created,o=void 0===r?e.created:r,a=t.methods,s=void 0===a?e.methods:a,c=t.getters,u=void 0===c?e.getters:c,l=t.proxy,h=void 0===l?e.proxy:l,f=t.options,d=void 0===f?e.options:f;for(var p in vt["h"].Not.Function(i)&&vt["c"].Throw.TypeError("Invalid `.data`, a function as constructor expected."),vt["h"].Not.Function(o)&&vt["c"].Throw.TypeError("Invalid `.created`, a function expected."),vt["h"].Not.Object(s)&&vt["c"].Throw.TypeError("Invalid `.methods`, an object expected."),s)vt["h"].Not.Function(s[p])&&vt["c"].Throw.TypeError("Invalid `.methods.".concat(p,"`, a function expected."));for(var v in vt["h"].Not.Object(u)&&vt["c"].Throw.TypeError("Invalid `.getters`, an object expected."),u)vt["h"].Not.Function(u[v])&&vt["c"].Throw.TypeError("Invalid `.getters.".concat(v,"`, a function expected."));return vt["h"].Not.Function(h)&&vt["c"].Throw.TypeError("Invalid `.proxy`, a function as constructor expected."),e.data=i,e.created=o,e.methods=s,e.getters=u,e.proxy=h,e.options=d,e},Kn=function(){return{}},Jn=function(t){var e={groupIndex:0,interative:!1,hoverable:!1,focusable:!1,selectable:!1,draggable:!1,state:Kn,render:null,created:vt["e"],destroy:vt["e"],methods:{},getters:{},proxy:function(){return this}},n=t.groupIndex,i=void 0===n?e.groupIndex:n,r=t.interative,o=void 0===r?e.interative:r,a=t.hoverable,s=void 0===a?e.hoverable:a,c=t.focusable,u=void 0===c?e.focusable:c,l=t.selectable,h=void 0===l?e.selectable:l,f=t.draggable,d=void 0===f?e.draggable:f,p=t.state,v=void 0===p?e.state:p,m=t.render,g=void 0===m?e.render:m,y=t.created,b=void 0===y?e.created:y,x=t.destroy,$=void 0===x?e.destroy:x,w=t.methods,k=void 0===w?e.methods:w,O=t.getters,j=void 0===O?e.getters:O,T=t.proxy,E=void 0===T?e.proxy:T;for(var S in vt["h"].Not.Number(i)&&vt["c"].Throw.TypeError("Invalid `.elements[].groupIndex`, a number expected."),vt["h"].Not.Boolean(o)&&vt["c"].Throw.TypeError("Invalid `.elements[].interative`, a boolean expected."),vt["h"].Not.Boolean(s)&&vt["c"].Throw.TypeError("Invalid `.elements[].hoverable`, a boolean expected."),vt["h"].Not.Boolean(u)&&vt["c"].Throw.TypeError("Invalid `.elements[].focusable`, a boolean expected."),vt["h"].Not.Boolean(h)&&vt["c"].Throw.TypeError("Invalid `.elements[].selectable`, a boolean expected."),vt["h"].Not.Boolean(d)&&vt["c"].Throw.TypeError("Invalid `.elements[].draggable`, a boolean expected."),vt["h"].Not.Function(v)&&vt["c"].Throw.TypeError("Invalid `.elements[].state`, a function expected."),vt["h"].Not.Function(g)&&vt["h"].Not.Null(g)&&vt["c"].Throw.TypeError("Invalid `.elements[].render`, a function or null expected."),vt["h"].Not.Function(b)&&vt["c"].Throw.TypeError("Invalid `.elements[].created`, a function expected."),vt["h"].Not.Function($)&&vt["c"].Throw.TypeError("Invalid `.elements[].destroy`, a function expected."),vt["h"].Not.Object(k)&&vt["c"].Throw.TypeError("Invalid `.elements[].methods`, an object as function map expected"),k)vt["h"].Not.Function(k[S])&&vt["c"].Throw.TypeError("Invalid `.elements[].methods.".concat(S,"`, a function expected."));for(var L in vt["h"].Not.Object(j)&&vt["c"].Throw.TypeError("Invalid `.elements[].getters`, an object as function map expected"),j)vt["h"].Not.Function(j[L])&&vt["c"].Throw.TypeError("Invalid `.elements[].getters.".concat(L,"`, a function expected."));return vt["h"].Not.Function(E)&&vt["c"].Throw.TypeError("Invalid `.proxy`, a function as constructor expected."),e.groupIndex=i,e.interative=o,e.hoverable=s,e.focusable=u,e.selectable=h,e.draggable=d,e.state=v,e.render=g,e.created=b,e.destroy=$,e.methods=k,e.getters=j,e.proxy=E,e},qn=(n("1bf2"),function(){return{}}),Qn=[0,function(){return vt["c"].throwError("Not implemented.")},0],Zn=function(t){vt["h"].isArray(t)&&3===t.length&&vt["h"].isFunction(t[1])||vt["c"].Throw.TypeError("Invalid transition, a [source, function, target] expected.")},ti=function(t){if(vt["h"].Not.Array(t)&&vt["c"].Throw.TypeError("Invalid action transition, an array expected."),0===t.length)return[Qn];if(vt["h"].Not.Array(t[0]))return Zn(t),[t];var e,n=[],i=Object(Te["a"])(t);try{for(i.s();!(e=i.n()).done;){var r=e.value;Zn(r),n.push(r)}}catch(o){i.e(o)}finally{i.f()}return n},ei=function(t){var e={};for(var n in vt["h"].Not.Object(t)&&vt["c"].Throw.TypeError("Invalid tool actions, a plain object expected."),t)e[n]=ti(t[n]);return e},ni=Object.freeze({entry:vt["e"],leave:vt["e"]}),ii=function(t){var e={entry:vt["e"],leave:vt["e"]},n=t.entry,i=void 0===n?e.entry:n,r=t.leave,o=void 0===r?e.leave:r;return vt["h"].Not.Function(i)&&vt["c"].Throw.TypeError("Invalid operation.entry, a function expected."),vt["h"].Not.Function(o)&&vt["c"].Throw.TypeError("Invalid operation.leave, a function expected."),e.entry=i,e.leave=o,e},ri=function(t,e){var n={};for(var i in e){var r=e[i];if(vt["h"].isArray(r[0])){var o,a=Object(Te["a"])(r);try{for(a.s();!(o=a.n()).done;){var s=o.value;n[s[0]]=n[s[2]]=ni}}catch(f){a.e(f)}finally{a.f()}}else n[r[0]]=n[r[2]]=ni}var c,u=Object(Te["a"])(vt["g"].ownKeys(t));try{for(u.s();!(c=u.n()).done;){var l=c.value,h=t[l];if(vt["h"].isUndefined(h))return;vt["h"].isObject(h)?n[l]=ii(h):vt["h"].isFunction(h)?n[l]=ii({entry:h}):vt["c"].Throw.TypeError("Invalid state operation, a function or expected.")}}catch(f){u.e(f)}finally{u.f()}return n},oi=function(t){var e={states:{},actions:{},data:qn,reset:vt["e"],methods:{},proxy:function(){return this}},n=t.states,i=void 0===n?e.states:n,r=t.actions,o=void 0===r?e.actions:r,a=t.data,s=void 0===a?e.data:a,c=t.reset,u=void 0===c?e.reset:c,l=t.methods,h=void 0===l?e.methods:l,f=t.proxy,d=void 0===f?e.proxy:f;for(var p in vt["h"].Not.Function(s)&&vt["c"].Throw.TypeError("Invalid `.tools[].data`, a function expected."),vt["h"].Not.Function(u)&&vt["c"].Throw.TypeError("Invalid `.tools[].reset`, a function expected."),vt["h"].Not.Function(d)&&vt["c"].Throw.TypeError("Invalid `.tools[].proxy`, a function expected."),h)vt["h"].Not.Function(h[p])&&vt["c"].Throw.TypeError("Invalid `.tools[].methods.".concat(p,"`, a function expected."));return e.actions=ei(o),e.states=ri(i,o),e.data=s,e.reset=u,e.methods=h,e.proxy=d,e},ai=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e={namespace:null,version:null,dependencies:[],plugin:{},elements:{},tools:{}},n=t.id,i=t.version,r=t.namespace,o=void 0===r?e.namespace:r,a=t.dependencies,s=void 0===a?e.dependencies:a,c=t.plugin,u=void 0===c?e.plugin:c,l=t.elements,h=void 0===l?e.elements:l,f=t.tools,d=void 0===f?e.tools:f;if(vt["h"].Not.String(n)&&vt["c"].Throw.TypeError("Invalid `.id`, a string expected."),vt["h"].Not.String(i)&&vt["c"].Throw.TypeError("Invalid `.version`, string expected."),vt["h"].Not.String(o)&&vt["h"].Not.Null(o)&&vt["c"].Throw.TypeError("Invalid `.namespace`, a string or null expected."),vt["h"].Not.Array(s))vt["c"].Throw.TypeError("Invalid `.dependencies`, an array expected.");else{var p,v=Object(Te["a"])(s);try{for(v.s();!(p=v.n()).done;){var m=Object(ae["a"])(p.value,2),g=m[0],y=m[1];vt["h"].Not.String(g)&&vt["c"].Throw.TypeError("Invalid `.dependencies[".concat(y,"]`, a string expected."))}}catch($){v.e($)}finally{v.f()}}for(var b in vt["h"].Not.Object(h)&&vt["c"].Throw.TypeError("Invalid `.elements`, an object as map expected."),e.id=n,e.version=i,e.namespace=o,e.dependencies=s,e.plugin=Xn(u),h)e.elements[b]=Jn(h[b]);for(var x in d)e.tools[x]=oi(d[x]);return e},si=new Map,ci=[],ui=function(t){var e=ai(t),n=e.id,i=e.namespace,r=e.version,o=e.plugin,a=e.elements,s=e.tools;ci.some((function(t){return t.id===n}))&&vt["c"].throwError("A Plugin id=".concat(n," is used."));var c={},u={};for(var l in a)c[l]={index:a[l].groupIndex,Element:Mn(l,a[l])};for(var h in s)u[h]=Yn(h,s[h]);var f=On(n,r,o,c,u);si.set(f,o.created),ci.push({id:n,namespace:i,Plugin:f,Elements:Object.freeze(c)})},li=function(t){var e,n=[],i=Object(Te["a"])(ci);try{for(i.s();!(e=i.n()).done;){var r=e.value,o=r.id,a=r.namespace,s=r.Plugin,c=r.Elements,u=new s(t),l=t.Plugin.Proxy[o]=u.context.$proxy;for(var h in t.Plugin.Context[o]=u.context,vt["h"].isString(a)&&(vt["h"].isUndefined(t.proxy[a])?t.proxy[a]=l:vt["b"].warn('Registering namespace "'.concat(a,'" is duplicated.'))),c){var f=new fn["Container"],d=c[h];f.name="".concat(h,"-group"),t.groupMap.set(d.Element,f),n.push({container:f,index:d.index})}n.sort((function(t,e){return t.index-e.index}));var p,v=Object(Te["a"])(n);try{for(v.s();!(p=v.n()).done;){var m=p.value;t.application.stage.addChild(m.container)}}catch(g){v.e(g)}finally{v.f()}si.get(s).call(u.context)}}catch(g){i.e(g)}finally{i.f()}Object.freeze(t.Plugin.Proxy)},hi={button:0,buttons:0,ctrlKey:!1,shiftKey:!1,altKey:!1,metaKey:!1},fi=function(t){return vt["h"].isNull(t)?null:t.context.$proxy};function di(t,e){var n=null,i=vt["f"].freeze({get drawing(){return t.proxy},get button(){return hi.button},get buttons(){return hi.buttons},get ctrlKey(){return hi.ctrlKey},get shiftKey(){return hi.shiftKey},get altKey(){return hi.altKey},get metaKey(){return hi.metaKey},get pointerX(){return e.pointer.x},get pointerY(){return e.pointer.y},get virtualX(){return e.virtual.x},get virtualY(){return e.virtual.y},get hovering(){return fi(e.hovering)},get focusing(){return fi(e.focusing)},get selecting(){return fi(e.selecting)},get holding(){return fi(e.holding)},stopPropagation:function(){n.stopPropagation()},preventDefault:function(){n.data.originalEvent.preventDefault()}});return{get current(){return n},set current(t){n=t},accessor:i}}["mousedown","mouseup","pointerdown","pointerup"].forEach((function(t){ln["a"].DOCUMENT.addEventListener(t,(function(t){hi.button=t.button,hi.buttons=t.buttons}),{capture:!0})})),["keydown","keyup"].forEach((function(t){ln["a"].addEventListener(ln["c"].WINDOW,t,(function(t){hi.ctrlKey=t.ctrlKey,hi.shiftKey=t.shiftKey,hi.altKey=t.altKey,hi.metaKey=t.metaKey}))}));var pi=25,vi=100,mi=100,gi=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:vi,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:mi;Object(ht["a"])(this,t),this.scale=pi,this.originX=e,this.originY=n}return Object(ft["a"])(t,[{key:"setScale",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:pi;this.scale=t}},{key:"move",value:function(t,e){this.originX=vt["d"].round(t),this.originY=vt["d"].round(e)}},{key:"toGeometry",value:function(t,e){var n=this.scale,i=this.originX,r=this.originY;return[(t-i)*n,(r-e)*n]}},{key:"toCanvas",value:function(t,e){var n=this.scale,i=this.originX,r=this.originY;return[i+t/n,r-e/n]}}]),t}(),yi=function(){return{x:0,y:0}},bi=function(){return{capturedAt:null,pointer:yi(),virtual:yi(),hovering:null,focusing:null,selecting:null,holding:null}},xi=["pointermove","pointerdown","pointerup"];function $i(t,e,n){var i=new fn["Application"]({antialias:!0,backgroundColor:n.style.backgroundColor,backgroundAlpha:n.style.backgroundOpacity}),r=i.stage,o=i.ticker;return r.interactive=!0,r.hitArea=new fn["Rectangle"],o.add((function(){return t.observer.update()})).add((function(){return t.watchSnap()})).add((function(){return t.watchSize()})),xi.forEach((function(e){r.on("".concat(e),(function(e){t.globalEvent.current=e}))})),r.on("pointerdown",(function(n){wi(t,"pointerdown");var i=n.target,r=e.focusing;vt["h"].Not.Null(r)&&i!==r.graphics&&t.setFocusing()})).on("pointerup",(function(){wi(t,"pointerup"),t.setHolding()})).on("pointermove",(function(i){if(n.capture){var r=i.data.global,o=r.x,a=r.y,s=e.pointer;s.x===o&&s.y===a||t.setPointer(o,a)}})),i}var wi=function(t,e){t.emit(e,t.globalEvent.accessor)},ki=(n("4de4"),function(){function t(){Object(ht["a"])(this,t),this.store=new Set}return Object(ft["a"])(t,[{key:"register",value:function(t){this.store.add(t)}},{key:"remove",value:function(t){this.store.has(t)&&this.store.delete(t)}},{key:"from",value:function(t,e){var n=!1,i=[t,e],r=Array.from(this.store).filter(ji).sort(Oi),o=function(t,e){v.Point(t,e),i[0]=t,i[1]=e,n=!0};while(!n&&r.length>0)r.pop().handle(t,e,o);return i}}]),t}()),Oi=function(t,e){return t.priority-e.priority},ji=function(t){return t.active},Ti=function(){function t(){Object(ht["a"])(this,t),this.registry=new Set}return Object(ft["a"])(t,[{key:"append",value:function(t){this.registry.add(t)}},{key:"reset",value:function(){var t,e=Object(Te["a"])(this.registry);try{for(e.s();!(t=e.n()).done;){var n=t.value;n.reset()}}catch(i){e.e(i)}finally{e.f()}}}]),t}(),Ei=200,Si=function(){function t(e){Object(ht["a"])(this,t),this.drawing=e,this.dirty=!1,this.set=new Set,this.tickerTimer=null,this.setDirty()}return Object(ft["a"])(t,[{key:"add",value:function(t){this.set.add(t)}},{key:"cancel",value:function(t){this.set.delete(t)}},{key:"setDirty",value:function(){ln["d"].Clear.Timeout(this.tickerTimer),this.drawing.application.ticker.start(),this.dirty=!0}},{key:"update",value:function(){var t=this;if(this.dirty){this.tickerTimer=ln["d"].Timeout((function(){t.drawing.application.ticker.stop()}),Ei);var e,n=Object(Te["a"])(this.set);try{for(n.s();!(e=n.n()).done;){var i=e.value;i()}}catch(r){n.e(r)}finally{n.f()}this.dirty=!1}}}]),t}(),Li=new WeakMap,Ci=function(t){return Li.get(t)},Pi=["keydown","keyup"];function Fi(t){ln["a"].addEventListener(ln["c"].WINDOW,t,this.keyboardEventListener)}function Ai(t){ln["a"].removeEventListener(ln["c"].WINDOW,t,this.keyboardEventListener)}for(var _i,Ri=function(t){Object(Qe["a"])(n,t);var e=Object(Ze["a"])(n);function n(t){var i;Object(ht["a"])(this,n),i=e.call(this,t),Li.set(t,Object(un["a"])(i));var r=i.state=bi(),o=i.options=new vn(Object(un["a"])(i));return i.destroyed=!1,i.proxy=t,i.containerElement=null,i.keyboardEventListener=function(t){return wi(Object(un["a"])(i),t.type)},i.application=$i(Object(un["a"])(i),r,o),i.observer=new Si(Object(un["a"])(i)),i.globalEvent=di(Object(un["a"])(i),r),i.coordinate=new gi,i.snapManager=new ki,i.toolManager=new Ti,i.groupMap=new Map,i.Plugin={Proxy:{},Context:{}},li(Object(un["a"])(i)),Pi.forEach(Fi,Object(un["a"])(i)),i}return Object(ft["a"])(n,[{key:"canvasElement",get:function(){return this.application.view}},{key:"watchSize",value:function(){if(this.options.autoResizing){var t=this.application.view,e=t.parentElement,n=e.offsetHeight,i=e.offsetWidth;t.height===n&&t.width===i||this.resize()}}},{key:"watchSnap",value:function(){if(this.options.snap.enable){var t=this.state,e=t.capturedAt,n=t.virtual,i=t.pointer;if(!vt["h"].isNull(e)){var r=Date.now();if(r-e>this.options.snap.interval){var o=this.snapManager.from(i.x,i.y),a=Object(ae["a"])(o,2);n.x=a[0],n.y=a[1],wi(this,"pointermove"),wi(this,"snap"),this.state.capturedAt=null}}}}},{key:"mount",value:function(t){ln["a"].appendChild(t,this.canvasElement),this.containerElement=t,wi(this,"mount"),this.resize()}},{key:"destroy",value:function(){Pi.forEach(Ai,this),this.keyboardEventListener=null,ln["a"].removeFromParent(this.canvasElement),hn["a"].destroy(this),this.destroyed=!0}},{key:"resize",value:function(){var t=this.application,e=t.stage,n=t.view,i=this.containerElement,r=i.offsetWidth,o=i.offsetHeight;e.hitArea.width=n.width=r,e.hitArea.height=n.height=o,this.application.renderer.resize(r,o),this.forceUpdateAll(),wi(this,"resize")}},{key:"setPointer",value:function(t,e){this.state.pointer.x=this.state.virtual.x=t,this.state.pointer.y=this.state.virtual.y=e,this.state.capturedAt=Date.now(),this.observer.setDirty(),wi(this,"pointermove")}},{key:"setHovering",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.state.hovering=t}},{key:"setFocusing",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=this.state.focusing;this.state.focusing=t,vt["h"].Not.Null(e)&&(e.emitBlur(),this.emit("element-blur",e.context.$proxy)),vt["h"].Not.Null(t)&&this.emit("element-focus",t.context.$proxy)}},{key:"setHolding",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.state.holding=t}},{key:"forceUpdateAll",value:function(){for(var t in this.observer.setDirty(),this.Plugin.Context)this.Plugin.Context[t].$forceUpdate()}}]),n}(hn["a"].Emitter),Di=0,Ni=1,Wi=function(t){return vt["h"].isNull(t)?null:t.context.$proxy},Mi=function(t){return[t.x,t.y]},Ii=(_i={},Object(dt["a"])(_i,Di,(function(t,e){t.setScale(e)})),Object(dt["a"])(_i,Ni,(function(t,e){t.setScaleByReference.apply(t,[e].concat(Object(pt["a"])(t.pointer)))})),_i),Hi=function(){function t(){Object(ht["a"])(this,t),new Ri(this),vt["f"].freeze(this)}return Object(ft["a"])(t,[{key:"options",get:function(){return Ci(this).options}},{key:"canvasElement",get:function(){return Ci(this).canvasElement}},{key:"hovering",get:function(){return Wi(Ci(this).state.hovering)}},{key:"selecting",get:function(){return Wi(Ci(this).state.selecting)}},{key:"focusing",get:function(){return Wi(Ci(this).state.focusing)}},{key:"holding",get:function(){return Wi(Ci(this).state.holding)}},{key:"plugins",get:function(){return Ci(this).Plugin.Proxy}},{key:"pointer",get:function(){return Mi(Ci(this).state.pointer)}},{key:"virtual",get:function(){return Mi(Ci(this).state.virtual)}},{key:"origin",get:function(){var t=Ci(this).coordinate,e=t.originX,n=t.originY;return[e,n]}},{key:"scale",get:function(){return Ci(this).coordinate.scale}},{key:"width",get:function(){return Ci(this).application.view.width}},{key:"height",get:function(){return Ci(this).application.view.height}},{key:"mount",value:function(t){vt["c"].instanceOf(t,HTMLElement)||vt["c"].Throw.TypeError("Invalid `element`, a HTMLElement expected."),Ci(this).mount(t)}},{key:"resize",value:function(){Ci(this).resize()}},{key:"destroy",value:function(){Ci(this).destroy()}},{key:"setOrigin",value:function(t,e){v.Point(t,e);var n=Ci(this);n.coordinate.move(t,e),n.forceUpdateAll()}},{key:"setScale",value:function(t){vt["h"].Not.Number(t)&&vt["c"].Throw.TypeError("Invalid scale, a number expected.");var e=Ci(this),n=this.options.scale,i=n.min,r=n.max,o=vt["d"].max(i,vt["d"].min(r,t));e.coordinate.setScale(o),e.forceUpdateAll()}},{key:"setScaleByReference",value:function(t,e,n){var i,r;v.Point(e,n);var o=Ci(this),s=this.origin,u=o.coordinate.toGeometry(e,n);this.setScale(t);var l=(i=o.coordinate).toCanvas.apply(i,Object(pt["a"])(u)),h=a.fromBothPoint.apply(a,Object(pt["a"])(l).concat([e,n]));(r=o.coordinate).move.apply(r,Object(pt["a"])(c.translate.apply(c,Object(pt["a"])(s).concat(Object(pt["a"])(h))))),o.forceUpdateAll()}},{key:"setScaleInMode",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Di;vt["f"].values(b).includes(e)?Ii[e](this,t):vt["c"].Throw.TypeError("Invalid `mode`, a value of SCALE_MODE expected.")}},{key:"on",value:function(t,e){return Ci(this).on(t,e),this}},{key:"off",value:function(t,e){return Ci(this).off(t,e),this}},{key:"registerSnap",value:function(t){Ci(this).snapManager.register(t)}},{key:"appendTool",value:function(t){Ci(this).toolManager.append(t)}},{key:"resetAllTool",value:function(){Ci(this).toolManager.reset()}}]),t}(),Bi=function(t){return Jn(t)},zi=function(t,e,n){return oi(vt["f"].assign(n,{states:t,actions:e}))},Vi=function(t){return Xn(t)},Ui=function(t){return ai(t)},Yi=m._,Gi=n("49a4"),Xi=function(t){return t.$proxy},Ki=function(t){Object(Qe["a"])(n,t);var e=Object(Ze["a"])(n);function n(){return Object(ht["a"])(this,n),e.apply(this,arguments)}return Object(ft["a"])(n,[{key:"hollows",value:regeneratorRuntime.mark((function t(){var e,n,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=Object(Te["a"])(Yi(this).hollows()),t.prev=1,e.s();case 3:if((n=e.n()).done){t.next=9;break}return i=n.value,t.next=7,i.$proxy;case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](1),e.e(t.t0);case 14:return t.prev=14,e.f(),t.finish(14);case 17:case"end":return t.stop()}}),t,this,[[1,11,14,17]])}))},{key:"createHollow",value:function(t,e,n){return Yi(this).createHollow(t,e,n)}},{key:"createMovingHollow",value:function(t,e){return Yi(this).createMovingHollow(t,e)}},{key:"getAllHollowList",value:function(){return Yi(this).$getElementList("Hollow").map(Xi)}}]),n}(y.Proxy.Plugin),Ji=w.define({proxy:y.Proxy.Creator(Ki),created:function(){var t=this;this.$on("element-created",(function(e,n){t.$emit("".concat(n.toLowerCase(),"-created"),e)}))},methods:{createHollow:function(t,e,n){return this.$createElement("Hollow",t,e,n)},createMovingHollow:function(t,e){var n=this.$createElement("Hollow",t);return e&&n.setWidth(e),this.$drawing.hammer.adjuster.moveElement(n),n},hollows:regeneratorRuntime.mark((function t(){var e,n,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=Object(Te["a"])(this.$elements("Hollow")),t.prev=1,e.s();case 3:if((n=e.n()).done){t.next=9;break}return i=n.value,t.next=7,i;case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](1),e.e(t.t0);case 14:return t.prev=14,e.f(),t.finish(14);case 17:case"end":return t.stop()}}),t,this,[[1,11,14,17]])}))}}),qi=(n("b64b"),{}),Qi=function(t,e){vt["h"].Not.String(t)&&vt["c"].Throw.TypeError("Invalid `name`, a string expected."),vt["h"].Not.Function(e.render)&&vt["c"].Throw.TypeError("Invalid `material`, a function expected."),t in qi&&vt["b"].warn('Duplicated material name="'.concat(t,'". The original is replaced.')),qi[t]=e},Zi=function(t){return qi[t]},tr=function(){return Object.keys(qi)},er=function(t){Object(Qe["a"])(n,t);var e=Object(Ze["a"])(n);function n(){return Object(ht["a"])(this,n),e.apply(this,arguments)}return Object(ft["a"])(n,[{key:"surface",get:function(){return Yi(this).surface}},{key:"virtualSurface",get:function(){return Yi(this).virtualSurface}},{key:"width",get:function(){return Yi(this).width}},{key:"defaultWidth",get:function(){return Yi(this).defaultWidth}},{key:"offset",get:function(){return Yi(this).offset}},{key:"materialName",get:function(){return Yi(this).materialName}},{key:"fliped",get:function(){return Yi(this).fliped}},{key:"x",get:function(){return Yi(this).x}},{key:"y",get:function(){return Yi(this).y}},{key:"rotation",get:function(){return Yi(this).rotation}},{key:"visible",get:function(){return Yi(this).$visible}},{key:"flip",value:function(){Yi(this).flip()}},{key:"toggleSurface",value:function(){Yi(this).toggleSurface()}},{key:"setSurface",value:function(t){Yi(this).setSurface(t)}},{key:"setMaterial",value:function(t){Yi(this).setMaterial(t)}},{key:"setOffset",value:function(t){Yi(this).setOffset(t)}},{key:"setWidth",value:function(t){Yi(this).setWidth(t)}},{key:"show",value:function(){Yi(this).$show()}},{key:"hide",value:function(){Yi(this).$hide()}},{key:"remove",value:function(){Yi(this).remove()}}]),n}(y.Proxy.Element),nr=function(){function t(e,n,i){Object(ht["a"])(this,t),this.name="virtual",this.corner={x:e,y:n},this.back={corner:{x:e+10,y:n}},this.wall={thickness:i}}return Object(ft["a"])(t,[{key:"setCorner",value:function(t,e){this.corner.x=t,this.corner.y=e}},{key:"setBackCorner",value:function(t,e){this.back.corner.x=t,this.back.corner.y=e}},{key:"setThinkness",value:function(t){this.wall.thickness=t}}]),t}(),ir=w.Element.define({groupIndex:1100,interative:!0,hoverable:!0,focusable:!0,draggable:!0,state:function(){return{surface:null,virtualSurface:null,offset:0,materialName:"",fliped:!1,width:0,defaultWidth:0,rendering:!1,x:0,y:0,rotation:0,changeListener:vt["e"],destroyListener:vt["e"]}},getters:{surface:function(){return this.$state.surface},virtualSurface:function(){return this.$state.virtualSurface},width:function(){return this.$state.width},defaultWidth:function(){return this.$state.defaultWidth},offset:function(){return this.$state.offset},materialName:function(){return this.$state.materialName},fliped:function(){return this.$state.fliped},x:function(){return this.$state.x},y:function(){return this.$state.y},rotation:function(){return this.$state.rotation}},created:function(t,e){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.$state.virtualSurface=new nr(1e4,10001,200),this.$state.changeListener=function(){n.updateVirtualSurface(),n.$setDirty()},this.$state.destroyListener=function(){n.setSurface(n.$state.virtualSurface)},this.$state.defaultWidth=Zi(t).width,this.setMaterial(t),this.setSurface(e||this.$state.virtualSurface),this.setOffset(i),this.setWidth(this.$state.defaultWidth)},destroy:function(){var t=this.$state.surface;!1===t.destroyed&&(t.wall.off("destroy",this.$state.destroyListener),t.wall.off("change",this.$state.changeListener))},render:function(t){var e=this.$state,n=e.surface,i=e.virtualSurface,r=e.width,o=e.fliped,s=e.offset,u=e.materialName,l=e.rendering,h=n.corner?n:i,f=this.$drawing.scale,d=h.corner,p=h.back.corner,v={width:r/f,height:h.wall.thickness/f,fliped:o,scale:f,hover:this.$hovering,focus:this.$focusing,hold:this.$holding};Zi(u).render(t,v),n&&"virtual"===n.name&&t.beginFill(16711680).drawCircle(v.width/2,v.height/2,5);var m=this.$toCanvas(d.x,d.y),g=this.$toCanvas(p.x,p.y),y=a.normalize.apply(a,Object(pt["a"])(a.fromBothPoint.apply(a,Object(pt["a"])(m).concat(Object(pt["a"])(g))))),b=Object(ae["a"])(y,2),x=b[0],$=b[1],w=c.translate.apply(c,Object(pt["a"])(m).concat(Object(pt["a"])(a.multiply(x,$,s/f)))),k=Object(ae["a"])(w,2);t.x=k[0],t.y=k[1];var O=this.$toGeometry(t.x,t.y),j=Object(ae["a"])(O,2);this.$state.x=j[0],this.$state.y=j[1],t.rotation=this.$state.rotation=vt["d"].atan2($,x),l&&(this.$emit("change",this.$proxy),this.setRendering(!1))},methods:{flip:function(){this.$state.fliped=!this.$state.fliped,this.$setDirty(),this.setRendering(!0)},toggleSurface:function(){var t=this.$state.surface.corner,e=this.$state.surface.back.corner,n=a.length.apply(a,Object(pt["a"])(a.fromBothPoint(t.x,t.y,e.x,e.y)));this.setOffset(n-this.$state.offset),this.setSurface(this.$state.surface.back)},setSurface:function(t){if(this.$state.surface!==t){var e=this.$state.surface;this.$state.surface=t,e&&!1===e.destroyed&&(e.wall.off("destroy",this.$state.destroyListener),e.wall.off("change",this.$state.changeListener)),t&&t.on&&(t.wall.on("destroy",this.$state.destroyListener),t.wall.on("change",this.$state.changeListener),this.updateVirtualSurface()),this.$emit("surface-change",t),this.$setDirty()}},setMaterial:function(t){this.$state.materialName=t,this.$setDirty(),this.setRendering(!0)},setOffset:function(t){this.$state.offset=t,this.$setDirty()},setWidth:function(t){this.$state.width=t,this.$setDirty(),this.setRendering(!0)},remove:function(){this.$destroy()},updateVirtualSurface:function(){var t=this.$state,e=t.surface,n=t.virtualSurface;n.setCorner(e.corner.x,e.corner.y),n.setBackCorner(e.back.corner.x,e.back.corner.y),n.setThinkness(e.wall.thickness)},setRendering:function(t){this.$state.rendering=t}},proxy:function(){return new er(this)}},Ji),rr=k.define({id:"com.3dnest.spoke.windoor",namespace:"windoor",version:Gi["a"],plugin:Ji,elements:{Hollow:ir}}),or=n("7580"),ar={},sr=function(t,e){vt["h"].Not.String(t)&&vt["c"].Throw.TypeError("Invalid `name`, a string expected."),vt["h"].Not.Function(e.render)&&vt["c"].Throw.TypeError("Invalid `material`, a function expected."),t in ar&&vt["b"].warn('Duplicated material name="'.concat(t,'". The original is replaced.')),ar[t]=e},cr=function(){var t=Object(or["a"])(regeneratorRuntime.mark((function t(e,n){var i,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,fn.Texture.fromURL(n);case 2:i=t.sent,r={texture:i,render:function(t,e){var n=e.width,r=e.height,o=n>0?n:i.width,a=r>0?r:i.height;t.beginTextureFill({texture:i,matrix:new fn.Matrix(o/i.width,0,0,a/i.height,0,0)}).drawRect(0,0,o,a)}},sr(e,r);case 5:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),ur=function(t){return t in ar||vt["b"].warn('material name="'.concat(t,'" is not exist.')),ar[t]},lr=function(t){Object(Qe["a"])(n,t);var e=Object(Ze["a"])(n);function n(){return Object(ht["a"])(this,n),e.apply(this,arguments)}return Object(ft["a"])(n,[{key:"createStuff",value:function(t,e,n,i,r){return Yi(this).createStuff(t,e,n,i,r)}},{key:"createMovingStuff",value:function(t,e,n,i){return Yi(this).createMovingStuff(t,e,n,i)}},{key:"getAllStuffList",value:function(){return Array.from(this.stuffs())}},{key:"stuffs",value:regeneratorRuntime.mark((function t(){var e,n,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=Object(Te["a"])(Yi(this).stuffs()),t.prev=1,e.s();case 3:if((n=e.n()).done){t.next=9;break}return i=n.value,t.next=7,i.$proxy;case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](1),e.e(t.t0);case 14:return t.prev=14,e.f(),t.finish(14);case 17:case"end":return t.stop()}}),t,this,[[1,11,14,17]])}))}]),n}(y.Proxy.Plugin),hr=w.define({proxy:y.Proxy.Creator(lr),created:function(){var t=this;this.$on("element-created",(function(e,n){t.$emit("".concat(n.toLowerCase(),"-created"),e)}))},methods:{createStuff:function(t,e,n,i,r){var o=ur(t).texture,a=this.$drawing.scale;return this.$createElement("Stuff",t,e,n,i||o.width*a,r||o.height*a).$proxy},createMovingStuff:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=this.createStuff(t,1e4,1e4,e,n);return r.setRotation(i),this.$drawing.common.transformer.moveElement(r),r},stuffs:regeneratorRuntime.mark((function t(){var e,n,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=Object(Te["a"])(this.$elements("Stuff")),t.prev=1,e.s();case 3:if((n=e.n()).done){t.next=9;break}return i=n.value,t.next=7,i;case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](1),e.e(t.t0);case 14:return t.prev=14,e.f(),t.finish(14);case 17:case"end":return t.stop()}}),t,this,[[1,11,14,17]])}))}}),fr=(n("cb29"),function(t){Object(Qe["a"])(n,t);var e=Object(Ze["a"])(n);function n(){return Object(ht["a"])(this,n),e.apply(this,arguments)}return Object(ft["a"])(n,[{key:"fill",get:function(){return Yi(this).fill}},{key:"width",get:function(){return Yi(this).width}},{key:"height",get:function(){return Yi(this).height}},{key:"rotation",get:function(){return Yi(this).rotation}},{key:"x",get:function(){return Yi(this).x}},{key:"y",get:function(){return Yi(this).y}},{key:"room",get:function(){return Yi(this).room}},{key:"visible",get:function(){return Yi(this).$visible}},{key:"setFill",value:function(t){Yi(this).setFill(t)}},{key:"setRoom",value:function(t){Yi(this).setRoom(t)}},{key:"setWidth",value:function(t){Yi(this).setWidth(t)}},{key:"setHeight",value:function(t){Yi(this).setHeight(t)}},{key:"setOffset",value:function(t,e){Yi(this).setOffet(t,e)}},{key:"setRotation",value:function(t){Yi(this).setRotation(t)}},{key:"setPosition",value:function(t,e){Yi(this).setPosition(t,e)}},{key:"show",value:function(){Yi(this).$show()}},{key:"hide",value:function(){Yi(this).$hide()}},{key:"remove",value:function(){Yi(this).remove()}}]),n}(y.Proxy.Element)),dr=w.Element.define({proxy:y.Proxy.Creator(fr),groupIndex:1200,interative:!0,focusable:!0,draggable:!0,state:function(){return{fill:"",width:0,height:0,room:null,offsetX:0,offsetY:0,x:0,y:0,rotation:0,rendering:!1,listener:vt["e"]}},getters:{fill:function(){return this.$state.fill},width:function(){return this.$state.width},height:function(){return this.$state.height},rotation:function(){return this.$state.rotation},x:function(){return this.$state.x},y:function(){return this.$state.y},room:function(){return this.$state.room}},created:function(t,e,n,i,r){this.setWidth(i),this.setHeight(r),this.setFill(t),this.setPosition(e,n)},destroy:function(){var t=this.$state.room;t&&t.off&&t.off("dirty",this.$state.listener)},render:function(t){var e=this.$state,n=e.width,i=e.height,r=e.rotation,o=e.fill,a=e.rendering,s=e.x,c=e.y,u=this.$drawing.scale,l={width:n/u,height:i/u};t.drawRect(0,0,l.width,l.height),t.pivot.x=l.width/2,t.pivot.y=l.height/2;var h=ur(o);h&&h.render(t,l);var f=this.$toCanvas(Number(s),Number(c)),d=Object(ae["a"])(f,2);t.x=d[0],t.y=d[1],t.rotation=r,a&&(this.$emit("change",this.$proxy),this.setRendering(!1))},methods:{setFill:function(t){this.$state.fill=t,this.$setDirty()},setRoom:function(t){var e=this;t!==this.$state.room&&(t?(this.$state.room=t,t.on("dirty",this.$state.listener=function(){return e.$setDirty()}),this.$setDirty()):this.$state.room=null)},setWidth:function(t){this.$state.width=t,this.$setDirty(),this.setRendering(!0)},setHeight:function(t){this.$state.height=t,this.$setDirty(),this.setRendering(!0)},setRotation:function(t){this.$state.rotation=t,this.$setDirty(),this.setRendering(!0)},setPosition:function(t,e){var n=this.$state.room,i=n?this.$toGeometry(n.$bounds.left,n.$bounds.bottom):[0,0],r=Object(ae["a"])(i,2),o=r[0],a=r[1];this.$state.x=t,this.$state.y=e,this.$state.offsetX=t-o,this.$state.offsetY=e-a,this.$setDirty(),this.setRendering(!0)},setOffset:function(t,e){var n=this.$state.room,i=n?this.$toGeometry(n.$bounds.left,n.$bounds.bottom):[0,0],r=Object(ae["a"])(i,2),o=r[0],a=r[1];this.$state.offsetX=t,this.$state.offsetY=e;var s=[o+t,a+e];this.$state.x=s[0],this.$state.y=s[1],this.$setDirty()},setRendering:function(t){this.$state.rendering=t},remove:function(){this.$destroy()}}},hr),pr=n("e07e"),vr=k.define({id:"com.3dnest.spoke.furniture",namespace:"furniture",version:pr["a"],plugin:hr,elements:{Stuff:dr}}),mr=n("3d04"),gr=n("5d77"),yr=(n("9911"),n("ac1f"),n("1276"),function(t){Object(Qe["a"])(n,t);var e=Object(Ze["a"])(n);function n(){return Object(ht["a"])(this,n),e.apply(this,arguments)}return Object(ft["a"])(n,[{key:"x",get:function(){return Yi(this).x}},{key:"y",get:function(){return Yi(this).y}},{key:"size",get:function(){return Yi(this).size}},{key:"point",get:function(){var t=Yi(this),e=t.x,n=t.y;return[e,n]}},{key:"move",value:function(t,e){return y.Assert.Point(t,e),Yi(this).move(t,e),this}},{key:"remove",value:function(){return Yi(this).remove(),this}},{key:"getAdjacentCornerList",value:function(){return Yi(this).getAdjacentCornerList().map(br)}},{key:"surfaces",value:regeneratorRuntime.mark((function t(){var e,n,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=Object(Te["a"])(Yi(this).surfaces()),t.prev=1,e.s();case 3:if((n=e.n()).done){t.next=9;break}return i=n.value,t.next=7,i.$proxy;case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](1),e.e(t.t0);case 14:return t.prev=14,e.f(),t.finish(14);case 17:case"end":return t.stop()}}),t,this,[[1,11,14,17]])}))},{key:"walls",value:regeneratorRuntime.mark((function t(){var e,n,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=Object(Te["a"])(Yi(this).surfaces()),t.prev=1,e.s();case 3:if((n=e.n()).done){t.next=9;break}return i=n.value,t.next=7,i.wall.$proxy;case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](1),e.e(t.t0);case 14:return t.prev=14,e.f(),t.finish(14);case 17:case"end":return t.stop()}}),t,this,[[1,11,14,17]])}))},{key:"getWallByToCorner",value:function(t){vt["c"].instanceOf(t,n)||vt["c"].Throw.TypeError("Invalid corner, a CornerProxy expected.");var e=Yi(this).getWallByToCorner(Yi(t));return vt["h"].isNull(e)?null:e.$proxy}}]),n}(y.Proxy.Element)),br=function(t){return t.$proxy},xr=function(t){Object(Qe["a"])(n,t);var e=Object(Ze["a"])(n);function n(){return Object(ht["a"])(this,n),e.apply(this,arguments)}return Object(ft["a"])(n,[{key:"thisCorner",get:function(){return Yi(this).thisSurface.corner.$proxy}},{key:"thatCorner",get:function(){return Yi(this).thatSurface.corner.$proxy}},{key:"thisSurface",get:function(){return Yi(this).thisSurface.$proxy}},{key:"thatSurface",get:function(){return Yi(this).thatSurface.$proxy}},{key:"thickness",get:function(){return Yi(this).$state.thickness},set:function(t){(vt["h"].Not.Number(t)||t<0)&&vt["c"].Throw.TypeError("Invalid `thickness`, a number >=0 expected."),Yi(this).setThickness(t)}},{key:"segment",get:function(){return Yi(this).segment}},{key:"color",get:function(){return Yi(this).$state.color},set:function(t){Yi(this).setColor(t)}},{key:"remove",value:function(){Yi(this).remove()}},{key:"removeSimple",value:function(){Yi(this).removeSimple()}},{key:"drawPolygon",value:function(t){vt["c"].instanceOf(t,fn.Graphics)||vt["c"].Throw.TypeError("Invalid `graphics`, a `PIXI.Graphics` expected."),Yi(this).drawPolygon(t)}},{key:"containsPoint",value:function(){}}]),n}(y.Proxy.Element),$r=function(t){Object(Qe["a"])(n,t);var e=Object(Ze["a"])(n);function n(){return Object(ht["a"])(this,n),e.apply(this,arguments)}return Object(ft["a"])(n,[{key:"getOptions",value:function(){return Yi(this).$data.optionsGetter}},{key:"createCorner",value:function(t,e){return y.Assert.Point(t,e),Yi(this).createCorner(t,e).$proxy}},{key:"removeCorner",value:function(t){return vt["c"].instanceOf(t,yr)||vt["c"].Throw.TypeError("Invalid `corner`, a CornerProxy expected."),Yi(this).removeCorner(Yi(t))}},{key:"createWall",value:function(t,e){return kr(t,e),vt["h"].Not.Null(t.getWallByToCorner(e))&&vt["c"].throwError("Duplicated wall"),t===e&&vt["c"].throwError("`fromCorner` and `toCorner` MUST NOT be same."),Yi(this).createWall(Yi(t),Yi(e)).$proxy}},{key:"removeWall",value:function(t){return vt["c"].instanceOf(t,xr)||vt["c"].Throw.TypeError("Invalid `wall`, a WallProxy expected."),Yi(this).removeWall(Yi(t))}},{key:"removeWallSimple",value:function(t){return vt["c"].instanceOf(t,xr)||vt["c"].Throw.TypeError("Invalid `wall`, a WallProxy expected."),Yi(this).removeWallSimple(Yi(t))}},{key:"split",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:vt["e"];return y.Assert.Point(e,n),vt["c"].instanceOf(t,xr)||vt["c"].Throw.TypeError("Invalid `wall`, a WallProxy expected."),Yi(this).split(Yi(t),e,n,(function(t,e,n){i(t.$proxy,e.$proxy,n.$proxy)})).$proxy}},{key:"merge",value:function(t){return vt["c"].instanceOf(t,yr)||vt["c"].Throw.TypeError("Invalid `corner`, a CornerProxy expected."),2!==t.size&&vt["c"].throwError("The Wall number of this Corner is NOT 2."),Yi(this).merge(Yi(t)).$proxy}},{key:"combine",value:function(t){vt["c"].instanceOf(t,xr)||vt["c"].Throw.TypeError("Invalid `wall`, a WallProxy expected.");var e=Yi(t);return Yi(this).combine(e).$proxy}},{key:"removeRoom",value:function(){}},{key:"getAllCornerList",value:function(){return Array.from(this.corners())}},{key:"getAllWallList",value:function(){return Array.from(this.walls())}},{key:"getAllRoomList",value:function(){return Array.from(this.rooms())}},{key:"getRoomByPoint",value:function(t,e){y.Assert.Point(t,e);var n=Yi(this).getRoomOfPoint(t,e);return n?n.$proxy:null}},{key:"queryCorner",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;y.Assert.Point(t,e),(vt["h"].Not.Number(n)||n<=0)&&vt["c"].Throw.TypeError("Invalid `range`, a number >0 expected.");var i=Yi(this).queryCorner(t,e,n);return vt["h"].isNull(i)?null:i.$proxy}},{key:"mergeAll",value:function(){}},{key:"clearEmplyCorner",value:function(){}},{key:"corners",value:regeneratorRuntime.mark((function t(){var e,n,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=Object(Te["a"])(Yi(this).$elements("Corner")),t.prev=1,e.s();case 3:if((n=e.n()).done){t.next=9;break}return i=n.value,t.next=7,i.$proxy;case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](1),e.e(t.t0);case 14:return t.prev=14,e.f(),t.finish(14);case 17:case"end":return t.stop()}}),t,this,[[1,11,14,17]])}))},{key:"walls",value:regeneratorRuntime.mark((function t(){var e,n,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=Object(Te["a"])(Yi(this).$elements("Wall")),t.prev=1,e.s();case 3:if((n=e.n()).done){t.next=9;break}return i=n.value,t.next=7,i.$proxy;case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](1),e.e(t.t0);case 14:return t.prev=14,e.f(),t.finish(14);case 17:case"end":return t.stop()}}),t,this,[[1,11,14,17]])}))},{key:"rooms",value:regeneratorRuntime.mark((function t(){var e,n,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=Object(Te["a"])(Yi(this).$elements("Room")),t.prev=1,e.s();case 3:if((n=e.n()).done){t.next=9;break}return i=n.value,t.next=7,i.$proxy;case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](1),e.e(t.t0);case 14:return t.prev=14,e.f(),t.finish(14);case 17:case"end":return t.stop()}}),t,this,[[1,11,14,17]])}))},{key:"surfaces",value:regeneratorRuntime.mark((function t(){var e,n,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=Object(Te["a"])(Yi(this).$elements("Surface")),t.prev=1,e.s();case 3:if((n=e.n()).done){t.next=9;break}return i=n.value,t.next=7,i.$proxy;case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](1),e.e(t.t0);case 14:return t.prev=14,e.f(),t.finish(14);case 17:case"end":return t.stop()}}),t,this,[[1,11,14,17]])}))}]),n}(y.Proxy.Plugin),wr=["from","to"],kr=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var i in wr)vt["c"].instanceOf(e[i],yr)||vt["c"].Throw.TypeError("Invalid `".concat(wr[i],"`, a CornerProxy excepted."))},Or=y.Options.define,jr=Or({show:!0},{snap:Or({},{corner:Or({active:!0,priority:0,maxDistance:15})}),corner:Or({show:!0,render:null},{style:Or({color:16777215,opacity:.75,radius:5},{hover:Or({color:0,opacity:.75,radius:5})})}),wall:Or({show:!0},{style:Or({opacity:1,color:10066329,hoverColor:13421772}),midline:Or({show:!0,color:16711680,width:1})}),room:Or({show:!0,defaultTexture:null}),surface:Or({opacity:1,borderColor:0,borderWidth:2})}),Tr=(n("2781"),n("c8d3"),n("1d93"),n("8fdf"),n("8f79"),n("cbd2"),n("6065"),function(t,e){var n,r=null,o=i.ROUND,a=Object(Te["a"])(p.Iterator.allHalfEdgeOfVertex(t));try{for(a.s();!(n=a.n()).done;){var s=n.value,c=u.differ(e,p.getAngleOfHalfEdge(s),!1);c<o&&(o=c,r=s)}}catch(l){a.e(l)}finally{a.f()}return r}),Er=function(t,e,n){if(vt["h"].Not.Null(t.incidentEdge)){var i=t.x,r=t.y,o=n.x,a=n.y,s=Math.atan2(a-r,o-i),c=Tr(t,s),u=c.twin;e.previous=u,e.twin.next=u.next,u.next.previous=e.twin,u.next=e}e.origin=t,t.incidentEdge=e},Sr=function(t,e){var n,i=Object(Te["a"])(p.Iterator.allHalfEdgeOfPath(t));try{for(i.s();!(n=i.n()).done;){var r=n.value;r.incidentFace=e}}catch(o){i.e(o)}finally{i.f()}},Lr=function(t,e){t.twin=e,e.twin=t,t.next=e,e.next=t,t.previous=e,e.previous=t},Cr=function(t,e,n){var i=vt["h"].isNull(t.incidentEdge)&&vt["h"].isNull(e.incidentEdge),r=new p.Struct.HalfEdge,o=new p.Struct.HalfEdge;Lr(r,o),Er(t,r,e),Er(e,o,t);var a=i?p.getFaceOfPoint(n,t):r.previous.incidentFace||r.next.incidentFace,s=a.outerComponent,c=a.innerComponents;if(p.isTwinInSamePath(r)){r.incidentFace=o.incidentFace=a;var u=c.splice(0);p.isPathContainsHalfEdge(r,s)?a.outerComponent=r:c.push(r);var l,h=Object(Te["a"])(u);try{for(h.s();!(l=h.n()).done;){var f=l.value;p.isPathContainsHalfEdge(r,f)||c.push(f)}}catch(j){h.e(j)}finally{h.f()}}else{var d=new p.Struct.Face,v=p.isOuterPath(o),m=p.isOuterPath(r),g=v?r:o,y=g.twin;Sr(y,d),g.incidentFace=a,d.outerComponent=y;var b=a.innerComponents.splice(0);m===v?a.outerComponent=g:a.innerComponents.push(g);var x,$=Object(Te["a"])(b);try{for($.s();!(x=$.n()).done;){var w=x.value,k=w.origin;if(!p.isPathContainsVertex(g,k)&&!p.isPathContainsHalfEdge(y,w)){var O=p.getFaceOfPoint(d,k)?d:a;w.incidentFace!==O&&Sr(w,O),O.innerComponents.push(w)}}}catch(j){$.e(j)}finally{$.f()}}return r},Pr=function(t){t.origin=null,t.twin=null,t.previous=null,t.next=null,t.incidentFace=null},Fr=function(t){return t.outerComponent=null,t.innerComponents.length=0,t},Ar=function(t){var e=t.twin,n=t.previous,i=t.origin,r=null;return e===n?i.incidentEdge=null:(n.next=i.incidentEdge=e.next,r=e.next.previous=n),r},_r=function(t){var e=t.incidentFace,n=t.twin,i=p.isTwinInSamePath(t),r=p.isOuterPath(t),o=Ar(t),a=Ar(n);if(i){var s,c=e.innerComponents,u=c.splice(0),l=[o,a].filter(vt["h"].Not.Null).filter((function(t){var n=p.isOuterPath(t);return n?e.outerComponent=t:c.push(t),!n})),h=Object(Te["a"])(u);try{var f=function(){var e=s.value;e!==t&&e!==n&&l.every((function(t){return!p.isPathContainsHalfEdge(t,e)}))&&c.push(e)};for(h.s();!(s=h.n()).done;)f()}catch(k){h.e(k)}finally{h.f()}}else{var d,v,m=o.incidentFace,g=a.incidentFace;if(r?(d=g,v=m):(d=m,v=g),p.isOuterPath(o))d.outerComponent=o;else{var y=d.innerComponents,b=d.innerComponents.splice(0).concat(v.innerComponents);y.push(o);var x,$=Object(Te["a"])(b);try{for($.s();!(x=$.n()).done;){var w=x.value;w===t||w===n||p.isPathContainsHalfEdge(o,w)||y.push(w)}}catch(k){$.e(k)}finally{$.f()}}Sr(o,d),Fr(v)}Pr(t),Pr(n)},Rr=function(t){return p.getVertexHalfEdgeList(t).forEach(_r),t.incidentEdge=null,t},Dr=function(t){t.incidentEdge=null,t.x=0,t.y=0},Nr=function(t){var e=t.incidentEdge.twin,n=e.next.twin,i=e.next.next,r=n.next.next;return Pr(e.twin),Pr(n.twin),Dr(t),e.twin=n,n.twin=e,e.next=i,n.next=r,i.previous=e,r.previous=n,e},Wr=function(t){var e=t.incidentFace;if(e.outerComponent===t)e.outerComponent=t.next;else{var n=e.innerComponents,i=n.indexOf(t);-1!==i&&(n[i]=t.next)}},Mr=function(t){var e=t.twin,n=t.origin,i=e.origin,r=p.hasOnlyHalfEdge(n),o=p.hasOnlyHalfEdge(i);Wr(t),Wr(e);var a=n;if(r)if(o)_r(t);else{var s=[n.x,n.y];i.x=s[0],i.y=s[1],Rr(n),a=i}else if(o)Rr(i);else{var c,u=Object(Te["a"])(p.Iterator.allHalfEdgeOfVertex(i));try{for(u.s();!(c=u.n()).done;){var l=c.value;l.origin=n}}catch(f){u.e(f)}finally{u.f()}n.incidentEdge=t.next,t.previous.next=t.next,t.next.previous=t.previous;var h=t.twin;h.previous.next=h.next,h.next.previous=h.previous,Pr(t),Pr(h),Dr(i)}return a},Ir=(n("97af"),n("000d"),"c"),Hr="d",Br="D",zr="Rg",Vr="_D",Ur="_Rg",Yr=new WeakMap,Gr=function(t){return Yr.get(t)},Xr=function(t,e,n,i,r){function o(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;Object(ht["a"])(this,o),Yr.set(t,this),this[Ir]=e}return Object(ft["a"])(o,[{key:t,get:function(){return vt["h"].isNull(this[Ir])}},{key:e,value:function(){this[Ir]=null,this[Vr]()}},{key:n,value:function(){this[Ur]()}},{key:i,value:function(){}},{key:r,value:function(){}}]),o}(Hr,Br,zr,Vr,Ur),Kr=function(){function t(){Object(ht["a"])(this,t)}return Object(ft["a"])(t,[{key:"mesh",get:function(){var t=Gr(this);return t[Hr]?null:t[Ir].$}},{key:"destroyed",get:function(){return Gr(this)[Hr]}}]),t}(),Jr="v",qr="s",Qr="Hs",Zr="F",to="H",eo="E",no="M",io="e",ro="v",oo="f",ao="g",so="mv",co="mf",uo="mh",lo="CV",ho="M",fo="L",po="S",vo="G",mo="C",go="LV",yo="RV",bo="RE",xo="HV",$o="HE",wo="HF",ko="TV",Oo="TH",jo="TF",To="PF",Eo="AE",So="AV",Lo="AF",Co="FV",Po="FE",Fo="FF",Ao="l",_o="VC",Ro="VD",Do="EC",No="ED",Wo="FC",Mo="FD",Io="HC",Ho="HD",Bo="t",zo="he",Vo="v",Uo="e",Yo="f",Go="n",Xo="p",Ko="b",Jo="P",qo=new WeakMap,Qo=function(t){return qo.get(t)},Zo=function(t){return t[Uo]},ta=function(t,e,n,i,r,o,a,s,c){Object(Qe["a"])(l,t);var u=Object(Ze["a"])(l);function l(t,e,n,i){var r;return Object(ht["a"])(this,l),r=u.call(this,t,e),qo.set(t,Object(un["a"])(r)),r.$=t,r[Jr]=p.createVertex(n,i),r[zr](),r}return Object(ft["a"])(l,[{key:e,get:function(){var t,e=0,n=Object(Te["a"])(p.Iterator.allHalfEdgeOfVertex(this[Jr]));try{for(n.s();!(t=n.n()).done;){t.value;e++}}catch(i){n.e(i)}finally{n.f()}return e}},{key:n,value:regeneratorRuntime.mark((function t(){var e,n,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=Object(Te["a"])(p.Iterator.allHalfEdgeOfVertex(this[Jr])),t.prev=1,e.s();case 3:if((n=e.n()).done){t.next=9;break}return i=n.value,t.next=7,this[Ir][Oo](i);case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](1),e.e(t.t0);case 14:return t.prev=14,e.f(),t.finish(14);case 17:case"end":return t.stop()}}),t,this,[[1,11,14,17]])}))},{key:i,value:function(){var t=this[Ir];t[ro].add(this),t[so].set(this[Jr],this)}},{key:r,value:function(){this[Jr]=null}},{key:o,value:function(){return p.getVertexHalfEdgeList(this[Jr]).map(this[Ir][Oo])}},{key:a,value:function(){return this[to]().map(Zo)}},{key:s,value:function(){var t,e=new Set,n=Object(Te["a"])(p.Iterator.allHalfEdgeOfVertex(this[Jr]));try{for(n.s();!(t=n.n()).done;){var i=t.value;e.add(i.incidentFace)}}catch(r){n.e(r)}finally{n.f()}return Array.from(e).map(this[Ir][jo])}},{key:c,value:function(t,e){this[Jr].x=t,this[Jr].y=e}}]),l}(Xr,qr,Qr,Ur,Vr,to,eo,Zr,no),ea=(n("c7b3"),function(t){return t.$}),na=function(t){Object(Qe["a"])(n,t);var e=Object(Ze["a"])(n);function n(t,i,r){var o;return Object(ht["a"])(this,n),o=e.call(this),new ta(Object(un["a"])(o),t,i,r),Object.seal(Object(un["a"])(o)),o}return Object(ft["a"])(n,[{key:"x",get:function(){return Qo(this)[Jr].x}},{key:"y",get:function(){return Qo(this)[Jr].y}},{key:"size",get:function(){return Qo(this)[qr]}},{key:"halfEdges",value:regeneratorRuntime.mark((function t(){var e,n,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=Object(Te["a"])(Qo(this)[Qr]()),t.prev=1,e.s();case 3:if((n=e.n()).done){t.next=9;break}return i=n.value,t.next=7,i.$;case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](1),e.e(t.t0);case 14:return t.prev=14,e.f(),t.finish(14);case 17:case"end":return t.stop()}}),t,this,[[1,11,14,17]])}))},{key:"move",value:function(t,e){return vt["h"].Not.Number(t)&&vt["c"].Throw.TypeError("Vertex.x MUST be a number."),vt["h"].Not.Number(e)&&vt["c"].Throw.TypeError("Vertex.y MUST be a number."),Qo(this)[no](t,e),this}},{key:"getFaceList",value:function(){return Qo(this)[Zr]().map(ea)}},{key:"getHalfEdgeList",value:function(){return Qo(this)[to]().map(ea)}},{key:"getEdgeList",value:function(){return Qo(this)[eo]().map(ea)}}]),n}(Kr),ia="if",ra="af",oa="iv",aa="av",sa="ih",ca="ah",ua=new WeakMap,la=function(t){return ua.get(t)},ha=function(t,e,n,i,r,o,a,s){Object(Qe["a"])(u,t);var c=Object(Ze["a"])(u);function u(t,e,n){var i;return Object(ht["a"])(this,u),i=c.call(this,t,e),ua.set(t,Object(un["a"])(i)),i.$=t,i[sa]=n,n[Uo]=n[Ko][Uo]=Object(un["a"])(i),i[zr](),i}return Object(ft["a"])(u,[{key:e,value:function(){this[Ir][io].add(this)}},{key:n,value:function(){this[sa]=null}},{key:i,get:function(){return this[sa][Yo]}},{key:r,get:function(){return this[ca][Yo]}},{key:o,get:function(){return this[sa][Vo]}},{key:a,get:function(){return this[ca][Vo]}},{key:s,get:function(){return this[sa][Ko]}}]),u}(Xr,Ur,Vr,ia,ra,oa,aa,ca),fa=(n("a939"),function(t){Object(Qe["a"])(n,t);var e=Object(Ze["a"])(n);function n(t,i){var r;return Object(ht["a"])(this,n),r=e.call(this),new ha(Object(un["a"])(r),t,i),Object.freeze(Object(un["a"])(r)),r}return Object(ft["a"])(n,[{key:"thisFace",get:function(){return la(this)[ia].$}},{key:"thatFace",get:function(){return la(this)[ra].$}},{key:"thisVertex",get:function(){return la(this)[oa].$}},{key:"thatVertex",get:function(){return la(this)[aa].$}},{key:"thisHalfEdge",get:function(){return la(this)[sa].$}},{key:"thatHalfEdge",get:function(){return la(this)[ca].$}}]),n}(Kr)),da="f",pa="o",va="i",ma="H",ga="C",ya="O",ba="P",xa=new WeakMap,$a=function(t){return xa.get(t)},wa=function(t,e,n,i,r,o,a,s,c){Object(Qe["a"])(l,t);var u=Object(Ze["a"])(l);function l(t,e,n){var i;return Object(ht["a"])(this,l),i=u.call(this,t,e),xa.set(t,Object(un["a"])(i)),i.$=t,i[da]=n,i}return Object(ft["a"])(l,[{key:e,get:function(){return this[Ir][Oo](this[da].outerComponent)}},{key:n,get:function(){return this[da].innerComponents.map(this[Ir][Oo])}},{key:i,value:function(){var t=this[Ir];t[oo].add(this),t[co].set(this[da],this)}},{key:r,value:function(){this[da]=null}},{key:o,value:function(){return p.getPathOfHalfEdge(this[da].outerComponent)}},{key:a,value:function(){return this[ma]().map(this[Ir][Oo])}},{key:s,value:function(){return p.queryChildFaceList(this[da]).map(this[Ir][jo])}},{key:c,value:function(t,e){var n=p.getPolygonFromFaceOuter(this[da]);return h.containsPoint(n,{x:t,y:e})}}]),l}(Xr,pa,va,Ur,Vr,ma,ya,ga,ba),ka=function(t){Object(Qe["a"])(n,t);var e=Object(Ze["a"])(n);function n(t,i){var r;return Object(ht["a"])(this,n),r=e.call(this),new wa(Object(un["a"])(r),t,i),Object.freeze(Object(un["a"])(r)),r}return Object(ft["a"])(n,[{key:"outerHalfEdge",get:function(){return $a(this)[pa].$}},{key:"innerHalfEdgeList",get:function(){return $a(this)[va].map(ea)}},{key:"getChildFaceList",value:function(){return $a(this)[ga]().map(ea)}},{key:"getOuterHalfEdgeList",value:function(){return $a(this)[ya]().map(ea)}},{key:"containsPoint",value:function(t,e){return $a(this)[ba](t,e)}}]),n}(Kr),Oa=function(t){return new ka(t,p.createGlobalFace())},ja=new WeakMap,Ta=function(t){return ja.get(t)},Ea=function(t,e,n,i,r,o,a,s,c,u){Object(Qe["a"])(h,t);var l=Object(Ze["a"])(h);function h(t,e,n){var i;return Object(ht["a"])(this,h),i=l.call(this,t,e),ja.set(t,Object(un["a"])(i)),i.$=t,i[zo]=n,i[Uo]=null,i[Ur](),i}return Object(ft["a"])(h,[{key:e,value:function(){this[Ir][uo].set(this[zo],this)}},{key:n,value:function(){this[zo]=null,this[Uo]=null}},{key:i,get:function(){return this[zo].twin}},{key:r,get:function(){return this[Ir][ko](this[zo].origin)}},{key:o,get:function(){return this[Ir][jo](this[zo].incidentFace)}},{key:a,get:function(){return this[Ir][Oo](this[zo].next)}},{key:s,get:function(){return this[Ir][Oo](this[zo].previous)}},{key:c,get:function(){return this[Ir][Oo](this[Bo])}},{key:u,value:regeneratorRuntime.mark((function t(){var e,n,i,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=this[Ir][Oo],n=Object(Te["a"])(p.Iterator.allHalfEdgeOfPath(this[zo])),t.prev=2,n.s();case 4:if((i=n.n()).done){t.next=10;break}return r=i.value,t.next=8,e(r);case 8:t.next=4;break;case 10:t.next=15;break;case 12:t.prev=12,t.t0=t["catch"](2),n.e(t.t0);case 15:return t.prev=15,n.f(),t.finish(15);case 18:case"end":return t.stop()}}),t,this,[[2,12,15,18]])}))}]),h}(Xr,Ur,Vr,Bo,Vo,Yo,Go,Xo,Ko,Jo),Sa=function(t){Object(Qe["a"])(n,t);var e=Object(Ze["a"])(n);function n(t,i){var r;return Object(ht["a"])(this,n),r=e.call(this),new Ea(Object(un["a"])(r),t,i),Object.freeze(Object(un["a"])(r)),r}return Object(ft["a"])(n,[{key:"vertex",get:function(){return Ta(this)[Vo].$}},{key:"edge",get:function(){return Ta(this)[Uo].$}},{key:"face",get:function(){return Ta(this)[Yo].$}},{key:"next",get:function(){return Ta(this)[Go].$}},{key:"previous",get:function(){return Ta(this)[Xo].$}},{key:"back",get:function(){return Ta(this)[Ko].$}},{key:"path",value:regeneratorRuntime.mark((function t(){var e,n,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=Object(Te["a"])(Ta(this)[Jo]()),t.prev=1,e.s();case 3:if((n=e.n()).done){t.next=9;break}return i=n.value,t.next=7,i.$;case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](1),e.e(t.t0);case 14:return t.prev=14,e.f(),t.finish(14);case 17:case"end":return t.stop()}}),t,this,[[1,11,14,17]])}))}]),n}(Kr),La=new WeakMap,Ca=function(t){return La.get(t)},Pa=function(t,e,n,i,r,o,a,s,c,u,l,h,f,d,v,m,g,y,b){function x(t){var e;Object(ht["a"])(this,x),La.set(t,this),this.$=t,this[io]=new Set,this[ro]=new Set;var n=this[so]=new Map,i=this[ao]=$a(Oa(this));this[oo]=new Set;var r=this[co]=new Map,o=this[uo]=new Map;this[Oo]=function(t){return o.get(t)};var a=i[da];this[jo]=function(t){return a===t?i:r.get(t)},this[ko]=function(t){return n.get(t)},this[Ao]=(e={},Object(dt["a"])(e,_o,vt["e"]),Object(dt["a"])(e,Ro,vt["e"]),Object(dt["a"])(e,Do,vt["e"]),Object(dt["a"])(e,No,vt["e"]),Object(dt["a"])(e,Wo,vt["e"]),Object(dt["a"])(e,Mo,vt["e"]),Object(dt["a"])(e,Io,vt["e"]),Object(dt["a"])(e,Ho,vt["e"]),e)}return Object(ft["a"])(x,[{key:t,value:function(t,e){var n=new na(this,t,e);return this[Ao][_o](n),n}},{key:e,value:function(t,e,n){t[no](e,n)}},{key:n,value:function(t,e){var n=this[ao][da],i=t[Jr],r=e[Jr],o=Cr(i,r,n),a=o.twin,s=o.incidentFace,c=a.incidentFace;if(s!==c){var u=this[jo](s)?c:s,l=new ka(this,u);$a(l)[zr](),this[Ao][Wo](l)}var h=new Sa(this,o),f=new Sa(this,a),d=new fa(this,Ta(h));return this[Ao][Io](h),this[Ao][Io](f),this[Ao][Do](d),d}},{key:i,value:function(t,e){var n=p.splitHalfEdgeByVertex(t[sa][zo],e[Jr]),i=t[sa][Bo],r=new Sa(this,n),o=new Sa(this,i),a=new fa(this,Ta(r));return t[ca][Uo]=t,this[Ao][Io](r),this[Ao][Io](o),this[Ao][Do](a),a}},{key:r,value:function(t){var e=t[Jr],n=p.getVertexHalfEdgeList(e);2!==n.length&&vt["c"].throwError("The MeshHalfEdge number of this MeshVertex is NOT 2.");var i=this[Oo](e.incidentEdge.twin.next)[Uo],r=this[Oo](e.incidentEdge)[Uo],o=this[Oo](Nr(e));o[Ko][Uo]=r,r[sa]=o,i[sa]=n[0];var a,s=Object(Te["a"])(n);try{for(s.s();!(a=s.n()).done;){var c=a.value;this[Oo](c)[Uo]=i}}catch(u){s.e(u)}finally{s.f()}return this[Po](),this[so].delete(t[Jr]),this[ro].delete(t),this[Ao][Ro](t.$),r}},{key:o,value:function(t){var e=t[sa],n=e[zo],i=Mr(n);return this[Co](),this[Po](),this[Fo](),this[ko](i)}},{key:a,value:function(t){Rr(t[Jr]),this[Po](),this[Fo]()}},{key:s,value:function(t){this[go](t),t[Br](),this[so].delete(t[Jr]),this[ro].delete(t),this[Ao][Ro](t.$)}},{key:c,value:function(t){_r(t[sa][zo]),this[Po](),this[Fo]()}},{key:u,value:function(t){return this[ro].has(t)}},{key:l,value:function(t){return this[io].has(t)}},{key:h,value:function(t){return this[oo].has(t)}},{key:f,value:function(){return Array.from(this[io])}},{key:d,value:function(){return Array.from(this[oo])}},{key:v,value:function(){return Array.from(this[ro])}},{key:m,value:function(t,e){var n=this[ao],i=n[da],r=p.getFaceOfPoint(i,{x:t,y:e});return r===i?n:this[jo](r)}},{key:g,value:function(){var t,e=this[so],n=this[ro],i=[],r=Object(Te["a"])(e);try{for(r.s();!(t=r.n()).done;){var o=Object(ae["a"])(t.value,2),a=o[0],s=o[1];vt["h"].isNull(a.incidentEdge)&&(n.delete(s),s[Br](),i.push(a),this[Ao][Ro](s.$))}}catch(h){r.e(h)}finally{r.f()}for(var c=0,u=i;c<u.length;c++){var l=u[c];e.delete(l)}}},{key:y,value:function(){var t,e=this[uo],n=this[io],i=[],r=new Set,o=Object(Te["a"])(e);try{for(o.s();!(t=o.n()).done;){var a=Object(ae["a"])(t.value,2),s=a[0],c=a[1];if(vt["h"].isNull(s.twin)){var u=c[Uo];n.delete(u),u[Br](),c[Br](),i.push(s),r.add(u),this[Ao][Ho](c.$)}}}catch(m){o.e(m)}finally{o.f()}for(var l=0,h=i;l<h.length;l++){var f=h[l];e.delete(f)}var d,p=Object(Te["a"])(r);try{for(p.s();!(d=p.n()).done;){var v=d.value;this[Ao][No](v.$)}}catch(m){p.e(m)}finally{p.f()}}},{key:b,value:function(){var t,e=this[co],n=this[oo],i=[],r=Object(Te["a"])(e);try{for(r.s();!(t=r.n()).done;){var o=Object(ae["a"])(t.value,2),a=o[0],s=o[1];vt["h"].isNull(a.outerComponent)&&(n.delete(s),s[Br](),i.push(a),this[Ao][Mo](s.$))}}catch(h){r.e(h)}finally{r.f()}for(var c=0,u=i;c<u.length;c++){var l=u[c];e.delete(l)}}}]),x}(lo,ho,fo,po,vo,mo,go,yo,bo,xo,$o,wo,Eo,Lo,So,To,Co,Po,Fo),Fa=function(){function t(){Object(ht["a"])(this,t),new Pa(this),vt["f"].seal(this)}return Object(ft["a"])(t,[{key:"globalFace",get:function(){return Ca(this)[ao].$}},{key:"createVertex",value:function(t,e){return vt["h"].Not.Number(t)&&vt["c"].throwError("The `x` MUST be a number."),vt["h"].Not.Number(e)&&vt["c"].throwError("The `y` MUST be a number."),Ca(this)[lo](t,e)}},{key:"moveVertex",value:function(t,e,n){vt["c"].instanceOf(t,na)||vt["c"].Throw.TypeError("The `vertex` MUST be a MeshVertex."),vt["h"].Not.Number(e)&&vt["c"].Throw.TypeError("Vertex.x MUST be a number."),vt["h"].Not.Number(n)&&vt["c"].Throw.TypeError("Vertex.y MUST be a number.");var i=Ca(this),r=Qo(t);return i[xo](r)||vt["c"].throwError("The `vertex` does NOT belong to this mesh."),i[ho](r,e,n)}},{key:"link",value:function(t,e){vt["c"].instanceOf(t,na)||vt["c"].Throw.TypeError("The `thisVertex` MUST be a MeshVertex."),vt["c"].instanceOf(e,na)||vt["c"].Throw.TypeError("The `thatVertex` MUST be a MeshVertex."),t===e&&vt["c"].throwError("The `thisVertex` MUST be NOT `thatVertex`.");var n=Ca(this),i=Qo(t),r=Qo(e);return n[xo](i)||vt["c"].throwError("The `thisVertex` does NOT belong to this mesh."),n[xo](r)||vt["c"].throwError("The `thatVertex` does NOT belong to this mesh."),n[fo](i,r)}},{key:"split",value:function(t,e){vt["c"].instanceOf(t,fa)||vt["c"].Throw.TypeError("The `edge` MUST be a MeshEdge."),vt["c"].instanceOf(e,na)||vt["c"].Throw.TypeError("The `vertex` MUST be a MeshVertex.");var n=Ca(this),i=la(t),r=Qo(e);return n[$o](i)||vt["c"].throwError("The `edge` does NOT belong to this mesh."),n[xo](r)||vt["c"].throwError("The `vertex` does NOT belong to this mesh."),n[po](i,r)}},{key:"merge",value:function(t){vt["c"].instanceOf(t,na)||vt["c"].Throw.TypeError("The `vertex` MUST be a MeshVertex.");var e=Ca(this)[vo](Qo(t));return vt["h"].isNull(e)?null:e.$}},{key:"combine",value:function(t){vt["c"].instanceOf(t,fa)||vt["c"].Throw.TypeError("The `edge` MUST be a MeshEdge.");var e=Ca(this)[mo](la(t));return vt["h"].isUndefined(e)?null:e.$}},{key:"clearVertex",value:function(t){vt["c"].instanceOf(t,na)||vt["c"].Throw.TypeError("The `vertex` MUST be a MeshVertex.");var e=Ca(this),n=Qo(t);e[xo](n)||vt["c"].throwError("The `vertex` does NOT belong to this mesh."),e[go](n)}},{key:"removeVertex",value:function(t){vt["c"].instanceOf(t,na)||vt["c"].Throw.TypeError("The `vertex` MUST be a MeshVertex.");var e=Ca(this),n=Qo(t);e[xo](n)||vt["c"].throwError("The `vertex` does NOT belong to this mesh."),e[yo](n)}},{key:"removeEdge",value:function(t){vt["c"].instanceOf(t,fa)||vt["c"].Throw.TypeError("The `edge` MUST be a MeshEdge.");var e=Ca(this),n=la(t);e[$o](n)||vt["c"].throwError("The `edge` does NOT belong to this mesh."),e[bo](n)}},{key:"getAllVertexList",value:function(){return Ca(this)[So]().map(ea)}},{key:"getAllEdgeList",value:function(){return Ca(this)[Eo]().map(ea)}},{key:"getAllFaceList",value:function(){return Ca(this)[Lo]().map(ea)}},{key:"hasVertex",value:function(t){return vt["c"].instanceOf(t,na)||vt["c"].Throw.TypeError("The `vertex` MUST be a MeshVertex."),Ca(this)[xo](Qo(t))}},{key:"hasEdge",value:function(t){return vt["c"].instanceOf(t,fa)||vt["c"].Throw.TypeError("The `edge` MUST be a MeshEdge."),Ca(this)[$o](la(t))}},{key:"hasFace",value:function(t){return vt["c"].instanceOf(t,ka)||vt["c"].Throw.TypeError("The `face` MUST be a MeshFace."),Ca(this)[wo]($a(t))}},{key:"getFaceOfPoint",value:function(t,e){return vt["h"].Not.Number(t)&&vt["c"].Throw.TypeError("The `x` MUST be a number."),vt["h"].Not.Number(e)&&vt["c"].Throw.TypeError("The `y` MUST be a number."),Ca(this)[To](t,e).$}},{key:"flush",value:function(){var t=Ca(this);t[Co](),t[Po](),t[Fo]()}},{key:"flushVertex",value:function(){Ca(this)[Co]()}}]),t}(),Aa=function(){var t=Object(ae["a"])(Ra[_a],2),e=t[0],n=t[1];vt["f"].defineProperty(Fa.prototype,e,{get:function(){return Ca(this)[Ao][n]},set:function(t){vt["h"].Not.Function(t)&&vt["c"].Throw.TypeError("listener MUST be a function."),Ca(this)[Ao][n]=t}})},_a=0,Ra=[["onVertexCreate",_o],["onVertexDestroy",Ro],["onEdgeCreate",Do],["onEdgeDestroy",No],["onFaceCreate",Wo],["onFaceDestroy",Mo],["onHalfEdgeCreate",Io],["onHalfEdgeDestroy",Ho]];_a<Ra.length;_a++)Aa();function Da(){return{mesh:new Fa,vertexToCorner:new Map,edgeToWall:new Map,faceToRoom:new Map,halfEdgeToSurface:new Map}}var Na=w.define({options:jr,data:Da,proxy:y.Proxy.Creator($r),created:function(){var t=this,e=this.$data,n=e.mesh,i=e.vertexToCorner,r=e.edgeToWall,o=e.halfEdgeToSurface,a=e.faceToRoom;n.onFaceCreate=function(e){return t.$createElement("Room",e)},n.onEdgeCreate=function(e){return t.$createElement("Wall",e)},n.onVertexCreate=function(e){return t.$createElement("Corner",e)},n.onHalfEdgeCreate=function(e){return t.$createElement("Surface",e)},n.onFaceDestroy=function(t){a.get(t).$destroy(),a.delete(t)},n.onVertexDestroy=function(t){i.get(t).$destroy(),i.delete(t)},n.onEdgeDestroy=function(t){r.get(t).$destroy(),r.delete(t)},n.onHalfEdgeDestroy=function(t){o.get(t).$destroy(),o.delete(t)},this.$on("element-created",(function(e,n){t.$emit("".concat(n.toLowerCase(),"-created"),e)}));var s=this.$options.snap;this.$drawing.registerSnap({name:"structure-corner",get priority(){return s.corner.priority},get active(){return s.corner.active},handle:function(e,n,r){var o,a=Object(Te["a"])(i);try{for(a.s();!(o=a.n()).done;){var u=Object(ae["a"])(o.value,1),l=u[0],h=t.$toCanvas(l.x,l.y),f=c.distanceToPoint.apply(c,[e,n].concat(Object(pt["a"])(h)));if(f<s.corner.maxDistance)return r.apply(void 0,Object(pt["a"])(h))}}catch(d){a.e(d)}finally{a.f()}}})},methods:{assertNoCornerAt:function(t,e){this.queryCorner(t,e)&&vt["c"].throwError("It could NOT create a new `Corner` in same place")},createCorner:function(t,e){this.assertNoCornerAt(t,e);var n=this.$data,i=n.mesh,r=n.vertexToCorner;return r.get(i.createVertex(t,e))},removeCorner:function(t){return t.remove()},createWall:function(t,e){var n=this.$data,i=n.mesh,r=n.edgeToWall;return r.get(i.link(t.vertex,e.vertex))},removeWall:function(t){return t.remove()},removeWallSimple:function(t){return t.removeSimple()},split:function(t,e,n,i){this.assertNoCornerAt(e,n);var r=t.thisSurface.corner,o=t.thatSurface.corner,a=this.createCorner(e,n),s=this.$data.mesh.split(t.$state.edge,a.vertex),c=this.$data.edgeToWall.get(s);return c.setThickness(t.$state.thickness),r.updateSurfaces(),o.updateSurfaces(),a.updateSurfaces(),i(c,t,a),a},merge:function(t){var e=this.$data,n=e.mesh,i=e.edgeToWall,r=n.merge(t.$state.vertex),o=i.get(r);return o.thisSurface.corner.updateSurfaces(),o.thatSurface.corner.updateSurfaces(),o},combine:function(t){var e=this.$data,n=e.mesh,i=e.vertexToCorner,r=n.combine(t.$state.edge),o=i.get(r);return o.updateAllSiblingSurface(),o},queryCorner:function(t,e){var n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=Object(Te["a"])(this.$data.vertexToCorner);try{for(r.s();!(n=r.n()).done;){var o=Object(ae["a"])(n.value,2),s=o[0],c=o[1],u=a.fromBothPoint(s.x,s.y,t,e);if(a.length.apply(a,Object(pt["a"])(u))<i)return c}}catch(l){r.e(l)}finally{r.f()}return null},queryWallByFromTo:function(t,e){return t.getWallByToCorner(e)},getRoomOfPoint:function(t,e){var n=this.$data,i=n.mesh,r=n.faceToRoom;return r.get(i.getFaceOfPoint(t,e))}}}),Wa=function(t){return t.back.vertex},Ma=function(t){return t.updateSurfaces()};function Ia(t){return this.get(t)}var Ha,Ba,za,Va,Ua,Ya=w.Element.define({proxy:y.Proxy.Creator(yr),groupIndex:1e3,interative:!0,focusable:!0,hoverable:!0,render:function(t){var e=this.$plugin.$options.corner.style,n=e.color,i=e.opacity,r=e.radius,o=e.hover,a=this.$state.vertex,s=a.x,c=a.y,u=this.$toCanvas(s,c),l=Object(ae["a"])(u,2),h=l[0],f=l[1];this.$hovering?t.beginFill(o.color,o.opacity):t.beginFill(n,i),t.drawCircle(0,0,r).endFill(),t.x=h,t.y=f,this.$state.rendering&&(this.$emit("change",this.$proxy),this.setRendering(!1))},created:function(t){this.$data.vertexToCorner.set(this.$state.vertex=t,this)},state:function(){return{vertex:null,point:[0,0],rendering:!1}},getters:{x:function(){return this.vertex.x},y:function(){return this.vertex.y},point:function(){var t=this.vertex,e=t.x,n=t.y,i=this.$state.point;return i[0]=e,i[1]=n,i},vertex:function(){return this.$state.vertex},size:function(){return this.$state.vertex.size},destroyed:function(){return this.$state.vertex.destroyed}},methods:{move:function(t,e){var n=this.$plugin.queryCorner(t,e);vt["h"].Not.Null(n)&&n!==this&&vt["c"].throwError("It could NOT move the Corner to the same <".concat(t,", ").concat(e,"> place.")),this.$state.vertex.move(t,e),this.updateAllSiblingSurface(),this.$setDirty(),this.setRendering(!0)},remove:function(){var t=this.$state.vertex,e=this.$data,n=e.mesh,i=e.vertexToCorner,r=t.getHalfEdgeList().map(Wa).map(Ia,i);n.removeVertex(t);var o,a=Object(Te["a"])(r);try{for(a.s();!(o=a.n()).done;){var s=o.value;s.updateSurfaces()}}catch(c){a.e(c)}finally{a.f()}return this},surfaces:regeneratorRuntime.mark((function t(){var e,n,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=Object(Te["a"])(this.$state.vertex.halfEdges()),t.prev=1,e.s();case 3:if((n=e.n()).done){t.next=9;break}return i=n.value,t.next=7,this.$data.halfEdgeToSurface.get(i);case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](1),e.e(t.t0);case 14:return t.prev=14,e.f(),t.finish(14);case 17:case"end":return t.stop()}}),t,this,[[1,11,14,17]])})),getWallByToCorner:function(t){var e,n=Object(Te["a"])(this.surfaces());try{for(n.s();!(e=n.n()).done;){var i=e.value;if(i.back.corner===t)return i.wall}}catch(r){n.e(r)}finally{n.f()}return null},getAdjacentCornerList:function(){return this.$state.vertex.getHalfEdgeList().map(Wa).map(Ia,this.$data.vertexToCorner)},updateAllSiblingSurface:function(){this.getAdjacentCornerList().concat([this]).forEach(Ma)},updateSurfaces:function(){var t,e=Object(Te["a"])(this.surfaces());try{for(e.s();!(t=e.n()).done;){var n=t.value;n.update()}}catch(i){e.e(i)}finally{e.f()}},setRendering:function(t){this.$state.rendering=t}}},Na),Ga=w.Element.define({proxy:y.Proxy.Creator(xr),groupIndex:900,interative:!0,focusable:!0,hoverable:!0,render:function(t){var e,n,i=this.$plugin.$options.wall,r=i.midline,o=i.style,a=o.hoverColor,s=this.$state.edge,c=s.thisVertex,u=s.thatVertex,l=[c.x,c.y],h=[u.x,u.y],f=this.$state.color||o.color;(t.beginFill(this.$hovering?a:f),this.drawPolygon(t),t.endFill(),r.show)&&(e=(n=t.lineStyle(r.width,r.color)).moveTo.apply(n,Object(pt["a"])(this.$toCanvas.apply(this,l)))).lineTo.apply(e,Object(pt["a"])(this.$toCanvas.apply(this,h)));this.$state.rendering&&(this.$emit("change",this.$proxy),this.setRendering(!1))},created:function(t){var e=this,n=t.thisVertex,i=t.thatVertex,r=this.$data,o=r.edgeToWall,a=r.vertexToCorner;o.set(this.$state.edge=t,this),a.get(n).updateSurfaces(),a.get(i).updateSurfaces(),this.$on("dirty",(function(){if(!t.destroyed){var n=e.thisSurface,i=e.thatSurface,r=n.room,o=i.room;vt["h"].Not.Null(r)&&r.$setDirty(),vt["h"].Not.Null(o)&&o.$setDirty(),n.emitChange(),i.emitChange()}}))},state:function(){return{type:0,thickness:200,edge:null,rendering:!1,color:null}},getters:{thisSurface:function(){return this.$data.halfEdgeToSurface.get(this.$state.edge.thisHalfEdge)},thatSurface:function(){return this.$data.halfEdgeToSurface.get(this.$state.edge.thatHalfEdge)},segment:function(){var t=this.$state.edge,e=t.thisVertex,n=t.thatVertex;return r.Segment(e.x,e.y,n.x,n.y)}},methods:{drawPolygon:function(t){var e=this.$state.edge,n=e.thisVertex,i=e.thatVertex,r=[n.x,n.y],o=[i.x,i.y],a=this.thisSurface,s=this.thatSurface;t.drawPolygon.apply(t,Object(pt["a"])(this.$toCanvas.apply(this,r)).concat(Object(pt["a"])(this.$toCanvas.apply(this,Object(pt["a"])(a.origin))),Object(pt["a"])(this.$toCanvas.apply(this,Object(pt["a"])(a.target))),Object(pt["a"])(this.$toCanvas.apply(this,o)),Object(pt["a"])(this.$toCanvas.apply(this,Object(pt["a"])(s.origin))),Object(pt["a"])(this.$toCanvas.apply(this,Object(pt["a"])(s.target)))))},setThickness:function(t){this.$state.thickness=t,this.thisSurface.corner.updateSurfaces(),this.thatSurface.corner.updateSurfaces(),this.$setDirty(),this.setRendering(!0)},remove:function(){var t=this.thisSurface.corner,e=this.thatSurface.corner;this.removeSimple();for(var n=0,i=[t,e];n<i.length;n++){var r=i[n];0===r.size?r.remove():r.updateSurfaces()}return this.$proxy},removeSimple:function(){return this.$data.mesh.removeEdge(this.$state.edge),this.$proxy},setColor:function(t){this.$state.color=t,this.$setDirty()},setRendering:function(t){this.$state.rendering=t}}},Na),Xa=(n("fb6a"),function(t){Object(Qe["a"])(n,t);var e=Object(Ze["a"])(n);function n(){return Object(ht["a"])(this,n),e.apply(this,arguments)}return Object(ft["a"])(n,[{key:"back",get:function(){return Yi(this).back.$proxy}},{key:"previous",get:function(){return Yi(this).previous.$proxy}},{key:"next",get:function(){return Yi(this).next.$proxy}},{key:"corner",get:function(){return Yi(this).corner.$proxy}},{key:"wall",get:function(){return Yi(this).wall.$proxy}},{key:"room",get:function(){var t=Yi(this).room;return t?t.$proxy:null}},{key:"origin",get:function(){return Yi(this).origin}},{key:"target",get:function(){return Yi(this).target}},{key:"originSafe",get:function(){return this.origin.slice(0)}},{key:"targetSafe",get:function(){return this.target.slice(0)}},{key:"path",value:regeneratorRuntime.mark((function t(){var e,n,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=Object(Te["a"])(Yi(this).path()),t.prev=1,e.s();case 3:if((n=e.n()).done){t.next=9;break}return i=n.value,t.next=7,i.$proxy;case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](1),e.e(t.t0);case 14:return t.prev=14,e.f(),t.finish(14);case 17:case"end":return t.stop()}}),t,this,[[1,11,14,17]])}))}]),n}(y.Proxy.Element)),Ka=function(t,e,n){n[0]=t,n[1]=e},Ja=w.Element.define({proxy:y.Proxy.Creator(Xa),groupIndex:920,state:function(){return{halfEdge:null,origin:[0,0],target:[0,0],normal:Object(pt["a"])(r.Vector(0,0)),translation:Object(pt["a"])(r.Vector(0,0)),line:Object(pt["a"])(r.Line(0,0,0,0))}},render:function(t){var e,n,i,r=this.$state,o=r.origin,a=r.target;(e=(n=(i=t.lineStyle(1.5,2236962)).moveTo.apply(i,Object(pt["a"])(this.$toCanvas.apply(this,Object(pt["a"])(o))))).lineTo.apply(n,Object(pt["a"])(this.$toCanvas.apply(this,Object(pt["a"])(a))))).lineTo.apply(e,Object(pt["a"])(this.$toCanvas.apply(this,Object(pt["a"])(this.next.origin))))},created:function(t){this.$data.halfEdgeToSurface.set(this.$state.halfEdge=t,this)},getters:{next:function(){return this.$data.halfEdgeToSurface.get(this.$state.halfEdge.next)},previous:function(){return this.$data.halfEdgeToSurface.get(this.$state.halfEdge.previous)},back:function(){return this.$data.halfEdgeToSurface.get(this.$state.halfEdge.back)},corner:function(){return this.$data.vertexToCorner.get(this.$state.halfEdge.vertex)},wall:function(){return this.$data.edgeToWall.get(this.$state.halfEdge.edge)},room:function(){var t=this.$state.halfEdge.face,e=this.$data.faceToRoom.get(t);return vt["h"].isUndefined(e)?null:e},origin:function(){return this.$state.origin},target:function(){return this.$state.target}},methods:{setOrigin:function(t,e){return Ka(t,e,this.$state.origin),this.$setDirty(),this},setTarget:function(t,e){return Ka(t,e,this.$state.target),this.$setDirty(),this},path:regeneratorRuntime.mark((function t(){var e,n,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=Object(Te["a"])(this.$state.halfEdge.path()),t.prev=1,e.s();case 3:if((n=e.n()).done){t.next=9;break}return i=n.value,t.next=7,this.$data.halfEdgeToSurface.get(i);case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](1),e.e(t.t0);case 14:return t.prev=14,e.f(),t.finish(14);case 17:case"end":return t.stop()}}),t,this,[[1,11,14,17]])})),getLine:function(){var t=this.$state,e=t.normal,n=t.line,i=t.translation,o=this.wall.$state.thickness/2,s=this.corner.point,u=this.next.corner.point;return vt["f"].assign(e,a.rotate90.apply(a,Object(pt["a"])(a.normalize.apply(a,Object(pt["a"])(a.fromBothPoint.apply(a,Object(pt["a"])(s).concat(Object(pt["a"])(u)))))))),vt["f"].assign(i,a.multiply.apply(a,Object(pt["a"])(e).concat([o]))),vt["f"].assign(n,r.Line.apply(r,Object(pt["a"])(c.translate.apply(c,Object(pt["a"])(s).concat(Object(pt["a"])(i)))).concat(Object(pt["a"])(e))))},update:function(){this.updateSelf(),this.back.updateSelf(),this.wall.$setDirty()},updateSelf:function(){var t=this.$state,e=t.origin,n=t.target,i=t.translation,r=this.getLine(),o=s.intersectLine.apply(s,Object(pt["a"])(r).concat(Object(pt["a"])(this.previous.getLine())));vt["f"].assign(e,vt["h"].isNull(o)?c.translate.apply(c,Object(pt["a"])(this.corner.point).concat(Object(pt["a"])(i))):o);var a=s.intersectLine.apply(s,Object(pt["a"])(r).concat(Object(pt["a"])(this.next.getLine())));vt["f"].assign(n,vt["h"].isNull(a)?c.translate.apply(c,Object(pt["a"])(this.next.corner.point).concat(Object(pt["a"])(i))):a),this.$setDirty()},emitChange:function(){this.$emit("change")}}},Na),qa={},Qa=function(t,e){vt["h"].Not.String(t)&&vt["c"].Throw.TypeError("Invalid `name`, a string expected."),vt["h"].Not.Function(e.render)&&vt["c"].Throw.TypeError("Invalid `material`, a function expected."),t in qa&&vt["b"].warn('Duplicated material name="'.concat(t,'". The original is replaced.')),qa[t]=e},Za=function(){var t=Object(or["a"])(regeneratorRuntime.mark((function t(e,n){var i,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,fn.Texture.fromURL(n);case 2:i=t.sent,r={texture:i,render:function(t,e){var n=e.drawing,r=n.origin,o=n.scale;t.beginTextureFill({texture:i,matrix:Object(dn["a"])(fn.Matrix,[5/o,0,0,5/o].concat(Object(pt["a"])(r)))})}},Qa(e,r);case 5:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),ts=function(t){return t in qa||vt["b"].warn('material name="'.concat(t,'" is not exist.')),qa[t]},es=function(t){Object(Qe["a"])(n,t);var e=Object(Ze["a"])(n);function n(){return Object(ht["a"])(this,n),e.apply(this,arguments)}return Object(ft["a"])(n,[{key:"area",get:function(){return Yi(this).area}},{key:"bounds",get:function(){return Yi(this).$getBounds()}},{key:"floor",get:function(){return Yi(this).floor}},{key:"setFloor",value:function(t){return Yi(this).setFloor(t)}},{key:"getOuterSurfaceList",value:function(){return Yi(this).getOuterSurfaceList()}}]),n}(y.Proxy.Element),ns=w.Element.define({proxy:y.Proxy.Creator(es),groupIndex:800,interative:!0,focusable:!0,hoverable:!0,render:function(t){if(this.$plugin.$options.room.show){var e,n=this.$state.floor,i=[],r=Object(Te["a"])(this.outerSurface.path());try{for(r.s();!(e=r.n()).done;){var o=e.value;i.push.apply(i,Object(pt["a"])(this.$toCanvas.apply(this,Object(pt["a"])(o.origin))).concat(Object(pt["a"])(this.$toCanvas.apply(this,Object(pt["a"])(o.target)))))}}catch(v){r.e(v)}finally{r.f()}n?ts(n).render(t,{drawing:this.$drawing}):t.beginFill(16777215,.01),t.drawPolygon(i).beginHole();var a,s=Object(Te["a"])(this.innerSurfaceList);try{for(s.s();!(a=s.n()).done;){var c,u=a.value,l=[],h=Object(Te["a"])(u.path());try{for(h.s();!(c=h.n()).done;){var f=c.value,d=f.origin,p=f.target;l.push.apply(l,Object(pt["a"])(this.$toCanvas.apply(this,Object(pt["a"])(d))).concat(Object(pt["a"])(this.$toCanvas.apply(this,Object(pt["a"])(p)))))}}catch(v){h.e(v)}finally{h.f()}t.drawPolygon.apply(t,l)}}catch(v){s.e(v)}finally{s.f()}}},state:function(){return{face:null,floor:null}},created:function(t){this.$data.faceToRoom.set(this.$state.face=t,this)},getters:{outerSurface:function(){return this.toSurface(this.$state.face.outerHalfEdge)},innerSurfaceList:function(){return this.$state.face.innerHalfEdgeList.map(this.toSurface,this)},area:function(){var t,e=this.areaOfSurface(this.outerSurface),n=Object(Te["a"])(this.innerSurfaceList);try{for(n.s();!(t=n.n()).done;){var i=t.value;e-=this.areaOfSurface(i)}}catch(r){n.e(r)}finally{n.f()}return e},floor:function(){return this.$state.floor}},methods:{areaOfSurface:function(t){var e,n=[],i=Object(Te["a"])(t.path());try{for(i.s();!(e=i.n()).done;){var r=e.value,o=r.origin,a=r.target;n.push.apply(n,Object(pt["a"])(o).concat(Object(pt["a"])(a)))}}catch(s){i.e(s)}finally{i.f()}return vt["d"].abs(h.area.apply(h,n))},toSurface:function(t){return this.$data.halfEdgeToSurface.get(t)},setFloor:function(t){this.$state.floor=t,this.$setDirty()},getOuterSurfaceList:function(){var t=this.$data.halfEdgeToSurface,e=this.$state.face;return e.getOuterHalfEdgeList().map((function(e){return t.get(e).$proxy}))}}},Na),is="com.3dnest.spoke.structure",rs="structure",os=k.define({id:is,namespace:rs,version:gr["a"],plugin:Na,elements:{Corner:Ya,Wall:Ga,Surface:Ja,Room:ns}}),as=function(t){Object(Qe["a"])(n,t);var e=Object(Ze["a"])(n);function n(){return Object(ht["a"])(this,n),e.apply(this,arguments)}return Object(ft["a"])(n,[{key:"Builder",get:function(){return Yi(this).$data.builder}},{key:"Mover",get:function(){return Yi(this).$data.mover}},{key:"Spliter",get:function(){return Yi(this).$data.spliter}},{key:"Extender",get:function(){return Yi(this).$data.extender}},{key:"Chamber",get:function(){return Yi(this).$data.chamber}}]),n}(y.Proxy.Plugin),ss=y.Options.define,cs=ss({},{spliter:ss({},{interaction:ss({distance:50})})}),us=w.define({options:cs,proxy:y.Proxy.Creator(as),data:function(){return{builder:null,mover:null,spliter:null,extender:null,chamber:null}},created:function(){vt["f"].assign(this.$data,{builder:this.$createTool("Builder"),mover:this.$createTool("Mover"),spliter:this.$createTool("Spliter"),extender:this.$createTool("Extender"),chamber:this.$createTool("Chamber")})}}),ls=5,hs=65280,fs={left:0,center:.5,right:1},ds=w.Element.define({groupIndex:1200,interative:!0,state:function(){return{from:[0,0],to:[0,0],thickness:200,alignment:"center"}},render:function(t){var e=this.$drawing.scale,n=this.$state,i=n.from,r=n.to,o=n.thickness,a=n.alignment,s=this.$toCanvas.apply(this,Object(pt["a"])(i)),c=Object(ae["a"])(s,2),u=c[0],l=c[1],h=this.$toCanvas.apply(this,Object(pt["a"])(r)),f=Object(ae["a"])(h,2),d=f[0],p=f[1];t.lineStyle(o/e,10066329,1,fs[a]).moveTo(u,l).lineTo(d,p).beginFill(hs).lineStyle(0).drawCircle(d,p,ls).drawCircle(u,l,ls)},created:function(){this.$hide()},methods:{setFrom:function(t,e){var n=this.$state,i=n.from,r=n.to;i[0]=r[0]=t,i[1]=r[1]=e,this.$setDirty()},setTo:function(t,e){this.$state.to[0]=t,this.$state.to[1]=e,this.$setDirty()},setThickness:function(t){this.$state.thickness=t,this.$setDirty()},setAlignment:function(t){this.$state.alignment=t,this.$setDirty()}}},us),ps=Symbol("PickupFrom"),vs=Symbol("PickupTo"),ms=10,gs=function(t,e){return t.distance-e.distance},ys=function(t){return t.corner},bs=function(t,e,n){return n.indexOf(t)===e},xs=function(t,e,n,i,r,a){return o.GT(t,n)===o.LT(t,r)&&o.GT(e,i)===o.LT(e,a)},$s=function(){function t(e){Object(ht["a"])(this,t),this.structure=e}return Object(ft["a"])(t,[{key:"inCollinearContinuousWall",value:function(t,e){var n,i={from:{point:t,distance:1/0,wall:null},to:{point:e,distance:1/0,wall:null}},r=Object(Te["a"])(this.structure.walls());try{for(r.s();!(n=r.n()).done;){var o=n.value,a=o.segment,s=o.thickness,u=s/2;for(var l in i){var h=i[l],f=c.distanceToSegment.apply(c,Object(pt["a"])(h.point).concat(Object(pt["a"])(a)));f<u&&f<h.distance&&xs.apply(void 0,Object(pt["a"])(h.point).concat(Object(pt["a"])(a)))&&(h.distance=f,h.wall=o)}}}catch(d){r.e(d)}finally{r.f()}return!vt["h"].isNull(i.from.wall)&&!vt["h"].isNull(i.to.wall)&&i.from.wall===i.to.wall}},{key:"ensureCorner",value:function(t,e){var n=this.structure.queryCorner(t,e,ms);return n||this.structure.createCorner(t,e)}},{key:"ensureFromAndTo",value:function(t,e){var n,i,r={from:(n=this.structure).queryCorner.apply(n,Object(pt["a"])(t).concat([ms])),to:(i=this.structure).queryCorner.apply(i,Object(pt["a"])(e).concat([ms]))};if(vt["h"].Not.Null(r.from)&&vt["h"].Not.Null(r.to))return r;var o=Object(pt["a"])(s.fromSegment.apply(s,Object(pt["a"])(t).concat(Object(pt["a"])(e)))),a={from:{point:t,distance:1/0,wall:null},to:{point:e,distance:1/0,wall:null}};for(var u in a){var l,h,f=a[u],d=f.point;if(!vt["h"].Not.Null(r[u])){var p,v=Object(Te["a"])(this.structure.walls());try{for(v.s();!(p=v.n()).done;){var m=p.value,g=m.segment,y=s.fromSegment.apply(s,Object(pt["a"])(m.segment)),b=m.thickness/2,x=s.intersectLine.apply(s,Object(pt["a"])(y).concat(Object(pt["a"])(o))),$=vt["h"].Not.Null(x),w=$?c.distanceToPoint.apply(c,Object(pt["a"])(d).concat(Object(pt["a"])(x))):c.distanceToLine.apply(c,Object(pt["a"])(d).concat(Object(pt["a"])(y))),k=$?x:c.project.apply(c,Object(pt["a"])(d).concat(Object(pt["a"])(y)));xs.apply(void 0,Object(pt["a"])(k).concat(Object(pt["a"])(g)))&&w<b&&(vt["f"].assign(d,k),f.distance=w,f.wall=m)}}catch(O){v.e(O)}finally{v.f()}r[u]=vt["h"].isNull(a[u].wall)?(l=this.structure).createCorner.apply(l,Object(pt["a"])(d)):(h=this.structure).split.apply(h,[a[u].wall].concat(Object(pt["a"])(d)))}}return r}},{key:"linkWall",value:function(t,e,n){var i=t.getWallByToCorner(e);if(vt["h"].isNull(i)){var r=this.structure.createWall(t,e);return r.thickness=n,r}return i.thickness=n,i}},{key:"buildWallByCorner",value:function(t,e,n){var i=this,r=[].concat(vt["a"].from(t.walls())).concat(vt["a"].from(e.walls())),o=t.point,a=e.point,u=[].concat(Object(pt["a"])(o),Object(pt["a"])(a)),h=s.fromSegment.apply(s,Object(pt["a"])(u)),f=function(t){var e=t.point,n=c.distanceToLine.apply(c,Object(pt["a"])(e).concat(Object(pt["a"])(h)));return n>1||!xs.apply(void 0,Object(pt["a"])(e).concat(Object(pt["a"])(u)))?null:{distance:c.distanceToPoint.apply(c,Object(pt["a"])(e).concat(Object(pt["a"])(o))),corner:t}},d=function(t){var e,n,r=l.intersectSegment.apply(l,Object(pt["a"])(t.segment).concat(Object(pt["a"])(o),Object(pt["a"])(a)));return vt["h"].isNull(r)?null:{distance:c.distanceToPoint.apply(c,Object(pt["a"])(r).concat(Object(pt["a"])(o))),corner:(e=i.structure).queryCorner.apply(e,Object(pt["a"])(r))||(n=i.structure).split.apply(n,[t].concat(Object(pt["a"])(r)))}},p=vt["a"].from(this.structure.corners()).filter((function(n){return n!==t&&n!==e})).map(f);vt["a"].from(this.structure.walls()).filter((function(t){return!r.includes(t)})).map(d).concat(p).filter(vt["h"].Not.Null).sort(gs).map(ys).concat([e]).filter(bs).reduce((function(t,e){return i.linkWall(t,e,n),e}),t)}}]),t}(),ws=function(t){Object(Qe["a"])(n,t);var e=Object(Ze["a"])(n);function n(){return Object(ht["a"])(this,n),e.apply(this,arguments)}return Object(ft["a"])(n,[{key:"from",get:function(){var t=Yi(this);return t.getCorner.apply(t,Object(pt["a"])(t.$data.from))}},{key:"to",get:function(){var t=Yi(this);return t.getCorner.apply(t,Object(pt["a"])(t.$data.to))}},{key:"setThickness",value:function(t){Yi(this).setThickness(t)}},{key:"setAlignment",value:function(t){Yi(this).setAlignment(t)}}]),n}(y.Proxy.ToolProvider(["build","pick","drop"])),ks=w.Tool.READY,Os=w.Tool.define((Ha={},Object(dt["a"])(Ha,ks,{entry:function(){this.$data.indicator.$hide()},leave:function(){this.$data.indicator.$show()}}),Object(dt["a"])(Ha,ps,(function(){this.setFromByTo()})),Ha),{build:[vs,function(){var t=this.$data,e=t.from,n=t.to,i=t.thickness,r=t.layer,o=r.ensureFromAndTo(e,n);o.from!==o.to&&(vt["f"].assign(e,o.from.point),vt["f"].assign(n,o.to.point),r.buildWallByCorner(o.from,o.to,i),this.setFromByTo(),this.$emit("end"),this.$emit("build"))},ks],pick:[[ks,vt["e"],ps],[ps,vt["e"],vs]],drop:[[vs,vt["e"],ps],[ps,vt["e"],ks],[ks,vt["e"],ks]]},{proxy:y.Proxy.Creator(ws),data:function(t){var e,n=this,i=t.$createElement("Builder"),r=[0,0],o=[0,0],a=(e={},Object(dt["a"])(e,ps,(function(t){vt["f"].assign(r,t),i.setFrom.apply(i,Object(pt["a"])(t))})),Object(dt["a"])(e,vs,(function(t){vt["f"].assign(o,t),i.setTo.apply(i,Object(pt["a"])(t))})),e);return t.$drawing.on("pointermove",(function(e){if(n.$state!==ks){var i=e.virtualX,r=e.virtualY;a[n.$state](t.$toGeometry(i,r))}})),{indicator:i,thickness:200,alignment:"center",from:r,to:o,layer:new $s(t.$drawing.structure)}},reset:function(){this.$data.indicator.$hide(),this.$emit("end")},methods:{setFromByTo:function(){var t=this.$data,e=t.from,n=t.to,i=t.indicator;vt["f"].assign(e,n),i.setFrom.apply(i,Object(pt["a"])(e))},setThickness:function(t){this.$data.thickness=t,this.$data.indicator.setThickness(t)},setAlignment:function(t){this.$data.alignment=t,this.$data.indicator.setAlignment(t)},getCorner:function(t,e){return this.$plugin.$drawing.structure.queryCorner(t,e)}}}),js=0,Ts=1,Es=function(t){return t.corner},Ss=function(t){return t.back.corner},Ls=(Ba={},Object(dt["a"])(Ba,js,vt["f"].freeze({name:js,isBare:function(t){return t.previous===t.back},origin:Es,sibling:function(t){return t.previous},source:Ss,target:Es})),Object(dt["a"])(Ba,Ts,vt["f"].freeze({name:Ts,isBare:function(t){return t.next===t.back},origin:Ss,sibling:function(t){return t.next},source:Es,target:Ss})),Ba),Cs=(n("00b4"),function(t){return a.fromBothPoint.apply(a,Object(pt["a"])(t.corner.point).concat(Object(pt["a"])(t.next.corner.point)))}),Ps=function(t,e){return a.cross.apply(a,Object(pt["a"])(Cs(t)).concat(Object(pt["a"])(Cs(e))))},Fs=function(t,e){return a.dot.apply(a,Object(pt["a"])(Cs(t)).concat(Object(pt["a"])(Cs(e))))},As={test:function(){return!0}},_s=(za={},Object(dt["a"])(za,js,o.LT),Object(dt["a"])(za,Ts,o.GT),za),Rs=function(t){return s.fromSegment.apply(s,Object(pt["a"])(t.corner.point).concat(Object(pt["a"])(t.next.corner.point)))},Ds=function(t){var e=t.current;return Rs(e)},Ns=[{name:"=180",test:function(t){var e=t.current,n=t.surface;return o.EQ_0(Ps(e,n))},Rail:function(t){var e=t.current,n=t.accessor,i=t.destination;return[].concat(Object(pt["a"])(n.source(e).point),Object(pt["a"])(a.fromSegment.apply(a,Object(pt["a"])(i))))},tail:"source"},{name:">180",test:function(t){var e=t.current,n=t.surface,i=t.accessor;return _s[i.name](Ps(e,n),0)},Rail:Ds,tail:"source"},{name:"<180",test:function(t){var e=t.current,n=t.destination,i=e.corner,r=e.next.corner;return c.toLeftOfSegment.apply(c,Object(pt["a"])(i.point).concat(Object(pt["a"])(n)))!==c.toLeftOfSegment.apply(c,Object(pt["a"])(r.point).concat(Object(pt["a"])(n)))},Rail:Ds,tail:"target"},{name:"bare",test:function(t){var e=t.current,n=t.accessor;return n.isBare(e)},Rail:Ds,tail:"target"},As],Ws=function(t){var e,n=Object(Te["a"])(Ns);try{for(n.s();!(e=n.n()).done;){var i=e.value;if(i.test(t))return i}}catch(r){n.e(r)}finally{n.f()}},Ms=function(t,e){var n=a.normalize.apply(a,Object(pt["a"])(Cs(t))),i=a.rotate90.apply(a,Object(pt["a"])(n)),r=a.multiply.apply(a,Object(pt["a"])(i).concat([e]));return r},Is=function(t,e){return l.translate.apply(l,Object(pt["a"])(t.corner.point).concat(Object(pt["a"])(t.next.corner.point),Object(pt["a"])(e)))},Hs=function(t,e,n){t.reset(),t.surface=e;var i=t.translation=Ms(e,n),r=t.destination=Is(e,i),o=t.context;for(var a in t.sides){var c=Ls[a],u=t.sides[a];if(o.accessor=c,u.isBare=c.isBare(e),u.origin=c.origin(e),u.isBare)u.rail=[].concat(Object(pt["a"])(c.target(e).point),Object(pt["a"])(Cs(e)));else{var l=e,h=As,f=!0;do{l=o.current=c.sibling(l),u.path.push(l),f=f&&c.source(l).size<3,f&&t.addWeak(l),o.weak=f,h=Ws(o)}while(h===As);u.rail=h.Rail(o),u.tail=c[h.tail](l).point,"source"===h.tail&&t.deleteWeak(l)}u.point=s.intersectLine.apply(s,Object(pt["a"])(u.rail).concat(Object(pt["a"])(s.fromSegment.apply(s,Object(pt["a"])(r)))))}},Bs=function(t){if(t.destroyed)return!1;if(2!==t.size)return!1;var e=vt["a"].from(t.surfaces());return o.EQ_0(Ps.apply(C,Object(pt["a"])(e)))},zs=function(t,e){var n=t.surface.wall,i=n.thickness;n.remove();var r,o=Object(Te["a"])(t.weaks);try{for(o.s();!(r=o.n()).done;){var a=r.value;a.wall.remove()}}catch(m){o.e(m)}finally{o.f()}var s=[],c=t.sides,u=c[js],l=c[Ts],h=e.ensureFromAndTo(u.point,l.point),f=h.from,d=h.to;if(e.buildWallByCorner(f,d,i),vt["h"].Not.Null(u.tail)){var p=e.ensureFromAndTo(u.point,u.tail);e.buildWallByCorner(p.from,p.to,200),s.push(p.to)}if(vt["h"].Not.Null(l.tail)){var v=e.ensureFromAndTo(l.point,l.tail);e.buildWallByCorner(v.from,v.to,200),s.push(v.to)}s.push(u.origin,l.origin),s.forEach((function(t){Bs(t)&&e.structure.merge(t)}))},Vs=function(){function t(){Object(ht["a"])(this,t),this.path=[],this.origin=null,this.isBare=!1,this.hasTail=!1,this.data={point:[0,0],rail:[0,0,0,0],tail:[0,0]}}return Object(ft["a"])(t,[{key:"reset",value:function(){vt["a"].empty(this.path),this.origin=null,this.isBare=!1,this.hasTail=!1}},{key:"point",get:function(){return this.data.point},set:function(t){vt["f"].assign(this.data.point,t)}},{key:"rail",get:function(){return this.data.rail},set:function(t){vt["f"].assign(this.data.rail,t)}},{key:"tail",get:function(){return this.hasTail?this.data.tail:null},set:function(t){vt["f"].assign(this.data.tail,t),this.hasTail=!0}}]),t}(),Us=function(t){return{get surface(){return t.surface},get destination(){return t.destination},accessor:null,current:null,weak:null}},Ys=function(){function t(){var e;Object(ht["a"])(this,t);var n={surface:null,destination:[0,0,0,0],translation:[0,0]};this.context=Us(n),this.data=n,this.weaks=new Set,this.sides=(e={},Object(dt["a"])(e,js,new Vs),Object(dt["a"])(e,Ts,new Vs),e)}return Object(ft["a"])(t,[{key:"surface",get:function(){return this.data.surface},set:function(t){this.data.surface=t}},{key:"destination",get:function(){return this.data.destination},set:function(t){vt["f"].assign(this.data.destination,t)}},{key:"translation",get:function(){return this.data.translation},set:function(t){vt["f"].assign(this.data.translation,t)}},{key:"addWeak",value:function(t){this.weaks.add(t)}},{key:"deleteWeak",value:function(t){this.weaks.delete(t)}},{key:"isWeak",value:function(t){return this.weaks.has(t)}},{key:"reset",value:function(){for(var t in this.weaks.clear(),this.data.surface=null,this.sides)this.sides[t].reset();var e=this.context;e.side=null,e.weak=null,e.current=null}}]),t}(),Gs=w.Element.define({groupIndex:1220,interative:!0,state:function(){var t=this;return{wall:null,pointer:[0,0],plan:null,updatePointer:function(e){t.setPointer([e.pointerX,e.pointerY])},finish:function(){t.unbind(),t.$emit("finish")},cancel:function(e){2===e.button&&(t.unbind(),t.$emit("cancel"))}}},render:function(t){var e,n,i,r,o,a=this.$state,s=a.wall,u=a.pointer,l=a.plan,h=this.$toGeometry.apply(this,Object(pt["a"])(u)),f=s.thisSurface,d=s.thatSurface,p=c.toLeftOfSegment.apply(c,Object(pt["a"])(h).concat(Object(pt["a"])(f.corner.point),Object(pt["a"])(d.corner.point)))?f:d,v=c.distanceToSegment.apply(c,Object(pt["a"])(h).concat(Object(pt["a"])(p.corner.point),Object(pt["a"])(p.back.corner.point)));for(var m in Hs(l,p,v),(e=(n=t.lineStyle(10,255)).moveTo.apply(n,Object(pt["a"])(this.$toCanvas.apply(this,Object(pt["a"])(p.origin))))).lineTo.apply(e,Object(pt["a"])(this.$toCanvas.apply(this,Object(pt["a"])(p.target)))),l.sides){var g,y,b=l.sides[m],x=b.path,$=b.point,w=Object(Te["a"])(x);try{for(w.s();!(y=w.n()).done;){var k,O,j=y.value;(k=(O=t.lineStyle(10,l.isWeak(j)?16711680:65280)).moveTo.apply(O,Object(pt["a"])(this.$toCanvas.apply(this,Object(pt["a"])(j.origin))))).lineTo.apply(k,Object(pt["a"])(this.$toCanvas.apply(this,Object(pt["a"])(j.target))))}}catch(P){w.e(P)}finally{w.f()}(g=t.lineStyle(5,65280)).drawCircle.apply(g,Object(pt["a"])(this.$toCanvas.apply(this,Object(pt["a"])($))).concat([5]))}var T=Object(ae["a"])(l.destination,4),E=T[0],S=T[1],L=T[2],C=T[3];(i=(r=t.lineStyle(3)).moveTo.apply(r,Object(pt["a"])(this.$toCanvas(E,S)))).lineTo.apply(i,Object(pt["a"])(this.$toCanvas(L,C))),(o=t.beginFill(0)).drawCircle.apply(o,Object(pt["a"])(this.$state.pointer).concat([5]))},created:function(){this.$hide(),this.$state.plan=new Ys},methods:{bind:function(){var t=this.$state,e=t.updatePointer,n=t.finish,i=t.cancel;this.$drawing.on("pointermove",e),ln["a"].addEventListener(ln["c"].WINDOW,"mouseup",n),ln["a"].addEventListener(ln["c"].WINDOW,"mousedown",i),this.$show()},unbind:function(){var t=this.$state,e=t.updatePointer,n=t.finish,i=t.cancel;this.$drawing.off("pointermove",e),ln["a"].removeEventListener(ln["c"].WINDOW,"mouseup",n),ln["a"].removeEventListener(ln["c"].WINDOW,"mousedown",i),this.$hide()},setPointer:function(t){vt["f"].assign(this.$state.pointer,t),this.$setDirty()},setWall:function(t){this.$state.wall=t,this.$setDirty()},reset:function(){this.$state.wall=null,this.$hide()}}}),Xs=Symbol("ExtenderWaiting"),Ks=Symbol("ExtenderActive"),Js=w.Tool.READY,qs=w.Tool.define((Va={},Object(dt["a"])(Va,Ks,(function(){this.$data.indicator.bind()})),Object(dt["a"])(Va,Xs,(function(){this.$data.indicator.unbind(),this.$data.wall=null})),Va),{open:[[Xs,vt["e"],Xs],[Js,vt["e"],Xs]],close:[[Js,vt["e"],Js],[Xs,vt["e"],Js]],capture:[Xs,function(){var t=this.$data,e=t.indicator,n=t.wall;e.setWall(n)},Ks],release:[Ks,vt["e"],Xs],extend:[Ks,function(){var t=this.$data,e=t.indicator,n=t.layer,i=e.$state.plan;zs(i,n)},Xs]},{data:function(t){var e=this,n=t.$createElement("Extender");return n.$on("cancel",(function(){return e.release()})).$on("finish",(function(){return e.extend()})),t.$drawing.structure.on("wall-created",(function(t){t.on("pointerdown",(function(i){e.$state===Xs&&(i.stopPropagation(),n.setPointer([i.pointerX,i.pointerY]),e.setWall(t),e.capture())}))})),{indicator:n,wall:null,layer:new $s(t.$drawing.structure)}},methods:{setWall:function(t){this.$data.wall=t,this.$data.indicator.setWall(t)}}}),Qs=w.Element.define({groupIndex:1150,interative:!0,state:function(){var t=this;return{origin:[0,0],current:[0,0],adjacentList:[],updateCurrent:function(e){t.setCurrent([e.virtualX,e.virtualY])},finish:function(){t.unbind(),t.$emit("finish")},cancel:function(e){2===e.button&&(t.unbind(),t.$emit("cancel"))}}},getters:{active:function(){return this.$visible}},created:function(){this.$hide()},render:function(t){var e,n=this.$state,i=n.adjacentList,r=n.current,o=this.$drawing.structure.options.corner.style.radius;(e=t.beginFill(0)).drawCircle.apply(e,Object(pt["a"])(r).concat([o])).lineStyle(2,0);var a,s=Object(Te["a"])(i);try{for(s.s();!(a=s.n()).done;){var c,u,l,h=a.value,f=this.$toCanvas.apply(this,Object(pt["a"])(h));(c=(u=(l=t.beginFill(16777215)).drawCircle.apply(l,Object(pt["a"])(f).concat([o]))).moveTo.apply(u,Object(pt["a"])(f))).lineTo.apply(c,Object(pt["a"])(r))}}catch(d){s.e(d)}finally{s.f()}},methods:{bind:function(){var t=this.$state,e=t.updateCurrent,n=t.cancel,i=t.finish;this.$drawing.on("pointermove",e),ln["a"].addEventListener(ln["c"].WINDOW,"mouseup",i),ln["a"].addEventListener(ln["c"].WINDOW,"mousedown",n),this.$show()},unbind:function(){var t=this.$state,e=t.updateCurrent,n=t.cancel,i=t.finish;this.$drawing.off("pointermove",e),ln["a"].removeEventListener(ln["c"].WINDOW,"mouseup",i),ln["a"].removeEventListener(ln["c"].WINDOW,"mousedown",n),this.$hide()},setCurrent:function(t){vt["f"].assign(this.$state.current,t),this.$setDirty()},setOrigin:function(t){vt["f"].assign(this.$state.origin,t),this.setCurrent(this.$toCanvas.apply(this,Object(pt["a"])(t)))},setSiblingList:function(t){this.$state.adjacentList=t,this.$setDirty()}}},us),Zs=Symbol("MoverWaiting"),tc=Symbol("MoverActive"),ec=w.Tool.READY,nc=["open","close"],ic=function(t){return vt["c"].instanceOf(t,yr)},rc=function(t){Object(Qe["a"])(n,t);var e=Object(Ze["a"])(n);function n(){return Object(ht["a"])(this,n),e.apply(this,arguments)}return Object(ft["a"])(n,[{key:"setCorner",value:function(t){ic(t)&&vt["c"].Throw.TypeError("Invalid corner, a Strucure.CornerProxy expected."),Yi(this).setCorner(t)}}]),n}(y.Proxy.ToolProvider(nc)),oc=w.Tool.define((Ua={},Object(dt["a"])(Ua,tc,(function(){this.$data.indicator.bind()})),Object(dt["a"])(Ua,Zs,(function(){this.$data.indicator.unbind(),this.$data.corner=null})),Ua),{open:[[ec,vt["e"],Zs],[Zs,vt["e"],Zs]],close:[[Zs,vt["e"],ec],[ec,vt["e"],ec]],capture:[Zs,function(){this.setCorner(this.$data.corner)},tc],release:[tc,vt["e"],Zs],move:[tc,function(){var t,e=this.$data,n=e.indicator,i=e.corner,r=e.layer,o=(t=this.$plugin).$toGeometry.apply(t,Object(pt["a"])(n.$state.current)),a=r.ensureFromAndTo(i.point,o);if(a.from!==a.to){var s=vt["a"].from(i.surfaces()).map((function(t){return[t.back.corner,t.wall.thickness]}));i.remove();var c,u=Object(Te["a"])(s);try{for(u.s();!(c=u.n()).done;){var l=Object(ae["a"])(c.value,2),h=l[0],f=l[1];h!==a.to&&r.buildWallByCorner(a.to,h,f)}}catch(d){u.e(d)}finally{u.f()}}},Zs]},{proxy:y.Proxy.Creator(rc),data:function(t){var e=this,n=t.$createElement("Mover");return n.$on("cancel",(function(){return e.release()})).$on("finish",(function(){return e.move()})),t.$drawing.structure.on("corner-created",(function(t){t.on("pointerdown",(function(n){e.$state===Zs&&(n.stopPropagation(),e.setCorner(t),e.capture())}))})),{corner:null,indicator:n,layer:new $s(t.$drawing.structure)}},reset:function(){this.$data.indicator.$hide(),this.$data.corner=null},methods:{setCorner:function(t){var e=this.$data.indicator,n=t.getAdjacentCornerList().map(ac);this.$data.corner=t,e.setOrigin(ac(t)),e.setSiblingList(n)}}}),ac=function(t){return[t.x,t.y]},sc=w.Element.define({groupIndex:1210,state:function(){return{breakpoint:[0,0],segment:[0,0,0,0]}},render:function(t){var e,n,i,r=this.$state,o=r.segment,s=r.breakpoint,u=Object(ae["a"])(o,4),l=u[0],h=u[1],f=u[2],d=u[3],p=a.rotate90.apply(a,Object(pt["a"])(a.normalize.apply(a,Object(pt["a"])(a.fromSegment.apply(a,Object(pt["a"])(o)))))),v=a.multiply.apply(a,Object(pt["a"])(p).concat([30]));(e=(n=(i=t.lineStyle(1,0)).moveTo.apply(i,Object(pt["a"])(c.translate.apply(c,Object(pt["a"])(s).concat(Object(pt["a"])(v)))))).lineTo.apply(n,Object(pt["a"])(c.translate.apply(c,Object(pt["a"])(s).concat(Object(pt["a"])(a.invert.apply(a,Object(pt["a"])(v))))))).moveTo(l,h).lineTo(f,d).beginFill(65280)).drawCircle.apply(e,Object(pt["a"])(s).concat([5]))},created:function(){this.$hide()},methods:{setBreakpoint:function(t){vt["f"].assign(this.$state.breakpoint,t),this.$setDirty()},setSegment:function(t){vt["f"].assign(this.$state.segment,t),this.$setDirty()}}},us),cc=Symbol("SpliterDetecting"),uc=Symbol("SpliterDetected"),lc=w.Tool.READY,hc=function(t){Object(Qe["a"])(n,t);var e=Object(Ze["a"])(n);function n(){return Object(ht["a"])(this,n),e.apply(this,arguments)}return Object(ft["a"])(n)}(y.Proxy.ToolProvider(["open","close"])),fc=w.Tool.define(Object(dt["a"])({},uc,{entry:function(){this.$data.indicator.$show()},leave:function(){this.$data.indicator.$hide()}}),{open:[lc,vt["e"],cc],found:[[cc,vt["e"],uc],[uc,vt["e"],uc]],lost:[[uc,vt["e"],cc],[cc,vt["e"],cc]],close:[[lc,vt["e"],lc],[cc,vt["e"],lc],[uc,vt["e"],lc]]},{proxy:y.Proxy.Creator(hc),data:function(t){var e=this,n=t.$createElement("Spliter"),i={indicator:n,target:null,breakpoint:[0,0]},r=t.$drawing,o=r.structure;return r.on("pointermove",(function(t){e.$state!==lc&&(e.findWall(t.pointerX,t.pointerY)?e.found():e.lost())})).on("pointerup",(function(t){0===t.button&&e.$state===uc&&o.split.apply(o,[i.target].concat(Object(pt["a"])(i.breakpoint)))})),i},methods:{findWall:function(t,e){var n,i=this.$data,o=i.indicator,a=i.breakpoint,u=this.$plugin,l=u.$drawing.structure,h=u.$options.spliter.interaction.distance,f=Object(Te["a"])(l.getAllWallList());try{for(f.s();!(n=f.n()).done;){var d=n.value,p=r.Segment.apply(r,Object(pt["a"])(u.$toCanvas.apply(u,Object(pt["a"])(d.thisSurface.corner.point))).concat(Object(pt["a"])(u.$toCanvas.apply(u,Object(pt["a"])(d.thatSurface.corner.point))))),v=c.distanceToSegment.apply(c,[t,e].concat(Object(pt["a"])(p)));if(v<h){var m=c.project.apply(c,[t,e].concat(Object(pt["a"])(s.fromSegment.apply(s,Object(pt["a"])(p)))));if(xs.apply(void 0,Object(pt["a"])(m).concat(Object(pt["a"])(p)))){var g=u.$toGeometry.apply(u,Object(pt["a"])(m));return vt["f"].assign(a,g),o.setBreakpoint(m),o.setSegment(p),this.$data.target=d,!0}}}}catch(y){f.e(y)}finally{f.f()}return!1}},reset:function(){this.close()}}),dc=w.Element.define({groupIndex:1160,interative:!0,state:function(){return{from:[0,0],to:[0,0]}},created:function(){this.$hide()},render:function(t){var e=this.$state,n=e.from,i=e.to,r=this.$toCanvas.apply(this,Object(pt["a"])(n)),o=Object(ae["a"])(r,2),a=o[0],s=o[1],c=this.$toCanvas.apply(this,Object(pt["a"])(i)),u=Object(ae["a"])(c,2),l=u[0],h=u[1];t.lineStyle(2,0).moveTo(a,s).lineTo(a,h).lineTo(l,h).lineTo(l,s).closePath().beginFill(16711680).drawCircle(l,h,5).beginFill(65280).drawCircle(a,s,5)},methods:{setFrom:function(t,e){var n=this.$state,i=n.from,r=n.to;i[0]=r[0]=t,i[1]=r[1]=e,this.$setDirty()},setTo:function(t,e){this.$state.to[0]=t,this.$state.to[1]=e,this.$setDirty()}}},us),pc=Symbol("PickupFrom"),vc=Symbol("PickupTo"),mc=w.Tool.READY,gc=function(t){Object(Qe["a"])(n,t);var e=Object(Ze["a"])(n);function n(){return Object(ht["a"])(this,n),e.apply(this,arguments)}return Object(ft["a"])(n,[{key:"setThickness",value:function(t){Yi(this).setThickness(t)}},{key:"setAlignment",value:function(){}}]),n}(y.Proxy.ToolProvider(["build","pick","drop"])),yc=w.Tool.define(Object(dt["a"])({},mc,{entry:function(){this.$data.indicator.$hide()},leave:function(){this.$data.indicator.$show()}}),{pick:[[mc,vt["e"],pc],[pc,vt["e"],vc]],drop:[[vc,vt["e"],pc],[pc,vt["e"],mc],[mc,vt["e"],mc]],build:[[vc,function(){var t=this.$data,e=t.indicator,n=t.thickness,i=Object(ae["a"])(t.from,2),r=i[0],a=i[1],s=Object(ae["a"])(t.to,2),c=s[0],u=s[1],l=t.layer;e.setFrom.apply(e,Object(pt["a"])(e.$state.to)),o.EQ(r,c)||o.EQ(a,u)||[[r,a],[c,a],[c,u],[r,u]].forEach((function(t,e,i){var r=i[(e+1)%4],o=l.ensureFromAndTo(t,r);l.buildWallByCorner(o.from,o.to,n)}))},mc]]},{proxy:y.Proxy.Creator(gc),data:function(t){var e,n=this,i=t.$createElement("Chamber"),r=[0,0],o=[0,0],a=(e={},Object(dt["a"])(e,pc,(function(t,e){r[0]=t,r[1]=e,i.setFrom(t,e)})),Object(dt["a"])(e,vc,(function(t,e){o[0]=t,o[1]=e,i.setTo(t,e)})),e);return t.$drawing.on("pointermove",(function(e){if(n.$state!==mc){var i=e.virtualX,r=e.virtualY;a[n.$state].apply(a,Object(pt["a"])(t.$toGeometry(i,r)))}})),{indicator:i,thickness:200,from:r,to:o,layer:new $s(t.$drawing.structure)}},methods:{setThickness:function(t){this.$data.thickness=t}}}),bc=k.define({id:"com.3dnest.spoke.bricklayer",namespace:"bricklayer",version:mr["a"],plugin:us,elements:{Builder:L.Indicator,Spliter:D.Indicator,Mover:_.Indicator,Extender:F.Indicator,Chamber:W.Indicator},tools:{Builder:L.Tool,Mover:_.Tool,Spliter:D.Tool,Extender:F.Tool,Chamber:W.Tool}}),xc=function(t){return t.$proxy},$c=function(t){Object(Qe["a"])(n,t);var e=Object(Ze["a"])(n);function n(){return Object(ht["a"])(this,n),e.apply(this,arguments)}return Object(ft["a"])(n,[{key:"createBitmap",value:function(t,e,n){return Yi(this).createBitmap(t,e,n)}},{key:"getAllBitmapList",value:function(){return Yi(this).$getElementList("Bitmap").map(xc)}},{key:"bitmaps",value:regeneratorRuntime.mark((function t(){var e,n,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=Object(Te["a"])(Yi(this).bitmaps()),t.prev=1,e.s();case 3:if((n=e.n()).done){t.next=9;break}return i=n.value,t.next=7,i.$proxy;case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](1),e.e(t.t0);case 14:return t.prev=14,e.f(),t.finish(14);case 17:case"end":return t.stop()}}),t,this,[[1,11,14,17]])}))}]),n}(y.Proxy.Plugin),wc=w.define({proxy:y.Proxy.Creator($c),created:function(){var t=this;this.$on("element-created",(function(e,n){t.$emit("".concat(n.toLowerCase(),"-created"),e)}))},methods:{createBitmap:function(t,e,n){var i=this;return Object(or["a"])(regeneratorRuntime.mark((function r(){var o,a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,fn.Texture.fromURL(t);case 2:return o=r.sent,a=i.$drawing.scale,r.abrupt("return",i.$createElement("Bitmap",o,e||o.width*a,n||o.height*a).$proxy);case 5:case"end":return r.stop()}}),r)})))()},bitmaps:regeneratorRuntime.mark((function t(){var e,n,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=Object(Te["a"])(this.$elements("Bitmap")),t.prev=1,e.s();case 3:if((n=e.n()).done){t.next=9;break}return i=n.value,t.next=7,i;case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](1),e.e(t.t0);case 14:return t.prev=14,e.f(),t.finish(14);case 17:case"end":return t.stop()}}),t,this,[[1,11,14,17]])}))}}),kc=function(t){Object(Qe["a"])(n,t);var e=Object(Ze["a"])(n);function n(){return Object(ht["a"])(this,n),e.apply(this,arguments)}return Object(ft["a"])(n,[{key:"url",get:function(){return Yi(this).url}},{key:"width",get:function(){return Yi(this).width}},{key:"height",get:function(){return Yi(this).height}},{key:"rotation",get:function(){return Yi(this).rotation}},{key:"x",get:function(){return Yi(this).x}},{key:"y",get:function(){return Yi(this).y}},{key:"alpha",get:function(){return Yi(this).alpha}},{key:"setWidth",value:function(t){Yi(this).setWidth(t)}},{key:"setHeight",value:function(t){Yi(this).setHeight(t)}},{key:"setRotation",value:function(t){Yi(this).setRotation(t)}},{key:"setPosition",value:function(t,e){Yi(this).setPosition(t,e)}},{key:"setAlpha",value:function(t){Yi(this).setAlpha(t)}},{key:"remove",value:function(){Yi(this).remove()}}]),n}(y.Proxy.Element),Oc=fn,jc=w.Element.define({proxy:y.Proxy.Creator(kc),groupIndex:-100,interative:!0,focusable:!0,draggable:!0,state:function(){return{texture:null,width:0,height:0,x:0,y:0,rotation:0,alpha:1,rendering:!1}},getters:{url:function(){return this.$state.texture.baseTexture.cacheId},width:function(){return this.$state.width},height:function(){return this.$state.height},rotation:function(){return this.$state.rotation},x:function(){return this.$state.x},y:function(){return this.$state.y},alpha:function(){return this.$state.alpha}},created:function(t,e,n){this.setTexture(t),this.setWidth(e),this.setHeight(n)},destroy:function(){},render:function(t){var e=this.$state,n=e.texture,i=e.width,r=e.height,o=e.x,a=e.y,s=e.rotation,c=e.alpha,u=e.rendering,l=this.$drawing.scale,h=i/l,f=r/l,d=h>0?h:n.width,p=f>0?f:n.height;t.pivot.x=h/2,t.pivot.y=f/2,t.beginTextureFill({texture:n,alpha:c,matrix:new Oc.Matrix(d/n.width,0,0,p/n.height,0,0)}).drawRect(0,0,d,p);var v=this.$toCanvas(o,a),m=Object(ae["a"])(v,2);t.x=m[0],t.y=m[1],t.rotation=s,u&&(this.$emit("change",this.$proxy),this.setRendering(!1))},methods:{setTexture:function(t){this.$state.texture=t,this.$setDirty()},setWidth:function(t){this.$state.width=t,this.$setDirty(),this.setRendering(!0)},setHeight:function(t){this.$state.height=t,this.$setDirty(),this.setRendering(!0)},setRotation:function(t){this.$state.rotation=t,this.$setDirty(),this.setRendering(!0)},setPosition:function(t,e){this.$state.x=t,this.$state.y=e,this.$setDirty(),this.setRendering(!0)},setAlpha:function(t){this.$state.alpha=t,this.$setDirty()},setRendering:function(t){this.$state.rendering=t},remove:function(){this.$destroy()}}},wc),Tc=n("3d1c"),Ec=k.define({id:"com.3dnest.spoke.negative",namespace:"negative",version:Tc["a"],plugin:wc,elements:{Bitmap:jc}}),Sc=n("2c55"),Lc=w.define({proxy:function(){var t=this;return{setPosition:function(e,n){t.setPosition(e,n)},setRotation:function(e){t.setRotation(e)},get rotation(){return t.$data.compass.rotation},get element(){return t.$data.compass.$proxy}}},data:function(){return{compass:null}},created:function(){this.$data.compass=this.$createElement("Element")},methods:{setPosition:function(t,e){this.$data.compass.setPosition(t,e)},setRotation:function(t){this.$data.compass.setRotation(t)}}}),Cc=function(t){Object(Qe["a"])(n,t);var e=Object(Ze["a"])(n);function n(){return Object(ht["a"])(this,n),e.apply(this,arguments)}return Object(ft["a"])(n,[{key:"x",get:function(){return Yi(this).x}},{key:"y",get:function(){return Yi(this).y}},{key:"rotation",get:function(){return Yi(this).rotation}},{key:"resetPosition",value:function(){Yi(this).resetPosition()}},{key:"setPosition",value:function(t,e){Yi(this).setPosition(t,e)}},{key:"setRotation",value:function(t){Yi(this).setRotation(t)}},{key:"setCompassColor",value:function(t){Yi(this).setCompassColor(t)}},{key:"setNorthPointColor",value:function(t){Yi(this).setNorthPointColor(t)}},{key:"setSouthPointColor",value:function(t){Yi(this).setSouthPointColor(t)}}]),n}(y.Proxy.Element),Pc=w.Element.define({proxy:y.Proxy.Creator(Cc),groupIndex:3e3,interative:!0,state:function(){return{x:50,y:50,rotation:0,compassColor:16777215,northPointColor:14423100,southPointColor:4098301,rendering:!1}},getters:{x:function(){return this.$state.x},y:function(){return this.$state.y},rotation:function(){return this.$state.rotation}},created:function(){var t=new fn.Text,e=new fn.Text;t.text="N",t.style.fontSize=12,t.transform.position.x=-4,t.transform.position.y=-34,e.text="S",e.style.fontSize=12,e.transform.position.x=-4,e.transform.position.y=19,this.$graphics.addChild(t),this.$graphics.addChild(e),window.p=this},render:function(t){var e,n,i,r,o,a,s,c,u,l,h=this.$state,f=h.x,d=h.y,p=h.rotation,v=h.compassColor,m=h.northPointColor,g=h.southPointColor,y=h.rendering,b=[0,0],x=[0,-20],$=[-6,0],w=[6,0],k=[0,20],O=(e=(n=(i=(r=(o=(a=(s=(c=(u=(l=t.beginFill(v)).moveTo.apply(l,b).lineStyle(0).drawCircle(0,0,35).beginFill(m)).moveTo.apply(u,b)).lineTo.apply(c,$)).lineTo.apply(s,x)).lineTo.apply(a,w)).lineTo.apply(o,b).beginFill(g)).lineTo.apply(r,$)).lineTo.apply(i,k)).lineTo.apply(n,w)).lineTo.apply(e,b).endFill().lineStyle(1,9082010).moveTo(0,-35).lineTo(0,-32).moveTo(0,35).lineTo(0,32).moveTo(-35,0).lineTo(-28,0).moveTo(35,0).lineTo(28,0);O.x=f,O.y=d,O.rotation=p,y&&(this.$emit("change",this.$proxy),this.setRendering(!1))},methods:{resetPosition:function(){this.$state.x=50,this.$state.y=50,this.$setDirty()},setPosition:function(t,e){this.$state.x=t,this.$state.y=e,this.$setDirty()},setRotation:function(t){this.$state.rotation=t,this.$setDirty(),this.setRendering(!0)},setCompassColor:function(t){this.$state.compassColor=t,this.$setDirty()},setNorthPointColor:function(t){this.$state.northPointColor=t,this.$setDirty()},setSouthPointColor:function(t){this.$state.southPointColor=t,this.$setDirty()},setRendering:function(t){this.$state.rendering=t}}}),Fc=k.define({id:"com.3dnest.spoke.compass",namespace:"compass",version:Sc["a"],plugin:Lc,elements:{Element:Pc}}),Ac=n("2bbc"),_c=function(t){Object(Qe["a"])(n,t);var e=Object(Ze["a"])(n);function n(){return Object(ht["a"])(this,n),e.apply(this,arguments)}return Object(ft["a"])(n,[{key:"transformer",get:function(){return Yi(this).transformer}},{key:"selector",get:function(){return Yi(this).selector}},{key:"addTransformerAdapter",value:function(t,e){return Yi(this).addTransformerAdapter(t,e)}},{key:"addSelectorAdapter",value:function(t,e){return Yi(this).addSelectorAdapter(t,e)}},{key:"transformerAction",value:function(t){return Yi(this).transformerAction(t)}},{key:"selectorAction",value:function(t,e){return Yi(this).selectorAction(t,e)}},{key:"getSelectedList",value:function(){return Yi(this).getSelectedList()}},{key:"remove",value:function(){return Yi(this).remove()}}]),n}(y.Proxy.Plugin),Rc=w.define({proxy:y.Proxy.Creator(_c),data:function(){return{transformer:null,selector:null,transformerAdapter:new Map,selectorAdapter:new Map}},created:function(){this.$data.transformer=this.$createTool("Transformer"),this.$data.selector=this.$createTool("Selector")},getters:{transformer:function(){return this.$data.transformer},selector:function(){return this.$data.selector}},methods:{addTransformerAdapter:function(t,e){this.$data.transformerAdapter.set(t,e)},addSelectorAdapter:function(t,e){this.$data.selectorAdapter.set(t,e)},transformerAction:function(t){var e=t?this.$data.transformerAdapter.get(t.constructor):null;e?this.$data.transformer.pick():this.$data.transformer.drop()},selectorAction:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.$data.selector,i=t?this.$data.selectorAdapter.get(t.constructor):null;i?(n.setElement(t),e?n.pick_multiple():n.pick_single()):n.drop()},getSelectedList:function(){return this.$data.selector.getElements()},remove:function(){var t=this,e=this.$data.selector.getElements();e.forEach((function(e){t.$data.selectorAdapter.get(e.constructor).remove(e)}))}}}),Dc=function(t,e,n,i,r,o){return c.project.apply(c,[r,o].concat(Object(pt["a"])(s.fromSegment(t,e,n,i))))},Nc=function(t,e,n,i,r,o){var s=Dc(t,e,n,i,r,o);return a.length.apply(a,Object(pt["a"])(a.fromBothPoint.apply(a,[t,e].concat(Object(pt["a"])(s)))))},Wc=function(t,e,n,i,r){var o=a.normalize.apply(a,Object(pt["a"])(a.fromBothPoint(t,e,n,i))),s=Object(ae["a"])(o,2),u=s[0],l=s[1],h=c.translate.apply(c,[t,e].concat(Object(pt["a"])(a.multiply(u,l,r)))),f=Object(ae["a"])(h,2),d=f[0],p=f[1];return[d,p]},Mc=w.Element.define({groupIndex:1300,interative:!0,state:function(){return{xStatus:0,yStatus:0,active:!1,x:0,y:0,width:0,height:0,rotation:0}},created:function(t,e){var n=this;this.$state.xStatus=t,this.$state.yStatus=e,this.$on("pointerdown",(function(t){t.stopPropagation(),n.beginAdjust()}))},render:function(t){if(this.$state.active){var e=this.$state,n=e.xStatus,i=e.yStatus,r=e.x,o=e.y,a=e.width,s=e.height,c=e.rotation,u=this.$drawing.scale;t.lineStyle(1,4096759).beginFill(16777215).drawRect(-5,-5,10,10),t.pivot.x=-n*a/2/u,t.pivot.y=i*s/2/u;var l=this.$toCanvas(r,o),h=Object(ae["a"])(l,2);t.x=h[0],t.y=h[1],t.rotation=c}},methods:{show:function(){this.$state.active=!0,this.$setDirty()},hide:function(){this.$state.active=!1,this.$setDirty()},setPosition:function(t,e){this.$state.x=t,this.$state.y=e,this.$setDirty()},setWidth:function(t){this.$state.width=t,this.$setDirty()},setHeight:function(t){this.$state.height=t,this.$setDirty()},setRotation:function(t){this.$state.rotation=t,this.$setDirty()},updateState:function(t,e,n,i,r){this.setPosition(t,e),this.setWidth(n),this.setHeight(i),this.setRotation(r)},beginAdjust:function(){var t=this,e=this.$data.transformer.getElement(),n=this.$data.transformerAdapter.get(e.constructor),i=function(i){var r=t.$state,o=r.xStatus,a=r.yStatus,s=r.x,u=r.y,l=r.width,h=r.height,f=r.rotation,d=t.$toGeometry(i.pointerX,i.pointerY),p=s+o*l/2,v=u+a*h/2,m=c.rotate(p,v,-f,s,u),g=Object(ae["a"])(m,2),y=g[0],b=g[1],x=Nc(s,u,y,b,y,b),$=Nc.apply(void 0,[s,u,y,b].concat(Object(pt["a"])(d))),w=c.rotate.apply(c,Object(pt["a"])(Wc(s,u,y,b,$)).concat([f,s,u])),k=Object(ae["a"])(w,2),O=k[0],j=k[1],T=o*(O-p),E=a*(j-v),S=l+T,L=h+E,C=Wc(s,u,y,b,($-x)/2),P=Object(ae["a"])(C,2),F=P[0],A=P[1];t.setWidth(S),t.setHeight(L),n.setWidth(e,S),n.setHeight(e,L),n.setPosition(e,F,A),t.$emit("update",{x:F,y:A,width:S,height:L,rotation:f})},r=function e(){t.$drawing.off("pointermove",i),window.removeEventListener("mouseup",e)};this.$drawing.on("pointermove",i),window.addEventListener("mouseup",r)}}},Rc),Ic=30,Hc=w.Element.define({groupIndex:1300,interative:!0,state:function(){return{active:!1,x:0,y:0,width:0,height:0,rotation:0}},created:function(){var t=this;this.$on("pointerdown",(function(e){e.stopPropagation(),t.beginAdjust()}))},render:function(t){if(this.$state.active){var e=this.$state,n=e.x,i=e.y,r=e.height,o=e.rotation,a=this.$drawing.scale;t.lineStyle(1,4096759).beginFill(16777215).drawCircle(0,0,5).moveTo(0,5).lineTo(0,Ic-5),t.pivot.x=0,t.pivot.y=r/a/2+Ic;var s=this.$toCanvas(n,i),c=Object(ae["a"])(s,2);t.x=c[0],t.y=c[1],t.rotation=o}},methods:{show:function(){this.$state.active=!0,this.$setDirty()},hide:function(){this.$state.active=!1,this.$setDirty()},setPosition:function(t,e){this.$state.x=t,this.$state.y=e,this.$setDirty()},setWidth:function(t){this.$state.width=t,this.$setDirty()},setHeight:function(t){this.$state.height=t,this.$setDirty()},setRotation:function(t){this.$state.rotation=t,this.$setDirty()},updateState:function(t,e,n,i,r){this.setPosition(t,e),this.setWidth(n),this.setHeight(i),this.setRotation(r)},beginAdjust:function(){var t=this,e=this.$data.transformer.getElement(),n=this.$data.transformerAdapter.get(e.constructor),i=function(i){var r=t.$state,o=r.x,s=r.y,c=r.width,u=r.height,l=t.$toGeometry(i.pointerX,i.pointerY),h=Math.atan2.apply(Math,Object(pt["a"])(a.fromBothPoint.apply(a,[o,s].concat(Object(pt["a"])(l)))));t.setRotation(h),n.setRotation(e,h),t.$emit("update",{x:o,y:s,width:c,height:u,rotation:h})},r=function e(){t.$drawing.off("pointermove",i),window.removeEventListener("mouseup",e)};this.$drawing.on("pointermove",i),window.addEventListener("mouseup",r)}}},Rc),Bc=w.Element.define({groupIndex:1200,interative:!0,state:function(){return{active:!1,x:0,y:0,width:0,height:0,rotation:0,isCreating:!1}},created:function(){var t=this;this.$on("pointerdown",(function(e){e.stopPropagation(),t.elementAdjust(e)}))},render:function(t){if(this.$state.active){var e=this.$state,n=e.x,i=e.y,r=e.width,o=e.height,a=e.rotation,s=this.$drawing.scale,c=r/s,u=o/s;t.lineStyle(1,16711680).beginFill(4096759,.01).drawRect(-c/2,-u/2,c,u).endFill(),t.pivot.x=0,t.pivot.y=0;var l=this.$toCanvas(n,i),h=Object(ae["a"])(l,2);t.x=h[0],t.y=h[1],t.rotation=a}},methods:{show:function(){this.$state.active=!0,this.$setDirty()},hide:function(){this.$state.active=!1,this.$setDirty()},setPosition:function(t,e){this.$state.x=t,this.$state.y=e,this.$setDirty()},setWidth:function(t){this.$state.width=t,this.$setDirty()},setHeight:function(t){this.$state.height=t,this.$setDirty()},setRotation:function(t){this.$state.rotation=t,this.$setDirty()},setCreating:function(t){this.$state.isCreating=t,this.$setDirty()},updateState:function(t,e,n,i,r){this.setPosition(t,e),this.setWidth(n),this.setHeight(i),this.setRotation(r)},elementAdjust:function(t){var e=this,n=this.$drawing,i=this.$data.transformer.getElement(),r=this.$data.transformerAdapter.get(i.constructor),o=this.$state,a=o.width,s=o.height,c=o.rotation,u=o.isCreating,l=r.getPosition(i),h=Object(ae["a"])(l,2),f=h[0],d=h[1],p=t?this.$toGeometry(t.pointerX,t.pointerY):[f,d],v=p[0]-f,m=p[1]-d,g=r.adjustVerify,y=function(t){var n=e.$toGeometry(t.pointerX,t.pointerY),o=n[0]-v,u=n[1]-m,l=e.$drawing.structure.getRoomByPoint(o,u);if(e.setPosition(o,u),g){var h=g(i,e);if(vt["h"].isArray(h))return r.setPosition.apply(r,[i].concat(Object(pt["a"])(h))),void e.$emit("update",{x:h[0],y:h[1],width:a,height:s,rotation:c});if(!h)return}r.setRoom&&r.setRoom(i,l),r.setPosition(i,o,u),e.$emit("update",{x:o,y:u,width:a,height:s,rotation:c})},b=function(){n.off("pointermove",y),window.removeEventListener("mouseup",x),window.removeEventListener("keydown",$),u&&(e.setCreating(!1),e.hide())},x=function(){var t=e.$data.element;t&&e.setPosition.apply(e,Object(pt["a"])(r.getPosition(t))),b()},$=function(t){"Escape"===t.code&&u&&(i.remove(),b())};n.on("pointermove",y),window.addEventListener("mouseup",x),window.addEventListener("keydown",$)}}},Rc),zc=w.Element.define({groupIndex:1250,state:function(){return{active:!1,x:0,y:0,width:0,height:0,rotation:0}},render:function(t){if(this.$state.active){var e=this.$state,n=e.x,i=e.y,r=e.width,o=e.height,a=e.rotation,s=this.$drawing.scale,c=r/s,u=o/s;t.lineStyle(1,4096759).beginFill(16777215).drawCircle(0,0,5).endFill().beginFill(4096759,.2).drawRect(-c/2,-u/2,c,u).endFill(),t.pivot.x=0,t.pivot.y=0;var l=this.$toCanvas(n,i),h=Object(ae["a"])(l,2);t.x=h[0],t.y=h[1],t.rotation=a}},methods:{show:function(){this.$state.active=!0,this.$setDirty()},hide:function(){this.$state.active=!1,this.$setDirty()},updateState:function(t,e,n,i,r){this.$state.x=t,this.$state.y=e,this.$state.width=n,this.$state.height=i,this.$state.rotation=r,this.$setDirty()}}},Rc),Vc=w.Element.define({groupIndex:1300,state:function(){return{active:!1,x:0,y:0,width:0,height:0}},render:function(t){if(this.$state.active){var e=this.$state,n=e.x,i=e.y,r=e.width,o=e.height,a=this.$drawing.scale,s=r/a,c=o/a;t.lineStyle(1,4096759).beginFill(4096759,.2).drawRect(-s/2,-c/2,s,c).endFill(),t.pivot.x=0,t.pivot.y=0;var u=this.$toCanvas(n,i),l=Object(ae["a"])(u,2);t.x=l[0],t.y=l[1]}},methods:{show:function(){this.$state.active=!0,this.$setDirty()},hide:function(){this.$state.active=!1,this.$setDirty()},updateState:function(t){var e=this.$drawing.scale,n=t.width*e,i=t.height*e,r=this.$toGeometry(t.x,t.y);this.$state.x=r[0]+n/2,this.$state.y=r[1]-i/2,this.$state.width=n,this.$state.height=i,this.$setDirty()},remove:function(){this.$destroy()}}},Rc),Uc=w.Tool.READY,Yc=Symbol("Pick"),Gc=Symbol("Show"),Xc=function(t){Object(Qe["a"])(n,t);var e=Object(Ze["a"])(n);function n(){return Object(ht["a"])(this,n),e.apply(this,arguments)}return Object(ft["a"])(n,[{key:"getElement",value:function(){return Yi(this).getElement()}},{key:"moveElement",value:function(t){return Yi(this).moveElement(t)}}]),n}(y.Proxy.ToolProvider(["open","pick","drop","close"])),Kc=[[-1,1],[0,1],[1,1],[-1,0],[1,0],[-1,-1],[0,-1],[1,-1]],Jc=w.Tool.define(Object(dt["a"])({},Gc,(function(){this.updateState()})),{open:[[Uc,vt["e"],Yc]],pick:[[Yc,function(){var t=this;this.$data.element=this.$plugin.$drawing.focusing;var e,n=Object(Te["a"])(this.$data.handlers);try{for(n.s();!(e=n.n()).done;){var i=e.value;i.show()}}catch(r){n.e(r)}finally{n.f()}this.$data.rotater.show(),this.$data.previewer.show(),this.$data.outline.show(),this.$data.element.on("change",this.$data.listener=function(){t.updateState()})},Gc],[Gc,function(){this.$data.element.off("change",this.$data.listener),this.$data.element=this.$plugin.$drawing.focusing,this.$data.element.on("change",this.$data.listener)},Gc],[Uc,vt["e"],Uc]],drop:[[Gc,function(){var t,e=Object(Te["a"])(this.$data.handlers);try{for(e.s();!(t=e.n()).done;){var n=t.value;n.hide()}}catch(i){e.e(i)}finally{e.f()}this.$data.rotater.hide(),this.$data.previewer.hide(),this.$data.outline.hide(),this.$data.element.off("change",this.$data.listener),this.$data.element=null},Yc],[Yc,vt["e"],Yc],[Uc,vt["e"],Uc]],close:[[Gc,function(){var t,e=Object(Te["a"])(this.$data.handlers);try{for(e.s();!(t=e.n()).done;){var n=t.value;n.hide()}}catch(i){e.e(i)}finally{e.f()}this.$data.rotater.hide(),this.$data.previewer.hide(),this.$data.outline.hide(),this.$data.element.off("change",this.$data.listener),this.$data.element=null},Uc],[Yc,vt["e"],Uc],[Uc,vt["e"],Uc]]},{proxy:y.Proxy.Creator(Xc),data:function(t){var e=t.$createElement("Rotater"),n=t.$createElement("Previewer"),i=t.$createElement("Outline"),r=Kc.map((function(o){var a=t.$createElement.apply(t,["Handler"].concat(Object(pt["a"])(o)));return a.$on("update",(function(t){var o,a=t.x,s=t.y,c=t.width,u=t.height,l=t.rotation,h=Object(Te["a"])(r);try{for(h.s();!(o=h.n()).done;){var f=o.value;f.updateState(a,s,c,u,l)}}catch(d){h.e(d)}finally{h.f()}e.updateState(a,s,c,u,l),n.updateState(a,s,c,u,l),i.updateState(a,s,c,u,l)})),a}));return e.$on("update",(function(t){var e,o=t.x,a=t.y,s=t.width,c=t.height,u=t.rotation,l=Object(Te["a"])(r);try{for(l.s();!(e=l.n()).done;){var h=e.value;h.updateState(o,a,s,c,u)}}catch(f){l.e(f)}finally{l.f()}n.updateState(o,a,s,c,u),i.updateState(o,a,s,c,u)})),n.$on("update",(function(t){var n,o=t.x,a=t.y,s=t.width,c=t.height,u=t.rotation,l=Object(Te["a"])(r);try{for(l.s();!(n=l.n()).done;){var h=n.value;h.updateState(o,a,s,c,u)}}catch(f){l.e(f)}finally{l.f()}e.updateState(o,a,s,c,u),i.updateState(o,a,s,c,u)})),{element:null,handlers:r,rotater:e,previewer:n,outline:i,listener:vt["e"]}},methods:{updateState:function(){var t,e=this.$data.element,n=this.$plugin.$data.transformerAdapter.get(e.constructor),i=n.getPosition(e),r=Object(ae["a"])(i,2),o=r[0],a=r[1],s=n.getWidth(e),c=n.getHeight(e),u=n.getRotation(e),l=Object(Te["a"])(this.$data.handlers);try{for(l.s();!(t=l.n()).done;){var h=t.value;h.updateState(o,a,s,c,u)}}catch(f){l.e(f)}finally{l.f()}this.$data.rotater.updateState(o,a,s,c,u),this.$data.previewer.updateState(o,a,s,c,u),this.$data.outline.updateState(o,a,s,c,u)},getElement:function(){return this.$data.element},moveElement:function(t){this.$data.element=t,this.updateState(),this.$data.previewer.setCreating(!0),this.$data.previewer.show(),this.$data.previewer.elementAdjust()}},reset:function(){this.close()}}),qc=w.Tool.READY,Qc=Symbol("Pick"),Zc=Symbol("Show"),tu=function(t){Object(Qe["a"])(n,t);var e=Object(Ze["a"])(n);function n(){return Object(ht["a"])(this,n),e.apply(this,arguments)}return Object(ft["a"])(n,[{key:"setElement",value:function(t){return Yi(this).setElement(t)}},{key:"getElements",value:function(){return Yi(this).getElements()}}]),n}(y.Proxy.ToolProvider(["open","pick_single","pick_multiple","drop","close"])),eu=w.Tool.define({},{open:[[qc,vt["e"],Qc]],pick_single:[[Qc,function(){this.addSingleBounds()},Zc],[Zc,function(){this.addSingleBounds()},Zc],[qc,vt["e"],qc]],pick_multiple:[[Qc,function(){this.addMultipleBounds()},Zc],[Zc,function(){this.addMultipleBounds()},Zc],[qc,vt["e"],qc]],drop:[[Zc,function(){this.clearBounds()},Qc],[Qc,vt["e"],Qc],[qc,vt["e"],qc]],close:[[Zc,function(){this.clearBounds()},qc],[Qc,vt["e"],qc],[qc,vt["e"],qc]]},{proxy:y.Proxy.Creator(tu),data:function(){return{element:null,boundsList:[],elementList:[],listenerList:[]}},methods:{addSingleBounds:function(){var t=this,e=this.$data.element||this.$plugin.$drawing.focusing,n=this.$plugin.$createElement("Bounds");this.clearBounds(),n.show(),this.updateState(n,e);var i=function(){t.updateState(n,e)};e.on("change",i),this.$data.boundsList.push(n),this.$data.elementList.push(e),this.$data.listenerList.push(i),this.$plugin.$emit("selector-add",this.$data.elementList)},addMultipleBounds:function(t){var e=this,n=this.$data,i=n.boundsList,r=n.elementList,o=n.listenerList,a=r.indexOf(t);if(a>-1){var s=i.splice(a,1),c=Object(ae["a"])(s,1),u=c[0];return r[a].off("change",o[a]),r.splice(a,1),void u.remove()}var l=this.$plugin.$createElement("Bounds");this.updateState(l,t),l.show();var h=function(){e.updateState(l,t)};t.on("change",h),i.push(l),r.push(t),o.push(h),this.$plugin.$emit("selector-add",this.$data.elementList)},clearBounds:function(){var t,e=this,n=Object(Te["a"])(this.$data.boundsList);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.remove()}}catch(r){n.e(r)}finally{n.f()}this.$data.elementList.forEach((function(t,n){t.off("change",e.$data.listenerList[n])})),this.$data.boundsList=[],this.$data.elementList=[],this.$data.listenerList=[],this.$plugin.$emit("selector-clear")},updateState:function(t,e){var n=this.$plugin.$data.selectorAdapter.get(e.constructor),i=n.getBounds(e);t.updateState(i)},setElement:function(t){this.$data.element=t},getElements:function(){return this.$data.elementList}},reset:function(){this.close()}}),nu=k.define({id:"com.3dnest.spoke.common",namespace:"common",version:Ac["a"],plugin:Rc,elements:{Handler:Mc,Rotater:Hc,Previewer:Bc,Outline:zc,Bounds:Vc},tools:{Transformer:Jc,Selector:eu}}),iu=n("0aa2"),ru=y.Options.define,ou=ru({enabled:!0},{rectangular:ru({enabled:!0,referenceUnit:15},{style:ru({color:13421823,lineWidth:1}),snap:ru({enabled:!0})})}),au=function(t){Object(Qe["a"])(n,t);var e=Object(Ze["a"])(n);function n(){return Object(ht["a"])(this,n),e.apply(this,arguments)}return Object(ft["a"])(n)}(y.Proxy.Plugin),su=w.define({options:ou,proxy:y.Proxy.Creator(au),data:function(){return{layerList:[]}},created:function(){var t=this.$createElement("RectangularGrid");this.$data.layerList.push(t)}}),cu=(n("6b93"),n("7db0"),[5,2,1]),uu=function(t,e,n){return t.moveTo(0,e).lineTo(n,e)},lu=function(t,e,n){return t.moveTo(e,0).lineTo(e,n)},hu=function(t){Object(Qe["a"])(n,t);var e=Object(Ze["a"])(n);function n(){return Object(ht["a"])(this,n),e.apply(this,arguments)}return Object(ft["a"])(n)}(y.Proxy.Element),fu=w.Element.define({proxy:y.Proxy.Creator(hu),groupIndex:0,render:function(t){var e=this.$plugin.$options,n=e.rectangular.style,i=this.$drawing,r=i.width,o=i.height,a=i.scale,s=i.origin,c=Object(ae["a"])(s,2),u=c[0],l=c[1],h=this.getUnitInMM(),f=function(t){return h*t/a};t.lineStyle(n.lineWidth,n.color,1,0);var d=0,p=0;for(d=1;(p=f(d))<u;d++)lu(t,vt["d"].round(u-p),o);for(d=1;(p=f(d))<r-u;d++)lu(t,vt["d"].round(u+p),o);for(d=1;(p=f(d))<l;d++)uu(t,vt["d"].round(l-p),r);for(d=1;(p=f(d))<o-l;d++)uu(t,vt["d"].round(l+p),r);t.lineStyle(1,16711680,1,0).moveTo(0,l).lineTo(r,l).moveTo(u,0).lineTo(u,o)},created:function(){var t=this,e=this.$plugin.$options;this.$drawing.registerSnap({name:"grid-point",priority:-1/0,get active(){return e.enabled&&e.rectangular.enabled&&e.rectangular.snap.enabled},handle:function(e,n,i){var r=t.getUnitInMM(),o=t.$toGeometry(e,n),a=o.map(du,r),s=t.$toCanvas.apply(t,Object(pt["a"])(a));i.apply(void 0,Object(pt["a"])(s))}})},methods:{getUnitInMM:function(){var t=this.$plugin.$options.rectangular.referenceUnit,e=t*this.$drawing.scale,n=vt["d"].pow(10,vt["d"].floor(vt["d"].log10(e)));return cu.find(pu,vt["d"].round(e/n))*n}}},su);function du(t){return vt["d"].round(t/this)*this}function pu(t){return this>=t}var vu,mu=4,gu=w.Element.define({groupIndex:1e4,created:function(){var t=this;this.$drawing.on("snap",(function(){return t.$setDirty()}))},render:function(t){t.lineStyle(1,13421772).moveTo(-mu,-mu).lineTo(mu,mu).moveTo(mu,-mu).lineTo(-mu,mu);var e=Object(ae["a"])(this.$drawing.virtual,2);t.x=e[0],t.y=e[1]}},su),yu=k.define({id:"com.3dnest.spoke.grid",namespace:"grid",version:iu["a"],plugin:su,elements:{RectangularGrid:fu,Crosshair:gu}}),bu=n("c5c2"),xu=function(t){Object(Qe["a"])(n,t);var e=Object(Ze["a"])(n);function n(){return Object(ht["a"])(this,n),e.apply(this,arguments)}return Object(ft["a"])(n,[{key:"adjuster",get:function(){return Yi(this).adjuster}}]),n}(y.Proxy.Plugin),$u=w.define({proxy:y.Proxy.Creator(xu),data:function(){return{adjuster:null}},created:function(){this.$data.adjuster=this.$createTool("Adjuster")},getters:{adjuster:function(){return this.$data.adjuster}}}),wu=50,ku=function(t,e){var n=t.corner,i=t.back.corner,r=a.normalize.apply(a,Object(pt["a"])(a.fromBothPoint(n.x,n.y,i.x,i.y))),o=Object(ae["a"])(r,2),s=o[0],u=o[1],l=c.translate.apply(c,[n.x,n.y].concat(Object(pt["a"])(a.multiply(s,u,e)))),h=Object(ae["a"])(l,2),f=h[0],d=h[1];return[f,d]},Ou=function(t,e,n){var i=t.corner,r=t.back.corner;return c.project.apply(c,[e,n].concat(Object(pt["a"])(s.fromSegment(i.x,i.y,r.x,r.y))))},ju=function(t,e,n){var i=t.corner,r=Ou(t,e,n);return a.length.apply(a,Object(pt["a"])(a.fromBothPoint.apply(a,[i.x,i.y].concat(Object(pt["a"])(r)))))},Tu=function(t,e,n,i,r){var o=null,s=null,u=0;if(t.forEach((function(t){var i=Ou(t.thisSurface,e,n),r=Object(ae["a"])(i,2),o=r[0],c=r[1],l=Math.min(t.thisSurface.corner.x,t.thatSurface.corner.x),h=Math.max(t.thisSurface.corner.x,t.thatSurface.corner.x),f=Math.min(t.thisSurface.corner.y,t.thatSurface.corner.y),d=Math.max(t.thisSurface.corner.y,t.thatSurface.corner.y);if(!(o<l||o>h||c<f||c>d)){var p=a.length.apply(a,Object(pt["a"])(a.fromBothPoint(e,n,o,c)));(!s||p<u)&&(s=t,u=p)}})),!s||u/i>wu)r.corner.x=e,r.corner.y=n,r.back.corner.x=e+10,r.back.corner.y=n,o=r;else{var l=s.thisSurface,h=s.thatSurface;o=c.toLeftOfSegment(e,n,h.corner.x,h.corner.y,l.corner.x,l.corner.y)?h:l}return o},Eu=w.Element.define({groupIndex:1200,interative:!0,hoverable:!0,state:function(){return{active:!1,surface:null,offset:0,width:0}},created:function(){var t=this;this.$on("pointerdown",(function(e){e.stopPropagation(),t.beginAdjust()}))},destroy:function(){},render:function(t){if(this.$state.active){var e=this.$state,n=e.surface,i=e.offset,r=e.width,o=this.$toCanvas.apply(this,Object(pt["a"])(ku(n,i-r/2))),a=Object(ae["a"])(o,2),s=a[0],c=a[1];t.lineStyle(this.$hovering||this.$holding?2:1,this.$hovering||this.$holding?16777215:4096759).beginFill(4096759,.5).drawCircle(s,c,5)}},methods:{show:function(){this.$state.active=!0,this.$setDirty()},hide:function(){this.$state.active=!1,this.$setDirty()},setSurface:function(t){this.$state.surface=t,this.$setDirty()},setOffset:function(t){this.$state.offset=t,this.$setDirty()},setWidth:function(t){this.$state.width=t,this.$setDirty()},updateState:function(t,e,n){this.setSurface(t),this.setOffset(e),this.setWidth(n)},beginAdjust:function(){var t=this,e=this.$data.adjuster.getElement(),n=this.$state,i=n.surface,r=n.offset,o=n.width,a=function(n){var a=t.$toGeometry(n.pointerX,n.pointerY),s=ju.apply(void 0,[i].concat(Object(pt["a"])(a))),c=r-o/2-s,u=r-c/2,l=o+c;t.setOffset(u),t.setWidth(l),e.setOffset(u),e.setWidth(l),t.$emit("update",{surface:i,offset:u,width:l})},s=function e(){t.$drawing.off("pointermove",a),window.removeEventListener("mouseup",e)};this.$drawing.on("pointermove",a),window.addEventListener("mouseup",s)}}},$u),Su=w.Element.define({groupIndex:1200,interative:!0,hoverable:!0,state:function(){return{active:!1,surface:null,offset:0,width:0}},created:function(){var t=this;this.$on("pointerdown",(function(e){e.stopPropagation(),t.beginAdjust()}))},destroy:function(){},render:function(t){if(this.$state.active){var e=this.$state,n=e.surface,i=e.offset,r=e.width,o=this.$toCanvas.apply(this,Object(pt["a"])(ku(n,i+r/2))),a=Object(ae["a"])(o,2),s=a[0],c=a[1];t.lineStyle(this.$hovering||this.$holding?2:1,this.$hovering||this.$holding?16777215:4096759).beginFill(4096759,.5).drawRect(s-5,c-5,10,10)}},methods:{show:function(){this.$state.active=!0,this.$setDirty()},hide:function(){this.$state.active=!1,this.$setDirty()},setSurface:function(t){this.$state.surface=t,this.$setDirty()},setOffset:function(t){this.$state.offset=t,this.$setDirty()},setWidth:function(t){this.$state.width=t,this.$setDirty()},updateState:function(t,e,n){this.setSurface(t),this.setOffset(e),this.setWidth(n)},beginAdjust:function(){var t=this,e=this.$data.adjuster.getElement(),n=this.$state,i=n.surface,r=n.offset,o=n.width,a=function(n){var a=t.$toGeometry(n.pointerX,n.pointerY),s=ju.apply(void 0,[i].concat(Object(pt["a"])(a))),c=s-r-o/2,u=r+c/2,l=o+c;t.setOffset(u),t.setWidth(l),e.setOffset(u),e.setWidth(l),t.$emit("update",{surface:i,offset:u,width:l})},s=function e(){t.$drawing.off("pointermove",a),window.removeEventListener("mouseup",e)};this.$drawing.on("pointermove",a),window.addEventListener("mouseup",s)}}},$u),Lu=w.Element.define({groupIndex:1200,interative:!0,state:function(){return{surface:null,offset:0,width:0,listener:null,isCreating:!1}},methods:{show:function(){var t=this,e=this.$data.adjuster.getElement();e.on("pointerdown",this.$state.listener=function(n){t.$state.isCreating||t.hollowAdjust(e,n)}),this.$setDirty()},hide:function(){var t=this.$data.adjuster.getElement();t&&t.off("pointerdown",this.$state.listener),this.$setDirty()},setSurface:function(t){this.$state.surface=t,this.$setDirty()},setOffset:function(t){this.$state.offset=t,this.$setDirty()},setWidth:function(t){this.$state.width=t,this.$setDirty()},setCreating:function(t){this.$state.isCreating=t,this.$setDirty()},updateState:function(t,e,n){this.setSurface(t),this.setOffset(e),this.setWidth(n)},adjustAction:function(t,e,n,i){this.setSurface(e),this.setOffset(n),t.setSurface(e),t.setOffset(n),this.$emit("update",{surface:e,offset:n,width:i})},hollowAdjust:function(t,e){var n=this,i=this.$state,r=i.surface,o=i.offset,a=i.width,s=i.isCreating,c=this.$drawing,u=e?ju.apply(void 0,[r].concat(Object(pt["a"])(this.$toGeometry(e.pointerX,e.pointerY))))-o:0,l=c.structure.getAllWallList(),h=function(e){var i=n.$toGeometry(e.pointerX,e.pointerY),r=Tu.apply(void 0,[l].concat(Object(pt["a"])(i),[n.$drawing.scale,t.virtualSurface]));if("virtual"!==r.name){var o=ju.apply(void 0,[r].concat(Object(pt["a"])(i)))-u,s=ju.apply(void 0,[r].concat(Object(pt["a"])(r.originSafe))),c=ju.apply(void 0,[r].concat(Object(pt["a"])(r.targetSafe))),h=ju.apply(void 0,[r].concat(Object(pt["a"])(r.back.originSafe))),f=ju.apply(void 0,[r].concat(Object(pt["a"])(r.back.targetSafe))),d=Math.max(s,f)+a/2,p=Math.min(c,h)-a/2,v=o<d?d:o>p?p:o;n.adjustAction(t,r,v,a)}else n.adjustAction(t,r,0,a)},f=function(){c.off("pointermove",h),window.removeEventListener("mouseup",d),window.removeEventListener("keydown",p),s&&n.setCreating(!1)},d=function(){f()},p=function(e){"Escape"===e.code&&s&&(t.remove(),f())};c.on("pointermove",h),window.addEventListener("mouseup",d),window.addEventListener("keydown",p)}}},$u),Cu=w.Tool.READY,Pu=Symbol("Pick"),Fu=Symbol("Show"),Au=function(t){Object(Qe["a"])(n,t);var e=Object(Ze["a"])(n);function n(){return Object(ht["a"])(this,n),e.apply(this,arguments)}return Object(ft["a"])(n,[{key:"getElement",value:function(){return Yi(this).getElement()}},{key:"moveElement",value:function(t){return Yi(this).moveElement(t)}}]),n}(y.Proxy.ToolProvider(["open","pick","drop","close"])),_u=w.Tool.define(Object(dt["a"])({},Fu,(function(){this.updateState()})),{open:[[Cu,vt["e"],Pu]],pick:[[Pu,function(){var t=this;this.$data.element=this.$plugin.$drawing.focusing,this.$data.element.on("change",this.$data.listener=function(){t.updateState()}),this.$data.headHandler.show(),this.$data.rearHandler.show(),this.$data.mover.show()},Fu],[Fu,function(){var t=this;this.$data.element!==this.$plugin.$drawing.focusing&&(this.$data.element.off("change",this.$data.listener),this.$data.mover.hide(),this.$data.element=this.$plugin.$drawing.focusing,this.$data.element.on("change",this.$data.listener=function(){t.updateState()}),this.$data.mover.show())},Fu],[Cu,vt["e"],Cu]],drop:[[Fu,function(){this.$data.headHandler.hide(),this.$data.rearHandler.hide(),this.$data.mover.hide(),this.$data.element.off("change",this.$data.listener),this.$data.element=null},Pu],[Pu,vt["e"],Pu],[Cu,vt["e"],Cu]],close:[[Fu,function(){this.$data.headHandler.hide(),this.$data.rearHandler.hide(),this.$data.mover.hide()},Cu],[Pu,vt["e"],Cu],[Cu,vt["e"],Cu]]},{proxy:y.Proxy.Creator(Au),data:function(t){var e=t.$createElement("HeadHandler"),n=t.$createElement("RearHandler"),i=t.$createElement("Mover");return e.$on("update",(function(t){var e=t.surface,r=t.offset,o=t.width;n.updateState(e,r,o),i.updateState(e,r,o)})),n.$on("update",(function(t){var n=t.surface,r=t.offset,o=t.width;e.updateState(n,r,o),i.updateState(n,r,o)})),i.$on("update",(function(t){var i=t.surface,r=t.offset,o=t.width;n.updateState(i,r,o),e.updateState(i,r,o)})),{element:null,headHandler:e,rearHandler:n,mover:i,listener:vt["e"]}},methods:{updateState:function(){var t=this.$data.element,e=t.surface,n=t.offset,i=t.width;this.$data.headHandler.updateState(e,n,i),this.$data.rearHandler.updateState(e,n,i),this.$data.mover.updateState(e,n,i)},getElement:function(){return this.$data.element},moveElement:function(t){this.$data.element=t,this.drop(),this.$data.mover.setCreating(!0),this.$data.mover.hollowAdjust(t)}},reset:function(){this.close()}}),Ru=k.define({id:"com.3dnest.spoke.hammer",namespace:"hammer",version:bu["a"],plugin:$u,elements:{HeadHandler:Eu,RearHandler:Su,Mover:Lu},tools:{Adjuster:_u}}),Du=n("7612"),Nu=function(t){Object(Qe["a"])(n,t);var e=Object(Ze["a"])(n);function n(){return Object(ht["a"])(this,n),e.apply(this,arguments)}return Object(ft["a"])(n,[{key:"from",get:function(){return vt["c"].throwError("The `.from` getter MUST be implemented.")}},{key:"to",get:function(){return vt["c"].throwError("The `.to` getter MUST be implemented.")}}]),n}(hn["a"].Emitter),Wu=function(t){return vt["c"].instanceOf(t,Nu)},Mu=Wu,Iu=function(t){Object(Qe["a"])(n,t);var e=Object(Ze["a"])(n);function n(){return Object(ht["a"])(this,n),e.apply(this,arguments)}return Object(ft["a"])(n,[{key:"createDimension",value:function(t){return Mu(t)||vt["c"].Throw.TypeError("Invalid adaptor, a adaptor expected."),Yi(this).createDimension(t).$proxy}},{key:"setFontsizer",value:function(t){Yi(this).setFontsizer(t)}},{key:"setTextOffsetYModifier",value:function(t){Yi(this).setTextOffsetYModifier(t)}},{key:"removeAll",value:function(){Yi(this).removeAll()}},{key:"dimensions",value:regeneratorRuntime.mark((function t(){var e,n,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=Object(Te["a"])(Yi(this).dimensions()),t.prev=1,e.s();case 3:if((n=e.n()).done){t.next=9;break}return i=n.value,t.next=7,i.$proxy;case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](1),e.e(t.t0);case 14:return t.prev=14,e.f(),t.finish(14);case 17:case"end":return t.stop()}}),t,this,[[1,11,14,17]])}))}]),n}(y.Proxy.Plugin),Hu=function(t){return 360/t},Bu=function(t){return-t},zu=w.define({proxy:y.Proxy.Creator(Iu),data:function(){return{fontsizer:Hu,textOffsetYModifier:Bu}},created:function(){var t=this;this.$on("element-created",(function(e,n){t.$emit("".concat(n.toLowerCase(),"-created"),e)}))},methods:{createDimension:function(t){return this.$createElement("Dimension",t)},setFontsizer:function(t){this.$data.fontsizer=t,this.$forceUpdate()},setTextOffsetYModifier:function(t){this.$data.textOffsetYModifier=t,this.$forceUpdate()},removeAll:function(){this.$getElementList("Dimension").forEach((function(t){return t.$proxy.remove()}))},dimensions:regeneratorRuntime.mark((function t(){var e,n,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=Object(Te["a"])(this.$elements("Dimension")),t.prev=1,e.s();case 3:if((n=e.n()).done){t.next=9;break}return i=n.value,t.next=7,i;case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](1),e.e(t.t0);case 14:return t.prev=14,e.f(),t.finish(14);case 17:case"end":return t.stop()}}),t,this,[[1,11,14,17]])}))}}),Vu=function(t){Object(Qe["a"])(n,t);var e=Object(Ze["a"])(n);function n(){return Object(ht["a"])(this,n),e.apply(this,arguments)}return Object(ft["a"])(n,[{key:"offset",get:function(){return Yi(this).$state.offset},set:function(t){vt["h"].Not.Number(t)&&vt["c"].Throw.TypeError("Invalid value, a number expected."),Yi(this).setOffset(t)}},{key:"hide",value:function(){Yi(this).$hide()}},{key:"show",value:function(){Yi(this).$show()}},{key:"remove",value:function(){Yi(this).$destroy()}}]),n}(y.Proxy.Element),Uu=200,Yu=200,Gu=0,Xu=100,Ku=30,Ju=vt["d"].PI,qu=Ju/2,Qu=400,Zu=function(t){return t>qu&&t<=Ju||t>-Ju&&t<=-qu},tl=w.Element.define({proxy:y.Proxy.Creator(Vu),groupIndex:1e3,interative:!0,focusable:!0,state:function(){return{element:null,offset:Uu,valueText:null}},render:function(t){var e=this.$state,n=e.element,i=e.offset,o=e.valueText,s=n.from,u=n.to,h=a.length.apply(a,Object(pt["a"])(a.from.apply(a,Object(pt["a"])(s).concat(Object(pt["a"])(u)))));if(h<Qu)o.visible=!1;else{var f=this.$drawing.scale,d=this.$data,p=d.fontsizer,v=d.textOffsetYModifier,m=Yu/f,g=Gu/f,y=Xu/f,b=Ku/f,x=p(f);o.visible=!0,o.style.fontSize=x,o.text=vt["d"].round(h),o.y=v(x),o.pivot.set(o.width/2,o.height/2);var $=r.Segment.apply(r,Object(pt["a"])(this.$toCanvas.apply(this,Object(pt["a"])(s))).concat(Object(pt["a"])(this.$toCanvas.apply(this,Object(pt["a"])(u))))),w=a.fromSegment.apply(a,Object(pt["a"])($)),k=Object(ae["a"])(w,2),O=k[0],j=k[1],T=a.length(O,j)/2;t.lineStyle(1,0),i<0?t.moveTo(-T,y).lineTo(-T,-m).moveTo(T,y).lineTo(T,-m):t.moveTo(-T,m).lineTo(-T,-y).moveTo(T,m).lineTo(T,-y),t.moveTo(-T-g,0).lineTo(T+g,0).lineStyle(3).moveTo(-T-b,b).lineTo(-T+b,-b).moveTo(T-b,b).lineTo(T+b,-b);var E=l.middle.apply(l,Object(pt["a"])($)),S=a.invert.apply(a,Object(pt["a"])(a.rotate90.apply(a,Object(pt["a"])(a.normalize(O,j))))),L=a.multiply.apply(a,Object(pt["a"])(S).concat([i/f])),C=c.translate.apply(c,Object(pt["a"])(E).concat(Object(pt["a"])(L))),P=Object(ae["a"])(C,2);t.x=P[0],t.y=P[1],Zu(t.rotation=vt["d"].atan2(j,O))&&(o.rotation=vt["d"].PI)}},created:function(t){var e=this,n=this.$state.valueText=new fn.Text;vt["f"].assign(n.style,{stroke:16777215,strokeThickness:2}),t.on("change",(function(){return e.$setDirty()})),t.on("destroy",(function(){return e.$destroy()})),this.$state.element=t,this.$graphics.addChild(n)},methods:{setOffset:function(t){this.$state.offset=t,this.$setDirty()}}},zu),el=k.define({id:"com.3dnest.spoke.measure",namespace:"measure",version:Du["a"],plugin:zu,elements:{Dimension:tl}}),nl=n("c394"),il=function(t){Object(Qe["a"])(n,t);var e=Object(Ze["a"])(n);function n(){return Object(ht["a"])(this,n),e.apply(this,arguments)}return Object(ft["a"])(n,[{key:"LineLabeler",get:function(){return Yi(this).$data.lineLabeler}},{key:"TextLabeler",get:function(){return Yi(this).$data.textLabeler}},{key:"LabelTransformer",get:function(){return Yi(this).$data.labelTransformer}},{key:"open",value:function(){return Yi(this).open()}},{key:"openTextLabeler",value:function(){return Yi(this).openTextLabeler()}},{key:"openLineLabeler",value:function(){return Yi(this).openLineLabeler()}},{key:"close",value:function(){return Yi(this).close()}},{key:"createLabelText",value:function(t,e,n){return Yi(this).createLabelText(t,e,n).$proxy}},{key:"createLabelLine",value:function(t,e,n){return Yi(this).createLabelLine(t,e,n).$proxy}},{key:"getAllLabelTextList",value:function(){return Array.from(this.textLabels())}},{key:"getAllLabelLineList",value:function(){return Array.from(this.lineLabels())}},{key:"textLabels",value:regeneratorRuntime.mark((function t(){var e,n,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=Object(Te["a"])(Yi(this).textLabels()),t.prev=1,e.s();case 3:if((n=e.n()).done){t.next=9;break}return i=n.value,t.next=7,i.$proxy;case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](1),e.e(t.t0);case 14:return t.prev=14,e.f(),t.finish(14);case 17:case"end":return t.stop()}}),t,this,[[1,11,14,17]])}))},{key:"lineLabels",value:regeneratorRuntime.mark((function t(){var e,n,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=Object(Te["a"])(Yi(this).lineLabels()),t.prev=1,e.s();case 3:if((n=e.n()).done){t.next=9;break}return i=n.value,t.next=7,i.$proxy;case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](1),e.e(t.t0);case 14:return t.prev=14,e.f(),t.finish(14);case 17:case"end":return t.stop()}}),t,this,[[1,11,14,17]])}))}]),n}(y.Proxy.Plugin),rl=w.define({proxy:y.Proxy.Creator(il),data:function(){return{lineLabeler:null,textLabeler:null,labelTransformer:null}},created:function(){var t=this;this.$data.lineLabeler=this.$createTool("LineLabeler"),this.$data.textLabeler=this.$createTool("TextLabeler"),this.$data.labelTransformer=this.$createTool("LabelTransformer"),this.$on("element-created",(function(e,n){t.$emit("".concat(n.toLowerCase(),"-created"),e)}))},methods:{open:function(){this.openTextLabeler()},openTextLabeler:function(){this.$data.lineLabeler.close(),this.$data.textLabeler.open()},openLineLabeler:function(){this.$data.textLabeler.close(),this.$data.lineLabeler.open()},close:function(){this.$data.textLabeler.close(),this.$data.lineLabeler.close()},createLabelText:function(t,e,n){var i=this.$createElement("LabelText");return i.setPosition(t,e),i.setText(n),i},createLabelLine:function(t,e,n){var i=this.$createElement("LabelLine");return i.setOrigin(t),i.setTarget(e),i.setText(n),i},lineLabels:regeneratorRuntime.mark((function t(){var e,n,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=Object(Te["a"])(this.$elements("LabelLine")),t.prev=1,e.s();case 3:if((n=e.n()).done){t.next=9;break}return i=n.value,t.next=7,i;case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](1),e.e(t.t0);case 14:return t.prev=14,e.f(),t.finish(14);case 17:case"end":return t.stop()}}),t,this,[[1,11,14,17]])})),textLabels:regeneratorRuntime.mark((function t(){var e,n,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=Object(Te["a"])(this.$elements("LabelText")),t.prev=1,e.s();case 3:if((n=e.n()).done){t.next=9;break}return i=n.value,t.next=7,i;case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](1),e.e(t.t0);case 14:return t.prev=14,e.f(),t.finish(14);case 17:case"end":return t.stop()}}),t,this,[[1,11,14,17]])}))}}),ol=function(t){Object(Qe["a"])(n,t);var e=Object(Ze["a"])(n);function n(){return Object(ht["a"])(this,n),e.apply(this,arguments)}return Object(ft["a"])(n,[{key:"origin",get:function(){return Yi(this).origin}},{key:"target",get:function(){return Yi(this).target}},{key:"text",get:function(){return Yi(this).text}},{key:"visible",get:function(){return Yi(this).$visible}},{key:"setOrigin",value:function(t){return Yi(this).setOrigin(t)}},{key:"setTarget",value:function(t){return Yi(this).setTarget(t)}},{key:"setText",value:function(t){return Yi(this).setText(t)}},{key:"setFontsize",value:function(t){return Yi(this).fontSize(t)}},{key:"show",value:function(){Yi(this).$show()}},{key:"hide",value:function(){Yi(this).$hide()}},{key:"remove",value:function(){Yi(this).remove()}}]),n}(y.Proxy.Element),al=1500,sl=w.Element.define({proxy:y.Proxy.Creator(ol),groupIndex:1400,interative:!0,focusable:!0,state:function(){return{pixiText:null,origin:null,target:null,text:"",fontSize:200,rendering:!1}},getters:{origin:function(){return this.$state.origin},target:function(){return this.$state.target},text:function(){return this.$state.text}},render:function(t){var e,n,i=this.$state,r=i.origin,o=i.target,s=i.pixiText,c=i.text,u=i.fontSize,l=i.rendering,h=this.$drawing.scale;if(r&&o){var f=this.$toCanvas.apply(this,Object(pt["a"])(r)),d=this.$toCanvas.apply(this,Object(pt["a"])(o)),p=a.fromBothPoint.apply(a,Object(pt["a"])(r).concat(Object(pt["a"])(o))),v=vt["d"].atan2(p[1],p[0]);s.text=c||"No Text",s.style.fontSize=u/h,s.transform.pivot.y=s.height,s.transform.position.x=d[0],s.transform.position.y=d[1];var m=s.width>al/h?s.width:al/h;(e=(n=t.lineStyle(1,0)).moveTo.apply(n,Object(pt["a"])(f))).lineTo.apply(e,Object(pt["a"])(d)),v<vt["d"].PI/2&&v>-vt["d"].PI/2?(s.transform.pivot.x=0,t.lineTo(d[0]+m,d[1])):(s.transform.pivot.x=s.width,t.lineTo(d[0]-m,d[1])),l&&(this.$emit("change",this.$proxy),this.setRendering(!1))}},created:function(){var t=this.$state.pixiText=new fn.Text;Object.assign(t.style,{stroke:16777215,strokeThickness:2}),this.$graphics.addChild(t)},methods:{setOrigin:function(t){this.$state.origin=t,this.$setDirty(),this.setRendering(!0)},setTarget:function(t){this.$state.target=t,this.$setDirty(),this.setRendering(!0)},setText:function(t){this.$state.text=t,this.$setDirty(),this.setRendering(!0)},setFontSize:function(t){this.$state.fontSize=t,this.$setDirty(),this.setRendering(!0)},setRendering:function(t){this.$state.rendering=t},remove:function(){this.$destroy()}}},rl),cl=function(t){Object(Qe["a"])(n,t);var e=Object(Ze["a"])(n);function n(){return Object(ht["a"])(this,n),e.apply(this,arguments)}return Object(ft["a"])(n,[{key:"text",get:function(){return Yi(this).text}},{key:"x",get:function(){return Yi(this).x}},{key:"y",get:function(){return Yi(this).y}},{key:"room",get:function(){return Yi(this).room}},{key:"visible",get:function(){return Yi(this).$visible}},{key:"setPosition",value:function(t,e){return Yi(this).setPosition(t,e)}},{key:"setText",value:function(t){return Yi(this).setText(t)}},{key:"setFontSize",value:function(t){return Yi(this).setFontSize(t)}},{key:"setRoom",value:function(t){return Yi(this).setRoom(t)}},{key:"show",value:function(){Yi(this).$show()}},{key:"hide",value:function(){Yi(this).$hide()}},{key:"remove",value:function(){Yi(this).remove()}}]),n}(y.Proxy.Element),ul=w.Element.define({proxy:y.Proxy.Creator(cl),groupIndex:1500,interative:!0,focusable:!0,state:function(){return{pixiText:null,text:"",fontSize:200,x:0,y:0,room:null,rendering:!1}},getters:{text:function(){return this.$state.text},x:function(){return this.$state.x},y:function(){return this.$state.y},room:function(){return this.$state.room}},render:function(t){var e=this.$state,n=e.pixiText,i=e.text,r=e.fontSize,o=e.x,a=e.y,s=e.rendering,c=this.$drawing.scale;n.text=i||"No Text",n.style.fontSize=r/c,t.pivot.x=t.width/2,t.pivot.y=t.height/2;var u=this.$toCanvas(o,a),l=Object(ae["a"])(u,2);t.x=l[0],t.y=l[1],s&&(this.$emit("change",this.$proxy),this.setRendering(!1))},created:function(){var t=this.$state.pixiText=new fn.Text;Object.assign(t.style,{stroke:16777215,strokeThickness:2,align:"center"}),this.$graphics.addChild(t)},methods:{setPosition:function(t,e){this.$state.x=t,this.$state.y=e,this.$setDirty(),this.setRendering(!0)},setText:function(t){this.$state.text=t,this.$setDirty(),this.setRendering(!0)},setFontSize:function(t){this.$state.fontSize=t,this.$setDirty(),this.setRendering(!0)},setRoom:function(t){this.$state.room=t,this.$setDirty()},setRendering:function(t){this.$state.rendering=t},remove:function(){this.$destroy()}}},rl),ll=w.Element.define({groupIndex:1600,interative:!0,hoverable:!0,state:function(){return{active:!1,x:0,y:0}},render:function(t){if(this.$state.active){var e=this.$state,n=e.x,i=e.y;this.$hovering?t.beginFill(16711680):t.beginFill(65280),t.drawCircle(0,0,3).endFill();var r=this.$toCanvas(n,i),o=Object(ae["a"])(r,2);t.x=o[0],t.y=o[1]}},created:function(){var t=this;this.$on("pointerdown",(function(e){e.stopPropagation(),t.beginAdjust()}))},methods:{show:function(){this.$state.active=!0,this.$setDirty()},hide:function(){this.$state.active=!1,this.$setDirty()},setPosition:function(t,e){this.$state.x=t,this.$state.y=e,this.$setDirty()},beginAdjust:function(){var t=this,e=this.$data.labelTransformer.getElement(),n=function(n){var i=t.$toGeometry(n.pointerX,n.pointerY);t.setPosition.apply(t,Object(pt["a"])(i)),e.setOrigin(Object(pt["a"])(i)),t.$emit("update")},i=function e(){t.$drawing.off("pointermove",n),window.removeEventListener("mouseup",e)};this.$drawing.on("pointermove",n),window.addEventListener("mouseup",i)}}},rl),hl=w.Element.define({groupIndex:1600,interative:!0,hoverable:!0,state:function(){return{active:!1,x:0,y:0}},render:function(t){if(this.$state.active){var e=this.$state,n=e.x,i=e.y;this.$hovering?t.beginFill(16711680):t.beginFill(65280),t.drawCircle(0,0,3).endFill();var r=this.$toCanvas(n,i),o=Object(ae["a"])(r,2);t.x=o[0],t.y=o[1]}},created:function(){var t=this;this.$on("pointerdown",(function(e){e.stopPropagation(),t.beginAdjust()}))},methods:{show:function(){this.$state.active=!0,this.$setDirty()},hide:function(){this.$state.active=!1,this.$setDirty()},setPosition:function(t,e){this.$state.x=t,this.$state.y=e,this.$setDirty()},beginAdjust:function(){var t=this,e=this.$data.labelTransformer.getElement(),n=function(n){var i=t.$toGeometry(n.pointerX,n.pointerY);t.setPosition.apply(t,Object(pt["a"])(i)),e.setTarget(Object(pt["a"])(i)),t.$emit("update")},i=function e(){t.$drawing.off("pointermove",n),window.removeEventListener("mouseup",e)};this.$drawing.on("pointermove",n),window.addEventListener("mouseup",i)}}},rl),fl=w.Element.define({groupIndex:1550,interative:!0,state:function(){return{active:!1,x:0,y:0,width:0,height:0}},render:function(t){if(this.$state.active){var e=this.$state,n=e.x,i=e.y,r=e.width,o=e.height,a=this.$drawing.scale,s=r/a,c=o/a;t.lineStyle(1,4096759).beginFill(4096759,.2).drawRect(-s/2,-c/2,s,c).endFill(),t.pivot.x=0,t.pivot.y=0;var u=this.$toCanvas(n,i),l=Object(ae["a"])(u,2);t.x=l[0],t.y=l[1]}},created:function(){var t=this;this.$on("pointerdown",(function(e){e.stopPropagation(),t.beginAdjust(e)}))},methods:{show:function(){this.$state.active=!0,this.$setDirty()},hide:function(){this.$state.active=!1,this.$setDirty()},setWidth:function(t){this.$state.width=t,this.$setDirty()},setHeight:function(t){this.$state.height=t,this.$setDirty()},setPosition:function(t,e){this.$state.x=t,this.$state.y=e,this.$setDirty()},updateState:function(t,e,n,i){this.setPosition(t,e),this.setWidth(n),this.setHeight(i)},beginAdjust:function(t){var e=this,n=this.$drawing,i=this.$data.labelTransformer.getElement(),r=this.$state,o=r.x,a=r.y,s=this.$toGeometry(t.pointerX,t.pointerY),c={x:s[0]-o,y:s[1]-a};vt["c"].instanceOf(i,ol)&&(c.originX=s[0]-i.origin[0],c.originY=s[1]-i.origin[1],c.targetX=s[0]-i.target[0],c.targetY=s[1]-i.target[1]);var u=function(t){var n=e.$toGeometry(t.pointerX,t.pointerY),r=n[0]-c.x,o=n[1]-c.y;if(vt["c"].instanceOf(i,cl))if(i.room){var a=e.$state,s=a.width,u=a.height,l=[{x:r-s/2,y:o+u/2},{x:r+s/2,y:o+u/2},{x:r-s/2,y:o-u/2},{x:r+s/2,y:o-u/2}],f=i.room.getOuterSurfaceList().map((function(t){return{x:t.origin[0],y:t.origin[1]}})),d=l.find((function(t){return!h.containsPoint(f,t)}));d||i.setPosition(r,o)}else i.setPosition(r,o);else i.setOrigin([n[0]-c.originX,n[1]-c.originY]),i.setTarget([n[0]-c.targetX,n[1]-c.targetY]);e.setPosition(r,o),e.$emit("update")},l=function t(){n.off("pointermove",u),window.removeEventListener("mouseup",t)};n.on("pointermove",u),window.addEventListener("mouseup",l)}}},rl),dl=w.Tool.READY,pl=Symbol("PickOrigin"),vl=Symbol("PickTarget"),ml={PICK_ORIGIN:pl,PICK_TARGET:vl},gl=function(t){Object(Qe["a"])(n,t);var e=Object(Ze["a"])(n);function n(){return Object(ht["a"])(this,n),e.apply(this,arguments)}return Object(ft["a"])(n)}(y.Proxy.ToolProvider(["open","pick","close"])),yl=w.Tool.define({},{open:[[dl,vt["e"],pl]],pick:[[pl,function(){var t=this.$plugin,e=this.$data.labelLine=this.$plugin.$createElement("LabelLine");e.setOrigin(t.$toGeometry.apply(t,Object(pt["a"])(t.$drawing.pointer))),t.$drawing.on("pointermove",this.$data.listener=function(n){var i=n.pointerX,r=n.pointerY;e.setTarget(t.$toGeometry(i,r))})},vl],[vl,function(){var t=this.$plugin;t.$drawing.off("pointermove",this.$data.listener),this.$emit("pick-target",this.$data.labelLine.$proxy)},dl]],close:[[pl,vt["e"],dl],[vl,function(){this.$data.labelLine.remove()},dl],[dl,vt["e"],dl]]},{proxy:y.Proxy.Creator(gl),data:function(){return{labelLine:null,listener:vt["e"]}},methods:{},reset:function(){this.close()}}),bl=w.Tool.READY,xl=Symbol("Pick"),$l={PICK:xl},wl=function(t){Object(Qe["a"])(n,t);var e=Object(Ze["a"])(n);function n(){return Object(ht["a"])(this,n),e.apply(this,arguments)}return Object(ft["a"])(n)}(y.Proxy.ToolProvider(["open","pick","close"])),kl=w.Tool.define({},{open:[[bl,vt["e"],xl]],pick:[[xl,function(){var t,e=this.$plugin.$drawing,n=this.$plugin.$createElement("LabelText");n.setPosition.apply(n,Object(pt["a"])((t=this.$plugin).$toGeometry.apply(t,Object(pt["a"])(e.pointer)))),this.$emit("pick",n.$proxy)},bl]],close:[[xl,vt["e"],bl],[bl,vt["e"],bl]]},{proxy:y.Proxy.Creator(wl),data:function(){return{}},methods:{},reset:function(){this.close()}}),Ol=w.Tool.READY,jl=Symbol("Pick"),Tl=Symbol("Show"),El=function(t){Object(Qe["a"])(n,t);var e=Object(Ze["a"])(n);function n(){return Object(ht["a"])(this,n),e.apply(this,arguments)}return Object(ft["a"])(n,[{key:"getElement",value:function(){return Yi(this).getElement()}}]),n}(y.Proxy.ToolProvider(["open","pick","drop","close"])),Sl=w.Tool.define(Object(dt["a"])({},Tl,(function(){this.updateState()})),{open:[[Ol,vt["e"],jl],[jl,vt["e"],jl]],pick:[[jl,function(){this.showTool()},Tl],[Tl,function(){this.$data.label!==this.$plugin.$drawing.focusing&&this.showTool()},Tl],[Ol,vt["e"],Ol]],drop:[[Tl,function(){this.hideTool()},jl],[jl,vt["e"],jl],[Ol,vt["e"],Ol]],close:[[Tl,function(){this.hideTool()},Ol],[jl,vt["e"],Ol],[Ol,vt["e"],Ol]]},{proxy:y.Proxy.Creator(El),data:function(t){var e=this,n=t.$createElement("OriginHandler"),i=t.$createElement("TargetHandler"),r=t.$createElement("LabelMover");return n.$on("update",(function(){e.updateState()})),i.$on("update",(function(){e.updateState()})),r.$on("update",(function(){e.updateState()})),{label:null,originHandler:n,targetHandler:i,labelMover:r}},methods:{showTool:function(){this.$data.label=this.$plugin.$drawing.focusing,this.$data.originHandler.show(),this.$data.targetHandler.show(),this.$data.labelMover.show()},hideTool:function(){this.$data.originHandler.hide(),this.$data.targetHandler.hide(),this.$data.labelMover.hide(),this.$data.label=null},updateState:function(){var t,e,n,i=this.$data.label,r=this.$plugin.$drawing.scale,o=i.$bounds,a=o.width,s=o.height,c=o.top,u=o.left,l=this.$plugin.$toGeometry(u+a/2,c+s/2);((t=this.$data.labelMover).updateState.apply(t,Object(pt["a"])(l).concat([a*r,s*r])),vt["c"].instanceOf(i,ol))?((e=this.$data.originHandler).setPosition.apply(e,Object(pt["a"])(i.origin)),(n=this.$data.targetHandler).setPosition.apply(n,Object(pt["a"])(i.target))):(this.$data.originHandler.hide(),this.$data.targetHandler.hide())},getElement:function(){return this.$data.label}},reset:function(){this.close()}}),Ll=k.define({id:"com.3dnest.spoke.label",namespace:"label",version:nl["a"],plugin:rl,elements:{LabelLine:sl,LabelText:ul,OriginHandler:ll,TargetHandler:hl,LabelMover:fl},tools:{LineLabeler:yl,TextLabeler:kl,LabelTransformer:Sl}}),Cl=n("7c09"),Pl=function(t){Object(Qe["a"])(n,t);var e=Object(Ze["a"])(n);function n(){return Object(ht["a"])(this,n),e.apply(this,arguments)}return Object(ft["a"])(n,[{key:"ViewAdjuster",get:function(){return Yi(this).$data.viewAdjuster}},{key:"backToCenter",value:function(t){return Yi(this).backToCenter(t)}}]),n}(y.Proxy.Plugin),Fl=w.define({proxy:y.Proxy.Creator(Pl),data:function(){return{viewAdjuster:null}},created:function(){this.$data.viewAdjuster=this.$createTool("ViewAdjuster")},methods:{backToCenter:function(t){var e,n=t.$bounds,i=n.top,r=n.right,o=n.bottom,a=n.left,s=this.$toGeometry(a,i),c=this.$toGeometry(r,o);(e=this.$data.viewAdjuster).backToCenter.apply(e,Object(pt["a"])(s).concat(Object(pt["a"])(c)))}}}),Al=w.Element.define({groupIndex:2e3,interative:!0,state:function(){return{origin:null,target:null}},getters:{origin:function(){return this.$state.origin},target:function(){return this.$state.target}},render:function(t){var e=this.$state,n=e.origin,i=e.target;if(n&&i){var r=this.$toCanvas.apply(this,Object(pt["a"])(n)),o=Object(ae["a"])(r,2),a=o[0],s=o[1],c=this.$toCanvas.apply(this,Object(pt["a"])(i)),u=Object(ae["a"])(c,2),l=u[0],h=u[1];t.lineStyle(1,4096759).beginFill(4096759,.2).drawRect(a,s,l-a,h-s).endFill()}},created:function(){},methods:{setOrigin:function(t,e){this.$state.origin=t&&e?[t,e]:null,this.$setDirty()},setTarget:function(t,e){this.$state.target=t&&e?[t,e]:null,this.$setDirty()},remove:function(){this.$destroy()}}},Fl),_l=5,Rl=w.Tool.READY,Dl=Symbol("Pick"),Nl=function(t){Object(Qe["a"])(n,t);var e=Object(Ze["a"])(n);function n(){return Object(ht["a"])(this,n),e.apply(this,arguments)}return Object(ft["a"])(n,[{key:"backToCenter",value:function(t,e,n,i){Yi(this).backToCenter(t,e,n,i)}}]),n}(y.Proxy.ToolProvider(["open","pick","close"])),Wl=w.Tool.define(Object(dt["a"])({},Rl,(function(){var t=this.$plugin;t.$drawing.off("pointerdown",this.$data.pointerdownListener),t.$drawing.off("pointermove",this.$data.pointermoveListener),t.$drawing.off("pointerup",this.$data.pointerupListener)})),{open:[[Rl,function(){var t=this.$plugin;t.$drawing.on("pointerdown",this.$data.pointerdownListener),t.$drawing.on("pointermove",this.$data.pointermoveListener),t.$drawing.on("pointerup",this.$data.pointerupListener)},Dl]],close:[[Dl,vt["e"],Rl],[Rl,vt["e"],Rl]]},{proxy:y.Proxy.Creator(Nl),data:function(t){var e=this,n=t.$drawing.scale,i=t.$createElement("Field"),r=function(e){if(0===e.button&&!i.origin){var n=e.pointerX,r=e.pointerY;i.setOrigin.apply(i,Object(pt["a"])(t.$toGeometry(n,r)))}},o=function(e){var n=e.pointerX,r=e.pointerY;i.setTarget.apply(i,Object(pt["a"])(t.$toGeometry(n,r)))},a=function(t){if(0===t.button){var r=i.origin,o=i.target,a=vt["d"].abs(r[0]-o[0])/n,s=vt["d"].abs(r[1]-o[1])/n;a>_l&&s>_l&&e.backToCenter.apply(e,Object(pt["a"])(r).concat(Object(pt["a"])(o))),i.setOrigin(null)}};return{field:i,pointerdownListener:r,pointermoveListener:o,pointerupListener:a}},methods:{backToCenter:function(t,e,n,i){var r=[(t+n)/2,(e+i)/2];this.areaZoomToView(t,e,n,i),this.pointBackToCenter.apply(this,r)},pointBackToCenter:function(t,e){var n=this.$plugin.$drawing,i=n.width,r=n.height,o=n.origin,a=this.$plugin.$toCanvas(t,e),s=i/2-a[0],c=r/2-a[1];this.$plugin.$drawing.setOrigin(o[0]+s,o[1]+c)},areaZoomToView:function(t,e,n,i){var r=this.$plugin.$drawing,o=r.width,a=r.height,s=r.scale,c=vt["d"].abs(t-n)/s,u=vt["d"].abs(e-i)/s,l=s*c/o,h=s*u/a;this.$plugin.$drawing.setScale(vt["d"].ceil(vt["d"].max(l,h)))}},reset:function(){this.close()}}),Ml=k.define({id:"com.3dnest.spoke.viewport",namespace:"viewport",version:Cl["a"],plugin:Fl,elements:{Field:Al},tools:{ViewAdjuster:Wl}}),Il=n("92e0"),Hl=function(t){Object(Qe["a"])(n,t);var e=Object(Ze["a"])(n);function n(){return Object(ht["a"])(this,n),e.apply(this,arguments)}return Object(ft["a"])(n,[{key:"changeTexture",value:function(t){return Yi(this).changeTexture(t)}},{key:"createArrow",value:function(t){return Yi(this).createArrow(t).$proxy}},{key:"getAllArrowList",value:function(){return Array.from(this.arrows())}},{key:"arrows",value:regeneratorRuntime.mark((function t(){var e,n,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=Object(Te["a"])(Yi(this).arrows()),t.prev=1,e.s();case 3:if((n=e.n()).done){t.next=9;break}return i=n.value,t.next=7,i.$proxy;case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](1),e.e(t.t0);case 14:return t.prev=14,e.f(),t.finish(14);case 17:case"end":return t.stop()}}),t,this,[[1,11,14,17]])}))}]),n}(y.Proxy.Plugin),Bl=y.Options.define,zl=Bl({},{arrow:Bl({width:30,height:30})}),Vl=w.define({options:zl,proxy:y.Proxy.Creator(Hl),data:function(){return{arrowTexture:null,matrix:null}},methods:{changeTexture:function(t){var e=this;return Object(or["a"])(regeneratorRuntime.mark((function n(){var i,r,o,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,fn.Texture.fromURL(t);case 2:i=n.sent,r=e.$options.arrow,o=r.width,a=r.height,e.$data.arrowTexture=i,e.$data.matrix=new fn.Matrix(o/i.width,0,0,a/i.height,0,0);case 6:case"end":return n.stop()}}),n)})))()},createArrow:function(t){return this.$createElement("Arrow",t)},arrows:regeneratorRuntime.mark((function t(){var e,n,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=Object(Te["a"])(this.$elements("Arrow")),t.prev=1,e.s();case 3:if((n=e.n()).done){t.next=9;break}return i=n.value,t.next=7,i;case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](1),e.e(t.t0);case 14:return t.prev=14,e.f(),t.finish(14);case 17:case"end":return t.stop()}}),t,this,[[1,11,14,17]])}))}}),Ul=function(t){Object(Qe["a"])(n,t);var e=Object(Ze["a"])(n);function n(){return Object(ht["a"])(this,n),e.apply(this,arguments)}return Object(ft["a"])(n,[{key:"x",get:function(){return Yi(this).x}},{key:"y",get:function(){return Yi(this).y}},{key:"rotation",get:function(){return Yi(this).rotation}},{key:"hollow",get:function(){return Yi(this).hollow}},{key:"show",value:function(){Yi(this).$show()}},{key:"hide",value:function(){Yi(this).$hide()}},{key:"remove",value:function(){Yi(this).remove()}}]),n}(y.Proxy.Element),Yl=1e3,Gl=w.Element.define({proxy:y.Proxy.Creator(Ul),groupIndex:1500,state:function(){return{x:0,y:0,rotation:0,hollow:null,listener:vt["e"]}},getters:{x:function(){return this.$state.x},y:function(){return this.$state.y},rotation:function(){return this.$state.rotation},hollow:function(){return this.$state.hollow}},render:function(t){var e=this.$plugin.$options.arrow,n=e.width,i=e.height,r=this.$data,o=r.arrowTexture,a=r.matrix,s=this.$state.hollow;this.$state.rotation=s.surface.room?s.rotation:s.rotation+Math.PI;var u=c.rotate(s.x,s.y+Yl,-this.$state.rotation+Math.PI,s.x,s.y),l=Object(ae["a"])(u,2);this.$state.x=l[0],this.$state.y=l[1],o?(t.beginTextureFill({texture:o,matrix:a}).drawRect(0,0,n,i),t.pivot.x=n/2,t.pivot.y=i/2):t.beginFill(3355443).moveTo(0,-10).lineTo(10,10).lineTo(-10,10).lineTo(0,-10).endFill();var h=this.$toCanvas(this.$state.x,this.$state.y),f=Object(ae["a"])(h,2);t.x=f[0],t.y=f[1],t.rotation=this.$state.rotation},created:function(t){var e=this;this.$state.hollow=t,t.on("dirty",this.$state.listener=function(){e.$setDirty()})},destroy:function(){this.$state.hollow.destroyed||this.$state.hollow.off("dirty",this.$state.listener)},methods:{remove:function(){this.$destroy()}}},Vl),Xl=k.define({id:"com.3dnest.spoke.entrance",namespace:"entrance",version:Il["a"],plugin:Vl,elements:{Arrow:Gl}}),Kl=function(t){t.canvasElement.addEventListener("contextmenu",ln["b"].preventDefault)},Jl=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;t.on("pointerdown",(function(n){if(n.button===e){var i=Object(ae["a"])(t.origin,2),r=i[0],o=i[1],a=n.pointerX,s=n.pointerY,c=function(e){var n=e.pointerX,i=e.pointerY;t.setOrigin(r+n-a,o+i-s)},u=function e(){t.off("pointermove",c),ln["a"].removeEventListener(ln["c"].WINDOW,"mouseup",e)};t.on("pointermove",c),ln["a"].addEventListener(ln["c"].WINDOW,"mouseup",u)}}))},ql=function(t){ln["a"].addEventListener(t.canvasElement,"wheel",(function(e){e.deltaY>0?t.setScaleInMode(t.scale+1,1):t.setScaleInMode(t.scale-1,1)}))},Ql=function(t,e){t.structure.on("room-created",(function(t){t.setFloor(e)}))},Zl=function(t){t.compass.element.on("pointerdown",(function(e){th(t,e)}))},th=function(t,e){var n=t.compass.element,i=n.x,r=n.y,o=n.rotation,s=e.pointerX,c=e.pointerY,u=vt["d"].atan2.apply(vt["d"],Object(pt["a"])(a.from(i,r,s,c))),l=function(t){var e=vt["d"].atan2.apply(vt["d"],Object(pt["a"])(a.from(i,r,t.pointerX,t.pointerY))),s=(o-e+u)%(2*vt["d"].PI);n.setRotation(s)},h=function e(){t.off("pointermove",l),window.removeEventListener("mouseup",e)};t.on("pointermove",l),window.addEventListener("mouseup",h)},eh=Symbol(),nh=Symbol(),ih=Symbol(),rh=Symbol(),oh=Symbol(),ah=Symbol(),sh=Symbol(),ch=(vu={},Object(dt["a"])(vu,eh,{open:function(t){t.hammer.adjuster.open(),t.common.transformer.open(),t.bricklayer.Mover.open(),t.bricklayer.Extender.open(),t.label.LabelTransformer.open()},close:function(t){t.hammer.adjuster.close(),t.common.transformer.close(),t.bricklayer.Mover.close(),t.bricklayer.Extender.close(),t.label.LabelTransformer.close()}}),Object(dt["a"])(vu,nh,{open:function(t){t.common.selector.open()},close:function(t){t.common.selector.close()}}),Object(dt["a"])(vu,ih,{open:function(t){t.bricklayer.Builder.pick()},close:function(t){t.bricklayer.Builder.drop().drop()}}),Object(dt["a"])(vu,rh,{open:function(t){t.bricklayer.Spliter.open()},close:function(t){t.bricklayer.Spliter.close()}}),Object(dt["a"])(vu,oh,{open:function(t){t.bricklayer.Chamber.pick()},close:function(t){t.bricklayer.Chamber.drop().drop()}}),Object(dt["a"])(vu,ah,{open:function(t){t.viewport.ViewAdjuster.open()},close:function(t){t.viewport.ViewAdjuster.close()}}),Object(dt["a"])(vu,sh,{open:function(t){t.label.open()},close:function(t){t.label.close()}}),vu),uh=function(){function t(e){Object(ht["a"])(this,t),vt["c"].instanceOf(e,Hi)||vt["c"].Throw.TypeError("The `drawing` MUST be a DrawingProxy."),this.drawing=e,this.current=null,this.activeDefault()}return Object(ft["a"])(t,[{key:"active",value:function(t){this.current!==t&&(this.current&&ch[this.current].close(this.drawing),ch[t].open(this.drawing),this.current=t)}},{key:"activeDefault",value:function(){this.active(nh)}},{key:"deactiveAllTool",value:function(){this.current&&(ch[this.current].close(this.drawing),this.current=null)}}]),t}(),lh=new WeakMap,hh=function(t){return lh.get(t)},fh=function(t){Object(Qe["a"])(n,t);var e=Object(Ze["a"])(n);function n(t){var i;return Object(ht["a"])(this,n),i=e.call(this),lh.set(Object(un["a"])(i),new uh(t)),i}return Object(ft["a"])(n,[{key:"activated",get:function(){return hh(this).current}},{key:"symbol",get:function(){return G}},{key:"openDefault",value:function(){hh(this).activeDefault(),this.emit("open","selector")}},{key:"closeAllTool",value:function(){hh(this).deactiveAllTool(),this.emit("open",null)}},{key:"openTransformer",value:function(){hh(this).active(eh),this.emit("open","transformer")}},{key:"openSelector",value:function(){hh(this).active(nh),this.emit("open","selector")}},{key:"openWallBuilder",value:function(){hh(this).active(ih),this.emit("open","builder")}},{key:"openChamber",value:function(){hh(this).active(oh),this.emit("open","chamber")}},{key:"openSpliter",value:function(){hh(this).active(rh),this.emit("open","spliter")}},{key:"openViewport",value:function(){hh(this).active(ah),this.emit("open","viewport")}},{key:"openLabeler",value:function(){hh(this).active(sh),this.emit("open","labeler")}}]),n}(hn["a"].Emitter),dh=function(t){Object(Qe["a"])(n,t);var e=Object(Ze["a"])(n);function n(t){var i,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(ht["a"])(this,n),i=e.call(this),i.drawing=t,i.options=r,i}return Object(ft["a"])(n,[{key:"execute",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=this.drawing.structure.getAllCornerList(),i=this.drawing.structure.getAllWallList(),r=this.drawing.structure.getAllRoomList(),o=this.drawing.windoor.getAllHollowList(),a=this.drawing.furniture.getAllStuffList(),s=this.drawing.negative.getAllBitmapList(),c=this.drawing.label.getAllLabelTextList(),u=this.drawing.label.getAllLabelLineList();this.options.corners&&this.options.corners(e,n);var l=n.map((function(n){var i=[n.x,n.y];return t.options.corner&&t.options.corner(e,n),i}));this.options.walls&&this.options.walls(e,i);var h=i.map((function(i){var r=[];return r.push(n.indexOf(i.thisSurface.corner)),r.push(n.indexOf(i.thatSurface.corner)),r.push(i.thickness),t.options.wall&&t.options.wall(e,i),r}));this.options.rooms&&this.options.rooms(e,r);var f=r.map((function(i){var r=i.getOuterSurfaceList().map((function(t){return n.indexOf(t.corner)})),o=c.find((function(t){return t.room===i})),a=o.text,s={cornerList:r,label:{text:a.includes("面积")?a.slice(0,a.indexOf("\n")):a,position:[o.x,o.y]},floor:i.floor};return t.options.room&&t.options.room(e,i),s}));this.options.hollows&&this.options.hollows(e,o);var d=o.map((function(i){var r=i.materialName,o=i.width,a=i.fliped,s=i.offset,c=i.surface,u="virtual"===c.name,l={materialName:r,width:o,fliped:a,offset:s,isVirtual:u,surface:u?[c.corner.x,c.corner.y]:[n.indexOf(c.corner),n.indexOf(c.back.corner)]};return t.options.hollow&&t.options.hollow(e,i),l}));this.options.stuffs&&this.options.stuffs(e,a);var p=a.map((function(n){var i=n.fill,r=n.x,o=n.y,a=n.width,s=n.height,c={fill:i,x:r,y:o,width:a,height:s};return t.options.stuff&&t.options.stuff(e,n),c}));this.options.bitmaps&&this.options.bitmaps(e,s);var v=s.map((function(n){var i=n.url,r=n.width,o=n.height,a=n.x,s=n.y,c=n.rotation,u={url:i,width:r,height:o,x:a,y:s,rotation:c};return t.options.bitmap&&t.options.bitmap(e,n),u}));this.options.labelTexts&&this.options.labelTexts(e,c);var m=c.filter((function(t){return!t.room})).map((function(n){var i=n.x,r=n.y,o=n.text,a={x:i,y:r,text:o};return t.options.labelText&&t.options.labelText(e,n),a}));this.options.labelLines&&this.options.labelLines(e,u);var g=u.map((function(n){var i=n.origin,r=n.target,o=n.text,a={origin:i,target:r,text:o};return t.options.labelLine&&t.oprions.labelLine(e,n),a}));return{cornerList:l,wallList:h,roomList:f,hollowList:d,stuffList:p,bitmapList:v,labelTextList:m,labelLineList:g}}}]),n}(hn["a"].Emitter),ph=function(t){Object(Qe["a"])(n,t);var e=Object(Ze["a"])(n);function n(t){var i,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(ht["a"])(this,n),i=e.call(this),i.drawing=t,i.options=r,i}return Object(ft["a"])(n,[{key:"execute",value:function(t,e){var n=this,i=t.cornerList,r=t.wallList,o=t.roomList,a=t.hollowList,s=t.stuffList,c=t.bitmapList,u=t.labelTextList,l=t.labelLineList;this.options.corners&&this.options.corners(e,i);var h=i.map((function(t,i){var r=n.drawing.structure.createCorner(t[0],t[1]);return n.options.corner&&n.options.corner(e,r,i),r}));r&&r.length&&(this.options.walls&&this.options.walls(e,r),r.forEach((function(t,i){var r=n.drawing.structure.createWall(h[t[0]],h[t[1]]);r.thickness=t[2],n.options.wall&&n.options.wall(e,r,i)}))),o&&o.length&&setTimeout((function(){n.options.rooms&&n.options.rooms(e,o);var t=n.drawing.structure.getAllRoomList(),i=n.drawing.label.getAllLabelTextList();o.forEach((function(r,o){var a=r.cornerList.map((function(t){return h[t]})),s=t.find((function(t){var e=t.getOuterSurfaceList().map((function(t){return t.corner}));return e.length===a.length&&e.filter((function(t){return a.includes(t)})).length===e.length}));s.setFloor(r.floor);var c=i.find((function(t){return t.room===s})),u=c.text,l=u.includes("面积")?"".concat(r.label.text).concat(u.slice(u.indexOf("\n"))):r.label.text;c.setText(l),c.setPosition.apply(c,Object(pt["a"])(r.label.position)),n.options.room&&n.options.room(e,s,o)}))})),a&&a.length&&(this.options.hollows&&this.options.hollows(e,a),a.forEach((function(t,i){var r=null;if(t.isVirtual){var o=Object(ae["a"])(t.surface,2),a=o[0],s=o[1];r=n.drawing.windoor.createHollow(t.materialName),r.virtualSurface.setCorner(a,s),r.virtualSurface.setBackCorner(a+10,s)}else{var c=h[t.surface[0]],u=h[t.surface[1]],l=c.getWallByToCorner(u);r=n.drawing.windoor.createHollow(t.materialName,l.thisSurface.corner===c?l.thisSurface:l.thatSurface,t.offset)}r.setWidth(t.width),r.fliped!==t.fliped&&r.flip(),n.options.hollow&&n.options.hollow(e,r,i)}))),s&&s.length&&(this.options.stuffs&&this.options.stuffs(e,s),s.forEach((function(t,i){var r=t.fill,o=t.x,a=t.y,s=t.width,c=t.height,u=n.drawing.furniture.createStuff(r,o,a,s,c);n.options.stuff&&n.options.stuff(e,u,i)}))),c&&c.length&&(this.options.bitmaps&&this.options.bitmaps(e,c),c.forEach((function(t,i){var r=t.url,o=t.width,a=t.height,s=t.x,c=t.y,u=t.rotation;n.drawing.negative.createBitmap(r,o,a).then((function(t){t.setPosition(s,c),t.setRotation(u),n.options.bitmap&&n.options.bitmap(e,t,i)}))}))),u&&u.length&&(this.options.labelTexts&&this.options.labelTexts(e,u),u.forEach((function(t,i){var r=t.x,o=t.y,a=t.text,s=n.drawing.label.createLabelText(r,o,a);n.options.labelText&&n.options.labelText(e,s,i)}))),l&&l.length&&(this.options.labelLines&&this.options.labelLines(e,l),l.forEach((function(t,i){var r=t.origin,o=t.target,a=t.text,s=n.drawing.label.createLabelLine(r,o,a);n.options.labelLine&&n.oprions.labelLine(e,s,i)})))}}]),n}(hn["a"].Emitter),vh=n("bf64"),mh={w:[0,-1],a:[-1,0],s:[0,1],d:[1,0]},gh=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;window.addEventListener("keydown",(function(n){var i=Object(ae["a"])(t.origin,2),r=i[0],o=i[1],a=mh[n.key];a&&t.setOrigin(r+e*a[0],o+e*a[1])}))},yh=function(t){Object(Qe["a"])(n,t);var e=Object(Ze["a"])(n);function n(t){var i;return Object(ht["a"])(this,n),i=e.call(this),i.surface=t,t.on("dirty",(function(){return i.emit("change")})),t.on("destroy",(function(){return i.emit("destroy")})),i}return Object(ft["a"])(n,[{key:"from",get:function(){return this.surface.origin}},{key:"to",get:function(){return this.surface.target}}]),n}(B.BaseAdaptor);function bh(t){var e=t.structure,n=t.measure;n.setFontsizer((function(t){return 200/t})),n.setTextOffsetYModifier((function(t){return-2*t/3})),e.on("surface-created",(function(t){n.createDimension(new yh(t))}))}var xh=bh,$h=function(){function t(e,n,i){Object(ht["a"])(this,t),vt["c"].instanceOf(e,Hi)||vt["c"].Throw.TypeError("The `drawing` MUST be a DrawingProxy."),vt["c"].instanceOf(n,dh)||vt["c"].Throw.TypeError("The `serializer` MUST be a instance of Serializer."),vt["c"].instanceOf(i,ph)||vt["c"].Throw.TypeError("The `deserializer` MUST be a instance of Deserializer."),this.drawing=e,this.serializer=n,this.deserializer=i}return Object(ft["a"])(t,[{key:"changeFloor",value:function(t,e,n){var i=this.serializer.execute(n);return wh(this.drawing),this.deserializer.execute(t,e),i}}]),t}(),wh=function(t){var e=t.windoor.getAllHollowList(),n=t.furniture.getAllStuffList(),i=t.structure.getAllCornerList(),r=t.negative.getAllBitmapList(),o=t.label.getAllLabelTextList(),a=t.label.getAllLabelLineList();e.forEach((function(t){return t.remove()})),n.forEach((function(t){return t.remove()})),i.forEach((function(t){return t.remove()})),r.forEach((function(t){return t.remove()})),o.filter((function(t){return!t.room})).forEach((function(t){return t.remove()})),a.forEach((function(t){return t.remove()}))},kh=function(t,e,n,i,r){var o=[[t-n/2,e+i/2],[t+n/2,e+i/2],[t+n/2,e-i/2],[t-n/2,e-i/2]];return o.map((function(n){return c.rotate.apply(c,Object(pt["a"])(n).concat([r,t,e])).slice(0)}))},Oh=function(t,e,n,i,r){var o=kh(t,e,n,i,r);return[[o[0],o[1]],[o[1],o[2]],[o[2],o[3]],[o[3],o[0]]]},jh=function(t,e,n,i,r,o){return c.project.apply(c,[t,e].concat(Object(pt["a"])(s.fromSegment(n,i,r,o))))},Th=function(t,e,n){var i=null,r=-1;return t.forEach((function(t){var o=c.distanceToSegment.apply(c,[e,n].concat(Object(pt["a"])(t.origin),Object(pt["a"])(t.target)));(!i||o<r)&&(i=t,r=o)})),i},Eh=function(t,e,n,i,r){var o=t.map((function(t){return c.distanceToSegment.apply(c,Object(pt["a"])(t).concat([e,n,i,r]))}));return Math.max.apply(Math,Object(pt["a"])(o))},Sh=[{proxy:T.StuffProxy,bounds:"$bounds",remove:"remove"},{proxy:j.HollowProxy,bounds:"$bounds",remove:"remove"},{proxy:U.LabelTextProxy,bounds:"$bounds",remove:"remove"},{proxy:U.LabelLineProxy,bounds:"$bounds",remove:"remove"},{proxy:E.CornerProxy,bounds:"$bounds",remove:"remove"},{proxy:E.WallProxy,bounds:"$bounds",remove:"remove"},{proxy:E.RoomProxy,bounds:"$bounds"},{proxy:H.BitmapProxy,bounds:"$bounds",remove:"remove"}],Lh={getPosition:function(t){return[t.x,t.y]},setPosition:function(t,e,n){t.setPosition(e,n)},getWidth:function(t){return t.width},setWidth:function(t,e){t.setWidth(e)},getHeight:function(t){return t.height},setHeight:function(t,e){t.setHeight(e)},getRotation:function(t){return t.rotation},setRotation:function(t,e){t.setRotation(e)}},Ch=function(t){return function(e,n){var i=n.$state,r=i.x,o=i.y,s=e.x,u=e.y,h=t.structure.getAllWallList(),f=h.map((function(t){return t.thisSurface})),d=h.map((function(t){return t.thatSurface})),p=f.concat(d),v=kh(r,o,e.width,e.height,e.rotation),m=Oh(r,o,e.width,e.height,e.rotation),g=p.filter((function(t){return m.find((function(e){return l.intersectSegment.apply(l,Object(pt["a"])(e[0]).concat(Object(pt["a"])(e[1]),Object(pt["a"])(t.origin),Object(pt["a"])(t.target)))}))}));if(g.length){if(g.length>2)return!1;if(2===g.length&&g[0].back!==g[1])return!1;var y=Th(g,s,u),b=c.toLeftOfSegment.apply(c,[s,u].concat(Object(pt["a"])(y.origin),Object(pt["a"])(y.target))),x=c.toLeftOfSegment.apply(c,[r,o].concat(Object(pt["a"])(y.origin),Object(pt["a"])(y.target))),$=v.filter((function(t){return c.toLeftOfSegment.apply(c,Object(pt["a"])(t).concat(Object(pt["a"])(y.origin),Object(pt["a"])(y.target)))!==b})),w=Eh.apply(void 0,[$].concat(Object(pt["a"])(y.origin),Object(pt["a"])(y.target))),k=jh.apply(void 0,[r,o].concat(Object(pt["a"])(y.origin),Object(pt["a"])(y.target))),O=b===x?a.fromBothPoint.apply(a,Object(pt["a"])(k).concat([r,o])):a.fromBothPoint.apply(a,[r,o].concat(Object(pt["a"])(k))),j=Object(ae["a"])(O,2),T=j[0],E=j[1],S=a.normalize(0===a.length(T,E)?T+1:T,E),L=Object(ae["a"])(S,2),C=L[0],P=L[1],F=c.translate.apply(c,[r,o].concat(Object(pt["a"])(a.multiply(C,P,w+1)))),A=Object(ae["a"])(F,2),_=A[0],R=A[1],D=Oh(_,R,e.width,e.height,e.rotation),N=D.find((function(t){var e=f.find((function(e){return l.intersectSegment.apply(l,Object(pt["a"])(t[0]).concat(Object(pt["a"])(t[1]),Object(pt["a"])(e.origin),Object(pt["a"])(e.target)))})),n=d.find((function(e){return l.intersectSegment.apply(l,Object(pt["a"])(t[0]).concat(Object(pt["a"])(t[1]),Object(pt["a"])(e.origin),Object(pt["a"])(e.target)))}));return e||n}));return N?null:[_,R]}return!0}},Ph=function(t){t.common.addTransformerAdapter(T.StuffProxy,Object.assign({adjustVerify:Ch(t),setRoom:function(t,e){t.setRoom(e)}},Lh)),t.common.addTransformerAdapter(H.BitmapProxy,Lh)},Fh=function(t){var e,n=Object(Te["a"])(Sh);try{var i=function(){var n=e.value;t.common.addSelectorAdapter(n.proxy,{getBounds:function(t){return t[n.bounds]},remove:function(e){n.remove&&(n.proxy===U.LabelTextProxy&&e.room||(t.common.selector.drop(),e[n.remove]()))}})};for(n.s();!(e=n.n()).done;)i()}catch(r){n.e(r)}finally{n.f()}},Ah=Math.PI,_h=60,Rh=15,Dh=10,Nh={stateless:{line:0,arcLine:14145753,fill:16777215,windowFill:13421772},hover:{line:8053503,arcLine:15464441,fill:16777215,windowFill:13421772},select:{line:4096759,arcLine:15068665,fill:16777215,windowFill:13421772}},Wh=function(t){var e=t.hover,n=t.focus,i=t.select;return i||n?Nh.select:e?Nh.hover:Nh.stateless},Mh={width:800,render:function(t,e){var n=e.width,i=e.height,r=e.fliped,o=e.scale,a=r?1:0,s=Rh/o,c=_h/o,u=Wh(e);return t.lineStyle(s,u.arcLine).beginFill(u.fill,.1).arc(n*a,i/2,n,-Ah/2*a-Ah/2,-Ah*a/2).lineTo(n*a,i/2).lineTo(0,i/2-n+a*n).endFill().beginFill(u.fill).lineStyle(s,u.fill).drawRect(0,0,n,i).lineStyle(s,u.line).moveTo(0,0).lineTo(0,i).moveTo(n,0).lineTo(n,i).lineStyle(s,u.line).drawRect((n-c)*a,i/2,c,-n),t.pivot.x=n/2,t.pivot.y=i/2,t}},Ih={width:1500,render:function(t,e){var n=e.width,i=e.height,r=e.scale,o=Rh/r,a=_h/r,s=Wh(e);return t.lineStyle(o,s.arcLine).beginFill(s.fill,.1).arc(0,i/2,n/2,-Ah/2,0).lineTo(0,i/2).lineTo(0,(i-n)/2).endFill().beginFill(s.fill,.1).lineStyle(o,s.arcLine).arc(n,i/2,n/2,Ah,-Ah/2).lineTo(n,i/2).lineTo(n/2,i/2).endFill().beginFill(s.fill).lineStyle(o,s.fill).drawRect(0,0,n,i).lineStyle(o,s.line).moveTo(0,0).lineTo(0,i).moveTo(n,0).lineTo(n,i).drawRect(0,i/2,a,-n/2).drawRect(n,i/2,-a,-n/2),t.pivot.x=n/2,t.pivot.y=i/2,t}},Hh={width:1500,render:function(t,e){var n=e.width,i=e.height,r=e.scale,o=e.fliped,a=o?-1:1,s=Rh/r,c=Dh/r,u=Wh(e);return t.lineStyle(s,u.line).beginFill(u.fill).drawRect(0,0,n,i).drawRect(0+s+c,i/2,2*n/3,i/4*a).drawRect(n-s-c,i/2,-2*n/3,-i/4*a),t.pivot.x=n/2,t.pivot.y=i/2,t}},Bh={width:1450,render:function(t,e){var n=e.width,i=e.height,r=e.fliped,o=e.scale,a=r?1:0,s=Rh/o,c=Wh(e);return t.lineStyle(s,c.line).beginFill(c.fill).drawRect(0,0,n,i).moveTo(0,i/3).lineTo(n,i/3).moveTo(0,2*i/3).lineTo(n,2*i/3).moveTo(n/4+a*n/2,i/3).lineTo(n/4+a*n/2,2*i/3).endFill(),t.pivot.x=n/2,t.pivot.y=i/2,t}},zh={width:2e3,render:function(t,e){var n=e.width,i=e.height,r=e.scale,o=Rh/r,a=Wh(e);return t.lineStyle(o,a.fill).beginFill(a.fill).drawRect(0,0,n,i).endFill().lineStyle(o,a.line).drawRect(0,0,n,i/3).drawRect(0,2*i/3,n,i/3),t.pivot.x=n/2,t.pivot.y=i/2,t}},Vh={width:800,render:function(t,e){var n=e.width,i=e.height,r=e.scale,o=Rh/r,a=Wh(e);return t.lineStyle(o,a.line).beginFill(a.fill).drawRect(0,0,n,i).moveTo(0,i/2).lineTo(n,i/2).endFill(),t.pivot.x=n/2,t.pivot.y=i/2,t}},Uh={width:1500,render:function(t,e){var n=e.width,i=e.scale,r=e.sillThickness,o=void 0===r?500/i:r,a=e.height,s=Rh/i,c=a,u=Wh(e);return t.lineStyle(s,u.line).beginFill(u.windowFill).drawRect(0,-o,n,o).endFill().beginFill(u.fill).moveTo(0,-a).lineTo(0,-o).lineTo(n,-o).lineTo(n,-a).lineTo(n+c,-a).lineTo(n+c,-(o+c)).lineTo(-c,-(o+c)).lineTo(-c,-a).lineTo(0,-a).endFill().moveTo(-c/2,-a).lineTo(-c/2,-(o+c/2)).lineTo(n+c/2,-(o+c/2)).lineTo(n+c/2,-a),t.pivot.x=n/2,t.pivot.y=-a/2,t}},Yh={width:1500,render:function(t,e){var n=e.width,i=e.height,r=e.scale,o=Rh/r,a=Wh(e);return t.lineStyle(o,a.line).beginFill(a.fill).drawRect(0,0,n,i).endFill().moveTo(0,i/2).lineTo(n,i/2).moveTo(0,i/3).lineTo(n,i/3).moveTo(0,2*i/3).lineTo(n,2*i/3).moveTo(n/2,i/3).lineTo(n/2,2*i/3),t.pivot.x=n/2,t.pivot.y=i/2,t}},Gh={render:function(t,e){var n=e.leftWidth,i=e.rightWidth,r=e.leftWallThickness,o=e.rightWallThickness,a=e.scale,s=Rh/a,c=Wh(e);return t.lineStyle(s,c.line).beginFill(c.fill).moveTo(0,0).lineTo(i,0).lineTo(i,o).lineTo(r,o).lineTo(r,n).lineTo(0,n).lineTo(0,0).endFill().moveTo(r/2,n).lineTo(r/2,o/2).lineTo(i,o/2),t.pivot.x=i/2,t.pivot.y=o/2,t}},Xh={render:function(t,e){var n=e.leftWidth,i=e.centerWidtn,r=e.rightWidth,o=e.leftWallThickness,a=e.centerWallThickness,s=e.rightWallThickness,c=e.scale,u=Rh/c,l=Wh(e);return t.lineStyle(u,l.line).beginFill(l.fill).moveTo(0,0).lineTo(i,0).lineTo(i,r).lineTo(i-s,r).lineTo(i-s,a).lineTo(o,a).lineTo(o,n).lineTo(0,n).lineTo(0,0).endFill().moveTo(o/2,n).lineTo(o/2,a/2).lineTo(i-s/2,a/2).lineTo(i-s/2,r),t.pivot.x=i/2,t.pivot.y=a/2,t}},Kh={render:function(t,e){var n=e.leftWidth,i=e.rightWidth,r=e.leftWindowThickness,o=e.rightWindowThickness,a=e.leftWallThickness,s=e.rightWallThickness,c=e.scale,u=Rh/c,l=Wh(e);return t.lineStyle(u,l.line).beginFill(l.windowFill).moveTo(a,s).lineTo(i,s).lineTo(i,s-o).lineTo(a-r,s-o).lineTo(a-r,n).lineTo(a,n).lineTo(a,s).endFill().beginFill(l.fill).moveTo(a-r,s-o).lineTo(i,s-o).lineTo(i,0).lineTo(i+s,0).lineTo(i+s,-o).lineTo(-r,-o).lineTo(-r,n+a).lineTo(0,n+a).lineTo(0,n).lineTo(a-r,n).lineTo(a-r,s-o).endFill().moveTo(0,n+a/2).lineTo(a/2-r,n+a/2).lineTo(a/2-r,s/2-o).lineTo(i+s/2,s/2-o).lineTo(i+s/2,0),t.pivot.x=i/2,t.pivot.y=s/2,t}},Jh={render:function(t,e){var n=e.leftWidth,i=e.centerWidtn,r=e.rightWidth,o=e.leftWindowThinkness,a=e.centerWindowThinkness,s=e.rightWindowThinkness,c=e.leftWallThickness,u=e.centerWallThickness,l=e.rightWallThickness,h=e.scale,f=Rh/h,d=Wh(e);return t.lineStyle(f,d.line).beginFill(d.windowFill).moveTo(c,u).lineTo(i-l,u).lineTo(i-l,r).lineTo(i-l+s,r).lineTo(i-l+s,u-a).lineTo(c-o,u-a).lineTo(c-o,n).lineTo(c,n).lineTo(c,u).endFill().beginFill(d.fill).moveTo(c-o,u-a).lineTo(i+s-l,u-a).lineTo(i+s-l,r).lineTo(i,r).lineTo(i,r+l).lineTo(i+s,r+l).lineTo(i+s,-a).lineTo(-o,-a).lineTo(-o,n+c).lineTo(0,n+c).lineTo(0,n).lineTo(c-o,n).lineTo(c-o,u-a).endFill().moveTo(0,n+c/2).lineTo(c/2-o,n+c/2).lineTo(c/2-o,u/2-a).lineTo(i+s-l/2,u/2-a).lineTo(i+s-l/2,r+l/2).lineTo(i,r+l/2),t.pivot.x=i/2,t.pivot.y=u/2,t}},qh=[{id:"singleDoor",material:nt.SingleDoor},{id:"doubleDoor",material:nt.DoubleDoor},{id:"slidingDoor",material:nt.SlidingDoor},{id:"parentDoor",material:nt.ParentDoor},{id:"bealock",material:nt.Bealock},{id:"basicWindow",material:it.BasicWindow},{id:"boilerWindow",material:it.BoilerWindow},{id:"floorWindow",material:it.FloorWindow}],Qh=function(t,e){return j.register(t,e)},Zh=function(t){var e,n=Object(Te["a"])(t);try{for(n.s();!(e=n.n()).done;){var i=e.value;j.register(i.id,i.material)}}catch(r){n.e(r)}finally{n.f()}return t.map((function(t){return t.id}))},tf=function(){Zh(qh)},ef=function(){return j.getAllNameList()},nf=function(t,e){return T.registerUrl(t,e)},rf=function(t){var e=t.map((function(t){return T.registerUrl(t.id,t.url)}));return Promise.all(e)},of=function(t,e){return E.registerFloor(t,e)},af=function(t){var e=t.map((function(t){return E.registerFloor(t.id,t.url)}));return Promise.all(e)};[os,rr,vr,bc,nu,Ru,yu,Ec,Fc,el,Ll,Ml,Xl].forEach((function(t){return ui(t)}));var sf,cf,uf,lf,hf=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("b-modal",{ref:"serialize-modal",attrs:{size:"lg","hide-footer":"",title:"序列化结果"}},[n("div",{staticClass:"d-block text-center"},[n("b-form-textarea",{attrs:{id:"textarea",value:t.floorListString,readonly:"","no-resize":"",size:"sm",rows:"20"}}),n("b-button",{staticClass:"mt-3",attrs:{variant:"info",block:""},on:{click:t.download}},[t._v("下载 json")])],1)]),n("b-modal",{ref:"deserialize-modal",attrs:{size:"lg","hide-footer":"",title:"反序列化"}},[n("div",{staticClass:"d-block text-center"},[n("b-form-textarea",{attrs:{id:"textarea","no-resize":"",size:"sm",rows:"20"},model:{value:t.floorData,callback:function(e){t.floorData=e},expression:"floorData"}}),n("b-button",{staticClass:"mt-3",attrs:{variant:"info",block:""},on:{click:t.upload}},[t._v("上传 json")]),n("b-button",{staticClass:"mt-1",attrs:{variant:"info",block:""},on:{click:t.deserialize}},[t._v("反序列化")])],1)]),n("input",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"file_input",attrs:{type:"file",accept:".json"},on:{change:t.onFileChange}})],1)},ff=[],df=(n("e9c4"),n("2b3d"),n("9861"),function(t){return 10*t}),pf={data:function(){return{floor:this.$spoke.getFloor(),floorListString:"",floorData:""}},mounted:function(){this.$pMenu.Bar.mount(this.$el),this.updateMenu()},computed:{menuBarOptions:function(){return[{title:"文件(&F)",menu:this.menuBarFileMenuOptions},{title:"编辑(&E)",menu:this.menuBarEditMenuOptions},{title:"户型图(&D)",menu:this.menuBarDrawingMenuOptions},{title:"视图(&V)",menu:this.menuBarViewMenuOptions},{title:"帮助(&H)",menu:this.menuBarHelpMenuOptions}]},menuBarFileMenuOptions:function(){var t=this;return[[{label:"新建(&N)"},{label:"新建窗口(&W)"}],[{label:"打开(&O)",click:function(){t.open()}},{label:"保存(&S)",click:function(){t.save()}}],[{label:"退出(&X)",click:function(){window.location.reload()}}]]},menuBarEditMenuOptions:function(){var t=this;return[[{label:"一键清空",click:function(){var e,n=t.$spoke.getEditor("primary"),i=n.drawing,r=Object(Te["a"])(i.windoor.hollows());try{for(r.s();!(e=r.n()).done;){var o=e.value;o.remove()}}catch($){r.e($)}finally{r.f()}var a,s=Object(Te["a"])(i.furniture.stuffs());try{for(s.s();!(a=s.n()).done;){var c=a.value;c.remove()}}catch($){s.e($)}finally{s.f()}var u,l=Object(Te["a"])(i.structure.corners());try{for(l.s();!(u=l.n()).done;){var h=u.value;h.remove()}}catch($){l.e($)}finally{l.f()}var f,d=Object(Te["a"])(i.negative.bitmaps());try{for(d.s();!(f=d.n()).done;){var p=f.value;p.remove()}}catch($){d.e($)}finally{d.f()}var v,m=Object(Te["a"])(i.label.textLabels());try{for(m.s();!(v=m.n()).done;){var g=v.value;g.room||g.remove()}}catch($){m.e($)}finally{m.f()}var y,b=Object(Te["a"])(i.label.lineLabels());try{for(b.s();!(y=b.n()).done;){var x=y.value;x.remove()}}catch($){b.e($)}finally{b.f()}t.originBackToCenter()}}]]},menuBarDrawingMenuOptions:function(){var t=this;return[[{label:"添加底图",click:function(){var e=t.$spoke.getEditor("primary"),n=e.drawing,i=t.$spoke.getConstant(),r=i.bitmap;n.negative.createBitmap(r.url,df(r.dWidth),df(r.dHeight))}}]]},menuBarViewMenuOptions:function(){var t=this,e=new DocumentFragment;return e.appendChild(new Text("Ctrl+=")),[[{label:"放大",accelerator:[e],click:function(){var e=t.$spoke.getEditor("primary"),n=e.drawing;n.setScaleInMode(n.scale-1)}},{label:"缩小",click:function(){var e=t.$spoke.getEditor("primary"),n=e.drawing;n.setScaleInMode(n.scale+1)}},{label:"重置视野",click:function(){t.originBackToCenter()}},{label:"适应",click:function(){var e,n,i=t.$spoke.getEditor("primary"),r=i.drawing,o=[],a=[],s=Object(Te["a"])(r.structure.corners());try{for(s.s();!(n=s.n()).done;){var c=n.value,u=c.x,l=c.y;o[0]=void 0===o[0]?u:Math.min(u,o[0]),o[1]=void 0===o[1]?l:Math.max(l,o[1]),a[0]=void 0===a[0]?u:Math.max(u,a[0]),a[1]=void 0===a[1]?l:Math.min(l,a[1])}}catch(h){s.e(h)}finally{s.f()}(e=r.viewport.ViewAdjuster).backToCenter.apply(e,o.concat(a))}}]]},menuBarHelpMenuOptions:function(){var t=this;return[[{label:"关于",click:function(){t.$bvModal.msgBoxOk("@3dnest/spoke")}}]]}},methods:{updateMenu:function(){this.$pMenu.Bar.set(this.menuBarOptions)},save:function(){this.$spoke.floorSerialize("primary"),this.floorListString=JSON.stringify({floorList:this.floor.floorList,extensionList:this.floor.extensionList},null,2),this.$refs["serialize-modal"].show()},download:function(){var t=new Blob([this.floorListString],{type:"text/json"}),e=document.createElement("a");e.download="data.json",e.href=window.URL.createObjectURL(t),e.click()},open:function(){this.$refs["deserialize-modal"].show()},upload:function(){this.$refs.file_input.click()},onFileChange:function(t){var e=this,n=t.target.files[0],i=new FileReader;i.readAsText(n,"utf8"),i.onload=function(){e.floorData=JSON.stringify(JSON.parse(this.result),null,2)}},deserialize:function(){if(this.floorData){var t=JSON.parse(this.floorData);this.$spoke.floorDeserialize("primary",t.floorList,t.extensionList),this.floorData="",this.$refs["deserialize-modal"].hide()}},originBackToCenter:function(){var t=this.$spoke.getEditor("primary"),e=t.drawing,n=e.width,i=e.height;e.setOrigin(n/2,i/2),e.setScale(25)}}},vf=pf,mf=n("0c7c"),gf=Object(mf["a"])(vf,hf,ff,!1,null,null,null),yf=gf.exports,bf=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("b-button-toolbar",{staticClass:"flex-column p-1",staticStyle:{width:"48px","font-size":"12px"},attrs:{id:"app-toolgroup"}},t._l(t.group,(function(e,i){return n("b-button-group",{key:i,staticClass:"my-1",attrs:{vertical:""}},t._l(e,(function(e){return n("b-button",{key:e,attrs:{pressed:t.current===e,title:t.map[e].title},on:{click:function(n){return t.activeButton(e)}}},[n("b-icon",{attrs:{icon:t.map[e].icon}})],1)})),1)})),1)},xf=[],$f="selector",wf="transformer",kf="builder",Of="chamber",jf="spliter",Tf="labeler",Ef="viewport",Sf=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"d-flex"})},Lf=[],Cf={name:"SelectorSetting"},Pf=Cf,Ff=Object(mf["a"])(Pf,Sf,Lf,!1,null,null,null),Af=Ff.exports,_f=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"d-flex"})},Rf=[],Df={name:"TransformerSetting"},Nf=Df,Wf=Object(mf["a"])(Nf,_f,Rf,!1,null,null,null),Mf=Wf.exports,If=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"d-flex"},[n("b-form-radio-group",{staticClass:"d-flex align-items-center pr-1 pl-3",attrs:{options:t.alignOptions},on:{change:t.setWallAlignment},model:{value:t.align,callback:function(e){t.align=e},expression:"align"}}),n("b-form-group",{staticClass:"my-1 px-2 border-left border-right",staticStyle:{width:"12em"},attrs:{"label-cols-sm":"3","content-cols-sm":"9",label:"墙厚","label-for":"wall-thinkness"}},[n("b-input-group",{attrs:{append:"mm"}},[n("b-form-input",{attrs:{id:"wall-thinkness",type:"number",min:"10",autocomplete:"off"},on:{update:t.setWallThinkness},model:{value:t.thinkness,callback:function(e){t.thinkness=t._n(e)},expression:"thinkness"}})],1)],1),n("b-form-checkbox-group",{staticClass:"d-flex align-items-center pl-3",attrs:{options:t.positionOptions,switches:""},model:{value:t.position,callback:function(e){t.position=e},expression:"position"}})],1)},Hf=[],Bf={name:"BuilderSetting",data:function(){return{thinkness:200,align:"center",alignOptions:[{value:"left",text:"左边对齐"},{value:"center",text:"中线对齐"},{value:"right",text:"右边对齐"}],position:["adsorption"],positionOptions:[{value:"adsorption",text:"吸附"},{value:"orthogonal",text:"正交"}]}},mounted:function(){this.setWallThinkness(),this.setWallAlignment()},methods:{setWallThinkness:function(){var t=this.$spoke.getEditor("primary"),e=t.drawing;e.bricklayer.Builder.setThickness(this.thinkness)},setWallAlignment:function(){var t=this.$spoke.getEditor("primary"),e=t.drawing;e.bricklayer.Builder.setAlignment(this.align)}}},zf=Bf,Vf=Object(mf["a"])(zf,If,Hf,!1,null,null,null),Uf=Vf.exports,Yf=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"d-flex"},[n("b-form-group",{staticClass:"my-1 pr-2 pl-3 border-right",staticStyle:{width:"12em"},attrs:{"label-cols-sm":"3","content-cols-sm":"9",label:"墙厚","label-for":"wall-thinkness"}},[n("b-input-group",{attrs:{append:"mm"}},[n("b-form-input",{attrs:{id:"wall-thinkness",type:"number",min:"10",autocomplete:"off"},on:{update:t.setWallThinkness},model:{value:t.thinkness,callback:function(e){t.thinkness=t._n(e)},expression:"thinkness"}})],1)],1),n("b-form-checkbox-group",{staticClass:"d-flex align-items-center pl-3",attrs:{options:t.positionOptions,switches:""},model:{value:t.position,callback:function(e){t.position=e},expression:"position"}})],1)},Gf=[],Xf={name:"ChamberSetting",data:function(){return{thinkness:200,position:["adsorption"],positionOptions:[{value:"adsorption",text:"吸附"}]}},mounted:function(){this.setWallThinkness()},methods:{setWallThinkness:function(){var t=this.$spoke.getEditor("primary"),e=t.drawing;e.bricklayer.Chamber.setThickness(this.thinkness)}}},Kf=Xf,Jf=Object(mf["a"])(Kf,Yf,Gf,!1,null,null,null),qf=Jf.exports,Qf=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"d-flex"})},Zf=[],td={name:"SpliterSetting"},ed=td,nd=Object(mf["a"])(ed,Qf,Zf,!1,null,null,null),id=nd.exports,rd=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("b-form-radio-group",{staticClass:"p-2 pl-3",attrs:{options:t.options},on:{change:t.changeLabeler},model:{value:t.selected,callback:function(e){t.selected=e},expression:"selected"}})],1)},od=[],ad={name:"LabelerSetting",data:function(){return{selected:"textLabeler",options:[{value:"textLabeler",text:"文字标注"},{value:"lineLabeler",text:"引线标注"}]}},methods:{changeLabeler:function(t){var e=this.$spoke.getEditor("primary"),n=e.drawing;"textLabeler"===t?n.label.openTextLabeler():n.label.openLineLabeler()}}},sd=ad,cd=Object(mf["a"])(sd,rd,od,!1,null,null,null),ud=cd.exports,ld=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("b-button-group",{staticClass:"p-2"},[n("b-button",{staticClass:"app-collapse-button mr-2",on:{click:t.originBackToCenter}},[t._v("原点回中")]),n("b-button",{staticClass:"app-collapse-button",on:{click:t.negativeBackToCenter}},[t._v("底图回中")])],1),n("b-modal",{ref:"viewport-info-modal",attrs:{size:"sm","hide-header":"","hide-footer":""}},[n("div",{staticClass:"d-block text-center"},[t._v("当前楼层没有底图")])])],1)},hd=[],fd={name:"ViewportSetting",methods:{originBackToCenter:function(){var t=this.$spoke.getEditor("primary"),e=t.drawing,n=e.width,i=e.height;e.setOrigin(n/2,i/2),e.setScale(25)},negativeBackToCenter:function(){var t=this.$spoke.getEditor("primary"),e=t.drawing,n=e.negative.getAllBitmapList();n.length?e.viewport.backToCenter(n[0]):this.$refs["viewport-info-modal"].show()}}},dd=fd,pd=Object(mf["a"])(dd,ld,hd,!1,null,null,null),vd=pd.exports,md=(sf={},Object(dt["a"])(sf,$f,{id:$f,title:$f,icon:"cursor",click:function(t){t.tool.openSelector()},setting:Af}),Object(dt["a"])(sf,wf,{id:wf,title:wf,icon:"arrows-move",click:function(t){t.tool.openTransformer()},setting:Mf}),Object(dt["a"])(sf,kf,{id:kf,title:kf,icon:"bricks",click:function(t){t.tool.openWallBuilder()},setting:Uf}),Object(dt["a"])(sf,Of,{id:Of,title:Of,icon:"grid1x2",click:function(t){t.tool.openChamber()},setting:qf}),Object(dt["a"])(sf,jf,{id:jf,title:jf,icon:"input-cursor",click:function(t){t.tool.openSpliter()},setting:id}),Object(dt["a"])(sf,Tf,{id:Tf,title:Tf,icon:"tags",click:function(t){t.tool.openLabeler()},setting:ud}),Object(dt["a"])(sf,Ef,{id:Ef,title:Ef,icon:"search",click:function(t){t.tool.openViewport()},setting:vd}),sf),gd=Object.freeze([[$f,wf],[kf,Of,jf],[Tf],[Ef]]),yd={data:function(){return{current:null,map:md,group:gd}},mounted:function(){var t=this,e=this.$spoke.getEditor("primary");this.activeButton($f),e.tool.on("open",(function(e){t.current!==e&&(t.current=e,t.$root.$emit("toolGroupChange",e))}))},methods:{activeButton:function(t){md[t].click(this.$spoke.getEditor("primary")),this.current=t,this.$root.$emit("toolGroupChange",t)}}},bd=yd,xd=(n("d607"),Object(mf["a"])(bd,bf,xf,!1,null,null,null)),$d=xd.exports,wd=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"position-absolute d-flex justify-content-center w-100",staticStyle:{top:"0",height:"0"}},[n(t.current,{tag:"component",staticClass:"border mt-1 position-absolute",staticStyle:{"background-color":"#FFF"}})],1)},kd=[],Od={name:"ToolGroupSetting",data:function(){return{current:null}},mounted:function(){var t=this;this.current=md[$f].setting,this.$root.$on("toolGroupChange",(function(e){t.current=e?md[e].setting:null}))}},jd=Od,Td=Object(mf["a"])(jd,wd,kd,!1,null,null,null),Ed=Td.exports,Sd=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("b-button-toolbar",{staticClass:"text-light",attrs:{id:"app-bottom-container"}},[n("app-status-pointer-bar"),n("app-status-statistics-bar")],1)},Ld=[],Cd=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"d-flex align-items-center px-1",staticStyle:{"font-size":"12px"},attrs:{id:"app-status-pointer"}},[n("b-icon-cursor-fill"),n("div",[n("span",{staticClass:"px-1 d-inline-block text-right",staticStyle:{width:"3em"}},[t._v(t._s(t.x))]),t._v(","),n("span",{staticClass:"px-1 d-inline-block text-right",staticStyle:{width:"3em"}},[t._v(t._s(t.y))])])],1)},Pd=[],Fd=(n("b65f"),{data:function(){return{x:0,y:0}},mounted:function(){var t=this,e=this.$spoke.getEditor("primary"),n=e.drawing;n.on("pointermove",(function(e){t.x=Math.trunc(e.pointerX),t.y=Math.trunc(e.pointerY)}))}}),Ad=Fd,_d=Object(mf["a"])(Ad,Cd,Pd,!1,null,null,null),Rd=_d.exports,Dd=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"d-flex px-1 align-items-center",attrs:{id:"app-status-statistics"}},[n("span",{staticClass:"d-inline-block text-right",staticStyle:{width:"3em"}},[t._v(t._s(t.count))])])},Nd=[],Wd={data:function(){return{count:0}},mounted:function(){var t=this,e=this.$spoke.getEditor("primary"),n=e.drawing;n.on("element-create",(function(){return t.count++})).on("element-destroy",(function(){return t.count--}))}},Md=Wd,Id=Object(mf["a"])(Md,Dd,Nd,!1,null,null,null),Hd=Id.exports,Bd={components:{AppStatusPointerBar:Rd,AppStatusStatisticsBar:Hd}},zd=Bd,Vd=(n("c6f4"),Object(mf["a"])(zd,Sd,Ld,!1,null,null,null)),Ud=Vd.exports,Yd=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("b-card",{staticClass:"h-100",attrs:{"no-body":"",id:"app-feature-tabs"}},[n("b-card-header",{attrs:{"header-class":"px-1 py-1 border-bottom"}},[n("b-nav",{attrs:{"card-header":"",small:""}},t._l(t.idList,(function(e){return n("b-nav-item",{key:e,staticClass:"mr-1",attrs:{active:t.current===e,title:t.features[e].title},on:{click:function(n){t.current=e}}},[n("b-icon",{attrs:{icon:t.features[e].icon}})],1)})),1)],1),n("b-card-body",{staticClass:"p-0 flex-grow-1"},[n(t.currentFeature.component,{tag:"component",staticClass:"h-100",attrs:{floor:t.floor}})],1)],1)},Gd=[],Xd=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"d-flex flex-column",attrs:{id:"app-feature-overview-panel"}},t._l(t.itemList,(function(e,i){return n("b-card",{key:e,staticClass:"border-0 overflow-hidden",attrs:{"no-body":""}},[n("b-card-header",{attrs:{"header-class":"p-0"}},[n("b-button",{staticClass:"py-0 px-1 text-sm-left font-weight-bold app-collapse-button",attrs:{block:"",variant:"dark"},on:{click:function(e){return t.toggle(i)}}},[n("b-icon",{staticClass:"mr-1",attrs:{icon:t.visibleList[i]?"chevron-down":"chevron-right"}}),t._v(t._s(t.itemMap[e].title))],1)],1),n("b-collapse",{staticClass:"overflow-auto",model:{value:t.visibleList[i],callback:function(e){t.$set(t.visibleList,i,e)},expression:"visibleList[index]"}},[n(t.itemMap[e].component,{tag:"component"})],1)],1)})),1)},Kd=[],Jd=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("b-list-group",{staticClass:"border-0",staticStyle:{"max-height":"500px"}},[t._l(t.roomList,(function(e,i){return n("b-list-group-item",{key:i,staticClass:"p-1 border-0",attrs:{active:e===t.activeStructure,button:""},on:{click:function(n){return t.selectRoom(e)},dblclick:function(n){return t.viewRoom(e)}}},[t._v(t._s(e.name))])})),n("b-list-group-item",{directives:[{name:"show",rawName:"v-show",value:0===t.roomList.length,expression:"roomList.length===0"}],staticClass:"p-1 border-0"},[t._v("No room")])],2)},qd=[],Qd=(n("c740"),new WeakMap),Zd=function(){return{name:"Untitled Room"}},tp={data:function(){return{roomList:[],wallList:[],cornerList:[],roomListenerList:[],activeStructure:null}},mounted:function(){this.updateRoomList(),this.roomListen(),this.selectorListen()},methods:{pushRoom:function(t){var e=Zd();Qd.set(e,t),this.roomList.push(e)},updateRoomList:function(){var t,e=this.$spoke.getEditor("primary"),n=e.drawing,i=Object(Te["a"])(n.structure.rooms());try{for(i.s();!(t=i.n()).done;){var r=t.value;this.pushRoom(r)}}catch(o){i.e(o)}finally{i.f()}},roomListen:function(){var t=this,e=this._createListener=function(e){return t.pushRoom(e)},n=this._destroyListener=function(e){var n=t.roomList.findIndex((function(t){return Qd.get(t)===e}));n>-1&&(Qd.delete(t.roomList[n]),t.$delete(t.roomList,n))};this.$root.$on("room-create",e),this.$root.$on("room-destroy",n)},selectorListen:function(){var t=this,e=this.$spoke.getEditor("primary"),n=e.drawing;this._addListener=function(e){t.activeStructure=1===e.length?t.roomList.find((function(t){return Qd.get(t)===e[0]})):null},this._addListener(n.common.getSelectedList()),n.common.on("selector-add",this._addListener),n.common.on("selector-clear",this._clearListener=function(){t.activeStructure=null})},selectRoom:function(t){var e=this.$spoke.getEditor("primary");e.tool.openSelector(),e.drawing.common.selectorAction(Qd.get(t))},viewRoom:function(t){var e=this.$spoke.getEditor("primary"),n=e.drawing;n.viewport.backToCenter(Qd.get(t)),this.$root.$emit("featureChange",1)}},destroyed:function(){var t=this.$spoke.getEditor("primary"),e=t.drawing;e.common.off("selector-add",this._addListener),e.common.off("selector-clear",this._clearListener),this.$root.$off("room-create",this._createListener),this.$root.$off("room-destroy",this._destroyListener)}},ep=tp,np=Object(mf["a"])(ep,Jd,qd,!1,null,null,null),ip=np.exports,rp={id:"structure",title:"structure",component:ip,defaultVisible:!0},op=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("b-list-group",{staticClass:"border-0",staticStyle:{"max-height":"500px"}},[t._l(t.hollowList,(function(e,i){return n("b-list-group-item",{key:i,staticClass:"p-1 border-0",attrs:{active:e===t.activeHollow,button:""},on:{click:function(n){return t.selectHollow(e)},dblclick:function(n){return t.viewHollow(e)}}},[n("div",{staticClass:"d-flex justify-content-between align-items-center"},[n("div",[t._v(t._s(e.name))]),n("div",[n("b-button",{staticClass:"p-0",attrs:{variant:"link"},on:{click:function(n){return n.stopPropagation(),t.toggleVisible(e)}}},[n("b-icon-eye",{directives:[{name:"show",rawName:"v-show",value:e.visible,expression:"hollow.visible"}],class:{"text-white":e===t.activeHollow}}),n("b-icon-eye-slash",{directives:[{name:"show",rawName:"v-show",value:!e.visible,expression:"!hollow.visible"}],class:{"text-white":e===t.activeHollow}})],1)],1)])])})),n("b-list-group-item",{directives:[{name:"show",rawName:"v-show",value:0===t.hollowList.length,expression:"hollowList.length===0"}],staticClass:"p-1 border-0"},[t._v("No hollow")])],2)},ap=[],sp=new WeakMap,cp=function(t){return{visible:t.visible,name:"Untitled Hollow"}},up={data:function(){return{hollowList:[],activeHollow:null}},mounted:function(){this.updateRoomList(),this.hollowListen(),this.selectorListen()},methods:{pushHollow:function(t){var e=cp(t);sp.set(e,t),this.hollowList.push(e)},updateRoomList:function(){var t,e=this.$spoke.getEditor("primary"),n=e.drawing,i=Object(Te["a"])(n.windoor.hollows());try{for(i.s();!(t=i.n()).done;){var r=t.value;this.pushHollow(r)}}catch(o){i.e(o)}finally{i.f()}},hollowListen:function(){var t=this,e=this._createListener=function(e){return t.pushHollow(e)},n=this._destroyListener=function(e){var n=t.hollowList.findIndex((function(t){return sp.get(t)===e}));n>-1&&(sp.delete(t.hollowList[n]),t.$delete(t.hollowList,n))};this.$root.$on("hollow-create",e),this.$root.$on("hollow-destroy",n)},selectorListen:function(){var t=this,e=this.$spoke.getEditor("primary"),n=e.drawing;this._addListener=function(e){t.activeHollow=1===e.length?t.hollowList.find((function(t){return sp.get(t)===e[0]})):null},this._addListener(n.common.getSelectedList()),n.common.on("selector-add",this._addListener),n.common.on("selector-clear",this._clearListener=function(){t.activeHollow=null})},selectHollow:function(t){var e=this.$spoke.getEditor("primary");e.tool.openSelector(),e.drawing.common.selectorAction(sp.get(t))},toggleVisible:function(t){var e=this.$spoke.getEditor("primary"),n=e.drawing;t.visible=!t.visible,t.visible?sp.get(t).show():sp.get(t).hide(),t===this.activeHollow&&n.common.selector.drop()},viewHollow:function(t){if(t.visible){var e=this.$spoke.getEditor("primary"),n=e.drawing;n.viewport.backToCenter(sp.get(t)),this.$root.$emit("featureChange",1)}}},destroyed:function(){var t=this.$spoke.getEditor("primary"),e=t.drawing;e.common.off("selector-add",this._addListener),e.common.off("selector-clear",this._clearListener),this.$root.$off("hollow-create",this._createListener),this.$root.$off("hollow-destroy",this._destroyListener)}},lp=up,hp=Object(mf["a"])(lp,op,ap,!1,null,null,null),fp=hp.exports,dp={id:"windoor",title:"window & door",component:fp,defaultVisible:!0},pp=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("b-list-group",{staticClass:"border-0",staticStyle:{"max-height":"500px"}},[t._l(t.stuffList,(function(e,i){return n("b-list-group-item",{key:i,staticClass:"p-1 border-0",attrs:{active:e===t.activeStuff,button:""},on:{click:function(n){return t.selectStuff(e)},dblclick:function(n){return t.viewStuff(e)}}},[n("div",{staticClass:"d-flex justify-content-between align-items-center"},[n("div",[t._v(t._s(e.name))]),n("div",[n("b-button",{staticClass:"p-0",attrs:{variant:"link"},on:{click:function(n){return n.stopPropagation(),t.toggleVisible(e)}}},[n("b-icon-eye",{directives:[{name:"show",rawName:"v-show",value:e.visible,expression:"stuff.visible"}],class:{"text-white":e===t.activeStuff}}),n("b-icon-eye-slash",{directives:[{name:"show",rawName:"v-show",value:!e.visible,expression:"!stuff.visible"}],class:{"text-white":e===t.activeStuff}})],1)],1)])])})),n("b-list-group-item",{directives:[{name:"show",rawName:"v-show",value:0===t.stuffList.length,expression:"stuffList.length===0"}],staticClass:"p-1 border-0"},[t._v("No stuff")])],2)},vp=[],mp=new WeakMap,gp=function(t){return{visible:t.visible,name:"Untitled stuff"}},yp={data:function(){return{stuffList:[],activeStuff:null}},mounted:function(){this.updateStuffList(),this.stuffListen(),this.selectorListen()},methods:{pushStuff:function(t){var e=gp(t);mp.set(e,t),this.stuffList.push(e)},updateStuffList:function(){var t,e=this.$spoke.getEditor("primary"),n=e.drawing,i=Object(Te["a"])(n.furniture.stuffs());try{for(i.s();!(t=i.n()).done;){var r=t.value;this.pushStuff(r)}}catch(o){i.e(o)}finally{i.f()}},stuffListen:function(){var t=this,e=this._createListener=function(e){return t.pushStuff(e)},n=this._destroyListener=function(e){var n=t.stuffList.findIndex((function(t){return mp.get(t)===e}));n>-1&&(mp.delete(t.stuffList[n]),t.$delete(t.stuffList,n))};this.$root.$on("stuff-create",e),this.$root.$on("stuff-destroy",n)},selectorListen:function(){var t=this,e=this.$spoke.getEditor("primary"),n=e.drawing;this._addListener=function(e){t.activeStuff=1===e.length?t.stuffList.find((function(t){return mp.get(t)===e[0]})):null},this._addListener(n.common.getSelectedList()),n.common.on("selector-add",this._addListener),n.common.on("selector-clear",this._clearListener=function(){t.activeStuff=null})},selectStuff:function(t){var e=this.$spoke.getEditor("primary");e.tool.openSelector(),e.drawing.common.selectorAction(mp.get(t))},toggleVisible:function(t){var e=this.$spoke.getEditor("primary"),n=e.drawing;t.visible=!t.visible,t.visible?mp.get(t).show():mp.get(t).hide(),t===this.activeStuff&&n.common.selector.drop()},viewStuff:function(t){if(t.visible){var e=this.$spoke.getEditor("primary"),n=e.drawing;n.viewport.backToCenter(mp.get(t)),this.$root.$emit("featureChange",1)}}},destroyed:function(){var t=this.$spoke.getEditor("primary"),e=t.drawing;e.common.off("selector-add",this._addListener),e.common.off("selector-clear",this._clearListener),this.$root.$off("stuff-create",this._createListener),this.$root.$off("stuff-destroy",this._destroyListener)}},bp=yp,xp=Object(mf["a"])(bp,pp,vp,!1,null,null,null),$p=xp.exports,wp={id:"furniture",title:"furniture",component:$p,defaultVisible:!0},kp=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",t._l(t.labelListMap,(function(e,i){return n("b-list-group",{key:i,staticClass:"border-0",staticStyle:{"max-height":"500px"}},[t._l(e,(function(e,i){return n("b-list-group-item",{key:i,staticClass:"p-1 border-0",attrs:{active:e===t.activeLabel,button:""},on:{click:function(n){return t.selectLabel(e)},dblclick:function(n){return t.viewLabel(e)}}},[n("div",{staticClass:"d-flex justify-content-between align-items-center"},[n("div",[t._v(t._s(e.name))]),n("div",[n("b-button",{staticClass:"p-0",attrs:{variant:"link"},on:{click:function(n){return n.stopPropagation(),t.toggleVisible(e)}}},[n("b-icon-eye",{directives:[{name:"show",rawName:"v-show",value:e.visible,expression:"label.visible"}],class:{"text-white":e===t.activeLabel}}),n("b-icon-eye-slash",{directives:[{name:"show",rawName:"v-show",value:!e.visible,expression:"!label.visible"}],class:{"text-white":e===t.activeLabel}})],1)],1)])])})),n("b-list-group-item",{directives:[{name:"show",rawName:"v-show",value:0===e.length,expression:"list.length===0"}],staticClass:"p-1 border-0"},[t._v("No "+t._s(i)+" label")])],2)})),1)},Op=[],jp=new WeakMap,Tp=function(t,e){return{visible:t.visible,name:"Untitled ".concat(e," label")}},Ep={data:function(){return{labelListMap:{text:[],line:[]},activeLabel:null}},mounted:function(){this.updateLabelList(),this.labelListen(),this.selectorListen()},methods:{pushLabel:function(t,e){var n=Tp(t,e);jp.set(n,t),this.labelListMap[e].push(n)},updateLabelList:function(){var t=this.$spoke.getEditor("primary"),e=t.drawing,n={text:e.label.textLabels(),line:e.label.lineLabels()};for(var i in n){var r,o=Object(Te["a"])(n[i]);try{for(o.s();!(r=o.n()).done;){var a=r.value;this.pushLabel(a,i)}}catch(s){o.e(s)}finally{o.f()}}},labelListen:function(){var t=this,e={labelText:"text",labelLine:"line"},n=this._createListener=function(n,i){t.pushLabel(n,e[i])},i=this._destroyListener=function(n,i){var r=t.labelListMap[e[i]].findIndex((function(t){return jp.get(t)===n}));r>-1&&(jp.delete(t.labelListMap[e[i]][r]),t.$delete(t.labelListMap[e[i]],r))};this.$root.$on("labelText-create",n),this.$root.$on("labelLine-create",n),this.$root.$on("labelText-destroy",i),this.$root.$on("labelLine-destroy",i)},selectorListen:function(){var t=this,e=this.$spoke.getEditor("primary"),n=e.drawing;this._addListener=function(e){var n=t.labelListMap.text.concat(t.labelListMap.line);t.activeLabel=1===e.length?n.find((function(t){return jp.get(t)===e[0]})):null},this._addListener(n.common.getSelectedList()),n.common.on("selector-add",this._addListener),n.common.on("selector-clear",this._clearListener=function(){t.activeLabel=null})},selectLabel:function(t){var e=this.$spoke.getEditor("primary");e.tool.openSelector(),e.drawing.common.selectorAction(jp.get(t))},viewLabel:function(t){if(t.visible){var e=this.$spoke.getEditor("primary"),n=e.drawing;n.viewport.backToCenter(jp.get(t)),this.$root.$emit("featureChange",1)}},toggleVisible:function(t){var e=this.$spoke.getEditor("primary"),n=e.drawing;t.visible=!t.visible,t.visible?jp.get(t).show():jp.get(t).hide(),t===this.activeLabel&&n.common.selector.drop()}},destroyed:function(){var t=this.$spoke.getEditor("primary"),e=t.drawing;e.common.off("selector-add",this._addListener),e.common.off("selector-clear",this._clearListener),this.$root.$off("labelText-create",this._createListener),this.$root.$off("labelLine-create",this._createListener),this.$root.$off("labelText-destroy",this._destroyListener),this.$root.$off("labelLine-destroy",this._destroyListener)}},Sp=Ep,Lp=Object(mf["a"])(Sp,kp,Op,!1,null,null,null),Cp=Lp.exports,Pp={id:"label",title:"label",component:Cp,defaultVisible:!0},Fp=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("b-list-group",{staticClass:"border-0",staticStyle:{"max-height":"500px"}},[t._l(t.dimensionList,(function(e,i){return n("b-list-group-item",{key:i,staticClass:"p-1 border-0",attrs:{button:""}},[t._v(t._s(e.name))])})),n("b-list-group-item",{directives:[{name:"show",rawName:"v-show",value:0===t.dimensionList.length,expression:"dimensionList.length===0"}],staticClass:"p-1 border-0"},[t._v("No dimension")])],2)},Ap=[],_p=new WeakMap,Rp=function(){return{name:"Untitled dimension"}},Dp={data:function(){return{dimensionList:[]}},mounted:function(){this.updateDimensionList(),this.dimensionListen()},methods:{pushDimension:function(t){var e=Rp();_p.set(e,t),this.dimensionList.push(e)},updateDimensionList:function(){var t,e=this.$spoke.getEditor("primary"),n=e.drawing,i=Object(Te["a"])(n.measure.dimensions());try{for(i.s();!(t=i.n()).done;){var r=t.value;this.pushDimension(r)}}catch(o){i.e(o)}finally{i.f()}},dimensionListen:function(){var t=this,e=this._createListener=function(e){return t.pushDimension(e)},n=this._destroyListener=function(e){var n=t.dimensionList.findIndex((function(t){return _p.get(t)===e}));n>-1&&(_p.delete(t.dimensionList[n]),t.$delete(t.dimensionList,n))};this.$root.$on("dimension-create",e),this.$root.$on("dimension-destroy",n)}},destroyed:function(){this.$root.$off("dimension-create",this._createListener),this.$root.$off("dimension-destroy",this._destroyListener)}},Np=Dp,Wp=Object(mf["a"])(Np,Fp,Ap,!1,null,null,null),Mp=Wp.exports,Ip={id:"dimension",title:"dimensions",component:Mp,defaultVisible:!1},Hp=(cf={},Object(dt["a"])(cf,rp.id,rp),Object(dt["a"])(cf,dp.id,dp),Object(dt["a"])(cf,wp.id,wp),Object(dt["a"])(cf,Pp.id,Pp),Object(dt["a"])(cf,Ip.id,Ip),cf),Bp=[rp.id,dp.id,wp.id,Pp.id,Ip.id],zp={data:function(){return{visibleList:Bp.map((function(t){return Hp[t].defaultVisible})),itemList:Bp.slice(0)}},computed:{itemMap:function(){return Hp}},methods:{toggle:function(t){this.$set(this.visibleList,t,!this.visibleList[t])}}},Vp=zp,Up=(n("d1d1"),Object(mf["a"])(Vp,Xd,Kd,!1,null,null,null)),Yp=Up.exports,Gp={id:"overview",icon:"list-stars",title:"Element Overview",component:Yp},Xp=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"p-1"},[n("b-button-group",{staticClass:"mb-1"},[n("b-button",{staticClass:"app-collapse-button mr-1",on:{click:t.addFloor}},[n("b-icon",{staticClass:"mr-2",attrs:{icon:"arrow-bar-up"}}),t._v("向上新建")],1),n("b-button",{staticClass:"app-collapse-button",on:{click:t.addBasement}},[n("b-icon",{staticClass:"mr-2",attrs:{icon:"arrow-bar-down"}}),t._v("向下新建")],1)],1),n("b-list-group",t._l(t.floorList,(function(e,i){return n("b-list-group-item",{key:i,staticClass:"pl-2 pr-1 py-0 border-0",attrs:{active:i===t.activeFloor,button:""},on:{click:function(e){return t.clickChangeFloor(i)}}},[n("div",{staticClass:"d-flex justify-content-between align-items-center"},[n("div",{staticClass:"app-text-tiny"},[n("span",{staticClass:"mr-3"},[t._v(t._s(e.name))]),n("span",[t._v(t._s(e.alias))])]),n("div",[n("b-button",{staticClass:"p-1",attrs:{variant:"link"},on:{click:function(e){return e.stopPropagation(),t.openNameModal(i)}}},[n("b-icon-pen",{class:{"text-white":i===t.activeFloor}})],1),e.isFirst?t._e():n("b-button",{staticClass:"p-1",attrs:{variant:"link"},on:{click:function(e){return e.stopPropagation(),t.deleteFloor(i)}}},[n("b-icon-trash",{class:{"text-white":i===t.activeFloor}})],1)],1)])])})),1),n("b-modal",{ref:"floor-name-modal",attrs:{size:"sm","hide-footer":"",title:"楼层名称"}},[n("div",{staticClass:"d-block text-center"},[n("b-form-input",{attrs:{placeholder:"请输入楼层名称"},model:{value:t.floorName,callback:function(e){t.floorName=e},expression:"floorName"}}),n("b-button",{staticClass:"mt-3",attrs:{variant:"info",block:""},on:{click:t.changeFloorName}},[t._v("确定")])],1)])],1)},Kp=[],Jp={name:"FeatureFloor",data:function(){var t=this.$spoke.getFloor();return{floor:t,activeFloor:t.currentFloor,floorName:"",floorNameIndex:0}},computed:{floorList:function(){var t=this.floor,e=t.floorList,n=t.extensionList,i=n.findIndex((function(t){return t.isFirst}));return e.map((function(t,e){var r=e>i?"负".concat(e-i,"层"):"".concat(i-e+1,"层");return{name:r,alias:n[e].floorName,isFirst:n[e].isFirst}}))}},methods:{addFloor:function(){var t=this.$spoke.getEditor("primary"),e=this.floor,n=e.floorList,i=e.extensionList,r=e.currentFloor;t.tool.closeAllTool();var o=0===this.activeFloor?t.serializer.execute(i[r]):n[0],a=0===this.activeFloor?i[r]:i[0],s={cornerList:o.cornerList,wallList:o.wallList,hollowList:o.hollowList},c={floorName:"未命名",isFirst:!1,wallList:a.wallList.slice(0)};n[this.activeFloor]=t.floor.changeFloor(s,c,i[r]),n.unshift(s),i.unshift(c),this.changeActiveFloor(0)},addBasement:function(){var t=this.$spoke.getEditor("primary"),e=this.floor,n=e.floorList,i=e.extensionList,r=e.currentFloor;t.tool.closeAllTool();var o=this.activeFloor===n.length-1?t.serializer.execute():n[n.length-1],a=this.activeFloor===n.length-1?i[r]:i[n.length-1],s={cornerList:o.cornerList,wallList:o.wallList,hollowList:o.hollowList},c={floorName:"未命名",isFirst:!1,wallList:a.wallList.slice(0)};n[this.activeFloor]=t.floor.changeFloor(s,c,i[r]),n.push(s),i.push(c),this.changeActiveFloor(n.length-1)},clickChangeFloor:function(t){if(t!==this.activeFloor){var e=this.$spoke.getEditor("primary"),n=this.floor,i=n.floorList,r=n.extensionList,o=n.currentFloor;e.tool.closeAllTool(),i[o]=e.floor.changeFloor(i[t],r[t],r[o]),this.changeActiveFloor(t)}},deleteFloor:function(t){var e=this.$spoke.getEditor("primary"),n=this.floor,i=n.floorList,r=n.extensionList;if(e.tool.closeAllTool(),i.splice(t,1),r.splice(t,1),t===this.activeFloor){var o=r.findIndex((function(t){return t.isFirst}));e.floor.changeFloor(i[o],r[o]),this.changeActiveFloor(o)}else t<this.activeFloor&&this.changeActiveFloor(this.activeFloor-1)},openNameModal:function(t){var e=this.floor.extensionList;this.floorName=e[t].floorName,this.floorNameIndex=t,this.$refs["floor-name-modal"].show()},changeFloorName:function(){var t=this.floor.extensionList,e=t[this.floorNameIndex];this.floorName?e.floorName=this.floorName:e.floorName="未命名",this.$set(t,this.floorNameIndex,e),this.$refs["floor-name-modal"].hide()},changeActiveFloor:function(t){this.activeFloor=t,this.floor.currentFloor=t}}},qp=Jp,Qp=Object(mf["a"])(qp,Xp,Kp,!1,null,null,null),Zp=Qp.exports,tv={id:"floor",icon:"ladder",title:"Floor Manager",component:Zp},ev=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"p-1 app-text-tiny",attrs:{id:"app-feature-property-panel"}},[n("b-form-group",{attrs:{label:"Orientation"}},[n("b-input",{staticClass:"app-text-tiny w-50",attrs:{type:"number",max:"360",min:"-360",autocomplete:"off"},model:{value:t.orientation,callback:function(e){t.orientation=t._n(e)},expression:"orientation"}})],1)],1)},nv=[],iv=(n("b680"),function(t){return t/Math.PI/2*360}),rv=function(t){return t/360*2*Math.PI},ov={data:function(){return{orientation:0}},watch:{orientation:function(t){var e=this.$spoke.getEditor("primary"),n=e.drawing,i=rv(t);n.compass.setRotation(i)}},mounted:function(){var t=this,e=this.$spoke.getEditor("primary"),n=e.drawing;this.orientation=iv(n.compass.rotation).toFixed(),n.compass.element.on("change",this._listener=function(e){t.orientation=iv(e.rotation).toFixed()})},destroyed:function(){var t=this.$spoke.getEditor("primary"),e=t.drawing;e.compass.element.off("change",this._listener),this.$emit("close")}},av=ov,sv=Object(mf["a"])(av,ev,nv,!1,null,null,null),cv=sv.exports,uv={id:"property",icon:"gear",title:"Drawing Properties",component:cv},lv=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("drawing-property",{directives:[{name:"show",rawName:"v-show",value:!t.component,expression:"!component"}]}),n(t.component,{tag:"component"})],1)},hv=[],fv=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"pt-1"},[t._l(t.propertyList,(function(e,i){return n("b-form-group",{key:i,staticClass:"px-1 mb-2",attrs:{label:e.name,"label-class":"app-text-tiny"}},[n("b-input-group",{attrs:{append:e.append}},[n("b-input",{staticClass:"app-text-tiny",attrs:{type:"number",min:e.min,max:e.max,autocomplete:"off"},on:{change:function(n){return t.propertyAction(e.method)}},model:{value:t.state[e.value],callback:function(n){t.$set(t.state,e.value,t._n(n))},expression:"state[property.value]"}})],1)],1)})),n("div",[n("b-button-group",{staticClass:"px-1 mb-1"},[n("b-button",{staticClass:"app-collapse-button mr-1",on:{click:t.copyStuff}},[t._v("复制")]),n("b-button",{staticClass:"app-collapse-button mr-1",on:{click:t.defaultWidthHeight}},[t._v("恢复默认")]),n("b-button",{staticClass:"app-collapse-button",on:{click:t.backToCenter}},[t._v("回中")])],1)],1),n("div",[n("b-button-group",{staticClass:"px-1"},[n("b-button",{staticClass:"app-collapse-button",attrs:{variant:"danger"},on:{click:t.deleteStuff}},[t._v("删除")])],1)],1)],2)},dv=[],pv=[{name:"横坐标",value:"x",method:"setPosition"},{name:"纵坐标",value:"y",method:"setPosition"},{name:"宽度",value:"width",append:"mm",method:"setWidth",min:10},{name:"高度",value:"height",append:"mm",method:"setHeight",min:10},{name:"角度",value:"rotation",append:"degrees",method:"setRotation",min:-360,max:360}],vv=function(t){return t/Math.PI/2*360},mv=function(t){return t/360*2*Math.PI},gv=function(t){return 10*t},yv=null,bv={name:"FeatureElementStuff",data:function(){return{state:{width:10,height:10,rotation:0,x:0,y:0}}},computed:{propertyList:function(){return pv}},mounted:function(){this.init()},destroyed:function(){var t=this.$spoke.getEditor("primary"),e=t.drawing;e.common.off("selector-add",this._addlistener),yv&&!yv.destroyed&&yv.off("change",this._changelistener)},methods:{init:function(){var t=this,e=this.$spoke.getEditor("primary"),n=e.drawing;this._changelistener=function(e){return t.updateState(e)},yv=n.common.getSelectedList()[0],this.updateState(yv),yv.on("change",this._changelistener),n.common.on("selector-add",this._addlistener=function(e){var n=e[0];n!==yv&&n.constructor===yv.constructor&&(yv.off("change",t._changelistener),n.on("change",t._changelistener),yv=n,t.updateState(n))})},updateState:function(t){var e=t.width,n=t.height,i=t.rotation,r=t.x,o=t.y;Object.assign(this.state,{width:e.toFixed(),height:n.toFixed(),rotation:vv(i).toFixed(),x:r.toFixed(),y:o.toFixed()})},propertyAction:function(t){this[t]()},setWidth:function(){yv.setWidth(Number(this.state.width))},setHeight:function(){yv.setHeight(Number(this.state.height))},setRotation:function(){yv.setRotation(mv(this.state.rotation))},setPosition:function(){yv.setPosition(Number(this.state.x),Number(this.state.y))},copyStuff:function(){var t=this.$spoke.getEditor("primary"),e=t.drawing,n=yv,i=n.fill,r=n.width,o=n.height,a=n.rotation;e.furniture.createMovingStuff(i,r,o,a)},defaultWidthHeight:function(){var t=this.$spoke.getConstant(),e=t.furnitureList,n=e.find((function(t){return t.id===yv.fill}));yv.setWidth(gv(n.dWidth)),yv.setHeight(gv(n.dHeight)),yv.setRotation(0)},deleteStuff:function(){var t=this.$spoke.getEditor("primary"),e=t.drawing;yv.off("change",this._changelistener),yv=null,e.common.remove()},backToCenter:function(){var t=this.$spoke.getEditor("primary"),e=t.drawing;e.viewport.backToCenter(yv)}}},xv=bv,$v=Object(mf["a"])(xv,fv,dv,!1,null,null,null),wv=$v.exports,kv=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"pt-1"},[t._l(t.propertyList,(function(e,i){return n("b-form-group",{key:i,staticClass:"px-1 mb-2",attrs:{label:e.name,"label-class":"app-text-tiny"}},[n("b-input-group",{attrs:{append:e.append}},[n("b-input",{staticClass:"app-text-tiny",attrs:{type:"number",min:e.min,max:e.max,autocomplete:"off"},on:{change:function(n){return t.propertyAction(e.method)}},model:{value:t.state[e.value],callback:function(n){t.$set(t.state,e.value,t._n(n))},expression:"state[property.value]"}})],1)],1)})),n("b-button-group",{staticClass:"px-1 mb-1"},[n("b-button",{staticClass:"app-collapse-button mr-1",on:{click:t.flip}},[t._v("翻转")]),n("b-button",{staticClass:"app-collapse-button mr-1",on:{click:t.copyHollow}},[t._v("复制")]),n("b-button",{staticClass:"app-collapse-button mr-1",on:{click:t.defaultWidth}},[t._v("恢复默认")]),n("b-button",{staticClass:"app-collapse-button",on:{click:t.backToCenter}},[t._v("回中")])],1),n("b-button-group",{staticClass:"px-1"},[n("b-button",{staticClass:"app-collapse-button mr-1",attrs:{variant:"danger"},on:{click:t.deleteHollow}},[t._v("删除")])],1)],2)},Ov=[],jv=[{name:"宽度",value:"width",append:"mm",method:"setWidth",min:100}],Tv=null,Ev={name:"FeatureElementHollow",data:function(){return{state:{width:10}}},computed:{propertyList:function(){return jv}},mounted:function(){this.init()},destroyed:function(){var t=this.$spoke.getEditor("primary"),e=t.drawing;e.common.off("selector-add",this._addlistener),Tv&&!Tv.destroyed&&Tv.off("change",this._changelistener)},methods:{init:function(){var t=this,e=this.$spoke.getEditor("primary"),n=e.drawing;this._changelistener=function(e){return t.updateState(e)},Tv=n.common.getSelectedList()[0],this.updateState(Tv),Tv.on("change",this._changelistener),n.common.on("selector-add",this._addlistener=function(e){var n=e[0];n!==Tv&&n.constructor===Tv.constructor&&(Tv.off("change",t._changelistener),n.on("change",t._changelistener),Tv=n,t.updateState(n))})},updateState:function(t){var e=t.width;Object.assign(this.state,{width:e.toFixed()})},propertyAction:function(t){this[t]()},setWidth:function(){Tv.setWidth(Number(this.state.width))},flip:function(){Tv.flip()},copyHollow:function(){var t=this.$spoke.getEditor("primary"),e=t.drawing,n=Tv,i=n.materialName,r=n.width;e.windoor.createMovingHollow(i,r)},defaultWidth:function(){Tv.setWidth(Tv.defaultWidth)},deleteHollow:function(){var t=this.$spoke.getEditor("primary"),e=t.drawing;Tv.off("change",this._changelistener),Tv=null,e.common.remove()},backToCenter:function(){var t=this.$spoke.getEditor("primary"),e=t.drawing;e.viewport.backToCenter(Tv)}}},Sv=Ev,Lv=Object(mf["a"])(Sv,kv,Ov,!1,null,null,null),Cv=Lv.exports,Pv=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"pt-1"},[t._l(t.propertyList,(function(e,i){return n("b-form-group",{key:i,staticClass:"px-1 mb-2",attrs:{label:e.name,"label-class":"app-text-tiny"}},[n("b-input-group",{attrs:{append:e.append}},[n("b-input",{staticClass:"app-text-tiny",attrs:{type:"number",min:e.min,max:e.max,autocomplete:"off"},on:{change:function(n){return t.propertyAction(e.method)}},model:{value:t.state[e.value],callback:function(n){t.$set(t.state,e.value,t._n(n))},expression:"state[property.value]"}})],1)],1)})),t.state.isRoomLabel?t._e():n("b-button-group",{staticClass:"px-1"},[n("b-button",{staticClass:"app-collapse-button mr-1",on:{click:t.openLabelModal}},[t._v("修改文字")]),n("b-button",{staticClass:"app-collapse-button mr-1",on:{click:t.backToCenter}},[t._v("回中")]),n("b-button",{staticClass:"app-collapse-button",attrs:{variant:"danger"},on:{click:t.deleteLabel}},[t._v("删除")])],1),n("b-modal",{ref:"label-text-modal",attrs:{size:"sm","hide-footer":"",title:"标注内容"}},[n("div",{staticClass:"d-block text-center"},[n("b-form-input",{attrs:{placeholder:"No Text"},model:{value:t.state.text,callback:function(e){t.$set(t.state,"text",e)},expression:"state.text"}}),n("b-button",{staticClass:"mt-3",attrs:{variant:"info",block:""},on:{click:t.setText}},[t._v("确定")])],1)])],2)},Fv=[],Av=(n("5319"),n("5b81"),[{name:"横坐标",value:"x",method:"setPosition"},{name:"纵坐标",value:"y",method:"setPosition"}]),_v=null,Rv={name:"FeatureElementLabelText",data:function(){return{state:{x:0,y:0,text:"",isRoomLabel:!1}}},computed:{propertyList:function(){return Av}},mounted:function(){this.init()},destroyed:function(){var t=this.$spoke.getEditor("primary"),e=t.drawing;e.common.off("selector-add",this._addlistener),_v&&!_v.destroyed&&_v.off("change",this._changelistener)},methods:{init:function(){var t=this,e=this.$spoke.getEditor("primary"),n=e.drawing;this._changelistener=function(e){return t.updateState(e)},_v=n.common.getSelectedList()[0],this.updateState(_v),_v.on("change",this._changelistener),n.common.on("selector-add",this._addlistener=function(e){var n=e[0];n!==_v&&n.constructor===_v.constructor&&(_v.off("change",t._changelistener),n.on("change",t._changelistener),_v=n,t.updateState(n))})},updateState:function(t){var e=t.x,n=t.y,i=t.text,r=t.room;Object.assign(this.state,{x:e.toFixed(),y:n.toFixed(),isRoomLabel:!!r,text:i})},propertyAction:function(t){this[t]()},setPosition:function(){_v.setPosition(Number(this.state.x),Number(this.state.y))},openLabelModal:function(){this.state.text=_v.text.replaceAll("\n","\\n"),this.$refs["label-text-modal"].show()},setText:function(){_v.setText(this.state.text.replaceAll("\\n","\n")),this.$refs["label-text-modal"].hide()},deleteLabel:function(){var t=this.$spoke.getEditor("primary"),e=t.drawing;_v.off("change",this._changelistener),_v=null,e.common.remove()},backToCenter:function(){var t=this.$spoke.getEditor("primary"),e=t.drawing;e.viewport.backToCenter(_v)}}},Dv=Rv,Nv=Object(mf["a"])(Dv,Pv,Fv,!1,null,null,null),Wv=Nv.exports,Mv=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"pt-1"},[t._l(t.propertyList,(function(e,i){return n("b-form-group",{key:i,staticClass:"px-1 mb-2",attrs:{label:e.name,"label-class":"app-text-tiny"}},[n("b-input-group",{attrs:{append:e.append}},[n("b-input",{staticClass:"app-text-tiny",attrs:{type:"number",min:e.min,max:e.max,autocomplete:"off"},on:{change:function(n){return t.propertyAction(e.method)}},model:{value:t.state[e.value],callback:function(n){t.$set(t.state,e.value,t._n(n))},expression:"state[property.value]"}})],1)],1)})),n("div",[n("b-button-group",{staticClass:"px-1 mb-1"},[n("b-button",{staticClass:"app-collapse-button mr-1",on:{click:t.openLabelModal}},[t._v("修改文字")]),n("b-button",{staticClass:"app-collapse-button",on:{click:t.backToCenter}},[t._v("回中")])],1)],1),n("div",[n("b-button-group",{staticClass:"px-1"},[n("b-button",{staticClass:"app-collapse-button",attrs:{variant:"danger"},on:{click:t.deleteLabel}},[t._v("删除")])],1)],1),n("b-modal",{ref:"label-line-modal",attrs:{size:"sm","hide-footer":"",title:"标注内容"}},[n("div",{staticClass:"d-block text-center"},[n("b-form-input",{attrs:{placeholder:"No Text"},model:{value:t.state.text,callback:function(e){t.$set(t.state,"text",e)},expression:"state.text"}}),n("b-button",{staticClass:"mt-3",attrs:{variant:"info",block:""},on:{click:t.setText}},[t._v("确定")])],1)])],2)},Iv=[],Hv=[{name:"起点横坐标",value:"originX",method:"setOrigin"},{name:"起点纵坐标",value:"originY",method:"setOrigin"},{name:"终点横坐标",value:"targetX",method:"setTarget"},{name:"终点纵坐标",value:"targetY",method:"setTarget"}],Bv=null,zv={name:"FeatureElementLabelLine",data:function(){return{state:{originX:0,originY:0,targetX:0,targetY:0,text:""}}},computed:{propertyList:function(){return Hv}},mounted:function(){this.init()},destroyed:function(){var t=this.$spoke.getEditor("primary"),e=t.drawing;e.common.off("selector-add",this._addlistener),Bv&&!Bv.destroyed&&Bv.off("change",this._changelistener)},methods:{init:function(){var t=this,e=this.$spoke.getEditor("primary"),n=e.drawing;this._changelistener=function(e){return t.updateState(e)},Bv=n.common.getSelectedList()[0],this.updateState(Bv),Bv.on("change",this._changelistener),n.common.on("selector-add",this._addlistener=function(e){var n=e[0];n!==Bv&&n.constructor===Bv.constructor&&(Bv.off("change",t._changelistener),n.on("change",t._changelistener),Bv=n,t.updateState(n))})},updateState:function(t){var e=t.origin,n=t.target,i=t.text;Object.assign(this.state,{originX:e[0].toFixed(),originY:e[1].toFixed(),targetX:n[0].toFixed(),targetY:n[1].toFixed(),text:i})},propertyAction:function(t){this[t]()},setOrigin:function(){Bv.setOrigin([Number(this.state.originX),Number(this.state.originY)])},setTarget:function(){Bv.setTarget([Number(this.state.targetX),Number(this.state.targetY)])},openLabelModal:function(){this.state.text=Bv.text.replaceAll("\n","\\n"),this.$refs["label-line-modal"].show()},setText:function(){Bv.setText(this.state.text.replaceAll("\\n","\n")),this.$refs["label-line-modal"].hide()},deleteLabel:function(){var t=this.$spoke.getEditor("primary"),e=t.drawing;Bv.off("change",this._changelistener),Bv=null,e.common.remove()},backToCenter:function(){var t=this.$spoke.getEditor("primary"),e=t.drawing;e.viewport.backToCenter(Bv)}}},Vv=zv,Uv=Object(mf["a"])(Vv,Mv,Iv,!1,null,null,null),Yv=Uv.exports,Gv=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"pt-1"},[t._l(t.propertyList,(function(e,i){return n("b-form-group",{key:i,staticClass:"px-1 mb-2",attrs:{label:e.name,"label-class":"app-text-tiny"}},[n("b-input-group",{attrs:{append:e.append}},[n("b-input",{staticClass:"app-text-tiny",attrs:{type:"number",min:e.min,max:e.max,autocomplete:"off"},on:{change:function(n){return t.propertyAction(e.method)}},model:{value:t.state[e.value],callback:function(n){t.$set(t.state,e.value,t._n(n))},expression:"state[property.value]"}})],1)],1)})),n("b-button-group",{staticClass:"px-1"},[n("b-button",{staticClass:"app-collapse-button mr-1",on:{click:t.backToCenter}},[t._v("回中")]),n("b-button",{staticClass:"app-collapse-button",attrs:{variant:"danger"},on:{click:t.deleteCorner}},[t._v("删除")])],1)],2)},Xv=[],Kv=[{name:"横坐标",value:"x",method:"move"},{name:"纵坐标",value:"y",method:"move"}],Jv=null,qv={name:"FeatureElementWall",data:function(){return{state:{x:0,y:0}}},computed:{propertyList:function(){return Kv}},mounted:function(){this.init()},destroyed:function(){var t=this.$spoke.getEditor("primary"),e=t.drawing;e.common.off("selector-add",this._addlistener),Jv&&!Jv.destroyed&&Jv.off("change",this._changelistener)},methods:{init:function(){var t=this,e=this.$spoke.getEditor("primary"),n=e.drawing;this._changelistener=function(e){return t.updateState(e)},Jv=n.common.getSelectedList()[0],this.updateState(Jv),Jv.on("change",this._changelistener),n.common.on("selector-add",this._addlistener=function(e){var n=e[0];n!==Jv&&n.constructor===Jv.constructor&&(Jv.off("change",t._changelistener),n.on("change",t._changelistener),Jv=n,t.updateState(n))})},updateState:function(t){var e=t.x,n=t.y;Object.assign(this.state,{x:e.toFixed(),y:n.toFixed()})},propertyAction:function(t){this[t]()},move:function(){Jv.move(Number(this.state.x),Number(this.state.y))},deleteCorner:function(){var t=this.$spoke.getEditor("primary"),e=t.drawing;Jv.off("change",this._changelistener),Jv=null,e.common.remove()},backToCenter:function(){var t=this.$spoke.getEditor("primary"),e=t.drawing;e.viewport.backToCenter(Jv)}}},Qv=qv,Zv=Object(mf["a"])(Qv,Gv,Xv,!1,null,null,null),tm=Zv.exports,em=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"pt-1"},[n("b-form-group",{staticClass:"px-1 mb-2",attrs:{label:"墙体类型","label-class":"app-text-tiny"}},[n("b-form-group",[n("b-form-radio-group",{attrs:{options:t.wallTypeList,buttons:"","button-variant":"primary"},on:{change:t.setType},model:{value:t.state.type,callback:function(e){t.$set(t.state,"type",e)},expression:"state.type"}})],1)],1),t._l(t.propertyList,(function(e,i){return n("b-form-group",{key:i,staticClass:"px-1 mb-2",attrs:{label:e.name,"label-class":"app-text-tiny"}},[n("b-input-group",{attrs:{append:e.append}},[n("b-input",{staticClass:"app-text-tiny",attrs:{type:"number",min:e.min,max:e.max,autocomplete:"off"},on:{change:function(n){return t.propertyAction(e.method)}},model:{value:t.state[e.value],callback:function(n){t.$set(t.state,e.value,t._n(n))},expression:"state[property.value]"}})],1)],1)})),n("b-button-group",{staticClass:"px-1"},[n("b-button",{staticClass:"app-collapse-button mr-1",on:{click:t.backToCenter}},[t._v("回中")]),n("b-button",{staticClass:"app-collapse-button",attrs:{variant:"danger"},on:{click:t.deleteWall}},[t._v("删除")])],1)],2)},nm=[],im=[{name:"墙厚",value:"thickness",method:"setThickness"}],rm=null,om={name:"FeatureElementWall",data:function(){return{state:{thickness:0,type:"common"}}},computed:{propertyList:function(){return im},wallTypeList:function(){return this.$spoke.getConstant().wallTypeData}},mounted:function(){this.init()},destroyed:function(){var t=this.$spoke.getEditor("primary"),e=t.drawing;e.common.off("selector-add",this._addlistener),rm&&!rm.destroyed&&rm.off("change",this._changelistener)},methods:{init:function(){var t=this,e=this.$spoke.getEditor("primary"),n=e.drawing;this._changelistener=function(e){return t.updateState(e)},rm=n.common.getSelectedList()[0],this.updateState(rm),rm.on("change",this._changelistener),n.common.on("selector-add",this._addlistener=function(e){var n=e[0];n!==rm&&n.constructor===rm.constructor&&(rm.off("change",t._changelistener),n.on("change",t._changelistener),rm=n,t.updateState(n))})},updateState:function(t){var e=t.thickness,n=this.$spoke.getProperty("primary",t),i=n.type;Object.assign(this.state,{thickness:e.toFixed(),type:i||"common"})},propertyAction:function(t){this[t]()},setType:function(t){var e=this.$spoke.getConstant(),n=e.wallTypeColor;rm.color=n[t]||null,this.$spoke.setProperty("primary",rm,"type",t)},setThickness:function(){rm.thickness=Number(this.state.thickness)},deleteWall:function(){var t=this.$spoke.getEditor("primary"),e=t.drawing;rm.off("change",this._changelistener),rm=null,e.common.remove()},backToCenter:function(){var t=this.$spoke.getEditor("primary"),e=t.drawing;e.viewport.backToCenter(rm)}}},am=om,sm=Object(mf["a"])(am,em,nm,!1,null,null,null),cm=sm.exports,um=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"pt-1"},[n("b-form-group",{staticClass:"px-1 mb-2",attrs:{label:"房间类型","label-class":"app-text-tiny"}},[n("b-input-group",[n("b-input",{staticClass:"app-text-tiny",attrs:{autocomplete:"off",list:"room-name-id"},on:{change:t.setRoomName},model:{value:t.state.name,callback:function(e){t.$set(t.state,"name",e)},expression:"state.name"}}),n("datalist",{attrs:{id:"room-name-id"}},t._l(t.roomNameOptions,(function(e,i){return n("option",{key:i},[t._v(t._s(e))])})),0)],1)],1),n("b-form-group",{staticClass:"px-1 mb-2",attrs:{label:"地板","label-class":"app-text-tiny"}},[n("div",{staticClass:"d-flex flex-wrap py-1 pl-1"},t._l(t.floorList,(function(e,i){return n("div",{key:i,staticClass:"d-flex flex-column align-items-center mr-1",on:{click:function(n){return t.setFloor(e.id)}}},[n("span",{staticStyle:{width:"60px",height:"60px",cursor:"pointer"}},[n("b-img",{staticClass:"h-100 w-100",attrs:{src:e.url}})],1),n("span",{staticClass:"app-text-tiny"},[t._v(t._s(e.name))])])})),0)]),n("b-button-group",{staticClass:"px-1"},[n("b-button",{staticClass:"app-collapse-button",on:{click:t.backToCenter}},[t._v("回中")])],1)],1)},lm=[],hm=["客厅","卧室","厨房","餐厅","卫生间","储物间"],fm=null,dm=null,pm={name:"FeatureElementRoom",data:function(){return{state:{name:""}}},computed:{roomNameOptions:function(){return hm},floorList:function(){var t=this.$spoke.getConstant().floorList;return[{name:"空",url:null}].concat(t)}},mounted:function(){this.init()},destroyed:function(){var t=this.$spoke.getEditor("primary"),e=t.drawing;e.common.off("selector-add",this._addlistener)},methods:{init:function(){var t=this,e=this.$spoke.getEditor("primary"),n=e.drawing;fm=n.common.getSelectedList()[0],dm=this.getRoomLabel(n.label.textLabels(),fm),this.updateState(),n.common.on("selector-add",this._addlistener=function(e){var i=e[0];i!==fm&&i.constructor===fm.constructor&&(fm=i,dm=t.getRoomLabel(n.label.textLabels(),i),t.updateState())})},getRoomLabel:function(t,e){var n,i=Object(Te["a"])(t);try{for(i.s();!(n=i.n()).done;){var r=n.value;if(r.room===e)return r}}catch(o){i.e(o)}finally{i.f()}},updateState:function(){var t=dm.text,e=this.$spoke.getRoomAreaShow();Object.assign(this.state,{name:e?t.slice(0,t.indexOf("\n")):t})},setRoomName:function(){var t=dm.text,e=this.$spoke.getRoomAreaShow();this.state.name||(this.state.name="未命名");var n=e?"".concat(this.state.name).concat(t.slice(t.indexOf("\n"))):this.state.name;dm.setText(n)},setFloor:function(t){fm.setFloor(t)},backToCenter:function(){var t=this.$spoke.getEditor("primary"),e=t.drawing;e.viewport.backToCenter(fm)}}},vm=pm,mm=Object(mf["a"])(vm,um,lm,!1,null,null,null),gm=mm.exports,ym=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"pt-1"},[t._l(t.propertyList,(function(e,i){return n("b-form-group",{key:i,staticClass:"px-1 mb-2",attrs:{label:e.name,"label-class":"app-text-tiny"}},[n("b-input-group",{attrs:{append:e.append}},[n("b-input",{staticClass:"app-text-tiny",attrs:{type:"number",min:e.min,max:e.max,autocomplete:"off"},on:{change:function(n){return t.propertyAction(e.method)}},model:{value:t.state[e.value],callback:function(n){t.$set(t.state,e.value,t._n(n))},expression:"state[property.value]"}})],1)],1)})),n("div",{staticClass:"mb-1"},[n("b-button-group",{staticClass:"px-1"},[n("b-button",{staticClass:"app-collapse-button mr-1",on:{click:t.lockBitmap}},[t._v(t._s(t.state.locked?"解锁":"锁定"))]),n("b-button",{staticClass:"app-collapse-button mr-1",on:{click:t.defaultWidthHeight}},[t._v("恢复默认")]),n("b-button",{staticClass:"app-collapse-button",on:{click:t.backToCenter}},[t._v("回中")])],1)],1),n("div",[n("b-button-group",{staticClass:"px-1"},[n("b-button",{staticClass:"app-collapse-button",attrs:{variant:"danger"},on:{click:t.deleteBitmap}},[t._v("删除")])],1)],1)],2)},bm=[],xm=[{name:"横坐标",value:"x",method:"setPosition"},{name:"纵坐标",value:"y",method:"setPosition"},{name:"宽度",value:"width",append:"mm",method:"setWidth",min:10},{name:"高度",value:"height",append:"mm",method:"setHeight",min:10},{name:"角度",value:"rotation",append:"degrees",method:"setRotation",min:-360,max:360}],$m=function(t){return t/Math.PI/2*360},wm=function(t){return t/360*2*Math.PI},km=function(t){return 10*t},Om=null,jm={name:"FeatureElementBitmap",data:function(){return{state:{width:10,height:10,rotation:0,x:0,y:0,locked:!1}}},computed:{propertyList:function(){return xm}},mounted:function(){this.init()},destroyed:function(){var t=this.$spoke.getEditor("primary"),e=t.drawing;e.common.off("selector-add",this._addlistener),Om&&!Om.destroyed&&Om.off("change",this._changelistener)},methods:{init:function(){var t=this,e=this.$spoke.getEditor("primary"),n=e.drawing;this._changelistener=function(e){return t.updateState(e)},Om=n.common.getSelectedList()[0],this.updateState(Om),Om.on("change",this._changelistener),n.common.on("selector-add",this._addlistener=function(e){var n=e[0];n!==Om&&n.constructor===Om.constructor&&(Om.off("change",t._changelistener),n.on("change",t._changelistener),Om=n,t.updateState(n))})},updateState:function(t){var e=this.$spoke.getLocked(),n=t.width,i=t.height,r=t.rotation,o=t.x,a=t.y;Object.assign(this.state,{width:n.toFixed(),height:i.toFixed(),rotation:$m(r).toFixed(),x:o.toFixed(),y:a.toFixed(),locked:e.has(t)})},propertyAction:function(t){this[t]()},setWidth:function(){Om.setWidth(Number(this.state.width))},setHeight:function(){Om.setHeight(Number(this.state.height))},setRotation:function(){Om.setRotation(wm(this.state.rotation))},setPosition:function(){Om.setPosition(Number(this.state.x),Number(this.state.y))},defaultWidthHeight:function(){var t=this.$spoke.getConstant(),e=t.bitmap;Om.setHeight(km(e.dHeight)),Om.setWidth(km(e.dWidth)),Om.setRotation(0)},deleteBitmap:function(){var t=this.$spoke.getEditor("primary"),e=t.drawing;Om.off("change",this._changelistener),Om=null,e.common.remove()},lockBitmap:function(){var t=this.state.locked;t?this.$spoke.unlock(Om):this.$spoke.lock(Om),this.state.locked=!t},backToCenter:function(){var t=this.$spoke.getEditor("primary"),e=t.drawing;e.viewport.backToCenter(Om)}}},Tm=jm,Em=Object(mf["a"])(Tm,ym,bm,!1,null,null,null),Sm=Em.exports,Lm=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"pt-1"},t._l(t.propertyList,(function(e,i){return n("b-form-group",{key:i,staticClass:"px-1 mb-2",attrs:{label:e.name,"label-class":"app-text-tiny"}},[n("b-input-group",{attrs:{append:e.append}},[n("b-input",{staticClass:"app-text-tiny",attrs:{type:"number",min:e.min,max:e.max,autocomplete:"off"},on:{change:function(n){return t.propertyAction(e.method)}},model:{value:t.state[e.value],callback:function(n){t.$set(t.state,e.value,t._n(n))},expression:"state[property.value]"}})],1),n("b-form-checkbox",{staticClass:"mt-2",attrs:{switch:""},on:{change:t.changeAreaShow},model:{value:t.showArea,callback:function(e){t.showArea=e},expression:"showArea"}},[t._v("显示面积")]),n("b-form-checkbox",{staticClass:"mt-2",attrs:{switch:""},on:{change:t.changeEntryDoor},model:{value:t.showEntryDoor,callback:function(e){t.showEntryDoor=e},expression:"showEntryDoor"}},[t._v("显示入户门")])],1)})),1)},Cm=[],Pm=[{name:"方向",value:"compassRotation",append:"degrees",method:"setCompassRotation",min:-360,max:360}],Fm=function(t){return t/Math.PI/2*360},Am=function(t){return t/360*2*Math.PI},_m=null,Rm={name:"FeatureElementDrawing",data:function(){return{state:{compassRotation:0},showArea:!1,showEntryDoor:!1}},computed:{propertyList:function(){return Pm}},mounted:function(){this.init()},destroyed:function(){_m.element.off("change",this._compasslistener)},methods:{init:function(){var t=this,e=this.$spoke.getEditor("primary"),n=e.drawing;_m=n.compass,_m.element.on("change",this._compasslistener=function(e){t.state.compassRotation=Fm(e.rotation).toFixed()}),this.showArea=this.$spoke.getRoomAreaShow(),this.showEntryDoor=this.$spoke.getEntryDoorShow(),this.updateState()},updateState:function(){Object.assign(this.state,{compassRotation:Fm(_m.rotation).toFixed()})},propertyAction:function(t){this[t]()},setCompassRotation:function(){_m.setRotation(Am(this.state.compassRotation))},changeAreaShow:function(t){this.$spoke.setRoomAreaShow("primary",t)},changeEntryDoor:function(t){this.$spoke.setEntryDoorShow("primary",t)}}},Dm=Rm,Nm=Object(mf["a"])(Dm,Lm,Cm,!1,null,null,null),Wm=Nm.exports,Mm=new Map([[tt.Furniture.StuffProxy,wv],[tt.Windoor.HollowProxy,Cv],[tt.Label.LabelTextProxy,Wv],[tt.Label.LabelLineProxy,Yv],[tt.Structure.CornerProxy,tm],[tt.Structure.WallProxy,cm],[tt.Structure.RoomProxy,gm],[tt.Negative.BitmapProxy,Sm]]),Im=Wm,Hm={name:"FeatureElementProperty",components:{DrawingProperty:Im},data:function(){return{component:null}},mounted:function(){this.init()},destroyed:function(){var t=this.$spoke.getEditor("primary"),e=t.drawing;e.common.off("selector-add",this._addlistener),e.common.off("selector-clear",this._clearlistener)},methods:{init:function(){var t=this,e=this.$spoke.getEditor("primary"),n=e.drawing,i=n.common.getSelectedList();1===i.length&&(this.component=Mm.get(i[0].constructor)),n.common.on("selector-add",this._addlistener=function(e){1===e.length?t.component=Mm.get(e[0].constructor):t.component=null}),n.common.on("selector-clear",this._clearlistener=function(){t.component=null})}}},Bm=Hm,zm=Object(mf["a"])(Bm,lv,hv,!1,null,null,null),Vm=zm.exports,Um={id:"element",icon:"braces",title:"Element Property",component:Vm},Ym=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"d-flex flex-column",attrs:{id:"app-feature-overview-panel"}},t._l(t.itemList,(function(e,i){return n("b-card",{key:e,staticClass:"border-0",class:{"h-100":"furniture"===e},attrs:{"no-body":""}},[n("b-card-header",{attrs:{"header-class":"p-0"}},[n("b-button",{staticClass:"py-0 px-1 text-sm-left font-weight-bold app-collapse-button",attrs:{block:"",variant:"dark"},on:{click:function(e){return t.toggle(i)}}},[n("b-icon",{staticClass:"mr-1",attrs:{icon:t.visibleList[i]?"chevron-down":"chevron-right"}}),t._v(t._s(e))],1)],1),n("b-collapse",{staticClass:"overflow-auto",model:{value:t.visibleList[i],callback:function(e){t.$set(t.visibleList,i,e)},expression:"visibleList[index]"}},[n(t.itemMap[e].component,{tag:"component"})],1)],1)})),1)},Gm=[],Xm=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"d-flex flex-wrap py-1 pl-1"},t._l(t.doorList,(function(e){return n("div",{key:e.id,staticClass:"d-flex flex-column align-items-center mr-1",on:{click:function(n){return t.createDoor(e.id)}}},[n("span",{staticStyle:{width:"60px",height:"60px",cursor:"pointer"}},[n("b-img",{staticClass:"h-100 w-100",attrs:{src:"img/"+e.img+".png"}})],1),n("span",{staticClass:"app-text-tiny"},[t._v(t._s(e.title))])])})),0)},Km=[],Jm=[{id:"singleDoor",title:"单开门",img:"SingleDoor"},{id:"doubleDoor",title:"双开门",img:"DoubleDoor"},{id:"slidingDoor",title:"移门",img:"SlidingDoor"},{id:"parentDoor",title:"子母门",img:"ParentDoor"}],qm=[{id:"basicWindow",title:"窗",img:"BasicWindow"},{id:"boilerWindow",title:"飘窗",img:"BoilerWindow"},{id:"floorWindow",title:"落地窗",img:"FloorWindow"}],Qm={name:"FeatureResourceDoor",data:function(){return{doorList:Jm}},methods:{createDoor:function(t){var e=this.$spoke.getEditor("primary"),n=e.drawing,i=e.tool;i.closeAllTool(),n.windoor.createMovingHollow(t)}}},Zm=Qm,tg=Object(mf["a"])(Zm,Xm,Km,!1,null,null,null),eg=tg.exports,ng={id:"door",title:"door",component:eg},ig=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"d-flex flex-wrap py-1 pl-1"},t._l(t.windowList,(function(e){return n("div",{key:e.id,staticClass:"d-flex flex-column align-items-center mr-1",on:{click:function(n){return t.createWindow(e.id)}}},[n("span",{staticStyle:{width:"60px",height:"60px",cursor:"pointer"}},[n("img",{staticClass:"h-100 w-100",attrs:{src:"img/"+e.img+".png"}})]),n("span",{staticClass:"app-text-tiny"},[t._v(t._s(e.title))])])})),0)},rg=[],og={name:"FeatureResourceWindow",data:function(){return{windowList:qm}},methods:{createWindow:function(t){var e=this.$spoke.getEditor("primary"),n=e.drawing,i=e.tool;i.closeAllTool(),n.windoor.createMovingHollow(t)}}},ag=og,sg=Object(mf["a"])(ag,ig,rg,!1,null,null,null),cg=sg.exports,ug={id:"window",title:"window",component:cg},lg=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"d-flex flex-wrap py-1 pl-1"},t._l(t.furnitureList,(function(e,i){return n("div",{key:e.id+i,staticClass:"d-flex flex-column align-items-center mr-1",on:{click:function(n){return t.createFurniture(e.id,e.dWidth,e.dHeight)}}},[n("span",{staticStyle:{width:"60px",height:"60px",cursor:"pointer"}},[n("b-img",{staticClass:"h-100 w-100",attrs:{src:e.img}})],1),n("span",{staticClass:"app-text-tiny"},[t._v(t._s(e.title))])])})),0)},hg=[],fg=function(t){return 10*t},dg={name:"FeatureResourceFurniture",data:function(){return{furnitureList:this.$spoke.getConstant().furnitureList}},methods:{createFurniture:function(t,e,n){var i=this.$spoke.getEditor("primary"),r=i.drawing,o=i.tool;o.closeAllTool(),r.furniture.createMovingStuff(t,fg(e),fg(n))}}},pg=dg,vg=Object(mf["a"])(pg,lg,hg,!1,null,null,null),mg=vg.exports,gg={id:"furniture",title:"furniture",component:mg},yg=(uf={},Object(dt["a"])(uf,ng.id,ng),Object(dt["a"])(uf,ug.id,ug),Object(dt["a"])(uf,gg.id,gg),uf),bg=[ng.id,ug.id,gg.id],xg={name:"FeatureResourcePanel",data:function(){return{visibleList:bg.map((function(){return!0})),itemList:bg.slice(0)}},computed:{itemMap:function(){return yg}},methods:{toggle:function(t){this.$set(this.visibleList,t,!this.visibleList[t])}}},$g=xg,wg=(n("5eac"),Object(mf["a"])($g,Ym,Gm,!1,null,null,null)),kg=wg.exports,Og={id:"resource",icon:"inboxes",title:"Resource Manager",component:kg},jg=[Gp.id,Um.id,tv.id,uv.id,Og.id],Tg=(lf={},Object(dt["a"])(lf,Gp.id,Gp),Object(dt["a"])(lf,tv.id,tv),Object(dt["a"])(lf,uv.id,uv),Object(dt["a"])(lf,Um.id,Um),Object(dt["a"])(lf,Og.id,Og),lf),Eg={data:function(){return{current:jg[0],floor:this.$spoke.getFloor()}},computed:{idList:function(){return jg},features:function(){return Tg},currentFeature:function(){return this.features[this.current]}},mounted:function(){var t=this;this.floorInit(),this.$root.$on("featureChange",(function(e){t.current=jg[e]}))},methods:{floorInit:function(){var t=this.floor,e=t.floorList,n=t.extensionList;0===e.length&&(e.push({}),n.push({floorName:"未命名",isFirst:!0,wallList:[]}))}}},Sg=Eg,Lg=(n("7096"),Object(mf["a"])(Sg,Yd,Gd,!1,null,null,null)),Cg=Lg.exports,Pg=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("b-modal",{ref:"modal",attrs:{size:"lg",title:"Uncaught Error:"},on:{hide:t.modalHide}},[n("b-textarea",{staticStyle:{height:"30em"},attrs:{value:t.stack,readonly:"","no-resize":""}})],1)},Fg=[],Ag={data:function(){return{stack:""}},mounted:function(){var t=this;window.addEventListener("error",(function(e){t.stack=e.error.stack,t.$refs.modal.show()}))},methods:{modalHide:function(){window.location.reload()}}},_g=Ag,Rg=Object(mf["a"])(_g,Pg,Fg,!1,null,null,null),Dg=Rg.exports,Ng=new Map([[tt.Structure.CornerProxy,"corner"],[tt.Structure.WallProxy,"wall"],[tt.Structure.RoomProxy,"room"],[tt.Windoor.HollowProxy,"hollow"],[tt.Furniture.StuffProxy,"stuff"],[tt.Label.LabelTextProxy,"labelText"],[tt.Label.LabelLineProxy,"labelLine"],[tt.Negative.BitmapProxy,"bitmap"],[tt.Measure.DimensionProxy,"dimension"]]),Wg={components:{AppMenu:yf,AppToolGroupBar:$d,AppToolGroupSetting:Ed,AppStatusBar:Ud,AppFeaturePanel:Cg,AppError:Dg},data:function(){return{layout:{consoleHeight:200}}},mounted:function(){var t=this;this.$nextTick((function(){return t.layout.consoleHeight=200})),this.$spoke.getEditor("primary").drawing.mount(this.$refs.drawing),this.elementEventListen()},destroyed:function(){var t=this.$spoke.getEditor("primary"),e=t.drawing;e.off("element-create",this._createlistener),e.off("element-destroy",this._destroylistener)},methods:{elementEventListen:function(){var t=this,e=this.$spoke.getEditor("primary"),n=e.drawing;n.on("element-create",this._createlistener=function(e){var n=Ng.get(e.constructor);n&&t.$root.$emit("".concat(n,"-create"),e,n)}),n.on("element-destroy",this._destroylistener=function(e){var n=Ng.get(e.constructor);n&&t.$root.$emit("".concat(n,"-destroy"),e,n)})}}},Mg=Wg,Ig=Object(mf["a"])(Mg,ut,lt,!1,null,null,null),Hg=Ig.exports,Bg=n("22d0"),zg=n("c8ae"),Vg=n("5f5b"),Ug=n("b1e0"),Yg=(n("d9e2"),at.Utility),Gg=at.Viewport,Xg=at.Persistence,Kg=at.Floor,Jg=at.Dimension,qg=at.ToolGroup,Qg=at.Registry,Zg="default",ty=Object(ft["a"])((function t(e,n){Object(ht["a"])(this,t),this.drawing=e,this.tool=new qg.Constructor(e),this.serializer=new Xg.Serializer(e,n.serializer),this.deserializer=new Xg.Deserializer(e,n.deserializer),this.floor=new Kg.Constructor(e,this.serializer,this.deserializer)})),ey=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=new O.Drawing,n=new ty(e,t);return t.element&&e.mount(t.element),e.entrance.changeTexture("/img/double-up.svg"),Jg.Surface.all(e),Yg.AdjustViewportByPointerButton(e),Yg.PreventDefaultContextMenu(e),Yg.AdjustZoomByWheel(e),Yg.SetDefaultFloor(e,Zg),Yg.rotateCompassByDrag(e),Gg.MovingByWASD(e,10),Qg.Common.transformerRegister(e),Qg.Common.selectorRegister(e),n},ny=function(t){return(t/1e6).toFixed(2)},iy=function(t,e,n,i,r,o){return((n-t)*(o-e)-(r-t)*(i-e))/2},ry=function(t){if(!(t.length<3)){for(var e=t[0],n=0,i=0,r=0,o=t[1],a=2;a<t.length;a++){var s=t[a],c=iy.apply(void 0,Object(pt["a"])(e).concat(Object(pt["a"])(o),Object(pt["a"])(s)));r+=c,n+=(e[0]+o[0]+s[0])*c,i+=(e[1]+o[1]+s[1])*c,o=s}return[n/r/3,i/r/3]}},oy=tt.Bricklayer,ay=tt.Windoor,sy=tt.Label,cy=tt.Structure,uy={locked:new Set,roomAreaShow:!1,entryDoorShow:!1},ly=["singleDoor","doubleDoor","slidingDoor","parentDoor"],hy=function(t,e){var n,i=Object(Te["a"])(t.entrance.arrows());try{for(i.s();!(n=i.n()).done;){var r=n.value;r.hollow===e&&r.remove()}}catch(o){i.e(o)}finally{i.f()}},fy=function(t,e){if(uy.entryDoorShow&&ly.includes(e.materialName)){var n=e.surface,i=n.back,r=t.entrance.getAllArrowList();"virtual"!==n.name&&(n.room&&!i.room||!n.room&&i.room)?r.find((function(t){return t.hollow===e}))||t.entrance.createArrow(e):hy(t,e)}},dy=function(t){var e,n,i=t.drawing,r=t.tool,o=i.bricklayer.Builder,a=i.label.TextLabeler,s=i.label.LineLabeler,c=i.bricklayer.Chamber;i.on("pointerup",(function(t){if(0===t.button){var e=i.focusing;if(i.common.selectorAction(e),uy.locked.has(e))return;i.common.transformerAction(e),e instanceof ay.HollowProxy?i.hammer.adjuster.pick():i.hammer.adjuster.drop(),e instanceof sy.LabelTextProxy||e instanceof sy.LabelLineProxy?i.label.LabelTransformer.pick():i.label.LabelTransformer.drop()}})),i.on("pointerdown",(function(t){var e=t.button;if(o.$state===oy.STATE.Builder.PICKUP_TO){if(0===e)return void o.build().pick().pick();2===e&&o.drop()}else o.$state===oy.STATE.Builder.PICKUP_FROM&&0===e&&o.pick()}));var u=(e={},Object(dt["a"])(e,sy.STATE.TextLabeler.PICK,(function(t){0===t&&a.pick().open()})),Object(dt["a"])(e,sy.STATE.LineLabeler.PICK_ORIGIN,(function(t){0===t&&s.pick()})),Object(dt["a"])(e,sy.STATE.LineLabeler.PICK_TARGET,(function(t){0===t?s.pick().open():2===t&&s.close().open()})),e);i.on("pointerdown",(function(t){a.$state!==O.Plugin.Tool.READY&&u[a.$state](t.button),s.$state!==O.Plugin.Tool.READY&&u[s.$state](t.button)}));var l=(n={},Object(dt["a"])(n,oy.STATE.Chamber.PICKUP_FROM,(function(t){0===t&&c.pick()})),Object(dt["a"])(n,oy.STATE.Chamber.PICKUP_TO,(function(t){0===t?c.build().pick():2===t&&c.drop()})),n);i.on("pointerdown",(function(t){c.$state!==O.Plugin.Tool.READY&&l[c.$state](t.button)})),i.structure.on("room-created",(function(t){setTimeout((function(){var e,n=t.getOuterSurfaceList().map((function(t){return[t.corner.x,t.corner.y]})),r=uy.roomAreaShow?"未命名\n面积: ".concat(ny(t.area),"m²"):"未命名",a=(e=i.label).createLabelText.apply(e,Object(pt["a"])(ry(n)).concat([r]));a.setRoom(t);var s=t.area;t.on("dirty",(function(){if(t.area!==s){var e=t.getOuterSurfaceList().map((function(t){return[t.corner.x,t.corner.y]})),n=a.text,i=uy.roomAreaShow?"".concat(n.slice(0,n.indexOf("\n")),"\n面积: ").concat(ny(t.area),"m²"):n;a.setPosition.apply(a,Object(pt["a"])(ry(e))),a.setText(i),s=t.area}})),t.on("destroy",(function(){a.remove()}));var c=oy.STATE.Builder;o.$state===c.PICKUP_TO&&1!==o.from.size&&o.drop()}))})),i.structure.on("wall-created",(function(){var t,e=Object(Te["a"])(i.negative.bitmaps());try{for(e.s();!(t=e.n()).done;){var n=t.value;uy.locked.add(n)}}catch(r){e.e(r)}finally{e.f()}}));var h=function(t){fy(i,t),t.on("surface-change",(function(){fy(i,t)}))};i.on("element-create",(function(t){if(t instanceof ay.HollowProxy&&h(t),t instanceof cy.RoomProxy){var e,n=Object(Te["a"])(i.windoor.hollows());try{for(n.s();!(e=n.n()).done;){var r=e.value;fy(i,r)}}catch(o){n.e(o)}finally{n.f()}}}));var f=function(){var t=i.structure.getAllWallList();if(0===t.length){var e,n=Object(Te["a"])(i.negative.bitmaps());try{for(n.s();!(e=n.n()).done;){var r=e.value;uy.locked.delete(r)}}catch(o){n.e(o)}finally{n.f()}}};i.on("element-destroy",(function(t){if(t instanceof cy.WallProxy&&f(),t instanceof ay.HollowProxy&&hy(i,t),t instanceof cy.RoomProxy){var e,n=Object(Te["a"])(i.windoor.hollows());try{for(n.s();!(e=n.n()).done;){var r=e.value;fy(i,r)}}catch(o){n.e(o)}finally{n.f()}}})),window.addEventListener("keydown",(function(e){if("Escape"===e.key){if(r.activated===t.tool.symbol.WALL_BUILDER&&o.$state===oy.STATE.Builder.PICKUP_TO)return void o.drop();r.openDefault()}else"Delete"===e.key&&i.common.remove()}))},py=[{id:"bed",title:"床",img:"https://qhyxpicoss.kujiale.com/r/2020/03/30/L4D1111ENDDVAXSVUGEJKFNNVCQD3WKVY8_199x225.png",dWidth:180,dHeight:200},{id:"sofa",title:"沙发",img:"https://qhrenderpicoss.kujiale.com/r/2021/04/15/L4D1111ENDDV7Y72IBEJKVNWMVXL3WKVY8_303x104.png",dWidth:200,dHeight:100}],vy={url:"https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fpic.to8to.com%2Fcase%2F2006%2F23%2F20200623_6a750511c8d76b01310a6wvonv822qh0.jpg&refer=http%3A%2F%2Fpic.to8to.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=jpeg?sec=1645100826&t=0437dfdfef1405d8c159efd7c130d5ec",dWidth:2e3,dHeight:1500},my=[{text:"普通墙",value:"common"},{text:"承重墙",value:"bearing"},{text:"矮墙",value:"short"}],gy={bearing:3355443,short:16777215},yy=[{id:"default",name:"地板1",url:"https://qhcmsoss.kujiale.com/ttex/L2HNXEIKN4FT2AABAAAAAAY8.jpg"},{id:"floor2",name:"地板2",url:"https://file.t8tcdn.com/d/flash/567a/6b/bd/a3/567a6bbda31066a932cf1b80.jpg"},{id:"floor3",name:"地板3",url:"https://file.t8tcdn.com/d/flash/2020/11/13/16/20201113165143610211605256703196.jpg"},{id:"floor4",name:"地板4",url:"https://spriteoss.kujiale.com/tile/preview/2019/06/26/XRMsCApvBfEAAQAAAA0-large.jpg"},{id:"floor5",name:"地板5",url:"https://spriteoss.kujiale.com/tile/preview/2019/06/13/XQIWNApvCEwAAQAAAAA-large.jpg"}],by=function(t,e){t.serializer||(t.serializer={}),Object.assign(t.serializer,{walls:function(t){t.wallList=[]},wall:function(t,n){t.wallList.push(e.get(n))}}),t.deserializer||(t.deserializer={}),Object.assign(t.deserializer,{wall:function(t,n,i){var r=t.wallList[i];e.has(n)?Object.assign(e.get(n),r):e.set(n,r),r.type&&(n.color=gy[r.type])}})},xy=function(t,e,n){e.on(n,(function(e){t.has(e)||t.set(e,{}),e.on("destroy",(function(){return t.delete(e)}))}))},$y=function(t,e){var n=t.drawing;xy(e,n.structure,"corner-created"),xy(e,n.structure,"wall-created"),xy(e,n.structure,"room-created"),xy(e,n.windoor,"hollow-created"),xy(e,n.furniture,"stuff-created"),xy(e,n.label,"labeltext-created"),xy(e,n.label,"labelline-created"),xy(e,n.negative,"bitmap-created")},wy={},ky=function(t,e){wy[t]=setInterval((function(){var n=e.floorSerialize(t);localStorage.setItem("".concat(t,"Data"),JSON.stringify({error:!1,floor:n,date:Date.now()}))}),5e3),window.addEventListener("error",(function(){clearInterval(wy[t]);var e=JSON.parse(localStorage.getItem("".concat(t,"Data")));e.error=!0,localStorage.setItem("".concat(t,"Data"),JSON.stringify(e))}))},Oy=function(t,e){var n=JSON.parse(localStorage.getItem("".concat(t,"Data")));n&&n.error&&setTimeout((function(){var i=n.floor,r=i.floorList,o=i.extensionList,a=i.currentFloor;e.floorDeserialize(t,r,o,a)}))},jy={floorList:[],extensionList:[],currentFloor:0},Ty={},Ey={},Sy=Object.freeze({getEditor:function(t){var e=Ty[t];if(!e)throw new Error("id ".concat(t," is not existed"));return e},createEditor:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Ty[t];if(n)throw new Error("Duplicated id '".concat(t,"'"));Ey[t]=new Map,by(e,Ey[t]);var i=ey(e);return Ty[t]=i,dy(i),$y(i,Ey[t]),ky(t,Sy),i},setProperty:function(t,e,n,i){var r=Ey[t];if(!r)throw new Error("id ".concat(t," is not existed"));r.get(e)[n]=i},getProperty:function(t,e){var n=Ey[t];if(!n)throw new Error("id ".concat(t," is not existed"));return n.get(e)},resourceRegister:function(){at.Registry.Resource.windoorRegisterDefault();var t=py.map((function(t){return{id:t.id,url:t.img}})),e=yy.map((function(t){return{id:t.id,url:t.url}})),n=[at.Registry.Resource.furnitureListRegister(t),at.Registry.Resource.floorListRegister(e)];Promise.all(n).then((function(){Oy("primary",Sy)}))},getConstant:function(){return st},getFloor:function(){return jy},floorSerialize:function(t){var e=Ty[t],n=jy.floorList,i=jy.extensionList,r=jy.currentFloor,o=i[r];return n[jy.currentFloor]=e.serializer.execute(o),jy},floorDeserialize:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3?arguments[3]:void 0,r=Ty[t],o=void 0===i?n.findIndex((function(t){return t.isFirst})):i;return jy.floorList=e,jy.extensionList=n,jy.currentFloor=o,r.deserializer.execute(e[o],n[o]),jy},getLocked:function(){return uy.locked},lock:function(t){uy.locked.add(t)},unlock:function(t){uy.locked.delete(t)},getRoomAreaShow:function(){return uy.roomAreaShow},setRoomAreaShow:function(t,e){var n=Ty[t].drawing,i=n.label.getAllLabelTextList().filter((function(t){return t.room}));i.forEach((function(t){var n=t.text;e?t.setText("".concat(n,"\n面积: ").concat(ny(t.room.area),"m²")):t.setText(n.slice(0,n.indexOf("\n")))})),uy.roomAreaShow=e},getEntryDoorShow:function(){return uy.entryDoorShow},setEntryDoorShow:function(t,e){var n=Ty[t].drawing;if(uy.entryDoorShow=e,e){var i,r=Object(Te["a"])(n.windoor.hollows());try{for(r.s();!(i=r.n()).done;){var o=i.value;fy(n,o)}}catch(u){r.e(u)}finally{r.f()}}else{var a,s=Object(Te["a"])(n.entrance.arrows());try{for(s.s();!(a=s.n()).done;){var c=a.value;c.remove()}}catch(u){s.e(u)}finally{s.f()}}}}),Ly={install:function(t){t.prototype.$spoke=Sy}},Cy=(Sy.getEditor,Sy.createEditor),Py=Sy.resourceRegister,Fy=n("8f9c");ct["default"].use(Ly),ct["default"].use(Bg["a"]),ct["default"].use(zg["a"]),ct["default"].use(Vg["a"],Fy),ct["default"].use(Ug["a"]),window.d=Cy("primary"),Py(),new ct["default"]({render:function(t){return t(Hg)},mounted:function(){}}).$mount("#app"),window.addEventListener("keydown",(function(t){t.altKey&&t.preventDefault()}))},"5d77":function(t){t.exports=JSON.parse('{"a":"0.0.0"}')},"5eac":function(t,e,n){"use strict";n("d781")},6354:function(t,e,n){},"6c89":function(t,e,n){},7096:function(t,e,n){"use strict";n("73d0")},"73d0":function(t,e,n){},7612:function(t){t.exports=JSON.parse('{"a":"0.0.0"}')},"7c09":function(t){t.exports=JSON.parse('{"a":"0.0.0"}')},"8f9c":function(t){t.exports=JSON.parse('{"breakpoints":["xs","sm","md","lg","xl","xxl"],"formControls":{"size":"sm"},"BLink":{"activeClass":"active"},"BButton":{"variant":"primary","size":"sm"},"BToast":{"toaster":"b-toaster-top-center","autoHideDelay":3000,"variant":"primary","toastClass":null,"headerClass":null,"bodyClass":null},"BModal":{"cancelVariant":"secondary","okVariant":"primary"},"BFormGroup":{"labelSize":"sm"},"BInputGroup":{"size":"sm"},"BNavItem":{"linkClasses":["p-0","px-1"]}}')},"92e0":function(t){t.exports=JSON.parse('{"a":"0.0.0"}')},bf64:function(t,e){},c394:function(t){t.exports=JSON.parse('{"a":"0.0.0"}')},c5c2:function(t){t.exports=JSON.parse('{"a":"0.0.0"}')},c6f4:function(t,e,n){"use strict";n("6354")},d1d1:function(t,e,n){"use strict";n("ef4d")},d607:function(t,e,n){"use strict";n("6c89")},d781:function(t,e,n){},e07e:function(t){t.exports=JSON.parse('{"a":"0.0.0"}')},ef4d:function(t,e,n){}});